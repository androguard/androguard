// Ripped from https://github.com/Ch0pin/medusa/ and modified to fit Androguard packets

colorLog("[+] LOADING PREFERENCES/PREFERENCES.JS", { c: Color.Red });

var ContextWrapper = Java.use("android.content.ContextWrapper");

ContextWrapper.getSharedPreferences.overload(
    "java.lang.String",
    "int",
).implementation = function (var0, var1) {
    var sharedPreferences = this.getSharedPreferences(var0, var1);
    agPacket({ name: var0, mode: var1, ret: sharedPreferences }).send();
    return sharedPreferences;
};
