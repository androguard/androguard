
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="androguard Documentation">
      
      
        <meta name="author" content="androguard">
      
      
        <link rel="canonical" href="https://github.com/androguard/androguard/reference/androguard/decompiler/dataflow.html">
      
      
        <link rel="prev" href="dast.html">
      
      
        <link rel="next" href="decompile.html">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>dataflow - androguard</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#androguard.decompiler.dataflow" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="androguard" class="md-header__button md-logo" aria-label="androguard" data-md-component="logo">
      
  <img src="../../../assets/androguard.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            androguard
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              dataflow
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/androguard/androguard" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="androguard" class="md-nav__button md-logo" aria-label="androguard" data-md-component="logo">
      
  <img src="../../../assets/androguard.png" alt="logo">

    </a>
    androguard
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/androguard/androguard" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    androguard
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            androguard
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../cli/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cli
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1" id="__nav_3_1_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            cli
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/cli.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/main.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    main
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../core/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    core
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2" id="__nav_3_1_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../core/analysis/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    analysis
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2_1" id="__nav_3_1_1_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/analysis/analysis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    analysis
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/androconf.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    androconf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/api_specific_resources/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    api_specific_resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/apk/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../core/axml/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    axml
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2_5" id="__nav_3_1_1_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2_5">
            <span class="md-nav__icon md-icon"></span>
            axml
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/axml/types.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    types
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/bytecode.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bytecode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../core/dex/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    dex
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2_7" id="__nav_3_1_1_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2_7">
            <span class="md-nav__icon md-icon"></span>
            dex
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/dex/dex_types.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dex_types
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/mutf8/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mutf8
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../core/resources/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    resources
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2_9" id="__nav_3_1_1_2_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2_9">
            <span class="md-nav__icon md-icon"></span>
            resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/resources/public.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    public
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    decompiler
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_3" id="__nav_3_1_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            decompiler
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="basic_blocks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic_blocks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="control_flow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    control_flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dast
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    dataflow
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="dataflow.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    dataflow
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#androguard.decompiler.dataflow" class="md-nav__link">
    <span class="md-ellipsis">
      dataflow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.decompiler.dataflow.build_def_use" class="md-nav__link">
    <span class="md-ellipsis">
      build_def_use
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.decompiler.dataflow.clear_path" class="md-nav__link">
    <span class="md-ellipsis">
      clear_path
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.decompiler.dataflow.dead_code_elimination" class="md-nav__link">
    <span class="md-ellipsis">
      dead_code_elimination
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.decompiler.dataflow.register_propagation" class="md-nav__link">
    <span class="md-ellipsis">
      register_propagation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.decompiler.dataflow.update_chain" class="md-nav__link">
    <span class="md-ellipsis">
      update_chain
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="decompile.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    decompile
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="decompiler.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    decompiler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="graph.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graph
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="instruction.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    instruction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="node.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    node
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="opcode_ins.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    opcode_ins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="util.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="writer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    writer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    misc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../pentest/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    pentest
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_5" id="__nav_3_1_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            pentest
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pentest/adb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    adb
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../session.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../ui/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ui
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_7" id="__nav_3_1_1_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_7">
            <span class="md-nav__icon md-icon"></span>
            ui
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ui/data_types.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    data_types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ui/filter.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    filter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ui/selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ui/table.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ui/util.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_7_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../ui/widget/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    widget
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_7_6" id="__nav_3_1_1_7_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_7_6">
            <span class="md-nav__icon md-icon"></span>
            widget
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ui/widget/details.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    details
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ui/widget/filters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    filters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ui/widget/frame.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    frame
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ui/widget/help.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    help
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ui/widget/toolbar.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    toolbar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ui/widget/transactions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    transactions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../util.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    util
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#androguard.decompiler.dataflow" class="md-nav__link">
    <span class="md-ellipsis">
      dataflow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.decompiler.dataflow.build_def_use" class="md-nav__link">
    <span class="md-ellipsis">
      build_def_use
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.decompiler.dataflow.clear_path" class="md-nav__link">
    <span class="md-ellipsis">
      clear_path
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.decompiler.dataflow.dead_code_elimination" class="md-nav__link">
    <span class="md-ellipsis">
      dead_code_elimination
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.decompiler.dataflow.register_propagation" class="md-nav__link">
    <span class="md-ellipsis">
      register_propagation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.decompiler.dataflow.update_chain" class="md-nav__link">
    <span class="md-ellipsis">
      update_chain
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>dataflow</h1>

<div class="doc doc-object doc-module">



<a id="androguard.decompiler.dataflow"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="androguard.decompiler.dataflow.build_def_use" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_def_use</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">lparams</span><span class="p">)</span></code>

<a href="#androguard.decompiler.dataflow.build_def_use" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Builds the Def-Use and Use-Def (DU/UD) chains of the variables of the
method.</p>

            <details class="quote">
              <summary>Source code in <code>androguard/decompiler/dataflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="k">def</span> <span class="nf">build_def_use</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">lparams</span><span class="p">):</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">    Builds the Def-Use and Use-Def (DU/UD) chains of the variables of the</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">    method.</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">analysis</span> <span class="o">=</span> <span class="n">reach_def_analysis</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">lparams</span><span class="p">)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="n">UD</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">rpo</span><span class="p">:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ins</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">get_loc_with_ins</span><span class="p">():</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ins</span><span class="o">.</span><span class="n">get_used_vars</span><span class="p">():</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                <span class="c1"># var not in analysis.def_to_loc: test that the register</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>                <span class="c1"># exists. It is possible that it is not the case, when a</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                <span class="c1"># variable is of a type which is stored on multiple registers</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                <span class="c1"># e.g: a &#39;double&#39; stored in v3 is also present in v4, so a call</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                <span class="c1"># to foo(v3), will in fact call foo(v3, v4).</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">analysis</span><span class="o">.</span><span class="n">def_to_loc</span><span class="p">:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>                <span class="n">ldefs</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">defs</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>                <span class="n">prior_def</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ldefs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="nb">set</span><span class="p">()):</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>                    <span class="k">if</span> <span class="n">prior_def</span> <span class="o">&lt;</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                        <span class="n">prior_def</span> <span class="o">=</span> <span class="n">v</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                <span class="k">if</span> <span class="n">prior_def</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                    <span class="n">UD</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prior_def</span><span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>                    <span class="n">intersect</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">def_to_loc</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>                        <span class="n">analysis</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>                    <span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>                    <span class="n">UD</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">intersect</span><span class="p">)</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="n">DU</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="k">for</span> <span class="n">var_loc</span><span class="p">,</span> <span class="n">defs_loc</span> <span class="ow">in</span> <span class="n">UD</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="n">var</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">var_loc</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="k">for</span> <span class="n">def_loc</span> <span class="ow">in</span> <span class="n">defs_loc</span><span class="p">:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>            <span class="n">DU</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">def_loc</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="k">return</span> <span class="n">UD</span><span class="p">,</span> <span class="n">DU</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="androguard.decompiler.dataflow.clear_path" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clear_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">loc1</span><span class="p">,</span> <span class="n">loc2</span><span class="p">)</span></code>

<a href="#androguard.decompiler.dataflow.clear_path" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Check that the path from loc1 to loc2 is clear.
We have to check that there is no side effect between the two location
points. We also have to check that the variable <code>reg</code> is not redefined
along one of the possible pathes from loc1 to loc2.</p>

            <details class="quote">
              <summary>Source code in <code>androguard/decompiler/dataflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="k">def</span> <span class="nf">clear_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">loc1</span><span class="p">,</span> <span class="n">loc2</span><span class="p">):</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    Check that the path from loc1 to loc2 is clear.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    We have to check that there is no side effect between the two location</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    points. We also have to check that the variable `reg` is not redefined</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    along one of the possible pathes from loc1 to loc2.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;clear_path: reg(</span><span class="si">%s</span><span class="s1">), loc1(</span><span class="si">%s</span><span class="s1">), loc2(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">loc1</span><span class="p">,</span> <span class="n">loc2</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">node1</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">get_node_from_loc</span><span class="p">(</span><span class="n">loc1</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">node2</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">get_node_from_loc</span><span class="p">(</span><span class="n">loc2</span><span class="p">)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="c1"># If both instructions are in the same node, we only have to check that the</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="c1"># path is clear inside the node</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">if</span> <span class="n">node1</span> <span class="ow">is</span> <span class="n">node2</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="k">return</span> <span class="n">clear_path_node</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">loc1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">loc2</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="c1"># If instructions are in different nodes, we also have to check the nodes</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="c1"># in the path between the two locations.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">clear_path_node</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">loc1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">node1</span><span class="o">.</span><span class="n">ins_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="n">path</span> <span class="o">=</span> <span class="n">build_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node1</span><span class="p">,</span> <span class="n">node2</span><span class="p">)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">locs</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">ins_range</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">end_loc</span> <span class="o">=</span> <span class="n">loc2</span> <span class="k">if</span> <span class="p">(</span><span class="n">locs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">loc2</span> <span class="o">&lt;=</span> <span class="n">locs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">else</span> <span class="n">locs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">clear_path_node</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">locs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">end_loc</span><span class="p">):</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="androguard.decompiler.dataflow.dead_code_elimination" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dead_code_elimination</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">ud</span><span class="p">)</span></code>

<a href="#androguard.decompiler.dataflow.dead_code_elimination" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Run a dead code elimination pass.
Instructions are checked to be dead. If it is the case, we remove them and
we update the DU &amp; UD chains of its variables to check for further dead
instructions.</p>

            <details class="quote">
              <summary>Source code in <code>androguard/decompiler/dataflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="k">def</span> <span class="nf">dead_code_elimination</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">ud</span><span class="p">):</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    Run a dead code elimination pass.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    Instructions are checked to be dead. If it is the case, we remove them and</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    we update the DU &amp; UD chains of its variables to check for further dead</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    instructions.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">rpo</span><span class="p">:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ins</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">get_loc_with_ins</span><span class="p">():</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="n">reg</span> <span class="o">=</span> <span class="n">ins</span><span class="o">.</span><span class="n">get_lhs</span><span class="p">()</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="k">if</span> <span class="n">reg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>                <span class="c1"># If the definition is not used, we check that the instruction</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                <span class="c1"># has no side effect. If there is one and this is a call, we</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>                <span class="c1"># remove only the unused defined variable. else, this is</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>                <span class="c1"># something like an array access, so we do nothing.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>                <span class="c1"># Otherwise (no side effect) we can remove the instruction from</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>                <span class="c1"># the node.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">du</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>                    <span class="k">if</span> <span class="n">ins</span><span class="o">.</span><span class="n">is_call</span><span class="p">():</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>                        <span class="n">ins</span><span class="o">.</span><span class="n">remove_defined_var</span><span class="p">()</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                    <span class="k">elif</span> <span class="n">ins</span><span class="o">.</span><span class="n">has_side_effect</span><span class="p">():</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>                        <span class="k">continue</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                        <span class="c1"># We can delete the instruction. First update the DU</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                        <span class="c1"># chain of the variables used by the instruction to</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>                        <span class="c1"># `let them know` that they are not used anymore by the</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                        <span class="c1"># deleted instruction.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                        <span class="c1"># Then remove the instruction.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                        <span class="n">update_chain</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">ud</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>                        <span class="n">graph</span><span class="o">.</span><span class="n">remove_ins</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="androguard.decompiler.dataflow.register_propagation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_propagation</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">ud</span><span class="p">)</span></code>

<a href="#androguard.decompiler.dataflow.register_propagation" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Propagate the temporary registers between instructions and remove them if
necessary.
We process the nodes of the graph in reverse post order. For each
instruction in the node, we look at the variables that it uses. For each of
these variables we look where it is defined and if we can replace it with
its definition.
We have to be careful to the side effects some instructions may have.
To do the propagation, we use the computed DU and UD chains.</p>

            <details class="quote">
              <summary>Source code in <code>androguard/decompiler/dataflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="k">def</span> <span class="nf">register_propagation</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">ud</span><span class="p">):</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    Propagate the temporary registers between instructions and remove them if</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    necessary.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    We process the nodes of the graph in reverse post order. For each</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    instruction in the node, we look at the variables that it uses. For each of</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    these variables we look where it is defined and if we can replace it with</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    its definition.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    We have to be careful to the side effects some instructions may have.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    To do the propagation, we use the computed DU and UD chains.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="n">change</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="k">while</span> <span class="n">change</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="n">change</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">rpo</span><span class="p">:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ins</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">get_loc_with_ins</span><span class="p">():</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Treating instruction </span><span class="si">%d</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">ins</span><span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;  Used vars: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ins</span><span class="o">.</span><span class="n">get_used_vars</span><span class="p">())</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ins</span><span class="o">.</span><span class="n">get_used_vars</span><span class="p">():</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                    <span class="c1"># Get the list of locations this variable is defined at.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                    <span class="n">locs</span> <span class="o">=</span> <span class="n">ud</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;    var </span><span class="si">%s</span><span class="s1"> defined in lines </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">locs</span><span class="p">)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                    <span class="c1"># If the variable is uniquely defined for this instruction</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                    <span class="c1"># it may be eligible for propagation.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                        <span class="k">continue</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                    <span class="n">loc</span> <span class="o">=</span> <span class="n">locs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                    <span class="c1"># Methods parameters are defined with a location &lt; 0.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                    <span class="k">if</span> <span class="n">loc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>                        <span class="k">continue</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>                    <span class="n">orig_ins</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">get_ins_from_loc</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;     -&gt; </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">orig_ins</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                        <span class="s1">&#39;     -&gt; DU(</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">) = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">du</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">loc</span><span class="p">]</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                    <span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                    <span class="c1"># We defined some instructions as not propagable.</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>                    <span class="c1"># Actually this is the case only for array creation</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                    <span class="c1"># (new foo[x])</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">orig_ins</span><span class="o">.</span><span class="n">is_propagable</span><span class="p">():</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;    </span><span class="si">%s</span><span class="s1"> not propagable...&#39;</span><span class="p">,</span> <span class="n">orig_ins</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                        <span class="k">continue</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">orig_ins</span><span class="o">.</span><span class="n">get_rhs</span><span class="p">()</span><span class="o">.</span><span class="n">is_const</span><span class="p">():</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>                        <span class="c1"># We only try to propagate constants and definition</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>                        <span class="c1"># points which are used at only one location.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">du</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">loc</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>                            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>                                <span class="s1">&#39;       =&gt; variable has multiple uses&#39;</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>                                <span class="s1">&#39; and is not const =&gt; skip&#39;</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>                            <span class="p">)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>                            <span class="k">continue</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>                        <span class="c1"># We check that the propagation is safe for all the</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>                        <span class="c1"># variables that are used in the instruction.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>                        <span class="c1"># The propagation is not safe if there is a side effect</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>                        <span class="c1"># along the path from the definition of the variable</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>                        <span class="c1"># to its use in the instruction, or if the variable may</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>                        <span class="c1"># be redifined along this path.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>                        <span class="n">safe</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>                        <span class="n">orig_ins_used_vars</span> <span class="o">=</span> <span class="n">orig_ins</span><span class="o">.</span><span class="n">get_used_vars</span><span class="p">()</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>                            <span class="s1">&#39;    variables used by the original &#39;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>                            <span class="s1">&#39;instruction: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>                            <span class="n">orig_ins_used_vars</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>                        <span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>                        <span class="k">for</span> <span class="n">var2</span> <span class="ow">in</span> <span class="n">orig_ins_used_vars</span><span class="p">:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>                            <span class="c1"># loc is the location of the defined variable</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>                            <span class="c1"># i is the location of the current instruction</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">clear_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">var2</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                                <span class="n">safe</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>                                <span class="k">break</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">safe</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>                            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Propagation NOT SAFE&#39;</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>                            <span class="k">continue</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>                    <span class="c1"># We also check that the instruction itself is</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>                    <span class="c1"># propagable. If the instruction has a side effect it</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                    <span class="c1"># cannot be propagated if there is another side effect</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>                    <span class="c1"># along the path</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                    <span class="k">if</span> <span class="n">orig_ins</span><span class="o">.</span><span class="n">has_side_effect</span><span class="p">():</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">clear_path</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>                            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                                <span class="s1">&#39;        </span><span class="si">%s</span><span class="s1"> has side effect and the &#39;</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>                                <span class="s1">&#39;path is not clear !&#39;</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>                                <span class="n">orig_ins</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>                            <span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                            <span class="k">continue</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;     =&gt; Modification of the instruction!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;      - BEFORE: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ins</span><span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                    <span class="n">ins</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">orig_ins</span><span class="o">.</span><span class="n">get_rhs</span><span class="p">())</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;      -&gt; AFTER: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ins</span><span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> UD(</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">) : </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">ud</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>                    <span class="n">ud</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">    -&gt; </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ud</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ud</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>                        <span class="n">ud</span><span class="o">.</span><span class="n">pop</span><span class="p">((</span><span class="n">var</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>                    <span class="k">for</span> <span class="n">var2</span> <span class="ow">in</span> <span class="n">orig_ins</span><span class="o">.</span><span class="n">get_used_vars</span><span class="p">():</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>                        <span class="c1"># We update the UD chain of the variables we</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>                        <span class="c1"># propagate. We also have to take the</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>                        <span class="c1"># definition points of all the variables used</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>                        <span class="c1"># by the instruction and update the DU chain</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>                        <span class="c1"># with this information.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>                        <span class="n">old_ud</span> <span class="o">=</span> <span class="n">ud</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">var2</span><span class="p">,</span> <span class="n">loc</span><span class="p">))</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">  ud(</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">) = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">var2</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">old_ud</span><span class="p">)</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>                        <span class="c1"># If the instruction use the same variable</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>                        <span class="c1"># multiple times, the second+ time the ud chain</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>                        <span class="c1"># will be None because already treated.</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>                        <span class="k">if</span> <span class="n">old_ud</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>                            <span class="k">continue</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>                        <span class="n">ud</span><span class="p">[</span><span class="n">var2</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">old_ud</span><span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>                            <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">  - ud(</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">) = </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">var2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">ud</span><span class="p">[</span><span class="n">var2</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>                        <span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>                        <span class="n">ud</span><span class="o">.</span><span class="n">pop</span><span class="p">((</span><span class="n">var2</span><span class="p">,</span> <span class="n">loc</span><span class="p">))</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>                        <span class="k">for</span> <span class="n">def_loc</span> <span class="ow">in</span> <span class="n">old_ud</span><span class="p">:</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>                            <span class="n">du</span><span class="p">[</span><span class="n">var2</span><span class="p">,</span> <span class="n">def_loc</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>                            <span class="n">du</span><span class="p">[</span><span class="n">var2</span><span class="p">,</span> <span class="n">def_loc</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>                    <span class="n">new_du</span> <span class="o">=</span> <span class="n">du</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">loc</span><span class="p">]</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> new_du(</span><span class="si">%s</span><span class="s1">, </span><span class="si">%s</span><span class="s1">): </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">new_du</span><span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>                    <span class="n">new_du</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">    -&gt; </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">new_du</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">new_du</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">  REMOVING INS </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>                        <span class="n">du</span><span class="o">.</span><span class="n">pop</span><span class="p">((</span><span class="n">var</span><span class="p">,</span> <span class="n">loc</span><span class="p">))</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>                        <span class="n">graph</span><span class="o">.</span><span class="n">remove_ins</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>                        <span class="n">change</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="androguard.decompiler.dataflow.update_chain" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_chain</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">ud</span><span class="p">)</span></code>

<a href="#androguard.decompiler.dataflow.update_chain" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Updates the DU chain of the instruction located at loc such that there is
no more reference to it so that we can remove it.
When an instruction is found to be dead (i.e it has no side effect, and the
register defined is not used) we have to update the DU chain of all the
variables that may me used by the dead instruction.</p>

            <details class="quote">
              <summary>Source code in <code>androguard/decompiler/dataflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="k">def</span> <span class="nf">update_chain</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">ud</span><span class="p">):</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    Updates the DU chain of the instruction located at loc such that there is</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    no more reference to it so that we can remove it.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    When an instruction is found to be dead (i.e it has no side effect, and the</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    register defined is not used) we have to update the DU chain of all the</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    variables that may me used by the dead instruction.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">ins</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">get_ins_from_loc</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ins</span><span class="o">.</span><span class="n">get_used_vars</span><span class="p">():</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="c1"># We get the definition points of the current variable</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="k">for</span> <span class="n">def_loc</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">ud</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">loc</span><span class="p">]):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="c1"># We remove the use of the variable at loc from the DU chain of</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="c1"># the variable definition located at def_loc</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="n">du</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">def_loc</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="n">ud</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">loc</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">def_loc</span><span class="p">)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ud</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">var</span><span class="p">,</span> <span class="n">loc</span><span class="p">)):</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                <span class="n">ud</span><span class="o">.</span><span class="n">pop</span><span class="p">((</span><span class="n">var</span><span class="p">,</span> <span class="n">loc</span><span class="p">))</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="c1"># If the DU chain of the defined variable is now empty, this means</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>            <span class="c1"># that we may have created a new dead instruction, so we check that</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="c1"># the instruction has no side effect and we update the DU chain of</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="c1"># the new dead instruction, and we delete it.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="c1"># We also make sure that def_loc is not &lt; 0. This is the case when</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="c1"># the current variable is a method parameter.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="k">if</span> <span class="n">def_loc</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">du</span><span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">def_loc</span><span class="p">]:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="n">du</span><span class="o">.</span><span class="n">pop</span><span class="p">((</span><span class="n">var</span><span class="p">,</span> <span class="n">def_loc</span><span class="p">))</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                <span class="n">def_ins</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">get_ins_from_loc</span><span class="p">(</span><span class="n">def_loc</span><span class="p">)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                <span class="k">if</span> <span class="n">def_ins</span><span class="o">.</span><span class="n">is_call</span><span class="p">():</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                    <span class="n">def_ins</span><span class="o">.</span><span class="n">remove_defined_var</span><span class="p">()</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                <span class="k">elif</span> <span class="n">def_ins</span><span class="o">.</span><span class="n">has_side_effect</span><span class="p">():</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>                    <span class="n">update_chain</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">def_loc</span><span class="p">,</span> <span class="n">du</span><span class="p">,</span> <span class="n">ud</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                    <span class="n">graph</span><span class="o">.</span><span class="n">remove_ins</span><span class="p">(</span><span class="n">def_loc</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright  2024 androguard
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tracking", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>