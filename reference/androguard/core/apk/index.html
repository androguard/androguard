
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="androguard Documentation">
      
      
        <meta name="author" content="androguard">
      
      
        <link rel="canonical" href="https://github.com/androguard/androguard/reference/androguard/core/apk/index.html">
      
      
        <link rel="prev" href="../api_specific_resources/index.html">
      
      
        <link rel="next" href="../axml/index.html">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>apk - androguard</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#androguard.core.apk" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../index.html" title="androguard" class="md-header__button md-logo" aria-label="androguard" data-md-component="logo">
      
  <img src="../../../../assets/androguard.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            androguard
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              apk
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/androguard/androguard" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../index.html" title="androguard" class="md-nav__button md-logo" aria-label="androguard" data-md-component="logo">
      
  <img src="../../../../assets/androguard.png" alt="logo">

    </a>
    androguard
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/androguard/androguard" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    androguard
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            androguard
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cli/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cli
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1" id="__nav_3_1_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            cli
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/cli.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/main.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    main
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    core
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2" id="__nav_3_1_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../analysis/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    analysis
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2_1" id="__nav_3_1_1_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../analysis/analysis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    analysis
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../androconf.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    androconf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_specific_resources/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    api_specific_resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    apk
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="index.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    apk
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk" class="md-nav__link">
    <span class="md-ellipsis">
      apk
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.APK" class="md-nav__link">
    <span class="md-ellipsis">
      APK
    </span>
  </a>
  
    <nav class="md-nav" aria-label="APK">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.files" class="md-nav__link">
    <span class="md-ellipsis">
      files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.__getstate__" class="md-nav__link">
    <span class="md-ellipsis">
      __getstate__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      __setstate__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.canonical_name" class="md-nav__link">
    <span class="md-ellipsis">
      canonical_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.comparison_name" class="md-nav__link">
    <span class="md-ellipsis">
      comparison_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.find_certificate" class="md-nav__link">
    <span class="md-ellipsis">
      find_certificate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.find_tags" class="md-nav__link">
    <span class="md-ellipsis">
      find_tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.find_tags_from_xml" class="md-nav__link">
    <span class="md-ellipsis">
      find_tags_from_xml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_activities" class="md-nav__link">
    <span class="md-ellipsis">
      get_activities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_activity_aliases" class="md-nav__link">
    <span class="md-ellipsis">
      get_activity_aliases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_all_attribute_value" class="md-nav__link">
    <span class="md-ellipsis">
      get_all_attribute_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_all_dex" class="md-nav__link">
    <span class="md-ellipsis">
      get_all_dex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_android_manifest_axml" class="md-nav__link">
    <span class="md-ellipsis">
      get_android_manifest_axml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_android_manifest_xml" class="md-nav__link">
    <span class="md-ellipsis">
      get_android_manifest_xml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_android_resources" class="md-nav__link">
    <span class="md-ellipsis">
      get_android_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_androidversion_code" class="md-nav__link">
    <span class="md-ellipsis">
      get_androidversion_code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_androidversion_name" class="md-nav__link">
    <span class="md-ellipsis">
      get_androidversion_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_app_icon" class="md-nav__link">
    <span class="md-ellipsis">
      get_app_icon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_app_name" class="md-nav__link">
    <span class="md-ellipsis">
      get_app_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_attribute_value" class="md-nav__link">
    <span class="md-ellipsis">
      get_attribute_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificate" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificate_der" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificate_der
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificates" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificates_der_v2" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificates_der_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificates_der_v3" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificates_der_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificates_v1" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificates_v1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificates_v2" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificates_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificates_v3" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificates_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_declared_permissions" class="md-nav__link">
    <span class="md-ellipsis">
      get_declared_permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_declared_permissions_details" class="md-nav__link">
    <span class="md-ellipsis">
      get_declared_permissions_details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_details_permissions" class="md-nav__link">
    <span class="md-ellipsis">
      get_details_permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_dex" class="md-nav__link">
    <span class="md-ellipsis">
      get_dex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_dex_names" class="md-nav__link">
    <span class="md-ellipsis">
      get_dex_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_effective_target_sdk_version" class="md-nav__link">
    <span class="md-ellipsis">
      get_effective_target_sdk_version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_features" class="md-nav__link">
    <span class="md-ellipsis">
      get_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_file" class="md-nav__link">
    <span class="md-ellipsis">
      get_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_filename" class="md-nav__link">
    <span class="md-ellipsis">
      get_filename
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_files" class="md-nav__link">
    <span class="md-ellipsis">
      get_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_files_crc32" class="md-nav__link">
    <span class="md-ellipsis">
      get_files_crc32
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_files_information" class="md-nav__link">
    <span class="md-ellipsis">
      get_files_information
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_files_types" class="md-nav__link">
    <span class="md-ellipsis">
      get_files_types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_intent_filters" class="md-nav__link">
    <span class="md-ellipsis">
      get_intent_filters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_libraries" class="md-nav__link">
    <span class="md-ellipsis">
      get_libraries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_main_activities" class="md-nav__link">
    <span class="md-ellipsis">
      get_main_activities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_main_activity" class="md-nav__link">
    <span class="md-ellipsis">
      get_main_activity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_max_sdk_version" class="md-nav__link">
    <span class="md-ellipsis">
      get_max_sdk_version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_min_sdk_version" class="md-nav__link">
    <span class="md-ellipsis">
      get_min_sdk_version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_package" class="md-nav__link">
    <span class="md-ellipsis">
      get_package
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_permissions" class="md-nav__link">
    <span class="md-ellipsis">
      get_permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_providers" class="md-nav__link">
    <span class="md-ellipsis">
      get_providers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_public_keys_der_v2" class="md-nav__link">
    <span class="md-ellipsis">
      get_public_keys_der_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_public_keys_der_v3" class="md-nav__link">
    <span class="md-ellipsis">
      get_public_keys_der_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_public_keys_v2" class="md-nav__link">
    <span class="md-ellipsis">
      get_public_keys_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_public_keys_v3" class="md-nav__link">
    <span class="md-ellipsis">
      get_public_keys_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_raw" class="md-nav__link">
    <span class="md-ellipsis">
      get_raw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_receivers" class="md-nav__link">
    <span class="md-ellipsis">
      get_receivers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_requested_aosp_permissions" class="md-nav__link">
    <span class="md-ellipsis">
      get_requested_aosp_permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_requested_aosp_permissions_details" class="md-nav__link">
    <span class="md-ellipsis">
      get_requested_aosp_permissions_details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_requested_third_party_permissions" class="md-nav__link">
    <span class="md-ellipsis">
      get_requested_third_party_permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_res_value" class="md-nav__link">
    <span class="md-ellipsis">
      get_res_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_services" class="md-nav__link">
    <span class="md-ellipsis">
      get_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_signature" class="md-nav__link">
    <span class="md-ellipsis">
      get_signature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_signature_name" class="md-nav__link">
    <span class="md-ellipsis">
      get_signature_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_signature_names" class="md-nav__link">
    <span class="md-ellipsis">
      get_signature_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_signatures" class="md-nav__link">
    <span class="md-ellipsis">
      get_signatures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_target_sdk_version" class="md-nav__link">
    <span class="md-ellipsis">
      get_target_sdk_version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_uses_implied_permission_list" class="md-nav__link">
    <span class="md-ellipsis">
      get_uses_implied_permission_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_value_from_tag" class="md-nav__link">
    <span class="md-ellipsis">
      get_value_from_tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_androidtv" class="md-nav__link">
    <span class="md-ellipsis">
      is_androidtv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_leanback" class="md-nav__link">
    <span class="md-ellipsis">
      is_leanback
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_multidex" class="md-nav__link">
    <span class="md-ellipsis">
      is_multidex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_signed" class="md-nav__link">
    <span class="md-ellipsis">
      is_signed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_signed_v1" class="md-nav__link">
    <span class="md-ellipsis">
      is_signed_v1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_signed_v2" class="md-nav__link">
    <span class="md-ellipsis">
      is_signed_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_signed_v3" class="md-nav__link">
    <span class="md-ellipsis">
      is_signed_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_tag_matched" class="md-nav__link">
    <span class="md-ellipsis">
      is_tag_matched
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_valid_APK" class="md-nav__link">
    <span class="md-ellipsis">
      is_valid_APK
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_wearable" class="md-nav__link">
    <span class="md-ellipsis">
      is_wearable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.new_zip" class="md-nav__link">
    <span class="md-ellipsis">
      new_zip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.parse_signatures_or_digests" class="md-nav__link">
    <span class="md-ellipsis">
      parse_signatures_or_digests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.parse_v2_signing_block" class="md-nav__link">
    <span class="md-ellipsis">
      parse_v2_signing_block
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.parse_v3_signing_block" class="md-nav__link">
    <span class="md-ellipsis">
      parse_v3_signing_block
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.read_uint32_le" class="md-nav__link">
    <span class="md-ellipsis">
      read_uint32_le
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.x509_ordered_name" class="md-nav__link">
    <span class="md-ellipsis">
      x509_ordered_name
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.APKV2SignedData" class="md-nav__link">
    <span class="md-ellipsis">
      APKV2SignedData
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.APKV2Signer" class="md-nav__link">
    <span class="md-ellipsis">
      APKV2Signer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.APKV3SignedData" class="md-nav__link">
    <span class="md-ellipsis">
      APKV3SignedData
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.APKV3Signer" class="md-nav__link">
    <span class="md-ellipsis">
      APKV3Signer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.Error" class="md-nav__link">
    <span class="md-ellipsis">
      Error
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.ensure_final_value" class="md-nav__link">
    <span class="md-ellipsis">
      ensure_final_value
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.get_apkid" class="md-nav__link">
    <span class="md-ellipsis">
      get_apkid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.show_Certificate" class="md-nav__link">
    <span class="md-ellipsis">
      show_Certificate
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../axml/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    axml
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2_5" id="__nav_3_1_1_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2_5">
            <span class="md-nav__icon md-icon"></span>
            axml
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../axml/types.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    types
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bytecode.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bytecode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../dex/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    dex
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2_7" id="__nav_3_1_1_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2_7">
            <span class="md-nav__icon md-icon"></span>
            dex
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dex/dex_types.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dex_types
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mutf8/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mutf8
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../resources/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    resources
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2_9" id="__nav_3_1_1_2_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2_9">
            <span class="md-nav__icon md-icon"></span>
            resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../resources/public.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    public
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../decompiler/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    decompiler
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_3" id="__nav_3_1_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            decompiler
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/basic_blocks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic_blocks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/control_flow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    control_flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/dast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dast
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/dataflow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dataflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/decompile.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    decompile
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/decompiler.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    decompiler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/graph.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graph
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/instruction.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    instruction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/node.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    node
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/opcode_ins.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    opcode_ins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/util.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/writer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    writer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    misc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../pentest/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    pentest
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_5" id="__nav_3_1_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            pentest
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pentest/adb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    adb
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../session.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../ui/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ui
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_7" id="__nav_3_1_1_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_7">
            <span class="md-nav__icon md-icon"></span>
            ui
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/data_types.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    data_types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/filter.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    filter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/table.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/util.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_7_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../ui/widget/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    widget
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_7_6" id="__nav_3_1_1_7_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_7_6">
            <span class="md-nav__icon md-icon"></span>
            widget
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/widget/details.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    details
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/widget/filters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    filters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/widget/frame.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    frame
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/widget/help.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    help
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/widget/toolbar.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    toolbar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/widget/transactions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    transactions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../util.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    util
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk" class="md-nav__link">
    <span class="md-ellipsis">
      apk
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.APK" class="md-nav__link">
    <span class="md-ellipsis">
      APK
    </span>
  </a>
  
    <nav class="md-nav" aria-label="APK">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.files" class="md-nav__link">
    <span class="md-ellipsis">
      files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.__getstate__" class="md-nav__link">
    <span class="md-ellipsis">
      __getstate__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      __setstate__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.canonical_name" class="md-nav__link">
    <span class="md-ellipsis">
      canonical_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.comparison_name" class="md-nav__link">
    <span class="md-ellipsis">
      comparison_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.find_certificate" class="md-nav__link">
    <span class="md-ellipsis">
      find_certificate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.find_tags" class="md-nav__link">
    <span class="md-ellipsis">
      find_tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.find_tags_from_xml" class="md-nav__link">
    <span class="md-ellipsis">
      find_tags_from_xml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_activities" class="md-nav__link">
    <span class="md-ellipsis">
      get_activities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_activity_aliases" class="md-nav__link">
    <span class="md-ellipsis">
      get_activity_aliases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_all_attribute_value" class="md-nav__link">
    <span class="md-ellipsis">
      get_all_attribute_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_all_dex" class="md-nav__link">
    <span class="md-ellipsis">
      get_all_dex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_android_manifest_axml" class="md-nav__link">
    <span class="md-ellipsis">
      get_android_manifest_axml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_android_manifest_xml" class="md-nav__link">
    <span class="md-ellipsis">
      get_android_manifest_xml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_android_resources" class="md-nav__link">
    <span class="md-ellipsis">
      get_android_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_androidversion_code" class="md-nav__link">
    <span class="md-ellipsis">
      get_androidversion_code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_androidversion_name" class="md-nav__link">
    <span class="md-ellipsis">
      get_androidversion_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_app_icon" class="md-nav__link">
    <span class="md-ellipsis">
      get_app_icon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_app_name" class="md-nav__link">
    <span class="md-ellipsis">
      get_app_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_attribute_value" class="md-nav__link">
    <span class="md-ellipsis">
      get_attribute_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificate" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificate_der" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificate_der
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificates" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificates_der_v2" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificates_der_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificates_der_v3" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificates_der_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificates_v1" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificates_v1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificates_v2" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificates_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_certificates_v3" class="md-nav__link">
    <span class="md-ellipsis">
      get_certificates_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_declared_permissions" class="md-nav__link">
    <span class="md-ellipsis">
      get_declared_permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_declared_permissions_details" class="md-nav__link">
    <span class="md-ellipsis">
      get_declared_permissions_details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_details_permissions" class="md-nav__link">
    <span class="md-ellipsis">
      get_details_permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_dex" class="md-nav__link">
    <span class="md-ellipsis">
      get_dex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_dex_names" class="md-nav__link">
    <span class="md-ellipsis">
      get_dex_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_effective_target_sdk_version" class="md-nav__link">
    <span class="md-ellipsis">
      get_effective_target_sdk_version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_features" class="md-nav__link">
    <span class="md-ellipsis">
      get_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_file" class="md-nav__link">
    <span class="md-ellipsis">
      get_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_filename" class="md-nav__link">
    <span class="md-ellipsis">
      get_filename
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_files" class="md-nav__link">
    <span class="md-ellipsis">
      get_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_files_crc32" class="md-nav__link">
    <span class="md-ellipsis">
      get_files_crc32
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_files_information" class="md-nav__link">
    <span class="md-ellipsis">
      get_files_information
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_files_types" class="md-nav__link">
    <span class="md-ellipsis">
      get_files_types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_intent_filters" class="md-nav__link">
    <span class="md-ellipsis">
      get_intent_filters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_libraries" class="md-nav__link">
    <span class="md-ellipsis">
      get_libraries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_main_activities" class="md-nav__link">
    <span class="md-ellipsis">
      get_main_activities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_main_activity" class="md-nav__link">
    <span class="md-ellipsis">
      get_main_activity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_max_sdk_version" class="md-nav__link">
    <span class="md-ellipsis">
      get_max_sdk_version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_min_sdk_version" class="md-nav__link">
    <span class="md-ellipsis">
      get_min_sdk_version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_package" class="md-nav__link">
    <span class="md-ellipsis">
      get_package
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_permissions" class="md-nav__link">
    <span class="md-ellipsis">
      get_permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_providers" class="md-nav__link">
    <span class="md-ellipsis">
      get_providers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_public_keys_der_v2" class="md-nav__link">
    <span class="md-ellipsis">
      get_public_keys_der_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_public_keys_der_v3" class="md-nav__link">
    <span class="md-ellipsis">
      get_public_keys_der_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_public_keys_v2" class="md-nav__link">
    <span class="md-ellipsis">
      get_public_keys_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_public_keys_v3" class="md-nav__link">
    <span class="md-ellipsis">
      get_public_keys_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_raw" class="md-nav__link">
    <span class="md-ellipsis">
      get_raw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_receivers" class="md-nav__link">
    <span class="md-ellipsis">
      get_receivers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_requested_aosp_permissions" class="md-nav__link">
    <span class="md-ellipsis">
      get_requested_aosp_permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_requested_aosp_permissions_details" class="md-nav__link">
    <span class="md-ellipsis">
      get_requested_aosp_permissions_details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_requested_third_party_permissions" class="md-nav__link">
    <span class="md-ellipsis">
      get_requested_third_party_permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_res_value" class="md-nav__link">
    <span class="md-ellipsis">
      get_res_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_services" class="md-nav__link">
    <span class="md-ellipsis">
      get_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_signature" class="md-nav__link">
    <span class="md-ellipsis">
      get_signature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_signature_name" class="md-nav__link">
    <span class="md-ellipsis">
      get_signature_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_signature_names" class="md-nav__link">
    <span class="md-ellipsis">
      get_signature_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_signatures" class="md-nav__link">
    <span class="md-ellipsis">
      get_signatures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_target_sdk_version" class="md-nav__link">
    <span class="md-ellipsis">
      get_target_sdk_version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_uses_implied_permission_list" class="md-nav__link">
    <span class="md-ellipsis">
      get_uses_implied_permission_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.get_value_from_tag" class="md-nav__link">
    <span class="md-ellipsis">
      get_value_from_tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_androidtv" class="md-nav__link">
    <span class="md-ellipsis">
      is_androidtv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_leanback" class="md-nav__link">
    <span class="md-ellipsis">
      is_leanback
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_multidex" class="md-nav__link">
    <span class="md-ellipsis">
      is_multidex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_signed" class="md-nav__link">
    <span class="md-ellipsis">
      is_signed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_signed_v1" class="md-nav__link">
    <span class="md-ellipsis">
      is_signed_v1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_signed_v2" class="md-nav__link">
    <span class="md-ellipsis">
      is_signed_v2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_signed_v3" class="md-nav__link">
    <span class="md-ellipsis">
      is_signed_v3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_tag_matched" class="md-nav__link">
    <span class="md-ellipsis">
      is_tag_matched
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_valid_APK" class="md-nav__link">
    <span class="md-ellipsis">
      is_valid_APK
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.is_wearable" class="md-nav__link">
    <span class="md-ellipsis">
      is_wearable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.new_zip" class="md-nav__link">
    <span class="md-ellipsis">
      new_zip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.parse_signatures_or_digests" class="md-nav__link">
    <span class="md-ellipsis">
      parse_signatures_or_digests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.parse_v2_signing_block" class="md-nav__link">
    <span class="md-ellipsis">
      parse_v2_signing_block
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.parse_v3_signing_block" class="md-nav__link">
    <span class="md-ellipsis">
      parse_v3_signing_block
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.read_uint32_le" class="md-nav__link">
    <span class="md-ellipsis">
      read_uint32_le
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.apk.APK.x509_ordered_name" class="md-nav__link">
    <span class="md-ellipsis">
      x509_ordered_name
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.APKV2SignedData" class="md-nav__link">
    <span class="md-ellipsis">
      APKV2SignedData
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.APKV2Signer" class="md-nav__link">
    <span class="md-ellipsis">
      APKV2Signer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.APKV3SignedData" class="md-nav__link">
    <span class="md-ellipsis">
      APKV3SignedData
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.APKV3Signer" class="md-nav__link">
    <span class="md-ellipsis">
      APKV3Signer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.Error" class="md-nav__link">
    <span class="md-ellipsis">
      Error
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.ensure_final_value" class="md-nav__link">
    <span class="md-ellipsis">
      ensure_final_value
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.get_apkid" class="md-nav__link">
    <span class="md-ellipsis">
      get_apkid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.apk.show_Certificate" class="md-nav__link">
    <span class="md-ellipsis">
      show_Certificate
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>apk</h1>

<div class="doc doc-object doc-module">



<a id="androguard.core.apk"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="androguard.core.apk.APK" class="doc doc-heading">
            <code>APK</code>


<a href="#androguard.core.apk.APK" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-288"> 288</a></span>
<span class="normal"><a href="#__codelineno-0-289"> 289</a></span>
<span class="normal"><a href="#__codelineno-0-290"> 290</a></span>
<span class="normal"><a href="#__codelineno-0-291"> 291</a></span>
<span class="normal"><a href="#__codelineno-0-292"> 292</a></span>
<span class="normal"><a href="#__codelineno-0-293"> 293</a></span>
<span class="normal"><a href="#__codelineno-0-294"> 294</a></span>
<span class="normal"><a href="#__codelineno-0-295"> 295</a></span>
<span class="normal"><a href="#__codelineno-0-296"> 296</a></span>
<span class="normal"><a href="#__codelineno-0-297"> 297</a></span>
<span class="normal"><a href="#__codelineno-0-298"> 298</a></span>
<span class="normal"><a href="#__codelineno-0-299"> 299</a></span>
<span class="normal"><a href="#__codelineno-0-300"> 300</a></span>
<span class="normal"><a href="#__codelineno-0-301"> 301</a></span>
<span class="normal"><a href="#__codelineno-0-302"> 302</a></span>
<span class="normal"><a href="#__codelineno-0-303"> 303</a></span>
<span class="normal"><a href="#__codelineno-0-304"> 304</a></span>
<span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span>
<span class="normal"><a href="#__codelineno-0-1522">1522</a></span>
<span class="normal"><a href="#__codelineno-0-1523">1523</a></span>
<span class="normal"><a href="#__codelineno-0-1524">1524</a></span>
<span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span>
<span class="normal"><a href="#__codelineno-0-1530">1530</a></span>
<span class="normal"><a href="#__codelineno-0-1531">1531</a></span>
<span class="normal"><a href="#__codelineno-0-1532">1532</a></span>
<span class="normal"><a href="#__codelineno-0-1533">1533</a></span>
<span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span>
<span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span>
<span class="normal"><a href="#__codelineno-0-1927">1927</a></span>
<span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span>
<span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span>
<span class="normal"><a href="#__codelineno-0-2012">2012</a></span>
<span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span>
<span class="normal"><a href="#__codelineno-0-2015">2015</a></span>
<span class="normal"><a href="#__codelineno-0-2016">2016</a></span>
<span class="normal"><a href="#__codelineno-0-2017">2017</a></span>
<span class="normal"><a href="#__codelineno-0-2018">2018</a></span>
<span class="normal"><a href="#__codelineno-0-2019">2019</a></span>
<span class="normal"><a href="#__codelineno-0-2020">2020</a></span>
<span class="normal"><a href="#__codelineno-0-2021">2021</a></span>
<span class="normal"><a href="#__codelineno-0-2022">2022</a></span>
<span class="normal"><a href="#__codelineno-0-2023">2023</a></span>
<span class="normal"><a href="#__codelineno-0-2024">2024</a></span>
<span class="normal"><a href="#__codelineno-0-2025">2025</a></span>
<span class="normal"><a href="#__codelineno-0-2026">2026</a></span>
<span class="normal"><a href="#__codelineno-0-2027">2027</a></span>
<span class="normal"><a href="#__codelineno-0-2028">2028</a></span>
<span class="normal"><a href="#__codelineno-0-2029">2029</a></span>
<span class="normal"><a href="#__codelineno-0-2030">2030</a></span>
<span class="normal"><a href="#__codelineno-0-2031">2031</a></span>
<span class="normal"><a href="#__codelineno-0-2032">2032</a></span>
<span class="normal"><a href="#__codelineno-0-2033">2033</a></span>
<span class="normal"><a href="#__codelineno-0-2034">2034</a></span>
<span class="normal"><a href="#__codelineno-0-2035">2035</a></span>
<span class="normal"><a href="#__codelineno-0-2036">2036</a></span>
<span class="normal"><a href="#__codelineno-0-2037">2037</a></span>
<span class="normal"><a href="#__codelineno-0-2038">2038</a></span>
<span class="normal"><a href="#__codelineno-0-2039">2039</a></span>
<span class="normal"><a href="#__codelineno-0-2040">2040</a></span>
<span class="normal"><a href="#__codelineno-0-2041">2041</a></span>
<span class="normal"><a href="#__codelineno-0-2042">2042</a></span>
<span class="normal"><a href="#__codelineno-0-2043">2043</a></span>
<span class="normal"><a href="#__codelineno-0-2044">2044</a></span>
<span class="normal"><a href="#__codelineno-0-2045">2045</a></span>
<span class="normal"><a href="#__codelineno-0-2046">2046</a></span>
<span class="normal"><a href="#__codelineno-0-2047">2047</a></span>
<span class="normal"><a href="#__codelineno-0-2048">2048</a></span>
<span class="normal"><a href="#__codelineno-0-2049">2049</a></span>
<span class="normal"><a href="#__codelineno-0-2050">2050</a></span>
<span class="normal"><a href="#__codelineno-0-2051">2051</a></span>
<span class="normal"><a href="#__codelineno-0-2052">2052</a></span>
<span class="normal"><a href="#__codelineno-0-2053">2053</a></span>
<span class="normal"><a href="#__codelineno-0-2054">2054</a></span>
<span class="normal"><a href="#__codelineno-0-2055">2055</a></span>
<span class="normal"><a href="#__codelineno-0-2056">2056</a></span>
<span class="normal"><a href="#__codelineno-0-2057">2057</a></span>
<span class="normal"><a href="#__codelineno-0-2058">2058</a></span>
<span class="normal"><a href="#__codelineno-0-2059">2059</a></span>
<span class="normal"><a href="#__codelineno-0-2060">2060</a></span>
<span class="normal"><a href="#__codelineno-0-2061">2061</a></span>
<span class="normal"><a href="#__codelineno-0-2062">2062</a></span>
<span class="normal"><a href="#__codelineno-0-2063">2063</a></span>
<span class="normal"><a href="#__codelineno-0-2064">2064</a></span>
<span class="normal"><a href="#__codelineno-0-2065">2065</a></span>
<span class="normal"><a href="#__codelineno-0-2066">2066</a></span>
<span class="normal"><a href="#__codelineno-0-2067">2067</a></span>
<span class="normal"><a href="#__codelineno-0-2068">2068</a></span>
<span class="normal"><a href="#__codelineno-0-2069">2069</a></span>
<span class="normal"><a href="#__codelineno-0-2070">2070</a></span>
<span class="normal"><a href="#__codelineno-0-2071">2071</a></span>
<span class="normal"><a href="#__codelineno-0-2072">2072</a></span>
<span class="normal"><a href="#__codelineno-0-2073">2073</a></span>
<span class="normal"><a href="#__codelineno-0-2074">2074</a></span>
<span class="normal"><a href="#__codelineno-0-2075">2075</a></span>
<span class="normal"><a href="#__codelineno-0-2076">2076</a></span>
<span class="normal"><a href="#__codelineno-0-2077">2077</a></span>
<span class="normal"><a href="#__codelineno-0-2078">2078</a></span>
<span class="normal"><a href="#__codelineno-0-2079">2079</a></span>
<span class="normal"><a href="#__codelineno-0-2080">2080</a></span>
<span class="normal"><a href="#__codelineno-0-2081">2081</a></span>
<span class="normal"><a href="#__codelineno-0-2082">2082</a></span>
<span class="normal"><a href="#__codelineno-0-2083">2083</a></span>
<span class="normal"><a href="#__codelineno-0-2084">2084</a></span>
<span class="normal"><a href="#__codelineno-0-2085">2085</a></span>
<span class="normal"><a href="#__codelineno-0-2086">2086</a></span>
<span class="normal"><a href="#__codelineno-0-2087">2087</a></span>
<span class="normal"><a href="#__codelineno-0-2088">2088</a></span>
<span class="normal"><a href="#__codelineno-0-2089">2089</a></span>
<span class="normal"><a href="#__codelineno-0-2090">2090</a></span>
<span class="normal"><a href="#__codelineno-0-2091">2091</a></span>
<span class="normal"><a href="#__codelineno-0-2092">2092</a></span>
<span class="normal"><a href="#__codelineno-0-2093">2093</a></span>
<span class="normal"><a href="#__codelineno-0-2094">2094</a></span>
<span class="normal"><a href="#__codelineno-0-2095">2095</a></span>
<span class="normal"><a href="#__codelineno-0-2096">2096</a></span>
<span class="normal"><a href="#__codelineno-0-2097">2097</a></span>
<span class="normal"><a href="#__codelineno-0-2098">2098</a></span>
<span class="normal"><a href="#__codelineno-0-2099">2099</a></span>
<span class="normal"><a href="#__codelineno-0-2100">2100</a></span>
<span class="normal"><a href="#__codelineno-0-2101">2101</a></span>
<span class="normal"><a href="#__codelineno-0-2102">2102</a></span>
<span class="normal"><a href="#__codelineno-0-2103">2103</a></span>
<span class="normal"><a href="#__codelineno-0-2104">2104</a></span>
<span class="normal"><a href="#__codelineno-0-2105">2105</a></span>
<span class="normal"><a href="#__codelineno-0-2106">2106</a></span>
<span class="normal"><a href="#__codelineno-0-2107">2107</a></span>
<span class="normal"><a href="#__codelineno-0-2108">2108</a></span>
<span class="normal"><a href="#__codelineno-0-2109">2109</a></span>
<span class="normal"><a href="#__codelineno-0-2110">2110</a></span>
<span class="normal"><a href="#__codelineno-0-2111">2111</a></span>
<span class="normal"><a href="#__codelineno-0-2112">2112</a></span>
<span class="normal"><a href="#__codelineno-0-2113">2113</a></span>
<span class="normal"><a href="#__codelineno-0-2114">2114</a></span>
<span class="normal"><a href="#__codelineno-0-2115">2115</a></span>
<span class="normal"><a href="#__codelineno-0-2116">2116</a></span>
<span class="normal"><a href="#__codelineno-0-2117">2117</a></span>
<span class="normal"><a href="#__codelineno-0-2118">2118</a></span>
<span class="normal"><a href="#__codelineno-0-2119">2119</a></span>
<span class="normal"><a href="#__codelineno-0-2120">2120</a></span>
<span class="normal"><a href="#__codelineno-0-2121">2121</a></span>
<span class="normal"><a href="#__codelineno-0-2122">2122</a></span>
<span class="normal"><a href="#__codelineno-0-2123">2123</a></span>
<span class="normal"><a href="#__codelineno-0-2124">2124</a></span>
<span class="normal"><a href="#__codelineno-0-2125">2125</a></span>
<span class="normal"><a href="#__codelineno-0-2126">2126</a></span>
<span class="normal"><a href="#__codelineno-0-2127">2127</a></span>
<span class="normal"><a href="#__codelineno-0-2128">2128</a></span>
<span class="normal"><a href="#__codelineno-0-2129">2129</a></span>
<span class="normal"><a href="#__codelineno-0-2130">2130</a></span>
<span class="normal"><a href="#__codelineno-0-2131">2131</a></span>
<span class="normal"><a href="#__codelineno-0-2132">2132</a></span>
<span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span>
<span class="normal"><a href="#__codelineno-0-2135">2135</a></span>
<span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span>
<span class="normal"><a href="#__codelineno-0-2138">2138</a></span>
<span class="normal"><a href="#__codelineno-0-2139">2139</a></span>
<span class="normal"><a href="#__codelineno-0-2140">2140</a></span>
<span class="normal"><a href="#__codelineno-0-2141">2141</a></span>
<span class="normal"><a href="#__codelineno-0-2142">2142</a></span>
<span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span>
<span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span>
<span class="normal"><a href="#__codelineno-0-2207">2207</a></span>
<span class="normal"><a href="#__codelineno-0-2208">2208</a></span>
<span class="normal"><a href="#__codelineno-0-2209">2209</a></span>
<span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span>
<span class="normal"><a href="#__codelineno-0-2247">2247</a></span>
<span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span>
<span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span>
<span class="normal"><a href="#__codelineno-0-2315">2315</a></span>
<span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span>
<span class="normal"><a href="#__codelineno-0-2325">2325</a></span>
<span class="normal"><a href="#__codelineno-0-2326">2326</a></span>
<span class="normal"><a href="#__codelineno-0-2327">2327</a></span>
<span class="normal"><a href="#__codelineno-0-2328">2328</a></span>
<span class="normal"><a href="#__codelineno-0-2329">2329</a></span>
<span class="normal"><a href="#__codelineno-0-2330">2330</a></span>
<span class="normal"><a href="#__codelineno-0-2331">2331</a></span>
<span class="normal"><a href="#__codelineno-0-2332">2332</a></span>
<span class="normal"><a href="#__codelineno-0-2333">2333</a></span>
<span class="normal"><a href="#__codelineno-0-2334">2334</a></span>
<span class="normal"><a href="#__codelineno-0-2335">2335</a></span>
<span class="normal"><a href="#__codelineno-0-2336">2336</a></span>
<span class="normal"><a href="#__codelineno-0-2337">2337</a></span>
<span class="normal"><a href="#__codelineno-0-2338">2338</a></span>
<span class="normal"><a href="#__codelineno-0-2339">2339</a></span>
<span class="normal"><a href="#__codelineno-0-2340">2340</a></span>
<span class="normal"><a href="#__codelineno-0-2341">2341</a></span>
<span class="normal"><a href="#__codelineno-0-2342">2342</a></span>
<span class="normal"><a href="#__codelineno-0-2343">2343</a></span>
<span class="normal"><a href="#__codelineno-0-2344">2344</a></span>
<span class="normal"><a href="#__codelineno-0-2345">2345</a></span>
<span class="normal"><a href="#__codelineno-0-2346">2346</a></span>
<span class="normal"><a href="#__codelineno-0-2347">2347</a></span>
<span class="normal"><a href="#__codelineno-0-2348">2348</a></span>
<span class="normal"><a href="#__codelineno-0-2349">2349</a></span>
<span class="normal"><a href="#__codelineno-0-2350">2350</a></span>
<span class="normal"><a href="#__codelineno-0-2351">2351</a></span>
<span class="normal"><a href="#__codelineno-0-2352">2352</a></span>
<span class="normal"><a href="#__codelineno-0-2353">2353</a></span>
<span class="normal"><a href="#__codelineno-0-2354">2354</a></span>
<span class="normal"><a href="#__codelineno-0-2355">2355</a></span>
<span class="normal"><a href="#__codelineno-0-2356">2356</a></span>
<span class="normal"><a href="#__codelineno-0-2357">2357</a></span>
<span class="normal"><a href="#__codelineno-0-2358">2358</a></span>
<span class="normal"><a href="#__codelineno-0-2359">2359</a></span>
<span class="normal"><a href="#__codelineno-0-2360">2360</a></span>
<span class="normal"><a href="#__codelineno-0-2361">2361</a></span>
<span class="normal"><a href="#__codelineno-0-2362">2362</a></span>
<span class="normal"><a href="#__codelineno-0-2363">2363</a></span>
<span class="normal"><a href="#__codelineno-0-2364">2364</a></span>
<span class="normal"><a href="#__codelineno-0-2365">2365</a></span>
<span class="normal"><a href="#__codelineno-0-2366">2366</a></span>
<span class="normal"><a href="#__codelineno-0-2367">2367</a></span>
<span class="normal"><a href="#__codelineno-0-2368">2368</a></span>
<span class="normal"><a href="#__codelineno-0-2369">2369</a></span>
<span class="normal"><a href="#__codelineno-0-2370">2370</a></span>
<span class="normal"><a href="#__codelineno-0-2371">2371</a></span>
<span class="normal"><a href="#__codelineno-0-2372">2372</a></span>
<span class="normal"><a href="#__codelineno-0-2373">2373</a></span>
<span class="normal"><a href="#__codelineno-0-2374">2374</a></span>
<span class="normal"><a href="#__codelineno-0-2375">2375</a></span>
<span class="normal"><a href="#__codelineno-0-2376">2376</a></span>
<span class="normal"><a href="#__codelineno-0-2377">2377</a></span>
<span class="normal"><a href="#__codelineno-0-2378">2378</a></span>
<span class="normal"><a href="#__codelineno-0-2379">2379</a></span>
<span class="normal"><a href="#__codelineno-0-2380">2380</a></span>
<span class="normal"><a href="#__codelineno-0-2381">2381</a></span>
<span class="normal"><a href="#__codelineno-0-2382">2382</a></span>
<span class="normal"><a href="#__codelineno-0-2383">2383</a></span>
<span class="normal"><a href="#__codelineno-0-2384">2384</a></span>
<span class="normal"><a href="#__codelineno-0-2385">2385</a></span>
<span class="normal"><a href="#__codelineno-0-2386">2386</a></span>
<span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span>
<span class="normal"><a href="#__codelineno-0-2403">2403</a></span>
<span class="normal"><a href="#__codelineno-0-2404">2404</a></span>
<span class="normal"><a href="#__codelineno-0-2405">2405</a></span>
<span class="normal"><a href="#__codelineno-0-2406">2406</a></span>
<span class="normal"><a href="#__codelineno-0-2407">2407</a></span>
<span class="normal"><a href="#__codelineno-0-2408">2408</a></span>
<span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span>
<span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span>
<span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span>
<span class="normal"><a href="#__codelineno-0-2580">2580</a></span>
<span class="normal"><a href="#__codelineno-0-2581">2581</a></span>
<span class="normal"><a href="#__codelineno-0-2582">2582</a></span>
<span class="normal"><a href="#__codelineno-0-2583">2583</a></span>
<span class="normal"><a href="#__codelineno-0-2584">2584</a></span>
<span class="normal"><a href="#__codelineno-0-2585">2585</a></span>
<span class="normal"><a href="#__codelineno-0-2586">2586</a></span>
<span class="normal"><a href="#__codelineno-0-2587">2587</a></span>
<span class="normal"><a href="#__codelineno-0-2588">2588</a></span>
<span class="normal"><a href="#__codelineno-0-2589">2589</a></span>
<span class="normal"><a href="#__codelineno-0-2590">2590</a></span>
<span class="normal"><a href="#__codelineno-0-2591">2591</a></span>
<span class="normal"><a href="#__codelineno-0-2592">2592</a></span>
<span class="normal"><a href="#__codelineno-0-2593">2593</a></span>
<span class="normal"><a href="#__codelineno-0-2594">2594</a></span>
<span class="normal"><a href="#__codelineno-0-2595">2595</a></span>
<span class="normal"><a href="#__codelineno-0-2596">2596</a></span>
<span class="normal"><a href="#__codelineno-0-2597">2597</a></span>
<span class="normal"><a href="#__codelineno-0-2598">2598</a></span>
<span class="normal"><a href="#__codelineno-0-2599">2599</a></span>
<span class="normal"><a href="#__codelineno-0-2600">2600</a></span>
<span class="normal"><a href="#__codelineno-0-2601">2601</a></span>
<span class="normal"><a href="#__codelineno-0-2602">2602</a></span>
<span class="normal"><a href="#__codelineno-0-2603">2603</a></span>
<span class="normal"><a href="#__codelineno-0-2604">2604</a></span>
<span class="normal"><a href="#__codelineno-0-2605">2605</a></span>
<span class="normal"><a href="#__codelineno-0-2606">2606</a></span>
<span class="normal"><a href="#__codelineno-0-2607">2607</a></span>
<span class="normal"><a href="#__codelineno-0-2608">2608</a></span>
<span class="normal"><a href="#__codelineno-0-2609">2609</a></span>
<span class="normal"><a href="#__codelineno-0-2610">2610</a></span>
<span class="normal"><a href="#__codelineno-0-2611">2611</a></span>
<span class="normal"><a href="#__codelineno-0-2612">2612</a></span>
<span class="normal"><a href="#__codelineno-0-2613">2613</a></span>
<span class="normal"><a href="#__codelineno-0-2614">2614</a></span>
<span class="normal"><a href="#__codelineno-0-2615">2615</a></span>
<span class="normal"><a href="#__codelineno-0-2616">2616</a></span>
<span class="normal"><a href="#__codelineno-0-2617">2617</a></span>
<span class="normal"><a href="#__codelineno-0-2618">2618</a></span>
<span class="normal"><a href="#__codelineno-0-2619">2619</a></span>
<span class="normal"><a href="#__codelineno-0-2620">2620</a></span>
<span class="normal"><a href="#__codelineno-0-2621">2621</a></span>
<span class="normal"><a href="#__codelineno-0-2622">2622</a></span>
<span class="normal"><a href="#__codelineno-0-2623">2623</a></span>
<span class="normal"><a href="#__codelineno-0-2624">2624</a></span>
<span class="normal"><a href="#__codelineno-0-2625">2625</a></span>
<span class="normal"><a href="#__codelineno-0-2626">2626</a></span>
<span class="normal"><a href="#__codelineno-0-2627">2627</a></span>
<span class="normal"><a href="#__codelineno-0-2628">2628</a></span>
<span class="normal"><a href="#__codelineno-0-2629">2629</a></span>
<span class="normal"><a href="#__codelineno-0-2630">2630</a></span>
<span class="normal"><a href="#__codelineno-0-2631">2631</a></span>
<span class="normal"><a href="#__codelineno-0-2632">2632</a></span>
<span class="normal"><a href="#__codelineno-0-2633">2633</a></span>
<span class="normal"><a href="#__codelineno-0-2634">2634</a></span>
<span class="normal"><a href="#__codelineno-0-2635">2635</a></span>
<span class="normal"><a href="#__codelineno-0-2636">2636</a></span>
<span class="normal"><a href="#__codelineno-0-2637">2637</a></span>
<span class="normal"><a href="#__codelineno-0-2638">2638</a></span>
<span class="normal"><a href="#__codelineno-0-2639">2639</a></span>
<span class="normal"><a href="#__codelineno-0-2640">2640</a></span>
<span class="normal"><a href="#__codelineno-0-2641">2641</a></span>
<span class="normal"><a href="#__codelineno-0-2642">2642</a></span>
<span class="normal"><a href="#__codelineno-0-2643">2643</a></span>
<span class="normal"><a href="#__codelineno-0-2644">2644</a></span>
<span class="normal"><a href="#__codelineno-0-2645">2645</a></span>
<span class="normal"><a href="#__codelineno-0-2646">2646</a></span>
<span class="normal"><a href="#__codelineno-0-2647">2647</a></span>
<span class="normal"><a href="#__codelineno-0-2648">2648</a></span>
<span class="normal"><a href="#__codelineno-0-2649">2649</a></span>
<span class="normal"><a href="#__codelineno-0-2650">2650</a></span>
<span class="normal"><a href="#__codelineno-0-2651">2651</a></span>
<span class="normal"><a href="#__codelineno-0-2652">2652</a></span>
<span class="normal"><a href="#__codelineno-0-2653">2653</a></span>
<span class="normal"><a href="#__codelineno-0-2654">2654</a></span>
<span class="normal"><a href="#__codelineno-0-2655">2655</a></span>
<span class="normal"><a href="#__codelineno-0-2656">2656</a></span>
<span class="normal"><a href="#__codelineno-0-2657">2657</a></span>
<span class="normal"><a href="#__codelineno-0-2658">2658</a></span>
<span class="normal"><a href="#__codelineno-0-2659">2659</a></span>
<span class="normal"><a href="#__codelineno-0-2660">2660</a></span>
<span class="normal"><a href="#__codelineno-0-2661">2661</a></span>
<span class="normal"><a href="#__codelineno-0-2662">2662</a></span>
<span class="normal"><a href="#__codelineno-0-2663">2663</a></span>
<span class="normal"><a href="#__codelineno-0-2664">2664</a></span>
<span class="normal"><a href="#__codelineno-0-2665">2665</a></span>
<span class="normal"><a href="#__codelineno-0-2666">2666</a></span>
<span class="normal"><a href="#__codelineno-0-2667">2667</a></span>
<span class="normal"><a href="#__codelineno-0-2668">2668</a></span>
<span class="normal"><a href="#__codelineno-0-2669">2669</a></span>
<span class="normal"><a href="#__codelineno-0-2670">2670</a></span>
<span class="normal"><a href="#__codelineno-0-2671">2671</a></span>
<span class="normal"><a href="#__codelineno-0-2672">2672</a></span>
<span class="normal"><a href="#__codelineno-0-2673">2673</a></span>
<span class="normal"><a href="#__codelineno-0-2674">2674</a></span>
<span class="normal"><a href="#__codelineno-0-2675">2675</a></span>
<span class="normal"><a href="#__codelineno-0-2676">2676</a></span>
<span class="normal"><a href="#__codelineno-0-2677">2677</a></span>
<span class="normal"><a href="#__codelineno-0-2678">2678</a></span>
<span class="normal"><a href="#__codelineno-0-2679">2679</a></span>
<span class="normal"><a href="#__codelineno-0-2680">2680</a></span>
<span class="normal"><a href="#__codelineno-0-2681">2681</a></span>
<span class="normal"><a href="#__codelineno-0-2682">2682</a></span>
<span class="normal"><a href="#__codelineno-0-2683">2683</a></span>
<span class="normal"><a href="#__codelineno-0-2684">2684</a></span>
<span class="normal"><a href="#__codelineno-0-2685">2685</a></span>
<span class="normal"><a href="#__codelineno-0-2686">2686</a></span>
<span class="normal"><a href="#__codelineno-0-2687">2687</a></span>
<span class="normal"><a href="#__codelineno-0-2688">2688</a></span>
<span class="normal"><a href="#__codelineno-0-2689">2689</a></span>
<span class="normal"><a href="#__codelineno-0-2690">2690</a></span>
<span class="normal"><a href="#__codelineno-0-2691">2691</a></span>
<span class="normal"><a href="#__codelineno-0-2692">2692</a></span>
<span class="normal"><a href="#__codelineno-0-2693">2693</a></span>
<span class="normal"><a href="#__codelineno-0-2694">2694</a></span>
<span class="normal"><a href="#__codelineno-0-2695">2695</a></span>
<span class="normal"><a href="#__codelineno-0-2696">2696</a></span>
<span class="normal"><a href="#__codelineno-0-2697">2697</a></span>
<span class="normal"><a href="#__codelineno-0-2698">2698</a></span>
<span class="normal"><a href="#__codelineno-0-2699">2699</a></span>
<span class="normal"><a href="#__codelineno-0-2700">2700</a></span>
<span class="normal"><a href="#__codelineno-0-2701">2701</a></span>
<span class="normal"><a href="#__codelineno-0-2702">2702</a></span>
<span class="normal"><a href="#__codelineno-0-2703">2703</a></span>
<span class="normal"><a href="#__codelineno-0-2704">2704</a></span>
<span class="normal"><a href="#__codelineno-0-2705">2705</a></span>
<span class="normal"><a href="#__codelineno-0-2706">2706</a></span>
<span class="normal"><a href="#__codelineno-0-2707">2707</a></span>
<span class="normal"><a href="#__codelineno-0-2708">2708</a></span>
<span class="normal"><a href="#__codelineno-0-2709">2709</a></span>
<span class="normal"><a href="#__codelineno-0-2710">2710</a></span>
<span class="normal"><a href="#__codelineno-0-2711">2711</a></span>
<span class="normal"><a href="#__codelineno-0-2712">2712</a></span>
<span class="normal"><a href="#__codelineno-0-2713">2713</a></span>
<span class="normal"><a href="#__codelineno-0-2714">2714</a></span>
<span class="normal"><a href="#__codelineno-0-2715">2715</a></span>
<span class="normal"><a href="#__codelineno-0-2716">2716</a></span>
<span class="normal"><a href="#__codelineno-0-2717">2717</a></span>
<span class="normal"><a href="#__codelineno-0-2718">2718</a></span>
<span class="normal"><a href="#__codelineno-0-2719">2719</a></span>
<span class="normal"><a href="#__codelineno-0-2720">2720</a></span>
<span class="normal"><a href="#__codelineno-0-2721">2721</a></span>
<span class="normal"><a href="#__codelineno-0-2722">2722</a></span>
<span class="normal"><a href="#__codelineno-0-2723">2723</a></span>
<span class="normal"><a href="#__codelineno-0-2724">2724</a></span>
<span class="normal"><a href="#__codelineno-0-2725">2725</a></span>
<span class="normal"><a href="#__codelineno-0-2726">2726</a></span>
<span class="normal"><a href="#__codelineno-0-2727">2727</a></span>
<span class="normal"><a href="#__codelineno-0-2728">2728</a></span>
<span class="normal"><a href="#__codelineno-0-2729">2729</a></span>
<span class="normal"><a href="#__codelineno-0-2730">2730</a></span>
<span class="normal"><a href="#__codelineno-0-2731">2731</a></span>
<span class="normal"><a href="#__codelineno-0-2732">2732</a></span>
<span class="normal"><a href="#__codelineno-0-2733">2733</a></span>
<span class="normal"><a href="#__codelineno-0-2734">2734</a></span>
<span class="normal"><a href="#__codelineno-0-2735">2735</a></span>
<span class="normal"><a href="#__codelineno-0-2736">2736</a></span>
<span class="normal"><a href="#__codelineno-0-2737">2737</a></span>
<span class="normal"><a href="#__codelineno-0-2738">2738</a></span>
<span class="normal"><a href="#__codelineno-0-2739">2739</a></span>
<span class="normal"><a href="#__codelineno-0-2740">2740</a></span>
<span class="normal"><a href="#__codelineno-0-2741">2741</a></span>
<span class="normal"><a href="#__codelineno-0-2742">2742</a></span>
<span class="normal"><a href="#__codelineno-0-2743">2743</a></span>
<span class="normal"><a href="#__codelineno-0-2744">2744</a></span>
<span class="normal"><a href="#__codelineno-0-2745">2745</a></span>
<span class="normal"><a href="#__codelineno-0-2746">2746</a></span>
<span class="normal"><a href="#__codelineno-0-2747">2747</a></span>
<span class="normal"><a href="#__codelineno-0-2748">2748</a></span>
<span class="normal"><a href="#__codelineno-0-2749">2749</a></span>
<span class="normal"><a href="#__codelineno-0-2750">2750</a></span>
<span class="normal"><a href="#__codelineno-0-2751">2751</a></span>
<span class="normal"><a href="#__codelineno-0-2752">2752</a></span>
<span class="normal"><a href="#__codelineno-0-2753">2753</a></span>
<span class="normal"><a href="#__codelineno-0-2754">2754</a></span>
<span class="normal"><a href="#__codelineno-0-2755">2755</a></span>
<span class="normal"><a href="#__codelineno-0-2756">2756</a></span>
<span class="normal"><a href="#__codelineno-0-2757">2757</a></span>
<span class="normal"><a href="#__codelineno-0-2758">2758</a></span>
<span class="normal"><a href="#__codelineno-0-2759">2759</a></span>
<span class="normal"><a href="#__codelineno-0-2760">2760</a></span>
<span class="normal"><a href="#__codelineno-0-2761">2761</a></span>
<span class="normal"><a href="#__codelineno-0-2762">2762</a></span>
<span class="normal"><a href="#__codelineno-0-2763">2763</a></span>
<span class="normal"><a href="#__codelineno-0-2764">2764</a></span>
<span class="normal"><a href="#__codelineno-0-2765">2765</a></span>
<span class="normal"><a href="#__codelineno-0-2766">2766</a></span>
<span class="normal"><a href="#__codelineno-0-2767">2767</a></span>
<span class="normal"><a href="#__codelineno-0-2768">2768</a></span>
<span class="normal"><a href="#__codelineno-0-2769">2769</a></span>
<span class="normal"><a href="#__codelineno-0-2770">2770</a></span>
<span class="normal"><a href="#__codelineno-0-2771">2771</a></span>
<span class="normal"><a href="#__codelineno-0-2772">2772</a></span>
<span class="normal"><a href="#__codelineno-0-2773">2773</a></span>
<span class="normal"><a href="#__codelineno-0-2774">2774</a></span>
<span class="normal"><a href="#__codelineno-0-2775">2775</a></span>
<span class="normal"><a href="#__codelineno-0-2776">2776</a></span>
<span class="normal"><a href="#__codelineno-0-2777">2777</a></span>
<span class="normal"><a href="#__codelineno-0-2778">2778</a></span>
<span class="normal"><a href="#__codelineno-0-2779">2779</a></span>
<span class="normal"><a href="#__codelineno-0-2780">2780</a></span>
<span class="normal"><a href="#__codelineno-0-2781">2781</a></span>
<span class="normal"><a href="#__codelineno-0-2782">2782</a></span>
<span class="normal"><a href="#__codelineno-0-2783">2783</a></span>
<span class="normal"><a href="#__codelineno-0-2784">2784</a></span>
<span class="normal"><a href="#__codelineno-0-2785">2785</a></span>
<span class="normal"><a href="#__codelineno-0-2786">2786</a></span>
<span class="normal"><a href="#__codelineno-0-2787">2787</a></span>
<span class="normal"><a href="#__codelineno-0-2788">2788</a></span>
<span class="normal"><a href="#__codelineno-0-2789">2789</a></span>
<span class="normal"><a href="#__codelineno-0-2790">2790</a></span>
<span class="normal"><a href="#__codelineno-0-2791">2791</a></span>
<span class="normal"><a href="#__codelineno-0-2792">2792</a></span>
<span class="normal"><a href="#__codelineno-0-2793">2793</a></span>
<span class="normal"><a href="#__codelineno-0-2794">2794</a></span>
<span class="normal"><a href="#__codelineno-0-2795">2795</a></span>
<span class="normal"><a href="#__codelineno-0-2796">2796</a></span>
<span class="normal"><a href="#__codelineno-0-2797">2797</a></span>
<span class="normal"><a href="#__codelineno-0-2798">2798</a></span>
<span class="normal"><a href="#__codelineno-0-2799">2799</a></span>
<span class="normal"><a href="#__codelineno-0-2800">2800</a></span>
<span class="normal"><a href="#__codelineno-0-2801">2801</a></span>
<span class="normal"><a href="#__codelineno-0-2802">2802</a></span>
<span class="normal"><a href="#__codelineno-0-2803">2803</a></span>
<span class="normal"><a href="#__codelineno-0-2804">2804</a></span>
<span class="normal"><a href="#__codelineno-0-2805">2805</a></span>
<span class="normal"><a href="#__codelineno-0-2806">2806</a></span>
<span class="normal"><a href="#__codelineno-0-2807">2807</a></span>
<span class="normal"><a href="#__codelineno-0-2808">2808</a></span>
<span class="normal"><a href="#__codelineno-0-2809">2809</a></span>
<span class="normal"><a href="#__codelineno-0-2810">2810</a></span>
<span class="normal"><a href="#__codelineno-0-2811">2811</a></span>
<span class="normal"><a href="#__codelineno-0-2812">2812</a></span>
<span class="normal"><a href="#__codelineno-0-2813">2813</a></span>
<span class="normal"><a href="#__codelineno-0-2814">2814</a></span>
<span class="normal"><a href="#__codelineno-0-2815">2815</a></span>
<span class="normal"><a href="#__codelineno-0-2816">2816</a></span>
<span class="normal"><a href="#__codelineno-0-2817">2817</a></span>
<span class="normal"><a href="#__codelineno-0-2818">2818</a></span>
<span class="normal"><a href="#__codelineno-0-2819">2819</a></span>
<span class="normal"><a href="#__codelineno-0-2820">2820</a></span>
<span class="normal"><a href="#__codelineno-0-2821">2821</a></span>
<span class="normal"><a href="#__codelineno-0-2822">2822</a></span>
<span class="normal"><a href="#__codelineno-0-2823">2823</a></span>
<span class="normal"><a href="#__codelineno-0-2824">2824</a></span>
<span class="normal"><a href="#__codelineno-0-2825">2825</a></span>
<span class="normal"><a href="#__codelineno-0-2826">2826</a></span>
<span class="normal"><a href="#__codelineno-0-2827">2827</a></span>
<span class="normal"><a href="#__codelineno-0-2828">2828</a></span>
<span class="normal"><a href="#__codelineno-0-2829">2829</a></span>
<span class="normal"><a href="#__codelineno-0-2830">2830</a></span>
<span class="normal"><a href="#__codelineno-0-2831">2831</a></span>
<span class="normal"><a href="#__codelineno-0-2832">2832</a></span>
<span class="normal"><a href="#__codelineno-0-2833">2833</a></span>
<span class="normal"><a href="#__codelineno-0-2834">2834</a></span>
<span class="normal"><a href="#__codelineno-0-2835">2835</a></span>
<span class="normal"><a href="#__codelineno-0-2836">2836</a></span>
<span class="normal"><a href="#__codelineno-0-2837">2837</a></span>
<span class="normal"><a href="#__codelineno-0-2838">2838</a></span>
<span class="normal"><a href="#__codelineno-0-2839">2839</a></span>
<span class="normal"><a href="#__codelineno-0-2840">2840</a></span>
<span class="normal"><a href="#__codelineno-0-2841">2841</a></span>
<span class="normal"><a href="#__codelineno-0-2842">2842</a></span>
<span class="normal"><a href="#__codelineno-0-2843">2843</a></span>
<span class="normal"><a href="#__codelineno-0-2844">2844</a></span>
<span class="normal"><a href="#__codelineno-0-2845">2845</a></span>
<span class="normal"><a href="#__codelineno-0-2846">2846</a></span>
<span class="normal"><a href="#__codelineno-0-2847">2847</a></span>
<span class="normal"><a href="#__codelineno-0-2848">2848</a></span>
<span class="normal"><a href="#__codelineno-0-2849">2849</a></span>
<span class="normal"><a href="#__codelineno-0-2850">2850</a></span>
<span class="normal"><a href="#__codelineno-0-2851">2851</a></span>
<span class="normal"><a href="#__codelineno-0-2852">2852</a></span>
<span class="normal"><a href="#__codelineno-0-2853">2853</a></span>
<span class="normal"><a href="#__codelineno-0-2854">2854</a></span>
<span class="normal"><a href="#__codelineno-0-2855">2855</a></span>
<span class="normal"><a href="#__codelineno-0-2856">2856</a></span>
<span class="normal"><a href="#__codelineno-0-2857">2857</a></span>
<span class="normal"><a href="#__codelineno-0-2858">2858</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="k">class</span> <span class="nc">APK</span><span class="p">:</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="c1"># Constants in ZipFile</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="n">_PK_END_OF_CENTRAL_DIR</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x50\x4b\x05\x06</span><span class="s2">&quot;</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="n">_PK_CENTRAL_DIR</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x50\x4b\x01\x02</span><span class="s2">&quot;</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="c1"># Constants in the APK Signature Block</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="n">_APK_SIG_MAGIC</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;APK Sig Block 42&quot;</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="n">_APK_SIG_KEY_V2_SIGNATURE</span> <span class="o">=</span> <span class="mh">0x7109871A</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="n">_APK_SIG_KEY_V3_SIGNATURE</span> <span class="o">=</span> <span class="mh">0xF05368C0</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="n">_APK_SIG_ATTR_V2_STRIPPING_PROTECTION</span> <span class="o">=</span> <span class="mh">0xBEEFF00D</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>    <span class="n">_APK_SIG_ALGO_IDS</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="mh">0x0101</span><span class="p">:</span> <span class="s2">&quot;RSASSA-PSS with SHA2-256 digest, SHA2-256 MGF1, 32 bytes of salt, trailer: 0xbc&quot;</span><span class="p">,</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="mh">0x0102</span><span class="p">:</span> <span class="s2">&quot;RSASSA-PSS with SHA2-512 digest, SHA2-512 MGF1, 64 bytes of salt, trailer: 0xbc&quot;</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="mh">0x0103</span><span class="p">:</span> <span class="s2">&quot;RSASSA-PKCS1-v1_5 with SHA2-256 digest.&quot;</span><span class="p">,</span>  <span class="c1"># This is for build systems which require deterministic signatures.</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="mh">0x0104</span><span class="p">:</span> <span class="s2">&quot;RSASSA-PKCS1-v1_5 with SHA2-512 digest.&quot;</span><span class="p">,</span>  <span class="c1"># This is for build systems which require deterministic signatures.</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="mh">0x0201</span><span class="p">:</span> <span class="s2">&quot;ECDSA with SHA2-256 digest&quot;</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="mh">0x0202</span><span class="p">:</span> <span class="s2">&quot;ECDSA with SHA2-512 digest&quot;</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="mh">0x0301</span><span class="p">:</span> <span class="s2">&quot;DSA with SHA2-256 digest&quot;</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="p">}</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="n">__no_magic</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="n">raw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="n">magic_file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="n">skip_analysis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="n">testzip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        This class can access to all elements in an APK file</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">            &gt;&gt;&gt; APK(&quot;myfile.apk&quot;)</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">            &gt;&gt;&gt; APK(read(&quot;myfile.apk&quot;), raw=True)</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        :param filename: specify the path of the file, or raw data</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        :param raw: specify if the filename is a path or raw data (optional)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        :param magic_file: specify the magic file (not used anymore - legacy only)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        :param skip_analysis: Skip the analysis, e.g. no manifest files are read. (default: `False`)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        :param testzip: Test the APK for integrity, e.g. if the ZIP file is broken. Throw an exception on failure (default `False`)</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="k">if</span> <span class="n">magic_file</span><span class="p">:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>                <span class="s2">&quot;You set magic_file but this parameter is actually unused. You should remove it.&quot;</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="p">)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xml</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">axml</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">arsc</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">package</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">androidversion</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">uses_permissions</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">declared_permissions</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">valid_apk</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v2</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v3</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_v2_blocks</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_files</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">files_crc32</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__raw</span> <span class="o">=</span> <span class="n">filename</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_sha256</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__raw</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="c1"># Set the filename to something sane</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;raw_apk_sha256:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sha256</span><span class="p">)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zip</span> <span class="o">=</span> <span class="n">ZipEntry</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__raw</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zip</span> <span class="o">=</span> <span class="n">ZipEntry</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="k">if</span> <span class="n">testzip</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>                <span class="s2">&quot;Testing zip file integrity, this might take a while...&quot;</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="p">)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>            <span class="c1"># Test the zipfile for integrity before continuing.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="c1"># This process might be slow, as the whole file is read.</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="c1"># Therefore it is possible to enable it as a separate feature.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="c1">#</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="c1"># A short benchmark showed, that testing the zip takes about 10 times longer!</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="c1"># e.g. normal zip loading (skip_analysis=True) takes about 0.01s, where</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>            <span class="c1"># testzip takes 0.1s!</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="n">test_zip</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__raw</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="n">ret</span> <span class="o">=</span> <span class="n">test_zip</span><span class="o">.</span><span class="n">testzip</span><span class="p">()</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="k">if</span> <span class="n">ret</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>                <span class="c1"># we could print the filename here, but there are zip which are so broken</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>                <span class="c1"># That the filename is either very very long or does not make any sense.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>                <span class="c1"># Thus we do not do it, the user might find out by using other tools.</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>                <span class="k">raise</span> <span class="n">BrokenAPKError</span><span class="p">(</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>                    <span class="s2">&quot;The APK is probably broken: testzip returned an error.&quot;</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>                <span class="p">)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_analysis</span><span class="p">:</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_apk_analysis</span><span class="p">()</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="k">def</span> <span class="nf">_ns</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">        return the name including the Android namespace URI</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="k">return</span> <span class="n">NS_ANDROID</span> <span class="o">+</span> <span class="n">name</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="k">def</span> <span class="nf">_apk_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        Run analysis on the APK file.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        This method is usually called by __init__ except if skip_analysis is False.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        It will then parse the `AndroidManifest.xml` and set all fields in the APK class which can be</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        extracted from the Manifest.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="n">i</span> <span class="o">=</span> <span class="s2">&quot;AndroidManifest.xml&quot;</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting analysis on </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="n">manifest_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Missing AndroidManifest.xml. Is this an APK file?&quot;</span><span class="p">)</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="n">ap</span> <span class="o">=</span> <span class="n">AXMLPrinter</span><span class="p">(</span><span class="n">manifest_data</span><span class="p">)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ap</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                    <span class="s2">&quot;Error while parsing AndroidManifest.xml - is the file valid?&quot;</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                <span class="p">)</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                <span class="k">return</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ap</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_xml_obj</span><span class="p">()</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">is_packed</span><span class="p">():</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>                    <span class="s2">&quot;XML Seems to be packed, operations on the AndroidManifest.xml might fail.&quot;</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>                <span class="p">)</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tag</span> <span class="o">!=</span> <span class="s2">&quot;manifest&quot;</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                        <span class="s2">&quot;AndroidManifest.xml does not start with a &lt;manifest&gt; tag! Is this a valid APK?&quot;</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                    <span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                    <span class="k">return</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">package</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span><span class="s2">&quot;manifest&quot;</span><span class="p">,</span> <span class="s2">&quot;package&quot;</span><span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">androidversion</span><span class="p">[</span><span class="s2">&quot;Code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>                    <span class="s2">&quot;manifest&quot;</span><span class="p">,</span> <span class="s2">&quot;versionCode&quot;</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>                <span class="p">)</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">androidversion</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>                    <span class="s2">&quot;manifest&quot;</span><span class="p">,</span> <span class="s2">&quot;versionName&quot;</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                <span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                <span class="n">permission</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="s2">&quot;uses-permission&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                <span class="p">)</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permissions</span> <span class="o">+</span> <span class="n">permission</span><span class="p">))</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>                <span class="k">for</span> <span class="n">uses_permission</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_tags</span><span class="p">(</span><span class="s2">&quot;uses-permission&quot;</span><span class="p">):</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">uses_permissions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>                        <span class="p">[</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">get_value_from_tag</span><span class="p">(</span><span class="n">uses_permission</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">),</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_get_permission_maxsdk</span><span class="p">(</span><span class="n">uses_permission</span><span class="p">),</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                        <span class="p">]</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>                    <span class="p">)</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>                <span class="c1"># getting details of the declared permissions</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>                <span class="k">for</span> <span class="n">d_perm_item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_tags</span><span class="p">(</span><span class="s1">&#39;permission&#39;</span><span class="p">):</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>                    <span class="n">d_perm_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_res_string_value</span><span class="p">(</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value_from_tag</span><span class="p">(</span><span class="n">d_perm_item</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>                    <span class="p">)</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                    <span class="n">d_perm_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_res_string_value</span><span class="p">(</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value_from_tag</span><span class="p">(</span><span class="n">d_perm_item</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">))</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                    <span class="p">)</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>                    <span class="n">d_perm_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_res_string_value</span><span class="p">(</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>                        <span class="nb">str</span><span class="p">(</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">get_value_from_tag</span><span class="p">(</span><span class="n">d_perm_item</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">)</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                        <span class="p">)</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>                    <span class="p">)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>                    <span class="n">d_perm_permissionGroup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_res_string_value</span><span class="p">(</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>                        <span class="nb">str</span><span class="p">(</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">get_value_from_tag</span><span class="p">(</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>                                <span class="n">d_perm_item</span><span class="p">,</span> <span class="s2">&quot;permissionGroup&quot;</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>                            <span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>                        <span class="p">)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>                    <span class="p">)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>                    <span class="n">d_perm_protectionLevel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_res_string_value</span><span class="p">(</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>                        <span class="nb">str</span><span class="p">(</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">get_value_from_tag</span><span class="p">(</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>                                <span class="n">d_perm_item</span><span class="p">,</span> <span class="s2">&quot;protectionLevel&quot;</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>                            <span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>                        <span class="p">)</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>                    <span class="p">)</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>                    <span class="n">d_perm_details</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>                        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">d_perm_label</span><span class="p">,</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>                        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">d_perm_description</span><span class="p">,</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>                        <span class="s2">&quot;permissionGroup&quot;</span><span class="p">:</span> <span class="n">d_perm_permissionGroup</span><span class="p">,</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>                        <span class="s2">&quot;protectionLevel&quot;</span><span class="p">:</span> <span class="n">d_perm_protectionLevel</span><span class="p">,</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>                    <span class="p">}</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">declared_permissions</span><span class="p">[</span><span class="n">d_perm_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">d_perm_details</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">valid_apk</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;APK file was successfully validated!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">permission_module</span> <span class="o">=</span> <span class="n">androconf</span><span class="o">.</span><span class="n">load_api_specific_resource_module</span><span class="p">(</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="s2">&quot;aosp_permissions&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_target_sdk_version</span><span class="p">()</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="p">)</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">permission_module_min_sdk</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="n">androconf</span><span class="o">.</span><span class="n">load_api_specific_resource_module</span><span class="p">(</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                <span class="s2">&quot;aosp_permissions&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_min_sdk_version</span><span class="p">()</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>            <span class="p">)</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="p">)</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">        Function for pickling APK Objects.</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">        We remove the zip from the Object, as it is not pickable</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        And it does not make any sense to pickle it anyways.</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">        :returns: the picklable APK Object without zip.</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="c1"># Upon pickling, we need to remove the ZipFile</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>        <span class="n">x</span><span class="p">[</span><span class="s1">&#39;axml&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;axml&#39;</span><span class="p">])</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>        <span class="n">x</span><span class="p">[</span><span class="s1">&#39;xml&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;xml&#39;</span><span class="p">])</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>        <span class="k">del</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;zip&#39;</span><span class="p">]</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="k">return</span> <span class="n">x</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">        Load a pickled APK Object and restore the state</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">        We load the zip file back by reading __raw from the Object.</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">        :param state: pickled state</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="n">state</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zip</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_raw</span><span class="p">()),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>    <span class="k">def</span> <span class="nf">_get_res_string_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">string</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;@string/&#39;</span><span class="p">):</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>            <span class="k">return</span> <span class="n">string</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="n">string_key</span> <span class="o">=</span> <span class="n">string</span><span class="p">[</span><span class="mi">9</span><span class="p">:]</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="n">res_parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_android_resources</span><span class="p">()</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">res_parser</span><span class="p">:</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="n">string_value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="k">for</span> <span class="n">package_name</span> <span class="ow">in</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">get_packages_names</span><span class="p">():</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>            <span class="n">extracted_values</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">get_string</span><span class="p">(</span><span class="n">package_name</span><span class="p">,</span> <span class="n">string_key</span><span class="p">)</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>            <span class="k">if</span> <span class="n">extracted_values</span><span class="p">:</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>                <span class="n">string_value</span> <span class="o">=</span> <span class="n">extracted_values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>                <span class="k">break</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>        <span class="k">return</span> <span class="n">string_value</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>    <span class="k">def</span> <span class="nf">_get_permission_maxsdk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>        <span class="n">maxSdkVersion</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>            <span class="n">maxSdkVersion</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_value_from_tag</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s2">&quot;maxSdkVersion&quot;</span><span class="p">))</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>                <span class="nb">str</span><span class="p">(</span><span class="n">maxSdkVersion</span><span class="p">)</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>                <span class="o">+</span> <span class="s1">&#39; is not a valid value for &lt;uses-permission&gt; maxSdkVersion&#39;</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>            <span class="p">)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>            <span class="k">pass</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="k">return</span> <span class="n">maxSdkVersion</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>    <span class="k">def</span> <span class="nf">is_valid_APK</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">        Return `True` if the APK is valid, `False` otherwise.</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">        An APK is seen as valid, if the `AndroidManifest.xml` could be successful parsed.</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">        This does not mean that the APK has a valid signature nor that the APK</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">        can be installed on an Android system.</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">        :returns: `True` if the APK is valid, `False` otherwise.</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid_apk</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="k">def</span> <span class="nf">get_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">        Return the filename of the APK</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">        :returns: filename</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>    <span class="k">def</span> <span class="nf">get_app_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">        Return the appname of the APK</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">        This name is read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">        using the application `android:label`.</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">        If no label exists, the `android:label` of the main activity is used.</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">        If there is also no main activity label, an empty string is returned.</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">        :returns: the appname of the APK</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="n">app_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span><span class="s1">&#39;application&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="k">if</span> <span class="n">app_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>            <span class="n">activities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_main_activities</span><span class="p">()</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>            <span class="n">main_activity_name</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">activities</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>                <span class="n">main_activity_name</span> <span class="o">=</span> <span class="n">activities</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>            <span class="c1"># FIXME: would need to use _format_value inside get_attribute_value for each returned name!</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>            <span class="c1"># For example, as the activity name might be foobar.foo.bar but inside the activity it is only .bar</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>            <span class="n">app_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>                <span class="s1">&#39;activity&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">main_activity_name</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>            <span class="p">)</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="k">if</span> <span class="n">app_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>            <span class="c1"># No App name set</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>            <span class="c1"># TODO return packagename instead?</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>                <span class="s2">&quot;It looks like that no app name is set for the main activity!&quot;</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>            <span class="p">)</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>        <span class="k">if</span> <span class="n">app_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">):</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>            <span class="n">res_parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_android_resources</span><span class="p">()</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">res_parser</span><span class="p">:</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>                <span class="c1"># TODO: What should be the correct return value here?</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>                <span class="k">return</span> <span class="n">app_name</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>            <span class="n">res_id</span><span class="p">,</span> <span class="n">package</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">parse_id</span><span class="p">(</span><span class="n">app_name</span><span class="p">)</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>            <span class="c1"># If the package name is the same as the APK package,</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>            <span class="c1"># we should be able to resolve the ID.</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>            <span class="k">if</span> <span class="n">package</span> <span class="ow">and</span> <span class="n">package</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_package</span><span class="p">():</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>                <span class="k">if</span> <span class="n">package</span> <span class="o">==</span> <span class="s1">&#39;android&#39;</span><span class="p">:</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>                    <span class="c1"># TODO: we can not resolve this, as we lack framework-res.apk</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>                    <span class="c1"># one exception would be when parsing framework-res.apk directly.</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                        <span class="s2">&quot;Resource ID with android package name encountered! &quot;</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>                        <span class="s2">&quot;Will not resolve, framework-res.apk would be required.&quot;</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>                    <span class="p">)</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>                    <span class="k">return</span> <span class="n">app_name</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>                    <span class="c1"># TODO should look this up, might be in the resources</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>                        <span class="s2">&quot;Resource ID with Package name &#39;</span><span class="si">{}</span><span class="s2">&#39; encountered! Will not resolve&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>                            <span class="n">package</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>                        <span class="p">)</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>                    <span class="p">)</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>                    <span class="k">return</span> <span class="n">app_name</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>                <span class="n">config</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>                    <span class="n">ARSCResTableConfig</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="n">locale</span><span class="p">)</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>                    <span class="k">if</span> <span class="n">locale</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>                    <span class="k">else</span> <span class="n">ARSCResTableConfig</span><span class="o">.</span><span class="n">default_config</span><span class="p">()</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>                <span class="p">)</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>                <span class="n">app_name</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">get_resolved_res_configs</span><span class="p">(</span><span class="n">res_id</span><span class="p">,</span> <span class="n">config</span><span class="p">)[</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>                    <span class="mi">0</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>                <span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Exception selecting app name: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="k">return</span> <span class="n">app_name</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>    <span class="k">def</span> <span class="nf">get_app_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_dpi</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">65536</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">        Return the first icon file name, which density is not greater than max_dpi,</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">        unless exact icon resolution is set in the manifest, in which case</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">        return the exact file.</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">        This information is read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">        From &lt;https://developer.android.com/guide/practices/screens_support.html&gt;</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">        and &lt;https://developer.android.com/ndk/reference/group___configuration.html&gt;</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">        * DEFAULT                             0dpi</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">        * ldpi (low)                        120dpi</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">        * mdpi (medium)                     160dpi</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">        * TV                                213dpi</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a><span class="sd">        * hdpi (high)                       240dpi</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">        * xhdpi (extra-high)                320dpi</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">        * xxhdpi (extra-extra-high)         480dpi</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">        * xxxhdpi (extra-extra-extra-high)  640dpi</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">        * anydpi                          65534dpi (0xFFFE)</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">        * nodpi                           65535dpi (0xFFFF)</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="sd">        There is a difference between nodpi and anydpi:</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">        nodpi will be used if no other density is specified. Or the density does not match.</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">        nodpi is the fallback for everything else. If there is a resource that matches the DPI,</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">        this is used.</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">        anydpi is also valid for all densities but in this case, anydpi will overrule all other files!</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a><span class="sd">        Therefore anydpi is usually used with vector graphics and with constraints on the API level.</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="sd">        For example adaptive icons are usually marked as anydpi.</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">        When it comes now to selecting an icon, there is the following flow:</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a><span class="sd">        1. is there an anydpi icon?</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">        2. is there an icon for the dpi of the device?</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">        3. is there a nodpi icon?</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="sd">        4. (only on very old devices) is there a icon with dpi 0 (the default)</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">        For more information read here: &lt;https://stackoverflow.com/a/34370735/446140&gt;</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">        :returns: the first icon file name, or None if no resources or app icon exists.</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>        <span class="n">main_activity_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_main_activity</span><span class="p">()</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>        <span class="n">app_icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>            <span class="s1">&#39;activity&#39;</span><span class="p">,</span> <span class="s1">&#39;icon&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">main_activity_name</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>        <span class="p">)</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_icon</span><span class="p">:</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>            <span class="n">app_icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span><span class="s1">&#39;application&#39;</span><span class="p">,</span> <span class="s1">&#39;icon&#39;</span><span class="p">)</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>        <span class="n">res_parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_android_resources</span><span class="p">()</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">res_parser</span><span class="p">:</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>            <span class="c1"># Can not do anything below this point to resolve...</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_icon</span><span class="p">:</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>            <span class="n">res_id</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">get_res_id_by_key</span><span class="p">(</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">package</span><span class="p">,</span> <span class="s1">&#39;mipmap&#39;</span><span class="p">,</span> <span class="s1">&#39;ic_launcher&#39;</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>            <span class="p">)</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>            <span class="k">if</span> <span class="n">res_id</span><span class="p">:</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>                <span class="n">app_icon</span> <span class="o">=</span> <span class="s2">&quot;@</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">res_id</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_icon</span><span class="p">:</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>            <span class="n">res_id</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">get_res_id_by_key</span><span class="p">(</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">package</span><span class="p">,</span> <span class="s1">&#39;drawable&#39;</span><span class="p">,</span> <span class="s1">&#39;ic_launcher&#39;</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>            <span class="p">)</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>            <span class="k">if</span> <span class="n">res_id</span><span class="p">:</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>                <span class="n">app_icon</span> <span class="o">=</span> <span class="s2">&quot;@</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">res_id</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">app_icon</span><span class="p">:</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>            <span class="c1"># If the icon can not be found, return now</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="k">if</span> <span class="n">app_icon</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">):</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>            <span class="n">app_icon_id</span> <span class="o">=</span> <span class="n">app_icon</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>            <span class="n">app_icon_id</span> <span class="o">=</span> <span class="n">app_icon_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>            <span class="n">res_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">app_icon_id</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>            <span class="n">candidates</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">get_resolved_res_configs</span><span class="p">(</span><span class="n">res_id</span><span class="p">)</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>            <span class="n">app_icon</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>            <span class="n">current_dpi</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>                <span class="k">for</span> <span class="n">config</span><span class="p">,</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>                    <span class="n">dpi</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_density</span><span class="p">()</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>                    <span class="k">if</span> <span class="n">current_dpi</span> <span class="o">&lt;</span> <span class="n">dpi</span> <span class="o">&lt;=</span> <span class="n">max_dpi</span><span class="p">:</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>                        <span class="n">app_icon</span> <span class="o">=</span> <span class="n">file_name</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>                        <span class="n">current_dpi</span> <span class="o">=</span> <span class="n">dpi</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Exception selecting app icon: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>        <span class="k">return</span> <span class="n">app_icon</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>    <span class="k">def</span> <span class="nf">get_package</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">        Return the name of the package</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">        This information is read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">        :returns: the name of the package</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">package</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>    <span class="k">def</span> <span class="nf">get_androidversion_code</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">        Return the android version code</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">        This information is read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">        :returns: the android version code</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">androidversion</span><span class="p">[</span><span class="s2">&quot;Code&quot;</span><span class="p">]</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>    <span class="k">def</span> <span class="nf">get_androidversion_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">        Return the android version name</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">        This information is read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">        :returns: the android version name</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">androidversion</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>    <span class="k">def</span> <span class="nf">get_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">        Return the file names inside the APK.</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="sd">        :returns: a list of filename strings inside the APK</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">namelist</span><span class="p">()</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>    <span class="k">def</span> <span class="nf">_get_file_magic_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">        Return the filetype guessed for a buffer</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">        :param buffer: bytes</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">        :returns: guessed filetype, or &quot;Unknown&quot; if not resolved</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>        <span class="n">default</span> <span class="o">=</span> <span class="s2">&quot;Unknown&quot;</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>        <span class="c1"># Faster way, test once, return default.</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__no_magic</span><span class="p">:</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>            <span class="k">return</span> <span class="n">default</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>            <span class="c1"># Magic is optional</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>            <span class="kn">import</span> <span class="nn">magic</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__no_magic</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No Magic library was found on your system.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>            <span class="k">return</span> <span class="n">default</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__no_magic</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>                <span class="s2">&quot;It looks like you have the magic python package installed but not the magic library itself!&quot;</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>            <span class="p">)</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Error from magic library: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>                <span class="s2">&quot;Please follow the installation instructions at https://github.com/ahupp/python-magic/#installation&quot;</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>            <span class="p">)</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>                <span class="s2">&quot;You can also install the &#39;python-magic-bin&#39; package on Windows and MacOS&quot;</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>            <span class="p">)</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>            <span class="k">return</span> <span class="n">default</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>            <span class="c1"># There are several implementations of magic,</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>            <span class="c1"># unfortunately all called magic</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>            <span class="c1"># We use this one: https://github.com/ahupp/python-magic/</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>            <span class="c1"># You can also use python-magic-bin on Windows or MacOS</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>            <span class="nb">getattr</span><span class="p">(</span><span class="n">magic</span><span class="p">,</span> <span class="s2">&quot;MagicException&quot;</span><span class="p">)</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__no_magic</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>                <span class="s2">&quot;Not the correct Magic library was found on your &quot;</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>                <span class="s2">&quot;system. Please install python-magic or python-magic-bin!&quot;</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>            <span class="p">)</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>            <span class="k">return</span> <span class="n">default</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>            <span class="c1"># 1024 byte are usually enough to test the magic</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>            <span class="n">ftype</span> <span class="o">=</span> <span class="n">magic</span><span class="o">.</span><span class="n">from_buffer</span><span class="p">(</span><span class="n">buffer</span><span class="p">[:</span><span class="mi">1024</span><span class="p">])</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>        <span class="k">except</span> <span class="n">magic</span><span class="o">.</span><span class="n">MagicException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Error getting the magic type: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>            <span class="k">return</span> <span class="n">default</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">ftype</span><span class="p">:</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>            <span class="k">return</span> <span class="n">default</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patch_magic</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">ftype</span><span class="p">)</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>    <span class="k">def</span> <span class="nf">files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="sd">        Returns a dictionary of filenames and detected magic type</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="sd">        :returns: dictionary of files and their mime type</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files_types</span><span class="p">()</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>    <span class="k">def</span> <span class="nf">get_files_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">        Return the files inside the APK with their associated types (by using [python-magic](https://pypi.org/project/python-magic/))</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">        At the same time, the CRC32 are calculated for the files.</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">        :returns: the files inside the APK with their associated types</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span> <span class="o">==</span> <span class="p">{}:</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>            <span class="c1"># Generate File Types / CRC List</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">():</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>                <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_crc32</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_magic_name</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>    <span class="k">def</span> <span class="nf">_patch_magic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">orig</span><span class="p">):</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">        Overwrite some probably wrong detections by mime libraries</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">        :param buffer: bytes of the file to detect</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">        :param orig: guess by mime libary</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">        :returns: corrected guess</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>            <span class="p">(</span><span class="s2">&quot;Zip&quot;</span> <span class="ow">in</span> <span class="n">orig</span><span class="p">)</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>            <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;(JAR)&#39;</span> <span class="ow">in</span> <span class="n">orig</span><span class="p">)</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>            <span class="ow">and</span> <span class="n">androconf</span><span class="o">.</span><span class="n">is_android_raw</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;APK&#39;</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>        <span class="p">):</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>            <span class="k">return</span> <span class="s2">&quot;Android application package file&quot;</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>        <span class="k">return</span> <span class="n">orig</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>    <span class="k">def</span> <span class="nf">_get_crc32</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">        Calculates and compares the CRC32 and returns the raw buffer.</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">        The CRC32 is added to [files_crc32][androguard.core.apk.APK.files_crc32] dictionary, if not present.</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">        :param filename: filename inside the zipfile</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a><span class="sd">        :rtype: bytes</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>        <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>        <span class="k">if</span> <span class="n">filename</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files_crc32</span><span class="p">:</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">files_crc32</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">crc32</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">files_crc32</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>                <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">infolist</span><span class="p">()[</span><span class="n">filename</span><span class="p">]</span><span class="o">.</span><span class="n">crc32_of_uncompressed_data</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>            <span class="p">):</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>                    <span class="s2">&quot;File &#39;</span><span class="si">{}</span><span class="s2">&#39; has different CRC32 after unpacking! &quot;</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>                    <span class="s2">&quot;Declared: </span><span class="si">{:08x}</span><span class="s2">, Calculated: </span><span class="si">{:08x}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>                        <span class="n">filename</span><span class="p">,</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">infolist</span><span class="p">()[</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>                            <span class="n">filename</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>                        <span class="p">]</span><span class="o">.</span><span class="n">crc32_of_uncompressed_data</span><span class="p">,</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">files_crc32</span><span class="p">[</span><span class="n">filename</span><span class="p">],</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>                    <span class="p">)</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>                <span class="p">)</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>        <span class="k">return</span> <span class="n">buffer</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>    <span class="k">def</span> <span class="nf">get_files_crc32</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">        Calculates and returns a dictionary of filenames and CRC32</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">        :returns: dict of filename: CRC32</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">files_crc32</span> <span class="o">==</span> <span class="p">{}:</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">():</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_get_crc32</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">files_crc32</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>    <span class="k">def</span> <span class="nf">get_files_information</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">        Return the files inside the APK with their associated types and crc32</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">        :returns: the files inside the APK with their associated types and crc32</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">():</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>            <span class="k">yield</span> <span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files_types</span><span class="p">()[</span><span class="n">k</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files_crc32</span><span class="p">()[</span><span class="n">k</span><span class="p">]</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>    <span class="k">def</span> <span class="nf">get_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">        Return raw bytes of the APK</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">        :returns: bytes of the APK</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__raw</span><span class="p">:</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__raw</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__raw</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__raw</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>    <span class="k">def</span> <span class="nf">get_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="sd">        Return the raw data of the specified filename</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a><span class="sd">        inside the APK</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">        :param filename: the filename to get</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">        :raises FileNotPresent: if filename not found inside the apk</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">        :returns: bytes of the specified filename</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>            <span class="k">raise</span> <span class="n">FileNotPresent</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>    <span class="k">def</span> <span class="nf">get_dex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="sd">        Return the raw data of the classes dex file</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">        This will give you the data of the file called `classes.dex`</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">        inside the APK. If the APK has multiple DEX files, you need to use [get_all_dex][androguard.core.apk.APK.get_all_dex].</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">        :raises FileNotPresent: if classes.dex is not found</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">        :returns: the raw data of the classes dex file</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="s2">&quot;classes.dex&quot;</span><span class="p">)</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>        <span class="k">except</span> <span class="n">FileNotPresent</span><span class="p">:</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>            <span class="c1"># TODO is this a good idea to return an empty string?</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>            <span class="k">return</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>    <span class="k">def</span> <span class="nf">get_dex_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">        Return the names of all DEX files found in the APK.</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">        This method only accounts for &quot;offical&quot; dex files, i.e. all files</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">        in the root directory of the APK named `classes.dex` or `classes[0-9]+.dex`</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">        :returns: the names of all DEX files found in the APK</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>        <span class="n">dexre</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^classes(\d*).dex$&quot;</span><span class="p">)</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>        <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">dexre</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">())</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>    <span class="k">def</span> <span class="nf">get_all_dex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">        Return the raw bytes data of all classes dex files</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">        :returns: the raw bytes data of all classes dex files</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>        <span class="k">for</span> <span class="n">dex_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dex_names</span><span class="p">():</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">dex_name</span><span class="p">)</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>    <span class="k">def</span> <span class="nf">is_multidex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">        Test if the APK has multiple DEX files</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">        :returns: True if multiple dex found, otherwise False</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>        <span class="n">dexre</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^classes(\d+)?.dex$&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>            <span class="nb">len</span><span class="p">(</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>                <span class="p">[</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>                    <span class="n">instance</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>                    <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">()</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>                    <span class="k">if</span> <span class="n">dexre</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>                <span class="p">]</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>            <span class="p">)</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>            <span class="o">&gt;</span> <span class="mi">1</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>        <span class="p">)</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>    <span class="k">def</span> <span class="nf">_format_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">        Format a value with packagename, if not already set.</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">        For example, the name `&#39;.foobar&#39;` will be transformed into `&#39;package.name.foobar&#39;`.</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">        Names which do not contain any dots are assumed to be packagename-less as well:</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="sd">        `foobar` will also transform into `package.name.foobar`.</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">        :param value: string value to format with the packaname</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">        :returns: the formatted package name</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>        <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">package</span><span class="p">:</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>            <span class="n">v_dot</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>            <span class="k">if</span> <span class="n">v_dot</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>                <span class="c1"># Dot at the start</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">package</span> <span class="o">+</span> <span class="n">value</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>            <span class="k">elif</span> <span class="n">v_dot</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>                <span class="c1"># Not a single dot</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">package</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">value</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>        <span class="k">return</span> <span class="n">value</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>    <span class="k">def</span> <span class="nf">get_all_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>        <span class="n">tag_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>        <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>        <span class="n">format_value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>        <span class="o">**</span><span class="n">attribute_filter</span><span class="p">,</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">        Yields all the attribute values in xml files which match with the tag name and the specific attribute</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">        :param str tag_name: specify the tag name</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">        :param str attribute: specify the attribute</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">        :param bool format_value: specify if the value needs to be formatted with packagename</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">        :returns: the attribute values</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>        <span class="n">tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_tags</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="n">attribute</span><span class="p">))</span> <span class="ow">or</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>                <span class="k">if</span> <span class="n">format_value</span><span class="p">:</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>                    <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>                    <span class="k">yield</span> <span class="n">value</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>    <span class="k">def</span> <span class="nf">get_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>        <span class="n">tag_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>        <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>        <span class="n">format_value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>        <span class="o">**</span><span class="n">attribute_filter</span><span class="p">,</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">        Return the attribute value in xml files which matches the tag name and the specific attribute</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">        :param str tag_name: specify the tag name</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">        :param str attribute: specify the attribute</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="sd">        :param bool format_value: specify if the value needs to be formatted with packagename</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">        :returns: the attribute value</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>            <span class="n">tag_name</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">format_value</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>        <span class="p">):</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>                <span class="k">return</span> <span class="n">value</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>    <span class="k">def</span> <span class="nf">get_value_from_tag</span><span class="p">(</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">Element</span><span class="p">,</span> <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="sd">        Return the value of the android prefixed attribute in a specific tag.</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">        This function will always try to get the attribute with a `android:` prefix first,</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">        and will try to return the attribute without the prefix, if the attribute could not be found.</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">        This is useful for some broken `AndroidManifest.xml`, where no android namespace is set,</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">        but could also indicate malicious activity (i.e. wrongly repackaged files).</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">        A warning is printed if the attribute is found without a namespace prefix.</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">        If you require to get the exact result you need to query the tag directly:</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">            &gt;&gt;&gt; from lxml.etree import Element</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">            &gt;&gt;&gt; tag = Element(&#39;bar&#39;, nsmap={&#39;android&#39;: &#39;http://schemas.android.com/apk/res/android&#39;})</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">            &gt;&gt;&gt; tag.set(&#39;{http://schemas.android.com/apk/res/android}foobar&#39;, &#39;barfoo&#39;)</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">            &gt;&gt;&gt; tag.set(&#39;name&#39;, &#39;baz&#39;)</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">            # Assume that `a` is some APK object</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">            &gt;&gt;&gt; a.get_value_from_tag(tag, &#39;name&#39;)</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">            &#39;baz&#39;</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">            &gt;&gt;&gt; tag.get(&#39;name&#39;)</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">            &#39;baz&#39;</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">            &gt;&gt;&gt; tag.get(&#39;foobar&#39;)</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">            None</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">            &gt;&gt;&gt; a.get_value_from_tag(tag, &#39;foobar&#39;)</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">            &#39;barfoo&#39;</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">        :param lxml.etree.Element tag: specify the tag element</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">        :param str attribute: specify the attribute name</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">        :returns: the attribute&#39;s value, or None if the attribute is not present</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>        <span class="c1"># TODO: figure out if both android:name and name tag exist which one to give preference:</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a>        <span class="c1"># currently we give preference for the namespace one and fallback to the un-namespaced</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="n">attribute</span><span class="p">))</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>            <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>                <span class="c1"># If value is still None, the attribute could not be found, thus is not present</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>                    <span class="s2">&quot;Failed to get the attribute &#39;</span><span class="si">{}</span><span class="s2">&#39; on tag &#39;</span><span class="si">{}</span><span class="s2">&#39; with namespace. &quot;</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>                    <span class="s2">&quot;But found the same attribute without namespace!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>                        <span class="n">attribute</span><span class="p">,</span> <span class="n">tag</span><span class="o">.</span><span class="n">tag</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>                <span class="p">)</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>        <span class="k">return</span> <span class="n">value</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>    <span class="k">def</span> <span class="nf">find_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">        Return a list of all the matched tags in all available xml</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">        :param tag_name: specify the tag name</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">        :returns: the matched tags</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>        <span class="n">all_tags</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">find_tags_from_xml</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>        <span class="p">]</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">tag</span> <span class="k">for</span> <span class="n">tag_list</span> <span class="ow">in</span> <span class="n">all_tags</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tag_list</span><span class="p">]</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>    <span class="k">def</span> <span class="nf">find_tags_from_xml</span><span class="p">(</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">xml_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">        Return a list of all the matched tags in a specific xml</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">        :param str xml_name: specify from which xml to pick the tag from</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">        :param str tag_name: specify the tag name</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">        :returns: the matched tags</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>        <span class="n">xml</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="n">xml_name</span><span class="p">]</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>        <span class="k">if</span> <span class="n">xml</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>            <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>        <span class="k">if</span> <span class="n">xml</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="n">tag_name</span><span class="p">:</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_tag_matched</span><span class="p">(</span><span class="n">xml</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">):</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>                <span class="k">return</span> <span class="p">[</span><span class="n">xml</span><span class="p">]</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>            <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>        <span class="n">tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>        <span class="n">tags</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">xml</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//&quot;</span> <span class="o">+</span> <span class="n">tag_name</span><span class="p">))</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>        <span class="c1"># https://github.com/androguard/androguard/pull/1053</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>        <span class="c1"># permission declared using tag &lt;android:uses-permission...</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>        <span class="n">tags</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">xml</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//&quot;</span> <span class="o">+</span> <span class="n">NS_ANDROID</span> <span class="o">+</span> <span class="n">tag_name</span><span class="p">))</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>        <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>            <span class="n">tag</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_tag_matched</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>        <span class="p">]</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>    <span class="k">def</span> <span class="nf">is_tag_matched</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a><span class="sd">        Return `True` if the attributes matches in attribute filter.</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="sd">        An attribute filter is a dictionary containing: {attribute_name: value}.</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><span class="sd">        This function will return `True` if and only if all attributes have the same value.</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><span class="sd">        This function allows to set the dictionary via kwargs, thus you can filter like this:</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">            &gt;&gt;&gt; a.is_tag_matched(tag, name=&quot;foobar&quot;, other=&quot;barfoo&quot;)</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><span class="sd">        This function uses a fallback for attribute searching. It will by default use</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><span class="sd">        the namespace variant but fall back to the non-namespace variant.</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="sd">        Thus specifiying `{&quot;name&quot;: &quot;foobar&quot;}` will match on `&lt;bla name=&quot;foobar&quot; \&gt;`</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">        as well as on `&lt;bla android:name=&quot;foobar&quot; \&gt;`.</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="sd">        :param tag: specify the tag element</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="sd">        :param attribute_filter: specify the attribute filter as dictionary</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a><span class="sd">        :returns: `True` if the attributes matches in attribute filter, else `False`</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attribute_filter</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">attribute_filter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>            <span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value_from_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>            <span class="k">if</span> <span class="n">_value</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>                <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>    <span class="k">def</span> <span class="nf">get_main_activities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">        Return names of the main activities</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">        These values are read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><span class="sd">        :returns: names of the main activities</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>        <span class="n">x</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>        <span class="n">y</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">:</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>                <span class="k">continue</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>            <span class="n">activities_and_aliases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>                <span class="s2">&quot;.//activity&quot;</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>            <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//activity-alias&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">activities_and_aliases</span><span class="p">:</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>                <span class="c1"># Some applications have more than one MAIN activity.</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>                <span class="c1"># For example: paid and free content</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>                <span class="n">activityEnabled</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;enabled&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>                <span class="k">if</span> <span class="n">activityEnabled</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>                <span class="k">for</span> <span class="n">sitem</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//action&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>                    <span class="n">val</span> <span class="o">=</span> <span class="n">sitem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>                    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;android.intent.action.MAIN&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>                        <span class="n">activity</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>                        <span class="k">if</span> <span class="n">activity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>                            <span class="n">x</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)))</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Main activity without name&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>                <span class="k">for</span> <span class="n">sitem</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//category&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>                    <span class="n">val</span> <span class="o">=</span> <span class="n">sitem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>                    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;android.intent.category.LAUNCHER&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>                        <span class="n">activity</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>                        <span class="k">if</span> <span class="n">activity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>                            <span class="n">y</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)))</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Launcher activity without name&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a>    <span class="k">def</span> <span class="nf">get_main_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">        Return the name of the main activity</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">        This value is read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">        :returns: the name of the main activity</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>        <span class="n">activities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_main_activities</span><span class="p">()</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">activities</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_value</span><span class="p">(</span><span class="n">activities</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">activities</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>            <span class="n">main_activities</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_format_value</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span> <span class="k">for</span> <span class="n">ma</span> <span class="ow">in</span> <span class="n">activities</span><span class="p">}</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>            <span class="c1"># sorted is necessary</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>            <span class="c1"># 9fc7d3e8225f6b377f9181a92c551814317b77e1aa0df4c6d508d24b18f0f633</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>            <span class="n">good_main_activities</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>                <span class="n">main_activities</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_activities</span><span class="p">())</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>            <span class="p">)</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>            <span class="k">if</span> <span class="n">good_main_activities</span><span class="p">:</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>                <span class="k">return</span> <span class="n">good_main_activities</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>            <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">main_activities</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>    <span class="k">def</span> <span class="nf">get_activities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">        Return the `android:name` attribute of all activities</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">        :returns: the list of `android:name` attribute of all activities</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="s2">&quot;activity&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>    <span class="k">def</span> <span class="nf">get_activity_aliases</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a><span class="sd">        Return the `android:name` and `android:targetActivity` attribute of all activity aliases.</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a><span class="sd">        :returns: the list of `android:name` and `android:targetActivity` attribute of all activitiy aliases</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>        <span class="n">ali</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>        <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_tags</span><span class="p">(</span><span class="s1">&#39;activity-alias&#39;</span><span class="p">):</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>            <span class="n">activity_alias</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>            <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;targetActivity&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">alias</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> <span class="ow">or</span> <span class="n">alias</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="n">attribute</span><span class="p">))</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>                <span class="n">activity_alias</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>            <span class="k">if</span> <span class="n">activity_alias</span><span class="p">:</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a>                <span class="n">ali</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">activity_alias</span><span class="p">)</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>        <span class="k">return</span> <span class="n">ali</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>    <span class="k">def</span> <span class="nf">get_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><span class="sd">        Return the `android:name` attribute of all services</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a><span class="sd">        :returns: the list of the `android:name` attribute of all services</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="s2">&quot;service&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>    <span class="k">def</span> <span class="nf">get_receivers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><span class="sd">        Return the `android:name` attribute of all receivers</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="sd">        :returns: the list of the `android:name` attribute of all receivers</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="s2">&quot;receiver&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a>    <span class="k">def</span> <span class="nf">get_providers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">        Return the `android:name` attribute of all providers</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">        :returns: the list of the `android:name` attribute of all providers</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="s2">&quot;provider&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>    <span class="k">def</span> <span class="nf">get_res_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">        Return the literal value with a resource id</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a><span class="sd">        :returns: the literal value with a resource id</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>        <span class="n">res_parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_android_resources</span><span class="p">()</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">res_parser</span><span class="p">:</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>            <span class="k">return</span> <span class="n">name</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>        <span class="n">res_id</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">parse_id</span><span class="p">(</span><span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">get_resolved_res_configs</span><span class="p">(</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a>                <span class="n">res_id</span><span class="p">,</span> <span class="n">ARSCResTableConfig</span><span class="o">.</span><span class="n">default_config</span><span class="p">()</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Exception get resolved resource id: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>            <span class="k">return</span> <span class="n">name</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>        <span class="k">return</span> <span class="n">value</span>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>    <span class="k">def</span> <span class="nf">get_intent_filters</span><span class="p">(</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">itemtype</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a><span class="sd">        Find intent filters for a given item and name.</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a><span class="sd">        Intent filter are attached to activities, services or receivers.</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a><span class="sd">        You can search for the intent filters of such items and get a dictionary of all</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a><span class="sd">        attached actions and intent categories.</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><span class="sd">        :param itemtype: the type of parent item to look for, e.g. `activity`,  `service` or `receiver`</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a><span class="sd">        :param name: the `android:name` of the parent item, e.g. activity name</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="sd">        :returns: a dictionary with the keys `action` and `category` containing the `android:name` of those items</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>        <span class="n">attributes</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>            <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>                <span class="s1">&#39;scheme&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>                <span class="s1">&#39;host&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>                <span class="s1">&#39;port&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>                <span class="s1">&#39;path&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>                <span class="s1">&#39;pathPattern&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>                <span class="s1">&#39;pathPrefix&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>                <span class="s1">&#39;mimeType&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>            <span class="p">],</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a>        <span class="p">}</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>        <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a>            <span class="n">d</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">:</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a>            <span class="c1"># TODO: this can probably be solved using a single xpath</span>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//&quot;</span> <span class="o">+</span> <span class="n">itemtype</span><span class="p">):</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_value</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)))</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>                    <span class="k">for</span> <span class="n">sitem</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//intent-filter&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a>                        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a>                            <span class="k">for</span> <span class="n">ssitem</span> <span class="ow">in</span> <span class="n">sitem</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a>                                <span class="k">if</span> <span class="n">element</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>  <span class="c1"># multiple attributes</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a>                                    <span class="n">values</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a>                                    <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">[</span><span class="n">element</span><span class="p">]:</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a>                                        <span class="n">value</span> <span class="o">=</span> <span class="n">ssitem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="n">attribute</span><span class="p">))</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a>                                        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a>                                            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">):</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a>                                                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_res_value</span><span class="p">(</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>                                                    <span class="n">value</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a>                                                <span class="p">)</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a>                                            <span class="n">values</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>                                    <span class="k">if</span> <span class="n">values</span><span class="p">:</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>                                        <span class="n">d</span><span class="p">[</span><span class="n">element</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a>                                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a>                                    <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">[</span><span class="n">element</span><span class="p">]:</span>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a>                                        <span class="n">value</span> <span class="o">=</span> <span class="n">ssitem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="n">attribute</span><span class="p">))</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>                                        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">):</span>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>                                            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_res_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>                                        <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="n">element</span><span class="p">]:</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a>                                            <span class="n">d</span><span class="p">[</span><span class="n">element</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="p">[</span><span class="n">element</span><span class="p">]:</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>                <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>        <span class="k">return</span> <span class="n">d</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>    <span class="k">def</span> <span class="nf">get_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a><span class="sd">        Return permissions names declared in the `AndroidManifest.xml`.</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a><span class="sd">        It is possible that permissions are returned multiple times,</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a><span class="sd">        as this function does not filter the permissions, i.e. it shows you</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a><span class="sd">        exactly what was defined in the `AndroidManifest.xml`.</span>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a><span class="sd">        Implied permissions, which are granted automatically, are not returned</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a><span class="sd">        here. Use [get_uses_implied_permission_list][androguard.core.apk.APK.get_uses_implied_permission_list] if you need a list</span>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a><span class="sd">        of implied permissions.</span>
<a id="__codelineno-0-1432" name="__codelineno-0-1432"></a>
<a id="__codelineno-0-1433" name="__codelineno-0-1433"></a><span class="sd">        :returns: A list of permissions as strings</span>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span>
<a id="__codelineno-0-1436" name="__codelineno-0-1436"></a>
<a id="__codelineno-0-1437" name="__codelineno-0-1437"></a>    <span class="k">def</span> <span class="nf">get_uses_implied_permission_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1438" name="__codelineno-0-1438"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1439" name="__codelineno-0-1439"></a><span class="sd">        Return all permissions implied by the target SDK or other permissions.</span>
<a id="__codelineno-0-1440" name="__codelineno-0-1440"></a>
<a id="__codelineno-0-1441" name="__codelineno-0-1441"></a><span class="sd">        :returns: list of all permissions implied by the target SDK or other permissions as strings</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>        <span class="n">target_sdk_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_effective_target_sdk_version</span><span class="p">()</span>
<a id="__codelineno-0-1444" name="__codelineno-0-1444"></a>
<a id="__codelineno-0-1445" name="__codelineno-0-1445"></a>        <span class="n">READ_CALL_LOG</span> <span class="o">=</span> <span class="s1">&#39;android.permission.READ_CALL_LOG&#39;</span>
<a id="__codelineno-0-1446" name="__codelineno-0-1446"></a>        <span class="n">READ_CONTACTS</span> <span class="o">=</span> <span class="s1">&#39;android.permission.READ_CONTACTS&#39;</span>
<a id="__codelineno-0-1447" name="__codelineno-0-1447"></a>        <span class="n">READ_EXTERNAL_STORAGE</span> <span class="o">=</span> <span class="s1">&#39;android.permission.READ_EXTERNAL_STORAGE&#39;</span>
<a id="__codelineno-0-1448" name="__codelineno-0-1448"></a>        <span class="n">READ_PHONE_STATE</span> <span class="o">=</span> <span class="s1">&#39;android.permission.READ_PHONE_STATE&#39;</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449"></a>        <span class="n">WRITE_CALL_LOG</span> <span class="o">=</span> <span class="s1">&#39;android.permission.WRITE_CALL_LOG&#39;</span>
<a id="__codelineno-0-1450" name="__codelineno-0-1450"></a>        <span class="n">WRITE_CONTACTS</span> <span class="o">=</span> <span class="s1">&#39;android.permission.WRITE_CONTACTS&#39;</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451"></a>        <span class="n">WRITE_EXTERNAL_STORAGE</span> <span class="o">=</span> <span class="s1">&#39;android.permission.WRITE_EXTERNAL_STORAGE&#39;</span>
<a id="__codelineno-0-1452" name="__codelineno-0-1452"></a>
<a id="__codelineno-0-1453" name="__codelineno-0-1453"></a>        <span class="n">implied</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1454" name="__codelineno-0-1454"></a>
<a id="__codelineno-0-1455" name="__codelineno-0-1455"></a>        <span class="n">implied_WRITE_EXTERNAL_STORAGE</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1456" name="__codelineno-0-1456"></a>        <span class="k">if</span> <span class="n">target_sdk_version</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-1457" name="__codelineno-0-1457"></a>            <span class="k">if</span> <span class="n">WRITE_EXTERNAL_STORAGE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">:</span>
<a id="__codelineno-0-1458" name="__codelineno-0-1458"></a>                <span class="n">implied</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">WRITE_EXTERNAL_STORAGE</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<a id="__codelineno-0-1459" name="__codelineno-0-1459"></a>                <span class="n">implied_WRITE_EXTERNAL_STORAGE</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1460" name="__codelineno-0-1460"></a>            <span class="k">if</span> <span class="n">READ_PHONE_STATE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">:</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461"></a>                <span class="n">implied</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">READ_PHONE_STATE</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a>            <span class="n">WRITE_EXTERNAL_STORAGE</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a>            <span class="ow">or</span> <span class="n">implied_WRITE_EXTERNAL_STORAGE</span>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a>        <span class="p">)</span> <span class="ow">and</span> <span class="n">READ_EXTERNAL_STORAGE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">:</span>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>            <span class="n">maxSdkVersion</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">version</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">uses_permissions</span><span class="p">:</span>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a>                <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">WRITE_EXTERNAL_STORAGE</span><span class="p">:</span>
<a id="__codelineno-0-1470" name="__codelineno-0-1470"></a>                    <span class="n">maxSdkVersion</span> <span class="o">=</span> <span class="n">version</span>
<a id="__codelineno-0-1471" name="__codelineno-0-1471"></a>                    <span class="k">break</span>
<a id="__codelineno-0-1472" name="__codelineno-0-1472"></a>            <span class="n">implied</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">READ_EXTERNAL_STORAGE</span><span class="p">,</span> <span class="n">maxSdkVersion</span><span class="p">])</span>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>        <span class="k">if</span> <span class="n">target_sdk_version</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a>                <span class="n">READ_CONTACTS</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a>                <span class="ow">and</span> <span class="n">READ_CALL_LOG</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a>            <span class="p">):</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a>                <span class="n">implied</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">READ_CALL_LOG</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a>                <span class="n">WRITE_CONTACTS</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a>                <span class="ow">and</span> <span class="n">WRITE_CALL_LOG</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>            <span class="p">):</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a>                <span class="n">implied</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">WRITE_CALL_LOG</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a>        <span class="k">return</span> <span class="n">implied</span>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>    <span class="k">def</span> <span class="nf">_update_permission_protection_level</span><span class="p">(</span>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">protection_level</span><span class="p">,</span> <span class="n">sdk_version</span>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a>    <span class="p">):</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">sdk_version</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">sdk_version</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">15</span><span class="p">:</span>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a>            <span class="k">return</span> <span class="n">protection_level</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Or&#39;</span><span class="p">,</span> <span class="s1">&#39;|&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a>        <span class="k">return</span> <span class="n">protection_level</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494"></a>
<a id="__codelineno-0-1495" name="__codelineno-0-1495"></a>    <span class="k">def</span> <span class="nf">_fill_deprecated_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permissions</span><span class="p">):</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496"></a>        <span class="n">min_sdk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_min_sdk_version</span><span class="p">()</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497"></a>        <span class="n">target_sdk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_target_sdk_version</span><span class="p">()</span>
<a id="__codelineno-0-1498" name="__codelineno-0-1498"></a>        <span class="n">filled_permissions</span> <span class="o">=</span> <span class="n">permissions</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499"></a>        <span class="k">for</span> <span class="n">permission</span> <span class="ow">in</span> <span class="n">filled_permissions</span><span class="p">:</span>
<a id="__codelineno-0-1500" name="__codelineno-0-1500"></a>            <span class="n">protection_level</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">description</span> <span class="o">=</span> <span class="n">filled_permissions</span><span class="p">[</span>
<a id="__codelineno-0-1501" name="__codelineno-0-1501"></a>                <span class="n">permission</span>
<a id="__codelineno-0-1502" name="__codelineno-0-1502"></a>            <span class="p">]</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1504" name="__codelineno-0-1504"></a>                <span class="ow">not</span> <span class="n">label</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">description</span>
<a id="__codelineno-0-1505" name="__codelineno-0-1505"></a>            <span class="p">)</span> <span class="ow">and</span> <span class="n">permission</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permission_module_min_sdk</span><span class="p">:</span>
<a id="__codelineno-0-1506" name="__codelineno-0-1506"></a>                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permission_module_min_sdk</span><span class="p">[</span><span class="n">permission</span><span class="p">]</span>
<a id="__codelineno-0-1507" name="__codelineno-0-1507"></a>                <span class="n">protection_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_permission_protection_level</span><span class="p">(</span>
<a id="__codelineno-0-1508" name="__codelineno-0-1508"></a>                    <span class="n">x</span><span class="p">[</span><span class="s1">&#39;protectionLevel&#39;</span><span class="p">],</span> <span class="n">min_sdk</span>
<a id="__codelineno-0-1509" name="__codelineno-0-1509"></a>                <span class="p">)</span>
<a id="__codelineno-0-1510" name="__codelineno-0-1510"></a>                <span class="n">filled_permissions</span><span class="p">[</span><span class="n">permission</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1511" name="__codelineno-0-1511"></a>                    <span class="n">protection_level</span><span class="p">,</span>
<a id="__codelineno-0-1512" name="__codelineno-0-1512"></a>                    <span class="n">x</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span>
<a id="__codelineno-0-1513" name="__codelineno-0-1513"></a>                    <span class="n">x</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">],</span>
<a id="__codelineno-0-1514" name="__codelineno-0-1514"></a>                <span class="p">]</span>
<a id="__codelineno-0-1515" name="__codelineno-0-1515"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1516" name="__codelineno-0-1516"></a>                <span class="n">filled_permissions</span><span class="p">[</span><span class="n">permission</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1517" name="__codelineno-0-1517"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_update_permission_protection_level</span><span class="p">(</span>
<a id="__codelineno-0-1518" name="__codelineno-0-1518"></a>                        <span class="n">protection_level</span><span class="p">,</span> <span class="n">target_sdk</span>
<a id="__codelineno-0-1519" name="__codelineno-0-1519"></a>                    <span class="p">),</span>
<a id="__codelineno-0-1520" name="__codelineno-0-1520"></a>                    <span class="n">label</span><span class="p">,</span>
<a id="__codelineno-0-1521" name="__codelineno-0-1521"></a>                    <span class="n">description</span><span class="p">,</span>
<a id="__codelineno-0-1522" name="__codelineno-0-1522"></a>                <span class="p">]</span>
<a id="__codelineno-0-1523" name="__codelineno-0-1523"></a>        <span class="k">return</span> <span class="n">filled_permissions</span>
<a id="__codelineno-0-1524" name="__codelineno-0-1524"></a>
<a id="__codelineno-0-1525" name="__codelineno-0-1525"></a>    <span class="k">def</span> <span class="nf">get_details_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-1526" name="__codelineno-0-1526"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1527" name="__codelineno-0-1527"></a><span class="sd">        Return permissions with details.</span>
<a id="__codelineno-0-1528" name="__codelineno-0-1528"></a>
<a id="__codelineno-0-1529" name="__codelineno-0-1529"></a><span class="sd">        This can only return details about the permission, if the permission is</span>
<a id="__codelineno-0-1530" name="__codelineno-0-1530"></a><span class="sd">        defined in the AOSP.</span>
<a id="__codelineno-0-1531" name="__codelineno-0-1531"></a>
<a id="__codelineno-0-1532" name="__codelineno-0-1532"></a><span class="sd">        :returns: permissions with details: dict of `{permission: [protectionLevel, label, description]}`</span>
<a id="__codelineno-0-1533" name="__codelineno-0-1533"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1534" name="__codelineno-0-1534"></a>        <span class="n">l</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1535" name="__codelineno-0-1535"></a>
<a id="__codelineno-0-1536" name="__codelineno-0-1536"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">:</span>
<a id="__codelineno-0-1537" name="__codelineno-0-1537"></a>            <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permission_module</span><span class="p">:</span>
<a id="__codelineno-0-1538" name="__codelineno-0-1538"></a>                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permission_module</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-1539" name="__codelineno-0-1539"></a>                <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;protectionLevel&quot;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]]</span>
<a id="__codelineno-0-1540" name="__codelineno-0-1540"></a>            <span class="k">elif</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">declared_permissions</span><span class="p">:</span>
<a id="__codelineno-0-1541" name="__codelineno-0-1541"></a>                <span class="n">protectionLevel_hex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">declared_permissions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span>
<a id="__codelineno-0-1542" name="__codelineno-0-1542"></a>                    <span class="s2">&quot;protectionLevel&quot;</span>
<a id="__codelineno-0-1543" name="__codelineno-0-1543"></a>                <span class="p">]</span>
<a id="__codelineno-0-1544" name="__codelineno-0-1544"></a>                <span class="n">protectionLevel</span> <span class="o">=</span> <span class="n">protection_flags_to_attributes</span><span class="p">[</span>
<a id="__codelineno-0-1545" name="__codelineno-0-1545"></a>                    <span class="n">protectionLevel_hex</span>
<a id="__codelineno-0-1546" name="__codelineno-0-1546"></a>                <span class="p">]</span>
<a id="__codelineno-0-1547" name="__codelineno-0-1547"></a>                <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1548" name="__codelineno-0-1548"></a>                    <span class="n">protectionLevel</span><span class="p">,</span>
<a id="__codelineno-0-1549" name="__codelineno-0-1549"></a>                    <span class="s2">&quot;Unknown permission from android reference&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1550" name="__codelineno-0-1550"></a>                    <span class="s2">&quot;Unknown permission from android reference&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1551" name="__codelineno-0-1551"></a>                <span class="p">]</span>
<a id="__codelineno-0-1552" name="__codelineno-0-1552"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1553" name="__codelineno-0-1553"></a>                <span class="c1"># Is there a valid case not belonging to the above two?</span>
<a id="__codelineno-0-1554" name="__codelineno-0-1554"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown permission </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1555" name="__codelineno-0-1555"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_deprecated_permissions</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<a id="__codelineno-0-1556" name="__codelineno-0-1556"></a>
<a id="__codelineno-0-1557" name="__codelineno-0-1557"></a>    <span class="k">def</span> <span class="nf">get_requested_aosp_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1558" name="__codelineno-0-1558"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1559" name="__codelineno-0-1559"></a><span class="sd">        Returns requested permissions declared within AOSP project.</span>
<a id="__codelineno-0-1560" name="__codelineno-0-1560"></a>
<a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><span class="sd">        This includes several other permissions as well, which are in the platform apps.</span>
<a id="__codelineno-0-1562" name="__codelineno-0-1562"></a>
<a id="__codelineno-0-1563" name="__codelineno-0-1563"></a><span class="sd">        :returns: requested permissions</span>
<a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565"></a>        <span class="n">aosp_permissions</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1566" name="__codelineno-0-1566"></a>        <span class="n">all_permissions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>
<a id="__codelineno-0-1567" name="__codelineno-0-1567"></a>        <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">all_permissions</span><span class="p">:</span>
<a id="__codelineno-0-1568" name="__codelineno-0-1568"></a>            <span class="k">if</span> <span class="n">perm</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permission_module</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569"></a>                <span class="n">aosp_permissions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
<a id="__codelineno-0-1570" name="__codelineno-0-1570"></a>        <span class="k">return</span> <span class="n">aosp_permissions</span>
<a id="__codelineno-0-1571" name="__codelineno-0-1571"></a>
<a id="__codelineno-0-1572" name="__codelineno-0-1572"></a>    <span class="k">def</span> <span class="nf">get_requested_aosp_permissions_details</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-1573" name="__codelineno-0-1573"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1574" name="__codelineno-0-1574"></a><span class="sd">        Returns requested aosp permissions with details.</span>
<a id="__codelineno-0-1575" name="__codelineno-0-1575"></a>
<a id="__codelineno-0-1576" name="__codelineno-0-1576"></a><span class="sd">        :returns: requested aosp permissions</span>
<a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578"></a>        <span class="n">l</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1579" name="__codelineno-0-1579"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">:</span>
<a id="__codelineno-0-1580" name="__codelineno-0-1580"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a>                <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permission_module</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a>            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a>                <span class="c1"># if we have not found permission do nothing</span>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a>                <span class="k">continue</span>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a>        <span class="k">return</span> <span class="n">l</span>
<a id="__codelineno-0-1586" name="__codelineno-0-1586"></a>
<a id="__codelineno-0-1587" name="__codelineno-0-1587"></a>    <span class="k">def</span> <span class="nf">get_requested_third_party_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1588" name="__codelineno-0-1588"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1589" name="__codelineno-0-1589"></a><span class="sd">        Returns list of requested permissions not declared within AOSP project.</span>
<a id="__codelineno-0-1590" name="__codelineno-0-1590"></a>
<a id="__codelineno-0-1591" name="__codelineno-0-1591"></a><span class="sd">        :returns: requested permissions</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>        <span class="n">third_party_permissions</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>        <span class="n">all_permissions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>        <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">all_permissions</span><span class="p">:</span>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>            <span class="k">if</span> <span class="n">perm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permission_module</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>                <span class="n">third_party_permissions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a>        <span class="k">return</span> <span class="n">third_party_permissions</span>
<a id="__codelineno-0-1599" name="__codelineno-0-1599"></a>
<a id="__codelineno-0-1600" name="__codelineno-0-1600"></a>    <span class="k">def</span> <span class="nf">get_declared_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a><span class="sd">        Returns list of the declared permissions.</span>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a><span class="sd">        :returns: list of declared permissions</span>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">declared_permissions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-1607" name="__codelineno-0-1607"></a>
<a id="__codelineno-0-1608" name="__codelineno-0-1608"></a>    <span class="k">def</span> <span class="nf">get_declared_permissions_details</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a><span class="sd">        Returns declared permissions with the details.</span>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a><span class="sd">        :returns: declared permissions</span>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">declared_permissions</span>
<a id="__codelineno-0-1615" name="__codelineno-0-1615"></a>
<a id="__codelineno-0-1616" name="__codelineno-0-1616"></a>    <span class="k">def</span> <span class="nf">get_max_sdk_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a><span class="sd">        Return the `android:maxSdkVersion` attribute</span>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a><span class="sd">        :returns: the `android:maxSdkVersion` attribute</span>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span><span class="s2">&quot;uses-sdk&quot;</span><span class="p">,</span> <span class="s2">&quot;maxSdkVersion&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1623" name="__codelineno-0-1623"></a>
<a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>    <span class="k">def</span> <span class="nf">get_min_sdk_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a><span class="sd">          Return the `android:minSdkVersion` attribute</span>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a><span class="sd">          :returns: the `android:minSdkVersion` attribute</span>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span><span class="s2">&quot;uses-sdk&quot;</span><span class="p">,</span> <span class="s2">&quot;minSdkVersion&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1631" name="__codelineno-0-1631"></a>
<a id="__codelineno-0-1632" name="__codelineno-0-1632"></a>    <span class="k">def</span> <span class="nf">get_target_sdk_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1634" name="__codelineno-0-1634"></a><span class="sd">        Return the `android:targetSdkVersion` attribute</span>
<a id="__codelineno-0-1635" name="__codelineno-0-1635"></a>
<a id="__codelineno-0-1636" name="__codelineno-0-1636"></a><span class="sd">        :returns: the `android:targetSdkVersion` attribute</span>
<a id="__codelineno-0-1637" name="__codelineno-0-1637"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1638" name="__codelineno-0-1638"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span><span class="s2">&quot;uses-sdk&quot;</span><span class="p">,</span> <span class="s2">&quot;targetSdkVersion&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1639" name="__codelineno-0-1639"></a>
<a id="__codelineno-0-1640" name="__codelineno-0-1640"></a>    <span class="k">def</span> <span class="nf">get_effective_target_sdk_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1642" name="__codelineno-0-1642"></a><span class="sd">        Return the effective `targetSdkVersion`, always returns int &gt; 0.</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a><span class="sd">        If the `targetSdkVersion` is not set, it defaults to 1.  This is</span>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a><span class="sd">        set based on defaults as defined in:</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a><span class="sd">        &lt;https://developer.android.com/guide/topics/manifest/uses-sdk-element.html&gt;</span>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a><span class="sd">        :returns: the effective `targetSdkVersion`</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>        <span class="n">target_sdk_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_target_sdk_version</span><span class="p">()</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">target_sdk_version</span><span class="p">:</span>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>            <span class="n">target_sdk_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_min_sdk_version</span><span class="p">()</span>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">target_sdk_version</span><span class="p">)</span>
<a id="__codelineno-0-1655" name="__codelineno-0-1655"></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
<a id="__codelineno-0-1656" name="__codelineno-0-1656"></a>            <span class="k">return</span> <span class="mi">1</span>
<a id="__codelineno-0-1657" name="__codelineno-0-1657"></a>
<a id="__codelineno-0-1658" name="__codelineno-0-1658"></a>    <span class="k">def</span> <span class="nf">get_libraries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a><span class="sd">        Return the `android:name` attributes for libraries</span>
<a id="__codelineno-0-1661" name="__codelineno-0-1661"></a>
<a id="__codelineno-0-1662" name="__codelineno-0-1662"></a><span class="sd">        :returns: the `android:name` attributes</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="s2">&quot;uses-library&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>    <span class="k">def</span> <span class="nf">get_features</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a><span class="sd">        Return a list of all `android:names` found for the tag `uses-feature`</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><span class="sd">        in the `AndroidManifest.xml`</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a><span class="sd">        :returns: the `android:names` found</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="s2">&quot;uses-feature&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a>    <span class="k">def</span> <span class="nf">is_wearable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a><span class="sd">        Checks if this application is build for wearables by</span>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a><span class="sd">        checking if it uses the feature &#39;android.hardware.type.watch&#39;</span>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a><span class="sd">        See: https://developer.android.com/training/wearables/apps/creating.html for more information.</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a><span class="sd">        Not every app is setting this feature (not even the example Google provides),</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a><span class="sd">        so it might be wise to not 100% rely on this feature.</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a><span class="sd">        :returns: `True` if wearable, `False` otherwise</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a>        <span class="k">return</span> <span class="s1">&#39;android.hardware.type.watch&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a>    <span class="k">def</span> <span class="nf">is_leanback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a><span class="sd">        Checks if this application is build for TV (Leanback support)</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a><span class="sd">        by checkin if it uses the feature &#39;android.software.leanback&#39;</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a><span class="sd">        :returns: `True` if leanback feature is used, `False` otherwise</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a>        <span class="k">return</span> <span class="s1">&#39;android.software.leanback&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>    <span class="k">def</span> <span class="nf">is_androidtv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a><span class="sd">        Checks if this application does not require a touchscreen,</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a><span class="sd">        as this is the rule to get into the TV section of the Play Store</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a><span class="sd">        See: https://developer.android.com/training/tv/start/start.html for more information.</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a><span class="sd">        :returns: `True` if &#39;android.hardware.touchscreen&#39; is not required, `False` otherwise</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>                <span class="s1">&#39;uses-feature&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>                <span class="s1">&#39;name&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>                <span class="n">required</span><span class="o">=</span><span class="s2">&quot;false&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;android.hardware.touchscreen&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>            <span class="p">)</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>            <span class="o">==</span> <span class="s2">&quot;android.hardware.touchscreen&quot;</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>        <span class="p">)</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>    <span class="k">def</span> <span class="nf">get_certificate_der</span><span class="p">(</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_sdk_version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a><span class="sd">        Return the DER coded X.509 certificate from the signature file.</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a><span class="sd">        If minSdkVersion is prior to Android N only the first SignerInfo is used.</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a><span class="sd">        If signed attributes are present, they are taken into account</span>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a><span class="sd">        Note that unsupported critical extensions and key usage are not verified!</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a><span class="sd">        [V1SchemeVerifier.java](https://android.googlesource.com/platform/tools/apksig/+/refs/tags/platform-tools-34.0.5/src/main/java/com/android/apksig/internal/apk/v1/V1SchemeVerifier.java#668)</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a><span class="sd">        :param filename: Signature filename in APK</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a><span class="sd">        :param max_sdk_version: An optional integer parameter for the max sdk version</span>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a><span class="sd">        :returns: DER coded X.509 certificate as binary or None</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>        <span class="c1"># Get the signature</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>        <span class="n">pkcs7message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>        <span class="c1"># Get the .SF</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>        <span class="n">sf_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.SF&#39;</span>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>        <span class="n">sf_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">sf_filename</span><span class="p">)</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a>        <span class="c1"># Load the signature</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>        <span class="n">signed_data</span> <span class="o">=</span> <span class="n">cms</span><span class="o">.</span><span class="n">ContentInfo</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pkcs7message</span><span class="p">)</span>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>        <span class="c1"># Locate the SignerInfo structure</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>        <span class="n">signer_infos</span> <span class="o">=</span> <span class="n">signed_data</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">][</span><span class="s1">&#39;signer_infos&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">signer_infos</span><span class="p">:</span>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>                <span class="s1">&#39;No signer information found in the PKCS7 object. The APK may not be properly signed.&#39;</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>            <span class="p">)</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>        <span class="c1"># Prior to Android N, Android attempts to verify only the first SignerInfo. From N onwards, Android attempts</span>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>        <span class="c1"># to verify all SignerInfos and then picks the first verified SignerInfo.</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>        <span class="n">min_sdk_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_min_sdk_version</span><span class="p">()</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>            <span class="n">min_sdk_version</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">min_sdk_version</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">24</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>        <span class="p">):</span>  <span class="c1"># AndroidSdkVersion.N</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>                <span class="sa">f</span><span class="s2">&quot;minSdkVersion: </span><span class="si">{</span><span class="n">min_sdk_version</span><span class="si">}</span><span class="s2"> is less than 24. Getting the first signerInfo only!&quot;</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>            <span class="p">)</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>            <span class="n">unverified_signer_infos_to_try</span> <span class="o">=</span> <span class="p">[</span><span class="n">signer_infos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>            <span class="n">unverified_signer_infos_to_try</span> <span class="o">=</span> <span class="n">signer_infos</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>        <span class="c1"># Extract certificates from the PKCS7 object</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>        <span class="n">certificates</span> <span class="o">=</span> <span class="n">signed_data</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">][</span><span class="s1">&#39;certificates&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>        <span class="n">return_certificate</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>        <span class="n">list_certificates_verified</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>        <span class="k">for</span> <span class="n">signer_info</span> <span class="ow">in</span> <span class="n">unverified_signer_infos_to_try</span><span class="p">:</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>                <span class="n">matching_certificate_verified</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">verify_signer_info_against_sig_file</span><span class="p">(</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>                        <span class="n">signed_data</span><span class="p">,</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>                        <span class="n">certificates</span><span class="p">,</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>                        <span class="n">signer_info</span><span class="p">,</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>                        <span class="n">sf_object</span><span class="p">,</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>                        <span class="n">max_sdk_version</span><span class="p">,</span>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>                <span class="p">)</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">,</span> <span class="n">InvalidSignature</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>                    <span class="sa">f</span><span class="s2">&quot;The following exception was raised while verifying the certificate: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a>                <span class="p">)</span>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a>                <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>                    <span class="kc">None</span>  <span class="c1"># the validation stops due to the exception raised!</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>                <span class="p">)</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>            <span class="k">if</span> <span class="n">matching_certificate_verified</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>                <span class="n">list_certificates_verified</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>                    <span class="n">matching_certificate_verified</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a>                <span class="p">)</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">list_certificates_verified</span><span class="p">:</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>                <span class="sa">f</span><span class="s2">&quot;minSdkVersion: </span><span class="si">{</span><span class="n">min_sdk_version</span><span class="si">}</span><span class="s2">, # of SignerInfos: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">unverified_signer_infos_to_try</span><span class="p">)</span><span class="si">}</span><span class="s2">. None Verified!&quot;</span>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a>            <span class="p">)</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a>            <span class="n">return_certificate</span> <span class="o">=</span> <span class="n">list_certificates_verified</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a>        <span class="k">return</span> <span class="n">return_certificate</span>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a>    <span class="k">def</span> <span class="nf">verify_signer_info_against_sig_file</span><span class="p">(</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a>        <span class="n">signed_data</span><span class="p">:</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">ContentInfo</span><span class="p">,</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a>        <span class="n">certificates</span><span class="p">:</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">CertificateSet</span><span class="p">,</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a>        <span class="n">signer_info</span><span class="p">:</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">SignerInfo</span><span class="p">,</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a>        <span class="n">sf_object</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a>        <span class="n">max_sdk_version</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span>
<a id="__codelineno-0-1799" name="__codelineno-0-1799"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-1800" name="__codelineno-0-1800"></a>        <span class="n">matching_certificate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_certificate</span><span class="p">(</span><span class="n">certificates</span><span class="p">,</span> <span class="n">signer_info</span><span class="p">)</span>
<a id="__codelineno-0-1801" name="__codelineno-0-1801"></a>        <span class="n">matching_certificate_verified</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1802" name="__codelineno-0-1802"></a>        <span class="n">digest_algorithm</span><span class="p">,</span> <span class="n">crypto_hash_algorithm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_hash_algorithm</span><span class="p">(</span>
<a id="__codelineno-0-1803" name="__codelineno-0-1803"></a>            <span class="n">signer_info</span>
<a id="__codelineno-0-1804" name="__codelineno-0-1804"></a>        <span class="p">)</span>
<a id="__codelineno-0-1805" name="__codelineno-0-1805"></a>        <span class="k">if</span> <span class="n">matching_certificate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1807" name="__codelineno-0-1807"></a>                <span class="s2">&quot;Signing certificate referenced in SignerInfo not found in SignedData&quot;</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808"></a>            <span class="p">)</span>
<a id="__codelineno-0-1809" name="__codelineno-0-1809"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1810" name="__codelineno-0-1810"></a>            <span class="k">if</span> <span class="n">signer_info</span><span class="p">[</span><span class="s1">&#39;signed_attrs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">native</span><span class="p">:</span>
<a id="__codelineno-0-1811" name="__codelineno-0-1811"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Signed Attributes detected!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812"></a>                <span class="n">signed_attrs</span> <span class="o">=</span> <span class="n">signer_info</span><span class="p">[</span><span class="s1">&#39;signed_attrs&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1813" name="__codelineno-0-1813"></a>                <span class="n">signed_attrs_dict</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<a id="__codelineno-0-1814" name="__codelineno-0-1814"></a>                <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">signed_attrs</span><span class="p">:</span>
<a id="__codelineno-0-1815" name="__codelineno-0-1815"></a>                    <span class="k">if</span> <span class="n">attr</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dotted</span> <span class="ow">in</span> <span class="n">signed_attrs_dict</span><span class="p">:</span>
<a id="__codelineno-0-1816" name="__codelineno-0-1816"></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1817" name="__codelineno-0-1817"></a>                            <span class="sa">f</span><span class="s2">&quot;Duplicate signed attribute: </span><span class="si">{</span><span class="n">attr</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dotted</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819"></a>                    <span class="n">signed_attrs_dict</span><span class="p">[</span><span class="n">attr</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dotted</span><span class="p">]</span> <span class="o">=</span> <span class="n">attr</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1820" name="__codelineno-0-1820"></a>
<a id="__codelineno-0-1821" name="__codelineno-0-1821"></a>                <span class="c1"># Check content type attribute (for Android N and newer)</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822"></a>                <span class="k">if</span> <span class="n">max_sdk_version</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">max_sdk_version</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">24</span><span class="p">:</span>
<a id="__codelineno-0-1823" name="__codelineno-0-1823"></a>                    <span class="n">content_type_oid</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1824" name="__codelineno-0-1824"></a>                        <span class="s1">&#39;1.2.840.113549.1.9.3&#39;</span>  <span class="c1"># OID for contentType</span>
<a id="__codelineno-0-1825" name="__codelineno-0-1825"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>                    <span class="k">if</span> <span class="n">content_type_oid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">signed_attrs_dict</span><span class="p">:</span>
<a id="__codelineno-0-1827" name="__codelineno-0-1827"></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1828" name="__codelineno-0-1828"></a>                            <span class="s2">&quot;No Content Type in signed attributes&quot;</span>
<a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1830" name="__codelineno-0-1830"></a>                    <span class="n">content_type</span> <span class="o">=</span> <span class="n">signed_attrs_dict</span><span class="p">[</span><span class="n">content_type_oid</span><span class="p">][</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831"></a>                        <span class="mi">0</span>
<a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>                    <span class="p">]</span><span class="o">.</span><span class="n">native</span>
<a id="__codelineno-0-1833" name="__codelineno-0-1833"></a>                    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834"></a>                        <span class="n">content_type</span>
<a id="__codelineno-0-1835" name="__codelineno-0-1835"></a>                        <span class="o">!=</span> <span class="n">signed_data</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">][</span><span class="s1">&#39;encap_content_info&#39;</span><span class="p">][</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836"></a>                            <span class="s1">&#39;content_type&#39;</span>
<a id="__codelineno-0-1837" name="__codelineno-0-1837"></a>                        <span class="p">]</span><span class="o">.</span><span class="n">native</span>
<a id="__codelineno-0-1838" name="__codelineno-0-1838"></a>                    <span class="p">):</span>
<a id="__codelineno-0-1839" name="__codelineno-0-1839"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1840" name="__codelineno-0-1840"></a>                            <span class="s2">&quot;Content Type mismatch. Continuing to next SignerInfo, if any.&quot;</span>
<a id="__codelineno-0-1841" name="__codelineno-0-1841"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1842" name="__codelineno-0-1842"></a>                        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-1843" name="__codelineno-0-1843"></a>
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a>                <span class="c1"># Check message digest attribute</span>
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a>                <span class="n">message_digest_oid</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a>                    <span class="s1">&#39;1.2.840.113549.1.9.4&#39;</span>  <span class="c1"># OID for messageDigest</span>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a>                <span class="p">)</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a>                <span class="k">if</span> <span class="n">message_digest_oid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">signed_attrs_dict</span><span class="p">:</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No content digest in signed attributes&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>                <span class="n">expected_signature_file_digest</span> <span class="o">=</span> <span class="n">signed_attrs_dict</span><span class="p">[</span>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>                    <span class="n">message_digest_oid</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>                <span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">native</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>                <span class="n">hash_algo</span> <span class="o">=</span> <span class="n">digest_algorithm</span><span class="p">()</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>                <span class="n">hash_algo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sf_object</span><span class="p">)</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>                <span class="n">actual_digest</span> <span class="o">=</span> <span class="n">hash_algo</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a>                <span class="c1"># Compare digests</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>                <span class="k">if</span> <span class="n">actual_digest</span> <span class="o">!=</span> <span class="n">expected_signature_file_digest</span><span class="p">:</span>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>                        <span class="s2">&quot;Digest mismatch. Continuing to next SignerInfo, if any.&quot;</span>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>                    <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>                <span class="n">signed_attrs_dump</span> <span class="o">=</span> <span class="n">signed_attrs</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>                <span class="c1"># Modify the first byte to 0x31 for UNIVERSAL SET</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>                <span class="n">signed_attrs_dump</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x31</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">signed_attrs_dump</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>                <span class="n">matching_certificate_verified</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verify_signature</span><span class="p">(</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>                    <span class="n">signer_info</span><span class="p">,</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>                    <span class="n">matching_certificate</span><span class="p">,</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a>                    <span class="n">signed_attrs_dump</span><span class="p">,</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a>                    <span class="n">crypto_hash_algorithm</span><span class="p">,</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a>                <span class="p">)</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a>                <span class="n">matching_certificate_verified</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verify_signature</span><span class="p">(</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a>                    <span class="n">signer_info</span><span class="p">,</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>                    <span class="n">matching_certificate</span><span class="p">,</span>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a>                    <span class="n">sf_object</span><span class="p">,</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a>                    <span class="n">crypto_hash_algorithm</span><span class="p">,</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a>                <span class="p">)</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a>        <span class="k">return</span> <span class="n">matching_certificate_verified</span>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a>    <span class="k">def</span> <span class="nf">verify_signature</span><span class="p">(</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a>        <span class="n">signer_info</span><span class="p">:</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">SignerInfo</span><span class="p">,</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a>        <span class="n">matching_certificate</span><span class="p">,</span>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a>        <span class="n">signed_data</span><span class="p">,</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a>        <span class="n">crypto_hash_algorithm</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a>        <span class="n">matching_certificate_verified</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a>        <span class="n">signature</span> <span class="o">=</span> <span class="n">signer_info</span><span class="p">[</span><span class="s1">&#39;signature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">native</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a>        <span class="c1"># Load the certificate using asn1crypto as it can handle more cases (v1-only-with-rsa-1024-cert-not-der.apk)</span>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a>        <span class="n">cert</span> <span class="o">=</span> <span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">matching_certificate</span><span class="o">.</span><span class="n">chosen</span><span class="o">.</span><span class="n">dump</span><span class="p">())</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a>        <span class="n">public_key_info</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">public_key</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a>        <span class="c1"># Convert the ASN.1 public key to a cryptography-compatible object</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a>        <span class="n">public_key_der</span> <span class="o">=</span> <span class="n">public_key_info</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a>        <span class="n">public_key</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">load_der_public_key</span><span class="p">(</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a>            <span class="n">public_key_der</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">default_backend</span><span class="p">()</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a>        <span class="p">)</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a>            <span class="c1"># RSA Key</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">public_key</span><span class="p">,</span> <span class="n">rsa</span><span class="o">.</span><span class="n">RSAPublicKey</span><span class="p">):</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a>                <span class="n">public_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a>                    <span class="n">signature</span><span class="p">,</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a>                    <span class="n">signed_data</span><span class="p">,</span>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>                    <span class="n">padding</span><span class="o">.</span><span class="n">PKCS1v15</span><span class="p">(),</span>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a>                    <span class="n">crypto_hash_algorithm</span><span class="p">(),</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a>                <span class="p">)</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a>            <span class="c1"># DSA Key</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">public_key</span><span class="p">,</span> <span class="n">dsa</span><span class="o">.</span><span class="n">DSAPublicKey</span><span class="p">):</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a>                <span class="n">public_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a>                    <span class="n">signature</span><span class="p">,</span> <span class="n">signed_data</span><span class="p">,</span> <span class="n">crypto_hash_algorithm</span><span class="p">()</span>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a>                <span class="p">)</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a>
<a id="__codelineno-0-1918" name="__codelineno-0-1918"></a>            <span class="c1"># EC Key</span>
<a id="__codelineno-0-1919" name="__codelineno-0-1919"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">public_key</span><span class="p">,</span> <span class="n">ec</span><span class="o">.</span><span class="n">EllipticCurvePublicKey</span><span class="p">):</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>                <span class="n">public_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span>
<a id="__codelineno-0-1921" name="__codelineno-0-1921"></a>                    <span class="n">signature</span><span class="p">,</span> <span class="n">signed_data</span><span class="p">,</span> <span class="n">ec</span><span class="o">.</span><span class="n">ECDSA</span><span class="p">(</span><span class="n">crypto_hash_algorithm</span><span class="p">())</span>
<a id="__codelineno-0-1922" name="__codelineno-0-1922"></a>                <span class="p">)</span>
<a id="__codelineno-0-1923" name="__codelineno-0-1923"></a>
<a id="__codelineno-0-1924" name="__codelineno-0-1924"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1925" name="__codelineno-0-1925"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1926" name="__codelineno-0-1926"></a>                    <span class="sa">f</span><span class="s2">&quot;Unsupported key algorithm: </span><span class="si">{</span><span class="n">public_key</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1927" name="__codelineno-0-1927"></a>                <span class="p">)</span>
<a id="__codelineno-0-1928" name="__codelineno-0-1928"></a>
<a id="__codelineno-0-1929" name="__codelineno-0-1929"></a>            <span class="c1"># If verification succeeds, return the certificate</span>
<a id="__codelineno-0-1930" name="__codelineno-0-1930"></a>            <span class="n">matching_certificate_verified</span> <span class="o">=</span> <span class="n">matching_certificate</span><span class="o">.</span><span class="n">chosen</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
<a id="__codelineno-0-1931" name="__codelineno-0-1931"></a>
<a id="__codelineno-0-1932" name="__codelineno-0-1932"></a>        <span class="k">except</span> <span class="n">InvalidSignature</span><span class="p">:</span>
<a id="__codelineno-0-1933" name="__codelineno-0-1933"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-1934" name="__codelineno-0-1934"></a>                <span class="sa">f</span><span class="s2">&quot;The public key of the certificate: </span><span class="si">{</span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">matching_certificate</span><span class="o">.</span><span class="n">chosen</span><span class="o">.</span><span class="n">dump</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-1935" name="__codelineno-0-1935"></a>                <span class="sa">f</span><span class="s2">&quot;is not associated with the signature!&quot;</span>
<a id="__codelineno-0-1936" name="__codelineno-0-1936"></a>            <span class="p">)</span>
<a id="__codelineno-0-1937" name="__codelineno-0-1937"></a>
<a id="__codelineno-0-1938" name="__codelineno-0-1938"></a>        <span class="k">return</span> <span class="n">matching_certificate_verified</span>
<a id="__codelineno-0-1939" name="__codelineno-0-1939"></a>
<a id="__codelineno-0-1940" name="__codelineno-0-1940"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-1941" name="__codelineno-0-1941"></a>    <span class="k">def</span> <span class="nf">get_hash_algorithm</span><span class="p">(</span><span class="n">signer_info</span><span class="p">:</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">SignerInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">HashAlgorithm</span><span class="p">]:</span>
<a id="__codelineno-0-1942" name="__codelineno-0-1942"></a>        <span class="c1"># Determine the hash algorithm from the SignerInfo</span>
<a id="__codelineno-0-1943" name="__codelineno-0-1943"></a>        <span class="n">digest_algorithm</span> <span class="o">=</span> <span class="n">signer_info</span><span class="p">[</span><span class="s1">&#39;digest_algorithm&#39;</span><span class="p">][</span><span class="s1">&#39;algorithm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">native</span>
<a id="__codelineno-0-1944" name="__codelineno-0-1944"></a>        <span class="c1"># Map the digest algorithm to a hash function</span>
<a id="__codelineno-0-1945" name="__codelineno-0-1945"></a>        <span class="n">hash_algorithms</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1946" name="__codelineno-0-1946"></a>            <span class="s1">&#39;md5&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">md5</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">MD5</span><span class="p">),</span>
<a id="__codelineno-0-1947" name="__codelineno-0-1947"></a>            <span class="s1">&#39;sha1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">sha1</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">SHA1</span><span class="p">),</span>
<a id="__codelineno-0-1948" name="__codelineno-0-1948"></a>            <span class="s1">&#39;sha224&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">sha224</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">SHA224</span><span class="p">),</span>
<a id="__codelineno-0-1949" name="__codelineno-0-1949"></a>            <span class="s1">&#39;sha256&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">sha256</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">),</span>
<a id="__codelineno-0-1950" name="__codelineno-0-1950"></a>            <span class="s1">&#39;sha384&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">sha384</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">SHA384</span><span class="p">),</span>
<a id="__codelineno-0-1951" name="__codelineno-0-1951"></a>            <span class="s1">&#39;sha512&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">sha512</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">SHA512</span><span class="p">),</span>
<a id="__codelineno-0-1952" name="__codelineno-0-1952"></a>        <span class="p">}</span>
<a id="__codelineno-0-1953" name="__codelineno-0-1953"></a>        <span class="k">if</span> <span class="n">digest_algorithm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hash_algorithms</span><span class="p">:</span>
<a id="__codelineno-0-1954" name="__codelineno-0-1954"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported hash algorithm: </span><span class="si">{</span><span class="n">digest_algorithm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1955" name="__codelineno-0-1955"></a>        <span class="k">return</span> <span class="n">hash_algorithms</span><span class="p">[</span><span class="n">digest_algorithm</span><span class="p">]</span>
<a id="__codelineno-0-1956" name="__codelineno-0-1956"></a>
<a id="__codelineno-0-1957" name="__codelineno-0-1957"></a>    <span class="k">def</span> <span class="nf">find_certificate</span><span class="p">(</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1959" name="__codelineno-0-1959"></a>        <span class="n">signed_data_certificates</span><span class="p">:</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">CertificateSet</span><span class="p">,</span>
<a id="__codelineno-0-1960" name="__codelineno-0-1960"></a>        <span class="n">signer_info</span><span class="p">:</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">SignerInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-1961" name="__codelineno-0-1961"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1962" name="__codelineno-0-1962"></a><span class="sd">        From the bag of certs, obtain the certificate referenced by the `asn1crypto.cms.SignerInfo`.</span>
<a id="__codelineno-0-1963" name="__codelineno-0-1963"></a>
<a id="__codelineno-0-1964" name="__codelineno-0-1964"></a><span class="sd">        :param signed_data_certificates: List of certificates in the SignedData.</span>
<a id="__codelineno-0-1965" name="__codelineno-0-1965"></a><span class="sd">        :param signer_info: `SignerInfo` object containing the issuer and serial number reference.</span>
<a id="__codelineno-0-1966" name="__codelineno-0-1966"></a>
<a id="__codelineno-0-1967" name="__codelineno-0-1967"></a><span class="sd">        :returns: The matching certificate if found, otherwise None.</span>
<a id="__codelineno-0-1968" name="__codelineno-0-1968"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1969" name="__codelineno-0-1969"></a>        <span class="n">matching_certificate</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1970" name="__codelineno-0-1970"></a>        <span class="n">issuer_and_serial_number</span> <span class="o">=</span> <span class="n">signer_info</span><span class="p">[</span><span class="s1">&#39;sid&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1971" name="__codelineno-0-1971"></a>        <span class="n">issuer_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canonical_name</span><span class="p">(</span>
<a id="__codelineno-0-1972" name="__codelineno-0-1972"></a>            <span class="n">issuer_and_serial_number</span><span class="o">.</span><span class="n">chosen</span><span class="p">[</span><span class="s1">&#39;issuer&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1973" name="__codelineno-0-1973"></a>        <span class="p">)</span>
<a id="__codelineno-0-1974" name="__codelineno-0-1974"></a>        <span class="n">serial_number</span> <span class="o">=</span> <span class="n">issuer_and_serial_number</span><span class="o">.</span><span class="n">native</span><span class="p">[</span><span class="s1">&#39;serial_number&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1975" name="__codelineno-0-1975"></a>
<a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>        <span class="c1"># # Create a x509.Name object for the issuer in the SignerInfo</span>
<a id="__codelineno-0-1977" name="__codelineno-0-1977"></a>        <span class="c1"># issuer_name = x509.Name.build(issuer)</span>
<a id="__codelineno-0-1978" name="__codelineno-0-1978"></a>        <span class="c1"># issuer_str = self.canonical_name(issuer_name)</span>
<a id="__codelineno-0-1979" name="__codelineno-0-1979"></a>
<a id="__codelineno-0-1980" name="__codelineno-0-1980"></a>        <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">signed_data_certificates</span><span class="p">:</span>
<a id="__codelineno-0-1981" name="__codelineno-0-1981"></a>            <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;certificate&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1982" name="__codelineno-0-1982"></a>                <span class="n">cert_issuer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canonical_name</span><span class="p">(</span>
<a id="__codelineno-0-1983" name="__codelineno-0-1983"></a>                    <span class="n">cert</span><span class="o">.</span><span class="n">chosen</span><span class="p">[</span><span class="s1">&#39;tbs_certificate&#39;</span><span class="p">][</span><span class="s1">&#39;issuer&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1984" name="__codelineno-0-1984"></a>                <span class="p">)</span>
<a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>                <span class="n">cert_serial_number</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">native</span><span class="p">[</span><span class="s1">&#39;tbs_certificate&#39;</span><span class="p">][</span>
<a id="__codelineno-0-1986" name="__codelineno-0-1986"></a>                    <span class="s1">&#39;serial_number&#39;</span>
<a id="__codelineno-0-1987" name="__codelineno-0-1987"></a>                <span class="p">]</span>
<a id="__codelineno-0-1988" name="__codelineno-0-1988"></a>
<a id="__codelineno-0-1989" name="__codelineno-0-1989"></a>                <span class="c1"># Compare the canonical string representations of the issuers and the serial numbers</span>
<a id="__codelineno-0-1990" name="__codelineno-0-1990"></a>                <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1991" name="__codelineno-0-1991"></a>                    <span class="n">cert_issuer</span> <span class="o">==</span> <span class="n">issuer_str</span>
<a id="__codelineno-0-1992" name="__codelineno-0-1992"></a>                    <span class="ow">and</span> <span class="n">cert_serial_number</span> <span class="o">==</span> <span class="n">serial_number</span>
<a id="__codelineno-0-1993" name="__codelineno-0-1993"></a>                <span class="p">):</span>
<a id="__codelineno-0-1994" name="__codelineno-0-1994"></a>                    <span class="n">matching_certificate</span> <span class="o">=</span> <span class="n">cert</span>
<a id="__codelineno-0-1995" name="__codelineno-0-1995"></a>                    <span class="k">break</span>
<a id="__codelineno-0-1996" name="__codelineno-0-1996"></a>
<a id="__codelineno-0-1997" name="__codelineno-0-1997"></a>        <span class="k">return</span> <span class="n">matching_certificate</span>
<a id="__codelineno-0-1998" name="__codelineno-0-1998"></a>
<a id="__codelineno-0-1999" name="__codelineno-0-1999"></a>    <span class="k">def</span> <span class="nf">get_certificate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-2000" name="__codelineno-0-2000"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2001" name="__codelineno-0-2001"></a><span class="sd">        Return a X.509 certificate object by giving the name in the apk file</span>
<a id="__codelineno-0-2002" name="__codelineno-0-2002"></a>
<a id="__codelineno-0-2003" name="__codelineno-0-2003"></a><span class="sd">        :param filename: filename of the signature file in the APK</span>
<a id="__codelineno-0-2004" name="__codelineno-0-2004"></a><span class="sd">        :returns: the certificate object</span>
<a id="__codelineno-0-2005" name="__codelineno-0-2005"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2006" name="__codelineno-0-2006"></a>        <span class="n">cert</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificate_der</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-2007" name="__codelineno-0-2007"></a>        <span class="k">if</span> <span class="n">cert</span><span class="p">:</span>
<a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>            <span class="n">certificate</span> <span class="o">=</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2009" name="__codelineno-0-2009"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2010" name="__codelineno-0-2010"></a>            <span class="n">certificate</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2011" name="__codelineno-0-2011"></a>        <span class="k">return</span> <span class="n">certificate</span>
<a id="__codelineno-0-2012" name="__codelineno-0-2012"></a>
<a id="__codelineno-0-2013" name="__codelineno-0-2013"></a>    <span class="k">def</span> <span class="nf">canonical_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">android</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-2014" name="__codelineno-0-2014"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2015" name="__codelineno-0-2015"></a><span class="sd">        ```</span>
<a id="__codelineno-0-2016" name="__codelineno-0-2016"></a><span class="sd">         * Method is dual-licensed under the Apache License 2.0 and GPLv3+.</span>
<a id="__codelineno-0-2017" name="__codelineno-0-2017"></a><span class="sd">         * The original author has granted permission to use this code snippet under the</span>
<a id="__codelineno-0-2018" name="__codelineno-0-2018"></a><span class="sd">         * Apache License 2.0 for inclusion in this project.</span>
<a id="__codelineno-0-2019" name="__codelineno-0-2019"></a><span class="sd">         * https://github.com/obfusk/x509_canonical_name.py/blob/master/x509_canonical_name.py</span>
<a id="__codelineno-0-2020" name="__codelineno-0-2020"></a><span class="sd">        ```</span>
<a id="__codelineno-0-2021" name="__codelineno-0-2021"></a>
<a id="__codelineno-0-2022" name="__codelineno-0-2022"></a><span class="sd">        Returns canonical representation of `asn1crypto.x509.Name` as str (with raw control characters</span>
<a id="__codelineno-0-2023" name="__codelineno-0-2023"></a><span class="sd">        in places those are not stripped by normalisation).</span>
<a id="__codelineno-0-2024" name="__codelineno-0-2024"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2025" name="__codelineno-0-2025"></a>        <span class="c1"># return &quot;,&quot;.join(&quot;+&quot;.join(f&quot;{t}:{v}&quot; for _, t, v in avas) for avas in self.comparison_name(name))</span>
<a id="__codelineno-0-2026" name="__codelineno-0-2026"></a>        <span class="k">return</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-2027" name="__codelineno-0-2027"></a>            <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">avas</span><span class="p">)</span>
<a id="__codelineno-0-2028" name="__codelineno-0-2028"></a>            <span class="k">for</span> <span class="n">avas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparison_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">android</span><span class="o">=</span><span class="n">android</span><span class="p">)</span>
<a id="__codelineno-0-2029" name="__codelineno-0-2029"></a>        <span class="p">)</span>
<a id="__codelineno-0-2030" name="__codelineno-0-2030"></a>
<a id="__codelineno-0-2031" name="__codelineno-0-2031"></a>    <span class="k">def</span> <span class="nf">comparison_name</span><span class="p">(</span>
<a id="__codelineno-0-2032" name="__codelineno-0-2032"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">x509</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">android</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2033" name="__codelineno-0-2033"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
<a id="__codelineno-0-2034" name="__codelineno-0-2034"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2035" name="__codelineno-0-2035"></a><span class="sd">        ```</span>
<a id="__codelineno-0-2036" name="__codelineno-0-2036"></a><span class="sd">         * Method is dual-licensed under the Apache License 2.0 and GPLv3+.</span>
<a id="__codelineno-0-2037" name="__codelineno-0-2037"></a><span class="sd">         * The original author has granted permission to use this code snippet under the</span>
<a id="__codelineno-0-2038" name="__codelineno-0-2038"></a><span class="sd">         * Apache License 2.0 for inclusion in this project.</span>
<a id="__codelineno-0-2039" name="__codelineno-0-2039"></a><span class="sd">         * https://github.com/obfusk/x509_canonical_name.py/blob/master/x509_canonical_name.py</span>
<a id="__codelineno-0-2040" name="__codelineno-0-2040"></a><span class="sd">        ```</span>
<a id="__codelineno-0-2041" name="__codelineno-0-2041"></a>
<a id="__codelineno-0-2042" name="__codelineno-0-2042"></a><span class="sd">        Canonical representation of x509.Name as nested list.</span>
<a id="__codelineno-0-2043" name="__codelineno-0-2043"></a>
<a id="__codelineno-0-2044" name="__codelineno-0-2044"></a><span class="sd">        Returns a list of RDNs which are a list of AVAs which are a (type, value)</span>
<a id="__codelineno-0-2045" name="__codelineno-0-2045"></a><span class="sd">        tuple, where type is the standard name or dotted OID, and value is the</span>
<a id="__codelineno-0-2046" name="__codelineno-0-2046"></a><span class="sd">        normalised string representation of the value.</span>
<a id="__codelineno-0-2047" name="__codelineno-0-2047"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2048" name="__codelineno-0-2048"></a>
<a id="__codelineno-0-2049" name="__codelineno-0-2049"></a>        <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-2050" name="__codelineno-0-2050"></a>            <span class="p">[(</span><span class="n">t</span><span class="p">,</span> <span class="n">nv</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">nv</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">avas</span><span class="p">]</span>
<a id="__codelineno-0-2051" name="__codelineno-0-2051"></a>            <span class="k">for</span> <span class="n">avas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">x509_ordered_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">android</span><span class="o">=</span><span class="n">android</span><span class="p">)</span>
<a id="__codelineno-0-2052" name="__codelineno-0-2052"></a>        <span class="p">]</span>
<a id="__codelineno-0-2053" name="__codelineno-0-2053"></a>
<a id="__codelineno-0-2054" name="__codelineno-0-2054"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-2055" name="__codelineno-0-2055"></a>    <span class="k">def</span> <span class="nf">x509_ordered_name</span><span class="p">(</span>
<a id="__codelineno-0-2056" name="__codelineno-0-2056"></a>        <span class="n">name</span><span class="p">:</span> <span class="n">x509</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span>
<a id="__codelineno-0-2057" name="__codelineno-0-2057"></a>        <span class="o">*</span><span class="p">,</span>  <span class="c1"># type: ignore[no-any-unimported]</span>
<a id="__codelineno-0-2058" name="__codelineno-0-2058"></a>        <span class="n">android</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2059" name="__codelineno-0-2059"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
<a id="__codelineno-0-2060" name="__codelineno-0-2060"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2061" name="__codelineno-0-2061"></a><span class="sd">        ```</span>
<a id="__codelineno-0-2062" name="__codelineno-0-2062"></a><span class="sd">         * Method is dual-licensed under the Apache License 2.0 and GPLv3+.</span>
<a id="__codelineno-0-2063" name="__codelineno-0-2063"></a><span class="sd">         * The original author has granted permission to use this code snippet under the</span>
<a id="__codelineno-0-2064" name="__codelineno-0-2064"></a><span class="sd">         * Apache License 2.0 for inclusion in this project.</span>
<a id="__codelineno-0-2065" name="__codelineno-0-2065"></a><span class="sd">         * https://github.com/obfusk/x509_canonical_name.py/blob/master/x509_canonical_name.py</span>
<a id="__codelineno-0-2066" name="__codelineno-0-2066"></a><span class="sd">        ```</span>
<a id="__codelineno-0-2067" name="__codelineno-0-2067"></a>
<a id="__codelineno-0-2068" name="__codelineno-0-2068"></a><span class="sd">        Representation of `x509.Name` as nested list, in canonical ordering (but also</span>
<a id="__codelineno-0-2069" name="__codelineno-0-2069"></a><span class="sd">        including non-canonical pre-normalised string values).</span>
<a id="__codelineno-0-2070" name="__codelineno-0-2070"></a>
<a id="__codelineno-0-2071" name="__codelineno-0-2071"></a><span class="sd">        Returns a list of RDNs which are a list of AVAs which are a (oid, type,</span>
<a id="__codelineno-0-2072" name="__codelineno-0-2072"></a><span class="sd">        normalised_value, esc_value) tuple, where oid is 0 for standard names and 1</span>
<a id="__codelineno-0-2073" name="__codelineno-0-2073"></a><span class="sd">        for dotted OIDs, type is the standard name or dotted OID, normalised_value</span>
<a id="__codelineno-0-2074" name="__codelineno-0-2074"></a><span class="sd">        is the normalised string representation of the value, and esc_value is the</span>
<a id="__codelineno-0-2075" name="__codelineno-0-2075"></a><span class="sd">        string value before normalisation (but after escaping).</span>
<a id="__codelineno-0-2076" name="__codelineno-0-2076"></a>
<a id="__codelineno-0-2077" name="__codelineno-0-2077"></a><span class="sd">        NB: control characters are not escaped, only characters in &quot;,+&lt;&gt;;\&quot;\\&quot; and</span>
<a id="__codelineno-0-2078" name="__codelineno-0-2078"></a><span class="sd">        &quot;#&quot; at the start (before &quot;whitespace&quot; trimming) are.</span>
<a id="__codelineno-0-2079" name="__codelineno-0-2079"></a>
<a id="__codelineno-0-2080" name="__codelineno-0-2080"></a><span class="sd">        [X500Principal.getName](https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/security/auth/x500/X500Principal.html#getName(java.lang.String))</span>
<a id="__codelineno-0-2081" name="__codelineno-0-2081"></a><span class="sd">        [AVA.java](https://github.com/openjdk/jdk/blob/jdk-21%2B35/src/java.base/share/classes/sun/security/x509/AVA.java#L805)</span>
<a id="__codelineno-0-2082" name="__codelineno-0-2082"></a><span class="sd">        [RDN.java (472)](https://github.com/openjdk/jdk/blob/jdk-21%2B35/src/java.base/share/classes/sun/security/x509/RDN.java#L472)</span>
<a id="__codelineno-0-2083" name="__codelineno-0-2083"></a><span class="sd">        [RDN.java (481)](https://android.googlesource.com/platform/libcore/+/refs/heads/android14-release/ojluni/src/main/java/sun/security/x509/RDN.java#481)</span>
<a id="__codelineno-0-2084" name="__codelineno-0-2084"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2085" name="__codelineno-0-2085"></a>
<a id="__codelineno-0-2086" name="__codelineno-0-2086"></a>        <span class="k">def</span> <span class="nf">key</span><span class="p">(</span>
<a id="__codelineno-0-2087" name="__codelineno-0-2087"></a>            <span class="n">ava</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-0-2088" name="__codelineno-0-2088"></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2089" name="__codelineno-0-2089"></a>            <span class="n">o</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">nv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ava</span>
<a id="__codelineno-0-2090" name="__codelineno-0-2090"></a>            <span class="k">if</span> <span class="n">android</span> <span class="ow">and</span> <span class="n">o</span><span class="p">:</span>
<a id="__codelineno-0-2091" name="__codelineno-0-2091"></a>                <span class="k">return</span> <span class="n">o</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)],</span> <span class="n">nv</span>
<a id="__codelineno-0-2092" name="__codelineno-0-2092"></a>            <span class="k">return</span> <span class="n">o</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">nv</span>
<a id="__codelineno-0-2093" name="__codelineno-0-2093"></a>
<a id="__codelineno-0-2094" name="__codelineno-0-2094"></a>        <span class="n">DS</span><span class="p">,</span> <span class="n">U8</span><span class="p">,</span> <span class="n">PS</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2095" name="__codelineno-0-2095"></a>            <span class="n">x509</span><span class="o">.</span><span class="n">DirectoryString</span><span class="p">,</span>
<a id="__codelineno-0-2096" name="__codelineno-0-2096"></a>            <span class="n">x509</span><span class="o">.</span><span class="n">UTF8String</span><span class="p">,</span>
<a id="__codelineno-0-2097" name="__codelineno-0-2097"></a>            <span class="n">x509</span><span class="o">.</span><span class="n">PrintableString</span><span class="p">,</span>
<a id="__codelineno-0-2098" name="__codelineno-0-2098"></a>        <span class="p">)</span>
<a id="__codelineno-0-2099" name="__codelineno-0-2099"></a>        <span class="n">oids</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-2100" name="__codelineno-0-2100"></a>            <span class="s2">&quot;2.5.4.3&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;common_name&quot;</span><span class="p">,</span> <span class="s2">&quot;cn&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2101" name="__codelineno-0-2101"></a>            <span class="s2">&quot;2.5.4.6&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;country_name&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2102" name="__codelineno-0-2102"></a>            <span class="s2">&quot;2.5.4.7&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;locality_name&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2103" name="__codelineno-0-2103"></a>            <span class="s2">&quot;2.5.4.8&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;state_or_province_name&quot;</span><span class="p">,</span> <span class="s2">&quot;st&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2104" name="__codelineno-0-2104"></a>            <span class="s2">&quot;2.5.4.9&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;street_address&quot;</span><span class="p">,</span> <span class="s2">&quot;street&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2105" name="__codelineno-0-2105"></a>            <span class="s2">&quot;2.5.4.10&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;organization_name&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2106" name="__codelineno-0-2106"></a>            <span class="s2">&quot;2.5.4.11&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;organizational_unit_name&quot;</span><span class="p">,</span> <span class="s2">&quot;ou&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2107" name="__codelineno-0-2107"></a>            <span class="s2">&quot;0.9.2342.19200300.100.1.1&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="s2">&quot;uid&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2108" name="__codelineno-0-2108"></a>            <span class="s2">&quot;0.9.2342.19200300.100.1.25&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;domain_component&quot;</span><span class="p">,</span> <span class="s2">&quot;dc&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2109" name="__codelineno-0-2109"></a>        <span class="p">}</span>
<a id="__codelineno-0-2110" name="__codelineno-0-2110"></a>        <span class="n">esc</span> <span class="o">=</span> <span class="p">{</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">):</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="s2">&quot;,+&lt;&gt;;</span><span class="se">\&quot;\\</span><span class="s2">&quot;</span><span class="p">}</span>
<a id="__codelineno-0-2111" name="__codelineno-0-2111"></a>        <span class="n">cws</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-2112" name="__codelineno-0-2112"></a>            <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-2113" name="__codelineno-0-2113"></a>        <span class="p">)</span>  <span class="c1"># control (but not esc) and whitespace</span>
<a id="__codelineno-0-2114" name="__codelineno-0-2114"></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2115" name="__codelineno-0-2115"></a>        <span class="k">for</span> <span class="n">rdn</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">chosen</span><span class="p">):</span>
<a id="__codelineno-0-2116" name="__codelineno-0-2116"></a>            <span class="n">avas</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2117" name="__codelineno-0-2117"></a>            <span class="k">for</span> <span class="n">ava</span> <span class="ow">in</span> <span class="n">rdn</span><span class="p">:</span>
<a id="__codelineno-0-2118" name="__codelineno-0-2118"></a>                <span class="n">at</span><span class="p">,</span> <span class="n">av</span> <span class="o">=</span> <span class="n">ava</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="n">ava</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2119" name="__codelineno-0-2119"></a>                <span class="k">if</span> <span class="n">at</span><span class="o">.</span><span class="n">dotted</span> <span class="ow">in</span> <span class="n">oids</span><span class="p">:</span>
<a id="__codelineno-0-2120" name="__codelineno-0-2120"></a>                    <span class="n">o</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oids</span><span class="p">[</span><span class="n">at</span><span class="o">.</span><span class="n">dotted</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># order standard before OID</span>
<a id="__codelineno-0-2121" name="__codelineno-0-2121"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2122" name="__codelineno-0-2122"></a>                    <span class="n">o</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">at</span><span class="o">.</span><span class="n">dotted</span>
<a id="__codelineno-0-2123" name="__codelineno-0-2123"></a>                <span class="k">if</span> <span class="n">o</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span>
<a id="__codelineno-0-2124" name="__codelineno-0-2124"></a>                    <span class="nb">isinstance</span><span class="p">(</span><span class="n">av</span><span class="p">,</span> <span class="n">DS</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">av</span><span class="o">.</span><span class="n">chosen</span><span class="p">,</span> <span class="p">(</span><span class="n">U8</span><span class="p">,</span> <span class="n">PS</span><span class="p">))</span>
<a id="__codelineno-0-2125" name="__codelineno-0-2125"></a>                <span class="p">):</span>
<a id="__codelineno-0-2126" name="__codelineno-0-2126"></a>                    <span class="n">ev</span> <span class="o">=</span> <span class="n">nv</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span><span class="n">av</span><span class="o">.</span><span class="n">dump</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
<a id="__codelineno-0-2127" name="__codelineno-0-2127"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2128" name="__codelineno-0-2128"></a>                    <span class="n">ev</span> <span class="o">=</span> <span class="p">(</span><span class="n">av</span><span class="o">.</span><span class="n">native</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">esc</span><span class="p">)</span>
<a id="__codelineno-0-2129" name="__codelineno-0-2129"></a>                    <span class="k">if</span> <span class="n">ev</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
<a id="__codelineno-0-2130" name="__codelineno-0-2130"></a>                        <span class="n">ev</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">ev</span>
<a id="__codelineno-0-2131" name="__codelineno-0-2131"></a>                    <span class="n">nv</span> <span class="o">=</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span>
<a id="__codelineno-0-2132" name="__codelineno-0-2132"></a>                        <span class="s2">&quot;NFKD&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2133" name="__codelineno-0-2133"></a>                        <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot; +&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">ev</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">cws</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
<a id="__codelineno-0-2134" name="__codelineno-0-2134"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2135" name="__codelineno-0-2135"></a>                <span class="n">avas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">o</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">nv</span><span class="p">,</span> <span class="n">ev</span><span class="p">))</span>
<a id="__codelineno-0-2136" name="__codelineno-0-2136"></a>            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">avas</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">))</span>
<a id="__codelineno-0-2137" name="__codelineno-0-2137"></a>        <span class="k">return</span> <span class="n">data</span>
<a id="__codelineno-0-2138" name="__codelineno-0-2138"></a>
<a id="__codelineno-0-2139" name="__codelineno-0-2139"></a>    <span class="k">def</span> <span class="nf">new_zip</span><span class="p">(</span>
<a id="__codelineno-0-2140" name="__codelineno-0-2140"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2141" name="__codelineno-0-2141"></a>        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-2142" name="__codelineno-0-2142"></a>        <span class="n">deleted_files</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2143" name="__codelineno-0-2143"></a>        <span class="n">new_files</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-2144" name="__codelineno-0-2144"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2145" name="__codelineno-0-2145"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2146" name="__codelineno-0-2146"></a><span class="sd">        Create a new zip file</span>
<a id="__codelineno-0-2147" name="__codelineno-0-2147"></a>
<a id="__codelineno-0-2148" name="__codelineno-0-2148"></a><span class="sd">        :param filename: the output filename of the zip</span>
<a id="__codelineno-0-2149" name="__codelineno-0-2149"></a><span class="sd">        :param deleted_files: a regex pattern to remove specific file, or `None`</span>
<a id="__codelineno-0-2150" name="__codelineno-0-2150"></a><span class="sd">        :param new_files: a dictionnary of new files (key:filename, value:content of the file)</span>
<a id="__codelineno-0-2151" name="__codelineno-0-2151"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2152" name="__codelineno-0-2152"></a>        <span class="n">zout</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2153" name="__codelineno-0-2153"></a>
<a id="__codelineno-0-2154" name="__codelineno-0-2154"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">infolist</span><span class="p">():</span>
<a id="__codelineno-0-2155" name="__codelineno-0-2155"></a>            <span class="c1"># Block one: deleted_files, or deleted_files and new_files</span>
<a id="__codelineno-0-2156" name="__codelineno-0-2156"></a>            <span class="k">if</span> <span class="n">deleted_files</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2157" name="__codelineno-0-2157"></a>                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">deleted_files</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2158" name="__codelineno-0-2158"></a>                    <span class="c1"># if the regex of deleted_files doesn&#39;t match the filename</span>
<a id="__codelineno-0-2159" name="__codelineno-0-2159"></a>                    <span class="k">if</span> <span class="n">new_files</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-2160" name="__codelineno-0-2160"></a>                        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">new_files</span><span class="p">:</span>
<a id="__codelineno-0-2161" name="__codelineno-0-2161"></a>                            <span class="c1"># and if the filename is in new_files</span>
<a id="__codelineno-0-2162" name="__codelineno-0-2162"></a>                            <span class="n">zout</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">new_files</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
<a id="__codelineno-0-2163" name="__codelineno-0-2163"></a>                            <span class="k">continue</span>
<a id="__codelineno-0-2164" name="__codelineno-0-2164"></a>                    <span class="c1"># Otherwise, write the original file.</span>
<a id="__codelineno-0-2165" name="__codelineno-0-2165"></a>                    <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<a id="__codelineno-0-2166" name="__codelineno-0-2166"></a>                    <span class="n">zout</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<a id="__codelineno-0-2167" name="__codelineno-0-2167"></a>            <span class="c1"># Block two: deleted_files is None, new_files is not empty</span>
<a id="__codelineno-0-2168" name="__codelineno-0-2168"></a>            <span class="k">elif</span> <span class="n">new_files</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a>                <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">new_files</span><span class="p">:</span>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a>                    <span class="n">zout</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">new_files</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a>                    <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a>                    <span class="n">zout</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a>            <span class="c1"># Block three: deleted_files is None, new_files is empty.</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a>            <span class="c1"># Just write out the default zip</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a>                <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a>                <span class="n">zout</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a>        <span class="n">zout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-2180" name="__codelineno-0-2180"></a>
<a id="__codelineno-0-2181" name="__codelineno-0-2181"></a>    <span class="k">def</span> <span class="nf">get_android_manifest_axml</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">AXMLPrinter</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-2182" name="__codelineno-0-2182"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2183" name="__codelineno-0-2183"></a><span class="sd">        Return the [AXMLPrinter][androguard.core.axml.AXMLPrinter] object which corresponds to the `AndroidManifest.xml` file</span>
<a id="__codelineno-0-2184" name="__codelineno-0-2184"></a>
<a id="__codelineno-0-2185" name="__codelineno-0-2185"></a><span class="sd">        :returns: the `AXMLPrinter` object</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2187" name="__codelineno-0-2187"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="p">[</span><span class="s2">&quot;AndroidManifest.xml&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2189" name="__codelineno-0-2189"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2190" name="__codelineno-0-2190"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-2191" name="__codelineno-0-2191"></a>
<a id="__codelineno-0-2192" name="__codelineno-0-2192"></a>    <span class="k">def</span> <span class="nf">get_android_manifest_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2194" name="__codelineno-0-2194"></a><span class="sd">        Return the parsed xml object which corresponds to the `AndroidManifest.xml` file</span>
<a id="__codelineno-0-2195" name="__codelineno-0-2195"></a>
<a id="__codelineno-0-2196" name="__codelineno-0-2196"></a><span class="sd">        :returns: the parsed xml object</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2199" name="__codelineno-0-2199"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="s2">&quot;AndroidManifest.xml&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2201" name="__codelineno-0-2201"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-2202" name="__codelineno-0-2202"></a>
<a id="__codelineno-0-2203" name="__codelineno-0-2203"></a>    <span class="k">def</span> <span class="nf">get_android_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">ARSCParser</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-2204" name="__codelineno-0-2204"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2205" name="__codelineno-0-2205"></a><span class="sd">        Return the [ARSCParser][androguard.core.axml.ARSCParser] object which corresponds to the `resources.arsc` file</span>
<a id="__codelineno-0-2206" name="__codelineno-0-2206"></a>
<a id="__codelineno-0-2207" name="__codelineno-0-2207"></a><span class="sd">        :returns: the `ARSCParser` object</span>
<a id="__codelineno-0-2208" name="__codelineno-0-2208"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2209" name="__codelineno-0-2209"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2210" name="__codelineno-0-2210"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">arsc</span><span class="p">[</span><span class="s2">&quot;resources.arsc&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2211" name="__codelineno-0-2211"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2212" name="__codelineno-0-2212"></a>            <span class="k">if</span> <span class="s2">&quot;resources.arsc&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">namelist</span><span class="p">():</span>
<a id="__codelineno-0-2213" name="__codelineno-0-2213"></a>                <span class="c1"># There is a rare case, that no resource file is supplied.</span>
<a id="__codelineno-0-2214" name="__codelineno-0-2214"></a>                <span class="c1"># Maybe it was added manually, thus we check here</span>
<a id="__codelineno-0-2215" name="__codelineno-0-2215"></a>                <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-2216" name="__codelineno-0-2216"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">arsc</span><span class="p">[</span><span class="s2">&quot;resources.arsc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ARSCParser</span><span class="p">(</span>
<a id="__codelineno-0-2217" name="__codelineno-0-2217"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;resources.arsc&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2218" name="__codelineno-0-2218"></a>            <span class="p">)</span>
<a id="__codelineno-0-2219" name="__codelineno-0-2219"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">arsc</span><span class="p">[</span><span class="s2">&quot;resources.arsc&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2220" name="__codelineno-0-2220"></a>
<a id="__codelineno-0-2221" name="__codelineno-0-2221"></a>    <span class="k">def</span> <span class="nf">is_signed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2223" name="__codelineno-0-2223"></a><span class="sd">        Returns true if any of v1, v2, or v3 signatures were found.</span>
<a id="__codelineno-0-2224" name="__codelineno-0-2224"></a>
<a id="__codelineno-0-2225" name="__codelineno-0-2225"></a><span class="sd">        :returns: True if any of v1, v2, or v3 signatures were found, else False</span>
<a id="__codelineno-0-2226" name="__codelineno-0-2226"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2227" name="__codelineno-0-2227"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-2228" name="__codelineno-0-2228"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_signed_v1</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_signed_v2</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_signed_v3</span><span class="p">()</span>
<a id="__codelineno-0-2229" name="__codelineno-0-2229"></a>        <span class="p">)</span>
<a id="__codelineno-0-2230" name="__codelineno-0-2230"></a>
<a id="__codelineno-0-2231" name="__codelineno-0-2231"></a>    <span class="k">def</span> <span class="nf">is_signed_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-2232" name="__codelineno-0-2232"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2233" name="__codelineno-0-2233"></a><span class="sd">        Returns `True` if a v1 / JAR signature was found.</span>
<a id="__codelineno-0-2234" name="__codelineno-0-2234"></a>
<a id="__codelineno-0-2235" name="__codelineno-0-2235"></a><span class="sd">        Returning `True` does not mean that the file is properly signed!</span>
<a id="__codelineno-0-2236" name="__codelineno-0-2236"></a><span class="sd">        It just says that there is a signature file which needs to be validated.</span>
<a id="__codelineno-0-2237" name="__codelineno-0-2237"></a>
<a id="__codelineno-0-2238" name="__codelineno-0-2238"></a><span class="sd">        :returns: `True` if a v1 / JAR signature was found, else `False`</span>
<a id="__codelineno-0-2239" name="__codelineno-0-2239"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2240" name="__codelineno-0-2240"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signature_name</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-2241" name="__codelineno-0-2241"></a>
<a id="__codelineno-0-2242" name="__codelineno-0-2242"></a>    <span class="k">def</span> <span class="nf">is_signed_v2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-2243" name="__codelineno-0-2243"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2244" name="__codelineno-0-2244"></a><span class="sd">        Returns `True` of a v2 / APK signature was found.</span>
<a id="__codelineno-0-2245" name="__codelineno-0-2245"></a>
<a id="__codelineno-0-2246" name="__codelineno-0-2246"></a><span class="sd">        Returning `True` does not mean that the file is properly signed!</span>
<a id="__codelineno-0-2247" name="__codelineno-0-2247"></a><span class="sd">        It just says that there is a signature file which needs to be validated.</span>
<a id="__codelineno-0-2248" name="__codelineno-0-2248"></a>
<a id="__codelineno-0-2249" name="__codelineno-0-2249"></a><span class="sd">        :returns: `True` of a v2 / APK signature was found, else `False`</span>
<a id="__codelineno-0-2250" name="__codelineno-0-2250"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2251" name="__codelineno-0-2251"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2252" name="__codelineno-0-2252"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse_v2_v3_signature</span><span class="p">()</span>
<a id="__codelineno-0-2253" name="__codelineno-0-2253"></a>
<a id="__codelineno-0-2254" name="__codelineno-0-2254"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v2</span>
<a id="__codelineno-0-2255" name="__codelineno-0-2255"></a>
<a id="__codelineno-0-2256" name="__codelineno-0-2256"></a>    <span class="k">def</span> <span class="nf">is_signed_v3</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-2257" name="__codelineno-0-2257"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2258" name="__codelineno-0-2258"></a><span class="sd">        Returns `True` of a v3 / APK signature was found.</span>
<a id="__codelineno-0-2259" name="__codelineno-0-2259"></a>
<a id="__codelineno-0-2260" name="__codelineno-0-2260"></a><span class="sd">        Returning `True` does not mean that the file is properly signed!</span>
<a id="__codelineno-0-2261" name="__codelineno-0-2261"></a><span class="sd">        It just says that there is a signature file which needs to be validated.</span>
<a id="__codelineno-0-2262" name="__codelineno-0-2262"></a>
<a id="__codelineno-0-2263" name="__codelineno-0-2263"></a><span class="sd">        :returns: `True` of a v3 / APK signature was found, else `False`</span>
<a id="__codelineno-0-2264" name="__codelineno-0-2264"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2265" name="__codelineno-0-2265"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v3</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2266" name="__codelineno-0-2266"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse_v2_v3_signature</span><span class="p">()</span>
<a id="__codelineno-0-2267" name="__codelineno-0-2267"></a>
<a id="__codelineno-0-2268" name="__codelineno-0-2268"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v3</span>
<a id="__codelineno-0-2269" name="__codelineno-0-2269"></a>
<a id="__codelineno-0-2270" name="__codelineno-0-2270"></a>    <span class="k">def</span> <span class="nf">read_uint32_le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">io_stream</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-2271" name="__codelineno-0-2271"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;read a `uint32_le` from `io_stream`</span>
<a id="__codelineno-0-2272" name="__codelineno-0-2272"></a>
<a id="__codelineno-0-2273" name="__codelineno-0-2273"></a><span class="sd">        :param io_stream: the stream to get a `uint32_le` from</span>
<a id="__codelineno-0-2274" name="__codelineno-0-2274"></a><span class="sd">        :return: the `uint32_le` value</span>
<a id="__codelineno-0-2275" name="__codelineno-0-2275"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2276" name="__codelineno-0-2276"></a>        <span class="p">(</span><span class="n">value</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">io_stream</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-2277" name="__codelineno-0-2277"></a>        <span class="k">return</span> <span class="n">value</span>
<a id="__codelineno-0-2278" name="__codelineno-0-2278"></a>
<a id="__codelineno-0-2279" name="__codelineno-0-2279"></a>    <span class="k">def</span> <span class="nf">parse_signatures_or_digests</span><span class="p">(</span>
<a id="__codelineno-0-2280" name="__codelineno-0-2280"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">digest_bytes</span><span class="p">:</span> <span class="nb">bytes</span>
<a id="__codelineno-0-2281" name="__codelineno-0-2281"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]:</span>
<a id="__codelineno-0-2282" name="__codelineno-0-2282"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse digests</span>
<a id="__codelineno-0-2283" name="__codelineno-0-2283"></a>
<a id="__codelineno-0-2284" name="__codelineno-0-2284"></a><span class="sd">        :param digest_bytes: the digests bytes</span>
<a id="__codelineno-0-2285" name="__codelineno-0-2285"></a><span class="sd">        :returns: a list of tuple where the first element is the `algorithm_id` and the second is the digest bytes</span>
<a id="__codelineno-0-2286" name="__codelineno-0-2286"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2287" name="__codelineno-0-2287"></a>
<a id="__codelineno-0-2288" name="__codelineno-0-2288"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">digest_bytes</span><span class="p">):</span>
<a id="__codelineno-0-2289" name="__codelineno-0-2289"></a>            <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-2290" name="__codelineno-0-2290"></a>
<a id="__codelineno-0-2291" name="__codelineno-0-2291"></a>        <span class="n">digests</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2292" name="__codelineno-0-2292"></a>        <span class="n">block</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">digest_bytes</span><span class="p">)</span>
<a id="__codelineno-0-2293" name="__codelineno-0-2293"></a>
<a id="__codelineno-0-2294" name="__codelineno-0-2294"></a>        <span class="n">data_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2295" name="__codelineno-0-2295"></a>        <span class="k">while</span> <span class="n">block</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">data_len</span><span class="p">:</span>
<a id="__codelineno-0-2296" name="__codelineno-0-2296"></a>
<a id="__codelineno-0-2297" name="__codelineno-0-2297"></a>            <span class="n">algorithm_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2298" name="__codelineno-0-2298"></a>            <span class="n">digest_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2299" name="__codelineno-0-2299"></a>            <span class="n">digest</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">digest_len</span><span class="p">)</span>
<a id="__codelineno-0-2300" name="__codelineno-0-2300"></a>
<a id="__codelineno-0-2301" name="__codelineno-0-2301"></a>            <span class="n">digests</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">algorithm_id</span><span class="p">,</span> <span class="n">digest</span><span class="p">))</span>
<a id="__codelineno-0-2302" name="__codelineno-0-2302"></a>
<a id="__codelineno-0-2303" name="__codelineno-0-2303"></a>        <span class="k">return</span> <span class="n">digests</span>
<a id="__codelineno-0-2304" name="__codelineno-0-2304"></a>
<a id="__codelineno-0-2305" name="__codelineno-0-2305"></a>    <span class="k">def</span> <span class="nf">parse_v2_v3_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2306" name="__codelineno-0-2306"></a>        <span class="c1"># Need to find an v2 Block in the APK.</span>
<a id="__codelineno-0-2307" name="__codelineno-0-2307"></a>        <span class="c1"># The Google Docs gives you the following rule:</span>
<a id="__codelineno-0-2308" name="__codelineno-0-2308"></a>        <span class="c1"># * go to the end of the ZIP File</span>
<a id="__codelineno-0-2309" name="__codelineno-0-2309"></a>        <span class="c1"># * search for the End of Central directory</span>
<a id="__codelineno-0-2310" name="__codelineno-0-2310"></a>        <span class="c1"># * then jump to the beginning of the central directory</span>
<a id="__codelineno-0-2311" name="__codelineno-0-2311"></a>        <span class="c1"># * Read now the magic of the signing block</span>
<a id="__codelineno-0-2312" name="__codelineno-0-2312"></a>        <span class="c1"># * before the magic there is the size_of_block, so we can jump to</span>
<a id="__codelineno-0-2313" name="__codelineno-0-2313"></a>        <span class="c1"># the beginning.</span>
<a id="__codelineno-0-2314" name="__codelineno-0-2314"></a>        <span class="c1"># * There should be again the size_of_block</span>
<a id="__codelineno-0-2315" name="__codelineno-0-2315"></a>        <span class="c1"># * Now we can read the Key-Values</span>
<a id="__codelineno-0-2316" name="__codelineno-0-2316"></a>        <span class="c1"># * IDs with an unknown value should be ignored.</span>
<a id="__codelineno-0-2317" name="__codelineno-0-2317"></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_raw</span><span class="p">())</span>
<a id="__codelineno-0-2318" name="__codelineno-0-2318"></a>
<a id="__codelineno-0-2319" name="__codelineno-0-2319"></a>        <span class="n">size_central</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2320" name="__codelineno-0-2320"></a>        <span class="n">offset_central</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2321" name="__codelineno-0-2321"></a>
<a id="__codelineno-0-2322" name="__codelineno-0-2322"></a>        <span class="c1"># Go to the end</span>
<a id="__codelineno-0-2323" name="__codelineno-0-2323"></a>        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">SEEK_END</span><span class="p">)</span>
<a id="__codelineno-0-2324" name="__codelineno-0-2324"></a>        <span class="c1"># we know the minimal length for the central dir is 16+4+2</span>
<a id="__codelineno-0-2325" name="__codelineno-0-2325"></a>        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">SEEK_CUR</span><span class="p">)</span>
<a id="__codelineno-0-2326" name="__codelineno-0-2326"></a>
<a id="__codelineno-0-2327" name="__codelineno-0-2327"></a>        <span class="k">while</span> <span class="n">f</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-2328" name="__codelineno-0-2328"></a>            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">SEEK_CUR</span><span class="p">)</span>
<a id="__codelineno-0-2329" name="__codelineno-0-2329"></a>            <span class="p">(</span><span class="n">r</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;4s&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-2330" name="__codelineno-0-2330"></a>            <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PK_END_OF_CENTRAL_DIR</span><span class="p">:</span>
<a id="__codelineno-0-2331" name="__codelineno-0-2331"></a>                <span class="c1"># Read central dir</span>
<a id="__codelineno-0-2332" name="__codelineno-0-2332"></a>                <span class="p">(</span>
<a id="__codelineno-0-2333" name="__codelineno-0-2333"></a>                    <span class="n">this_disk</span><span class="p">,</span>
<a id="__codelineno-0-2334" name="__codelineno-0-2334"></a>                    <span class="n">disk_central</span><span class="p">,</span>
<a id="__codelineno-0-2335" name="__codelineno-0-2335"></a>                    <span class="n">this_entries</span><span class="p">,</span>
<a id="__codelineno-0-2336" name="__codelineno-0-2336"></a>                    <span class="n">total_entries</span><span class="p">,</span>
<a id="__codelineno-0-2337" name="__codelineno-0-2337"></a>                    <span class="n">size_central</span><span class="p">,</span>
<a id="__codelineno-0-2338" name="__codelineno-0-2338"></a>                    <span class="n">offset_central</span><span class="p">,</span>
<a id="__codelineno-0-2339" name="__codelineno-0-2339"></a>                <span class="p">)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;HHHHII&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<a id="__codelineno-0-2340" name="__codelineno-0-2340"></a>                <span class="c1"># TODO according to the standard we need to check if the</span>
<a id="__codelineno-0-2341" name="__codelineno-0-2341"></a>                <span class="c1"># end of central directory is the last item in the zip file</span>
<a id="__codelineno-0-2342" name="__codelineno-0-2342"></a>                <span class="c1"># TODO We also need to check if the central dir is exactly</span>
<a id="__codelineno-0-2343" name="__codelineno-0-2343"></a>                <span class="c1"># before the end of central dir...</span>
<a id="__codelineno-0-2344" name="__codelineno-0-2344"></a>
<a id="__codelineno-0-2345" name="__codelineno-0-2345"></a>                <span class="c1"># These things should not happen for APKs</span>
<a id="__codelineno-0-2346" name="__codelineno-0-2346"></a>                <span class="k">if</span> <span class="n">this_disk</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-2347" name="__codelineno-0-2347"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2348" name="__codelineno-0-2348"></a>                        <span class="s2">&quot;This is a multi disk ZIP! Attempting to process its signature anyway!&quot;</span>
<a id="__codelineno-0-2349" name="__codelineno-0-2349"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2350" name="__codelineno-0-2350"></a>                <span class="k">if</span> <span class="n">disk_central</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-2351" name="__codelineno-0-2351"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2352" name="__codelineno-0-2352"></a>                        <span class="s2">&quot;This is a multi disk ZIP! Attempting to process its signature anyway!&quot;</span>
<a id="__codelineno-0-2353" name="__codelineno-0-2353"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2354" name="__codelineno-0-2354"></a>                <span class="k">break</span>
<a id="__codelineno-0-2355" name="__codelineno-0-2355"></a>            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">SEEK_CUR</span><span class="p">)</span>
<a id="__codelineno-0-2356" name="__codelineno-0-2356"></a>
<a id="__codelineno-0-2357" name="__codelineno-0-2357"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">offset_central</span><span class="p">:</span>
<a id="__codelineno-0-2358" name="__codelineno-0-2358"></a>            <span class="k">return</span>
<a id="__codelineno-0-2359" name="__codelineno-0-2359"></a>
<a id="__codelineno-0-2360" name="__codelineno-0-2360"></a>        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">offset_central</span><span class="p">)</span>
<a id="__codelineno-0-2361" name="__codelineno-0-2361"></a>        <span class="p">(</span><span class="n">r</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;4s&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-2362" name="__codelineno-0-2362"></a>        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">SEEK_CUR</span><span class="p">)</span>
<a id="__codelineno-0-2363" name="__codelineno-0-2363"></a>        <span class="k">if</span> <span class="n">r</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_PK_CENTRAL_DIR</span><span class="p">:</span>
<a id="__codelineno-0-2364" name="__codelineno-0-2364"></a>            <span class="k">raise</span> <span class="n">BrokenAPKError</span><span class="p">(</span><span class="s2">&quot;No Central Dir at specified offset&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2365" name="__codelineno-0-2365"></a>
<a id="__codelineno-0-2366" name="__codelineno-0-2366"></a>        <span class="c1"># Go back and check if we have a magic</span>
<a id="__codelineno-0-2367" name="__codelineno-0-2367"></a>        <span class="n">end_offset</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2368" name="__codelineno-0-2368"></a>        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">SEEK_CUR</span><span class="p">)</span>
<a id="__codelineno-0-2369" name="__codelineno-0-2369"></a>        <span class="n">size_of_block</span><span class="p">,</span> <span class="n">magic</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;Q16s&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span>
<a id="__codelineno-0-2370" name="__codelineno-0-2370"></a>
<a id="__codelineno-0-2371" name="__codelineno-0-2371"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v2</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2372" name="__codelineno-0-2372"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v3</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2373" name="__codelineno-0-2373"></a>
<a id="__codelineno-0-2374" name="__codelineno-0-2374"></a>        <span class="k">if</span> <span class="n">magic</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_APK_SIG_MAGIC</span><span class="p">:</span>
<a id="__codelineno-0-2375" name="__codelineno-0-2375"></a>            <span class="k">return</span>
<a id="__codelineno-0-2376" name="__codelineno-0-2376"></a>
<a id="__codelineno-0-2377" name="__codelineno-0-2377"></a>        <span class="c1"># go back size_of_blocks + 8 and read size_of_block again</span>
<a id="__codelineno-0-2378" name="__codelineno-0-2378"></a>        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">size_of_block</span> <span class="o">+</span> <span class="mi">8</span><span class="p">),</span> <span class="n">io</span><span class="o">.</span><span class="n">SEEK_CUR</span><span class="p">)</span>
<a id="__codelineno-0-2379" name="__codelineno-0-2379"></a>        <span class="p">(</span><span class="n">size_of_block_start</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&lt;Q&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a id="__codelineno-0-2380" name="__codelineno-0-2380"></a>        <span class="k">if</span> <span class="n">size_of_block_start</span> <span class="o">!=</span> <span class="n">size_of_block</span><span class="p">:</span>
<a id="__codelineno-0-2381" name="__codelineno-0-2381"></a>            <span class="k">raise</span> <span class="n">BrokenAPKError</span><span class="p">(</span><span class="s2">&quot;Sizes at beginning and end does not match!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2382" name="__codelineno-0-2382"></a>
<a id="__codelineno-0-2383" name="__codelineno-0-2383"></a>        <span class="c1"># Store all blocks</span>
<a id="__codelineno-0-2384" name="__codelineno-0-2384"></a>        <span class="k">while</span> <span class="n">f</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">end_offset</span> <span class="o">-</span> <span class="mi">24</span><span class="p">:</span>
<a id="__codelineno-0-2385" name="__codelineno-0-2385"></a>            <span class="n">size</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;QI&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<a id="__codelineno-0-2386" name="__codelineno-0-2386"></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-2387" name="__codelineno-0-2387"></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_blocks</span><span class="p">:</span>
<a id="__codelineno-0-2388" name="__codelineno-0-2388"></a>                <span class="c1"># TODO: Store the duplicate V2 Signature blocks and offer a way to show them</span>
<a id="__codelineno-0-2389" name="__codelineno-0-2389"></a>                <span class="c1"># https://github.com/androguard/androguard/issues/1030</span>
<a id="__codelineno-0-2390" name="__codelineno-0-2390"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2391" name="__codelineno-0-2391"></a>                    <span class="s2">&quot;Duplicate block ID in APK Signing Block: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-2392" name="__codelineno-0-2392"></a>                <span class="p">)</span>
<a id="__codelineno-0-2393" name="__codelineno-0-2393"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2394" name="__codelineno-0-2394"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_v2_blocks</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-2395" name="__codelineno-0-2395"></a>
<a id="__codelineno-0-2396" name="__codelineno-0-2396"></a>        <span class="c1"># Test if a signature is found</span>
<a id="__codelineno-0-2397" name="__codelineno-0-2397"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_APK_SIG_KEY_V2_SIGNATURE</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_blocks</span><span class="p">:</span>
<a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v2</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-2399" name="__codelineno-0-2399"></a>
<a id="__codelineno-0-2400" name="__codelineno-0-2400"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_APK_SIG_KEY_V3_SIGNATURE</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_blocks</span><span class="p">:</span>
<a id="__codelineno-0-2401" name="__codelineno-0-2401"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v3</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>
<a id="__codelineno-0-2403" name="__codelineno-0-2403"></a>    <span class="k">def</span> <span class="nf">parse_v3_signing_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2404" name="__codelineno-0-2404"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2405" name="__codelineno-0-2405"></a><span class="sd">        Parse the V2 signing block and extract all features</span>
<a id="__codelineno-0-2406" name="__codelineno-0-2406"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2407" name="__codelineno-0-2407"></a>
<a id="__codelineno-0-2408" name="__codelineno-0-2408"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2409" name="__codelineno-0-2409"></a>
<a id="__codelineno-0-2410" name="__codelineno-0-2410"></a>        <span class="c1"># calling is_signed_v3 should also load the signature, if any</span>
<a id="__codelineno-0-2411" name="__codelineno-0-2411"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_signed_v3</span><span class="p">():</span>
<a id="__codelineno-0-2412" name="__codelineno-0-2412"></a>            <span class="k">return</span>
<a id="__codelineno-0-2413" name="__codelineno-0-2413"></a>
<a id="__codelineno-0-2414" name="__codelineno-0-2414"></a>        <span class="n">block_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_blocks</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_APK_SIG_KEY_V3_SIGNATURE</span><span class="p">]</span>
<a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>        <span class="n">block</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">block_bytes</span><span class="p">)</span>
<a id="__codelineno-0-2416" name="__codelineno-0-2416"></a>        <span class="n">view</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<a id="__codelineno-0-2417" name="__codelineno-0-2417"></a>
<a id="__codelineno-0-2418" name="__codelineno-0-2418"></a>        <span class="c1"># V3 signature Block data format:</span>
<a id="__codelineno-0-2419" name="__codelineno-0-2419"></a>        <span class="c1">#</span>
<a id="__codelineno-0-2420" name="__codelineno-0-2420"></a>        <span class="c1"># * signer:</span>
<a id="__codelineno-0-2421" name="__codelineno-0-2421"></a>        <span class="c1">#    * signed data:</span>
<a id="__codelineno-0-2422" name="__codelineno-0-2422"></a>        <span class="c1">#        * digests:</span>
<a id="__codelineno-0-2423" name="__codelineno-0-2423"></a>        <span class="c1">#            * signature algorithm ID (uint32)</span>
<a id="__codelineno-0-2424" name="__codelineno-0-2424"></a>        <span class="c1">#            * digest (length-prefixed)</span>
<a id="__codelineno-0-2425" name="__codelineno-0-2425"></a>        <span class="c1">#        * certificates</span>
<a id="__codelineno-0-2426" name="__codelineno-0-2426"></a>        <span class="c1">#        * minSDK</span>
<a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>        <span class="c1">#        * maxSDK</span>
<a id="__codelineno-0-2428" name="__codelineno-0-2428"></a>        <span class="c1">#        * additional attributes</span>
<a id="__codelineno-0-2429" name="__codelineno-0-2429"></a>        <span class="c1">#    * minSDK</span>
<a id="__codelineno-0-2430" name="__codelineno-0-2430"></a>        <span class="c1">#    * maxSDK</span>
<a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>        <span class="c1">#    * signatures</span>
<a id="__codelineno-0-2432" name="__codelineno-0-2432"></a>        <span class="c1">#    * publickey</span>
<a id="__codelineno-0-2433" name="__codelineno-0-2433"></a>        <span class="n">size_sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2434" name="__codelineno-0-2434"></a>        <span class="k">if</span> <span class="n">size_sequence</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">block_bytes</span><span class="p">):</span>
<a id="__codelineno-0-2435" name="__codelineno-0-2435"></a>            <span class="k">raise</span> <span class="n">BrokenAPKError</span><span class="p">(</span>
<a id="__codelineno-0-2436" name="__codelineno-0-2436"></a>                <span class="s2">&quot;size of sequence and blocksize does not match&quot;</span>
<a id="__codelineno-0-2437" name="__codelineno-0-2437"></a>            <span class="p">)</span>
<a id="__codelineno-0-2438" name="__codelineno-0-2438"></a>
<a id="__codelineno-0-2439" name="__codelineno-0-2439"></a>        <span class="k">while</span> <span class="n">block</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">block_bytes</span><span class="p">):</span>
<a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>            <span class="n">off_signer</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2441" name="__codelineno-0-2441"></a>            <span class="n">size_signer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>
<a id="__codelineno-0-2443" name="__codelineno-0-2443"></a>            <span class="c1"># read whole signed data, since we might to parse</span>
<a id="__codelineno-0-2444" name="__codelineno-0-2444"></a>            <span class="c1"># content within the signed data, and mess up offset</span>
<a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>            <span class="n">len_signed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2446" name="__codelineno-0-2446"></a>            <span class="n">signed_data_bytes</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2447" name="__codelineno-0-2447"></a>            <span class="n">signed_data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">signed_data_bytes</span><span class="p">)</span>
<a id="__codelineno-0-2448" name="__codelineno-0-2448"></a>
<a id="__codelineno-0-2449" name="__codelineno-0-2449"></a>            <span class="c1"># Digests</span>
<a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>            <span class="n">len_digests</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2451" name="__codelineno-0-2451"></a>            <span class="n">raw_digests</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_digests</span><span class="p">)</span>
<a id="__codelineno-0-2452" name="__codelineno-0-2452"></a>            <span class="n">digests</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_signatures_or_digests</span><span class="p">(</span><span class="n">raw_digests</span><span class="p">)</span>
<a id="__codelineno-0-2453" name="__codelineno-0-2453"></a>
<a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>            <span class="c1"># Certs</span>
<a id="__codelineno-0-2455" name="__codelineno-0-2455"></a>            <span class="n">certs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2456" name="__codelineno-0-2456"></a>            <span class="n">len_certs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2457" name="__codelineno-0-2457"></a>            <span class="n">start_certs</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>            <span class="k">while</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">start_certs</span> <span class="o">+</span> <span class="n">len_certs</span><span class="p">:</span>
<a id="__codelineno-0-2459" name="__codelineno-0-2459"></a>
<a id="__codelineno-0-2460" name="__codelineno-0-2460"></a>                <span class="n">len_cert</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2461" name="__codelineno-0-2461"></a>                <span class="n">cert</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_cert</span><span class="p">)</span>
<a id="__codelineno-0-2462" name="__codelineno-0-2462"></a>                <span class="n">certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2463" name="__codelineno-0-2463"></a>
<a id="__codelineno-0-2464" name="__codelineno-0-2464"></a>            <span class="c1"># versions</span>
<a id="__codelineno-0-2465" name="__codelineno-0-2465"></a>            <span class="n">signed_data_min_sdk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>            <span class="n">signed_data_max_sdk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>
<a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>            <span class="c1"># Addional attributes</span>
<a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>            <span class="n">len_attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>            <span class="n">attr</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_attr</span><span class="p">)</span>
<a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>
<a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>            <span class="n">signed_data_object</span> <span class="o">=</span> <span class="n">APKV3SignedData</span><span class="p">()</span>
<a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>            <span class="n">signed_data_object</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="n">signed_data_bytes</span>
<a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>            <span class="n">signed_data_object</span><span class="o">.</span><span class="n">digests</span> <span class="o">=</span> <span class="n">digests</span>
<a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>            <span class="n">signed_data_object</span><span class="o">.</span><span class="n">certificates</span> <span class="o">=</span> <span class="n">certs</span>
<a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>            <span class="n">signed_data_object</span><span class="o">.</span><span class="n">additional_attributes</span> <span class="o">=</span> <span class="n">attr</span>
<a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>            <span class="n">signed_data_object</span><span class="o">.</span><span class="n">minSDK</span> <span class="o">=</span> <span class="n">signed_data_min_sdk</span>
<a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>            <span class="n">signed_data_object</span><span class="o">.</span><span class="n">maxSDK</span> <span class="o">=</span> <span class="n">signed_data_max_sdk</span>
<a id="__codelineno-0-2479" name="__codelineno-0-2479"></a>
<a id="__codelineno-0-2480" name="__codelineno-0-2480"></a>            <span class="c1"># versions (should be the same as signed data&#39;s versions)</span>
<a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>            <span class="n">signer_min_sdk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>            <span class="n">signer_max_sdk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2483" name="__codelineno-0-2483"></a>
<a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>            <span class="c1"># Signatures</span>
<a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>            <span class="n">len_sigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2486" name="__codelineno-0-2486"></a>            <span class="n">raw_sigs</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_sigs</span><span class="p">)</span>
<a id="__codelineno-0-2487" name="__codelineno-0-2487"></a>            <span class="n">sigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_signatures_or_digests</span><span class="p">(</span><span class="n">raw_sigs</span><span class="p">)</span>
<a id="__codelineno-0-2488" name="__codelineno-0-2488"></a>
<a id="__codelineno-0-2489" name="__codelineno-0-2489"></a>            <span class="c1"># PublicKey</span>
<a id="__codelineno-0-2490" name="__codelineno-0-2490"></a>            <span class="n">len_publickey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2491" name="__codelineno-0-2491"></a>            <span class="n">publickey</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_publickey</span><span class="p">)</span>
<a id="__codelineno-0-2492" name="__codelineno-0-2492"></a>
<a id="__codelineno-0-2493" name="__codelineno-0-2493"></a>            <span class="n">signer</span> <span class="o">=</span> <span class="n">APKV3Signer</span><span class="p">()</span>
<a id="__codelineno-0-2494" name="__codelineno-0-2494"></a>            <span class="n">signer</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="n">view</span><span class="p">[</span><span class="n">off_signer</span> <span class="p">:</span> <span class="n">off_signer</span> <span class="o">+</span> <span class="n">size_signer</span><span class="p">]</span>
<a id="__codelineno-0-2495" name="__codelineno-0-2495"></a>            <span class="n">signer</span><span class="o">.</span><span class="n">signed_data</span> <span class="o">=</span> <span class="n">signed_data_object</span>
<a id="__codelineno-0-2496" name="__codelineno-0-2496"></a>            <span class="n">signer</span><span class="o">.</span><span class="n">signatures</span> <span class="o">=</span> <span class="n">sigs</span>
<a id="__codelineno-0-2497" name="__codelineno-0-2497"></a>            <span class="n">signer</span><span class="o">.</span><span class="n">public_key</span> <span class="o">=</span> <span class="n">publickey</span>
<a id="__codelineno-0-2498" name="__codelineno-0-2498"></a>            <span class="n">signer</span><span class="o">.</span><span class="n">minSDK</span> <span class="o">=</span> <span class="n">signer_min_sdk</span>
<a id="__codelineno-0-2499" name="__codelineno-0-2499"></a>            <span class="n">signer</span><span class="o">.</span><span class="n">maxSDK</span> <span class="o">=</span> <span class="n">signer_max_sdk</span>
<a id="__codelineno-0-2500" name="__codelineno-0-2500"></a>
<a id="__codelineno-0-2501" name="__codelineno-0-2501"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signer</span><span class="p">)</span>
<a id="__codelineno-0-2502" name="__codelineno-0-2502"></a>
<a id="__codelineno-0-2503" name="__codelineno-0-2503"></a>    <span class="k">def</span> <span class="nf">parse_v2_signing_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2504" name="__codelineno-0-2504"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2505" name="__codelineno-0-2505"></a><span class="sd">        Parse the V2 signing block and extract all features</span>
<a id="__codelineno-0-2506" name="__codelineno-0-2506"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2507" name="__codelineno-0-2507"></a>
<a id="__codelineno-0-2508" name="__codelineno-0-2508"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2509" name="__codelineno-0-2509"></a>
<a id="__codelineno-0-2510" name="__codelineno-0-2510"></a>        <span class="c1"># calling is_signed_v2 should also load the signature</span>
<a id="__codelineno-0-2511" name="__codelineno-0-2511"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_signed_v2</span><span class="p">():</span>
<a id="__codelineno-0-2512" name="__codelineno-0-2512"></a>            <span class="k">return</span>
<a id="__codelineno-0-2513" name="__codelineno-0-2513"></a>
<a id="__codelineno-0-2514" name="__codelineno-0-2514"></a>        <span class="n">block_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_blocks</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_APK_SIG_KEY_V2_SIGNATURE</span><span class="p">]</span>
<a id="__codelineno-0-2515" name="__codelineno-0-2515"></a>        <span class="n">block</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">block_bytes</span><span class="p">)</span>
<a id="__codelineno-0-2516" name="__codelineno-0-2516"></a>        <span class="n">view</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<a id="__codelineno-0-2517" name="__codelineno-0-2517"></a>
<a id="__codelineno-0-2518" name="__codelineno-0-2518"></a>        <span class="c1"># V2 signature Block data format:</span>
<a id="__codelineno-0-2519" name="__codelineno-0-2519"></a>        <span class="c1">#</span>
<a id="__codelineno-0-2520" name="__codelineno-0-2520"></a>        <span class="c1"># * signer:</span>
<a id="__codelineno-0-2521" name="__codelineno-0-2521"></a>        <span class="c1">#    * signed data:</span>
<a id="__codelineno-0-2522" name="__codelineno-0-2522"></a>        <span class="c1">#        * digests:</span>
<a id="__codelineno-0-2523" name="__codelineno-0-2523"></a>        <span class="c1">#            * signature algorithm ID (uint32)</span>
<a id="__codelineno-0-2524" name="__codelineno-0-2524"></a>        <span class="c1">#            * digest (length-prefixed)</span>
<a id="__codelineno-0-2525" name="__codelineno-0-2525"></a>        <span class="c1">#        * certificates</span>
<a id="__codelineno-0-2526" name="__codelineno-0-2526"></a>        <span class="c1">#        * additional attributes</span>
<a id="__codelineno-0-2527" name="__codelineno-0-2527"></a>        <span class="c1">#    * signatures</span>
<a id="__codelineno-0-2528" name="__codelineno-0-2528"></a>        <span class="c1">#    * publickey</span>
<a id="__codelineno-0-2529" name="__codelineno-0-2529"></a>
<a id="__codelineno-0-2530" name="__codelineno-0-2530"></a>        <span class="n">size_sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2531" name="__codelineno-0-2531"></a>        <span class="k">if</span> <span class="n">size_sequence</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">block_bytes</span><span class="p">):</span>
<a id="__codelineno-0-2532" name="__codelineno-0-2532"></a>            <span class="k">raise</span> <span class="n">BrokenAPKError</span><span class="p">(</span>
<a id="__codelineno-0-2533" name="__codelineno-0-2533"></a>                <span class="s2">&quot;size of sequence and blocksize does not match&quot;</span>
<a id="__codelineno-0-2534" name="__codelineno-0-2534"></a>            <span class="p">)</span>
<a id="__codelineno-0-2535" name="__codelineno-0-2535"></a>
<a id="__codelineno-0-2536" name="__codelineno-0-2536"></a>        <span class="k">while</span> <span class="n">block</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">block_bytes</span><span class="p">):</span>
<a id="__codelineno-0-2537" name="__codelineno-0-2537"></a>            <span class="n">off_signer</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2538" name="__codelineno-0-2538"></a>            <span class="n">size_signer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2539" name="__codelineno-0-2539"></a>
<a id="__codelineno-0-2540" name="__codelineno-0-2540"></a>            <span class="c1"># read whole signed data, since we might to parse</span>
<a id="__codelineno-0-2541" name="__codelineno-0-2541"></a>            <span class="c1"># content within the signed data, and mess up offset</span>
<a id="__codelineno-0-2542" name="__codelineno-0-2542"></a>            <span class="n">len_signed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>            <span class="n">signed_data_bytes</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>            <span class="n">signed_data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">signed_data_bytes</span><span class="p">)</span>
<a id="__codelineno-0-2545" name="__codelineno-0-2545"></a>
<a id="__codelineno-0-2546" name="__codelineno-0-2546"></a>            <span class="c1"># Digests</span>
<a id="__codelineno-0-2547" name="__codelineno-0-2547"></a>            <span class="n">len_digests</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>            <span class="n">raw_digests</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_digests</span><span class="p">)</span>
<a id="__codelineno-0-2549" name="__codelineno-0-2549"></a>            <span class="n">digests</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_signatures_or_digests</span><span class="p">(</span><span class="n">raw_digests</span><span class="p">)</span>
<a id="__codelineno-0-2550" name="__codelineno-0-2550"></a>
<a id="__codelineno-0-2551" name="__codelineno-0-2551"></a>            <span class="c1"># Certs</span>
<a id="__codelineno-0-2552" name="__codelineno-0-2552"></a>            <span class="n">certs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2553" name="__codelineno-0-2553"></a>            <span class="n">len_certs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2554" name="__codelineno-0-2554"></a>            <span class="n">start_certs</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2555" name="__codelineno-0-2555"></a>            <span class="k">while</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">start_certs</span> <span class="o">+</span> <span class="n">len_certs</span><span class="p">:</span>
<a id="__codelineno-0-2556" name="__codelineno-0-2556"></a>                <span class="n">len_cert</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2557" name="__codelineno-0-2557"></a>                <span class="n">cert</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_cert</span><span class="p">)</span>
<a id="__codelineno-0-2558" name="__codelineno-0-2558"></a>                <span class="n">certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2559" name="__codelineno-0-2559"></a>
<a id="__codelineno-0-2560" name="__codelineno-0-2560"></a>            <span class="c1"># Additional attributes</span>
<a id="__codelineno-0-2561" name="__codelineno-0-2561"></a>            <span class="n">len_attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2562" name="__codelineno-0-2562"></a>            <span class="n">attributes</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_attr</span><span class="p">)</span>
<a id="__codelineno-0-2563" name="__codelineno-0-2563"></a>
<a id="__codelineno-0-2564" name="__codelineno-0-2564"></a>            <span class="n">signed_data_object</span> <span class="o">=</span> <span class="n">APKV2SignedData</span><span class="p">()</span>
<a id="__codelineno-0-2565" name="__codelineno-0-2565"></a>            <span class="n">signed_data_object</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="n">signed_data_bytes</span>
<a id="__codelineno-0-2566" name="__codelineno-0-2566"></a>            <span class="n">signed_data_object</span><span class="o">.</span><span class="n">digests</span> <span class="o">=</span> <span class="n">digests</span>
<a id="__codelineno-0-2567" name="__codelineno-0-2567"></a>            <span class="n">signed_data_object</span><span class="o">.</span><span class="n">certificates</span> <span class="o">=</span> <span class="n">certs</span>
<a id="__codelineno-0-2568" name="__codelineno-0-2568"></a>            <span class="n">signed_data_object</span><span class="o">.</span><span class="n">additional_attributes</span> <span class="o">=</span> <span class="n">attributes</span>
<a id="__codelineno-0-2569" name="__codelineno-0-2569"></a>
<a id="__codelineno-0-2570" name="__codelineno-0-2570"></a>            <span class="c1"># Signatures</span>
<a id="__codelineno-0-2571" name="__codelineno-0-2571"></a>            <span class="n">len_sigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2572" name="__codelineno-0-2572"></a>            <span class="n">raw_sigs</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_sigs</span><span class="p">)</span>
<a id="__codelineno-0-2573" name="__codelineno-0-2573"></a>            <span class="n">sigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_signatures_or_digests</span><span class="p">(</span><span class="n">raw_sigs</span><span class="p">)</span>
<a id="__codelineno-0-2574" name="__codelineno-0-2574"></a>
<a id="__codelineno-0-2575" name="__codelineno-0-2575"></a>            <span class="c1"># PublicKey</span>
<a id="__codelineno-0-2576" name="__codelineno-0-2576"></a>            <span class="n">len_publickey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2577" name="__codelineno-0-2577"></a>            <span class="n">publickey</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_publickey</span><span class="p">)</span>
<a id="__codelineno-0-2578" name="__codelineno-0-2578"></a>
<a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>            <span class="n">signer</span> <span class="o">=</span> <span class="n">APKV2Signer</span><span class="p">()</span>
<a id="__codelineno-0-2580" name="__codelineno-0-2580"></a>            <span class="n">signer</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="n">view</span><span class="p">[</span><span class="n">off_signer</span> <span class="p">:</span> <span class="n">off_signer</span> <span class="o">+</span> <span class="n">size_signer</span><span class="p">]</span>
<a id="__codelineno-0-2581" name="__codelineno-0-2581"></a>            <span class="n">signer</span><span class="o">.</span><span class="n">signed_data</span> <span class="o">=</span> <span class="n">signed_data_object</span>
<a id="__codelineno-0-2582" name="__codelineno-0-2582"></a>            <span class="n">signer</span><span class="o">.</span><span class="n">signatures</span> <span class="o">=</span> <span class="n">sigs</span>
<a id="__codelineno-0-2583" name="__codelineno-0-2583"></a>            <span class="n">signer</span><span class="o">.</span><span class="n">public_key</span> <span class="o">=</span> <span class="n">publickey</span>
<a id="__codelineno-0-2584" name="__codelineno-0-2584"></a>
<a id="__codelineno-0-2585" name="__codelineno-0-2585"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signer</span><span class="p">)</span>
<a id="__codelineno-0-2586" name="__codelineno-0-2586"></a>
<a id="__codelineno-0-2587" name="__codelineno-0-2587"></a>    <span class="k">def</span> <span class="nf">get_public_keys_der_v3</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-0-2588" name="__codelineno-0-2588"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2589" name="__codelineno-0-2589"></a><span class="sd">        Return a list of DER coded X.509 public keys from the v3 signature block</span>
<a id="__codelineno-0-2590" name="__codelineno-0-2590"></a>
<a id="__codelineno-0-2591" name="__codelineno-0-2591"></a><span class="sd">        :returns: the list of public key bytes</span>
<a id="__codelineno-0-2592" name="__codelineno-0-2592"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2593" name="__codelineno-0-2593"></a>
<a id="__codelineno-0-2594" name="__codelineno-0-2594"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2595" name="__codelineno-0-2595"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse_v3_signing_block</span><span class="p">()</span>
<a id="__codelineno-0-2596" name="__codelineno-0-2596"></a>
<a id="__codelineno-0-2597" name="__codelineno-0-2597"></a>        <span class="n">public_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2598" name="__codelineno-0-2598"></a>
<a id="__codelineno-0-2599" name="__codelineno-0-2599"></a>        <span class="k">for</span> <span class="n">signer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span><span class="p">:</span>
<a id="__codelineno-0-2600" name="__codelineno-0-2600"></a>            <span class="n">public_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signer</span><span class="o">.</span><span class="n">public_key</span><span class="p">)</span>
<a id="__codelineno-0-2601" name="__codelineno-0-2601"></a>
<a id="__codelineno-0-2602" name="__codelineno-0-2602"></a>        <span class="k">return</span> <span class="n">public_keys</span>
<a id="__codelineno-0-2603" name="__codelineno-0-2603"></a>
<a id="__codelineno-0-2604" name="__codelineno-0-2604"></a>    <span class="k">def</span> <span class="nf">get_public_keys_der_v2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-0-2605" name="__codelineno-0-2605"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2606" name="__codelineno-0-2606"></a><span class="sd">        Return a list of DER coded X.509 public keys from the v3 signature block</span>
<a id="__codelineno-0-2607" name="__codelineno-0-2607"></a>
<a id="__codelineno-0-2608" name="__codelineno-0-2608"></a><span class="sd">        :returns: the list of public key bytes</span>
<a id="__codelineno-0-2609" name="__codelineno-0-2609"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2610" name="__codelineno-0-2610"></a>
<a id="__codelineno-0-2611" name="__codelineno-0-2611"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2612" name="__codelineno-0-2612"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse_v2_signing_block</span><span class="p">()</span>
<a id="__codelineno-0-2613" name="__codelineno-0-2613"></a>
<a id="__codelineno-0-2614" name="__codelineno-0-2614"></a>        <span class="n">public_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2615" name="__codelineno-0-2615"></a>
<a id="__codelineno-0-2616" name="__codelineno-0-2616"></a>        <span class="k">for</span> <span class="n">signer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span><span class="p">:</span>
<a id="__codelineno-0-2617" name="__codelineno-0-2617"></a>            <span class="n">public_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signer</span><span class="o">.</span><span class="n">public_key</span><span class="p">)</span>
<a id="__codelineno-0-2618" name="__codelineno-0-2618"></a>
<a id="__codelineno-0-2619" name="__codelineno-0-2619"></a>        <span class="k">return</span> <span class="n">public_keys</span>
<a id="__codelineno-0-2620" name="__codelineno-0-2620"></a>
<a id="__codelineno-0-2621" name="__codelineno-0-2621"></a>    <span class="k">def</span> <span class="nf">get_certificates_der_v3</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-0-2622" name="__codelineno-0-2622"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2623" name="__codelineno-0-2623"></a><span class="sd">        Return a list of DER coded X.509 certificates from the v3 signature block</span>
<a id="__codelineno-0-2624" name="__codelineno-0-2624"></a>
<a id="__codelineno-0-2625" name="__codelineno-0-2625"></a><span class="sd">        :returns: the list of public key bytes</span>
<a id="__codelineno-0-2626" name="__codelineno-0-2626"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2627" name="__codelineno-0-2627"></a>
<a id="__codelineno-0-2628" name="__codelineno-0-2628"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2629" name="__codelineno-0-2629"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse_v3_signing_block</span><span class="p">()</span>
<a id="__codelineno-0-2630" name="__codelineno-0-2630"></a>
<a id="__codelineno-0-2631" name="__codelineno-0-2631"></a>        <span class="n">certs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2632" name="__codelineno-0-2632"></a>        <span class="k">for</span> <span class="n">signed_data</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-2633" name="__codelineno-0-2633"></a>            <span class="n">signer</span><span class="o">.</span><span class="n">signed_data</span> <span class="k">for</span> <span class="n">signer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span>
<a id="__codelineno-0-2634" name="__codelineno-0-2634"></a>        <span class="p">]:</span>
<a id="__codelineno-0-2635" name="__codelineno-0-2635"></a>            <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">certificates</span><span class="p">:</span>
<a id="__codelineno-0-2636" name="__codelineno-0-2636"></a>                <span class="n">certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2637" name="__codelineno-0-2637"></a>
<a id="__codelineno-0-2638" name="__codelineno-0-2638"></a>        <span class="k">return</span> <span class="n">certs</span>
<a id="__codelineno-0-2639" name="__codelineno-0-2639"></a>
<a id="__codelineno-0-2640" name="__codelineno-0-2640"></a>    <span class="k">def</span> <span class="nf">get_certificates_der_v2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-0-2641" name="__codelineno-0-2641"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2642" name="__codelineno-0-2642"></a><span class="sd">        Return a list of DER coded X.509 certificates from the v3 signature block</span>
<a id="__codelineno-0-2643" name="__codelineno-0-2643"></a>
<a id="__codelineno-0-2644" name="__codelineno-0-2644"></a><span class="sd">        :returns: the list of public key bytes</span>
<a id="__codelineno-0-2645" name="__codelineno-0-2645"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2646" name="__codelineno-0-2646"></a>
<a id="__codelineno-0-2647" name="__codelineno-0-2647"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2648" name="__codelineno-0-2648"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parse_v2_signing_block</span><span class="p">()</span>
<a id="__codelineno-0-2649" name="__codelineno-0-2649"></a>
<a id="__codelineno-0-2650" name="__codelineno-0-2650"></a>        <span class="n">certs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2651" name="__codelineno-0-2651"></a>        <span class="k">for</span> <span class="n">signed_data</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-2652" name="__codelineno-0-2652"></a>            <span class="n">signer</span><span class="o">.</span><span class="n">signed_data</span> <span class="k">for</span> <span class="n">signer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span>
<a id="__codelineno-0-2653" name="__codelineno-0-2653"></a>        <span class="p">]:</span>
<a id="__codelineno-0-2654" name="__codelineno-0-2654"></a>            <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">certificates</span><span class="p">:</span>
<a id="__codelineno-0-2655" name="__codelineno-0-2655"></a>                <span class="n">certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2656" name="__codelineno-0-2656"></a>
<a id="__codelineno-0-2657" name="__codelineno-0-2657"></a>        <span class="k">return</span> <span class="n">certs</span>
<a id="__codelineno-0-2658" name="__codelineno-0-2658"></a>
<a id="__codelineno-0-2659" name="__codelineno-0-2659"></a>    <span class="k">def</span> <span class="nf">get_public_keys_v3</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">PublicKeyInfo</span><span class="p">]:</span>
<a id="__codelineno-0-2660" name="__codelineno-0-2660"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2661" name="__codelineno-0-2661"></a><span class="sd">        Return a list of `asn1crypto.keys.PublicKeyInfo` which are found</span>
<a id="__codelineno-0-2662" name="__codelineno-0-2662"></a><span class="sd">        in the v3 signing block.</span>
<a id="__codelineno-0-2663" name="__codelineno-0-2663"></a>
<a id="__codelineno-0-2664" name="__codelineno-0-2664"></a><span class="sd">        :returns: a list of the found `asn1crypto.keys.PublicKeyInfo`</span>
<a id="__codelineno-0-2665" name="__codelineno-0-2665"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2666" name="__codelineno-0-2666"></a>        <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-2667" name="__codelineno-0-2667"></a>            <span class="n">keys</span><span class="o">.</span><span class="n">PublicKeyInfo</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pkey</span><span class="p">)</span>
<a id="__codelineno-0-2668" name="__codelineno-0-2668"></a>            <span class="k">for</span> <span class="n">pkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_public_keys_der_v3</span><span class="p">()</span>
<a id="__codelineno-0-2669" name="__codelineno-0-2669"></a>        <span class="p">]</span>
<a id="__codelineno-0-2670" name="__codelineno-0-2670"></a>
<a id="__codelineno-0-2671" name="__codelineno-0-2671"></a>    <span class="k">def</span> <span class="nf">get_public_keys_v2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">PublicKeyInfo</span><span class="p">]:</span>
<a id="__codelineno-0-2672" name="__codelineno-0-2672"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2673" name="__codelineno-0-2673"></a><span class="sd">        Return a list of `asn1crypto.keys.PublicKeyInfo` which are found</span>
<a id="__codelineno-0-2674" name="__codelineno-0-2674"></a><span class="sd">        in the v2 signing block.</span>
<a id="__codelineno-0-2675" name="__codelineno-0-2675"></a>
<a id="__codelineno-0-2676" name="__codelineno-0-2676"></a><span class="sd">        :returns: a list of the found `asn1crypto.keys.PublicKeyInfo`</span>
<a id="__codelineno-0-2677" name="__codelineno-0-2677"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2678" name="__codelineno-0-2678"></a>        <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-2679" name="__codelineno-0-2679"></a>            <span class="n">keys</span><span class="o">.</span><span class="n">PublicKeyInfo</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pkey</span><span class="p">)</span>
<a id="__codelineno-0-2680" name="__codelineno-0-2680"></a>            <span class="k">for</span> <span class="n">pkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_public_keys_der_v2</span><span class="p">()</span>
<a id="__codelineno-0-2681" name="__codelineno-0-2681"></a>        <span class="p">]</span>
<a id="__codelineno-0-2682" name="__codelineno-0-2682"></a>
<a id="__codelineno-0-2683" name="__codelineno-0-2683"></a>    <span class="k">def</span> <span class="nf">get_certificates_v3</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">]:</span>
<a id="__codelineno-0-2684" name="__codelineno-0-2684"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2685" name="__codelineno-0-2685"></a><span class="sd">        Return a list of `asn1crypto.x509.Certificate` which are found</span>
<a id="__codelineno-0-2686" name="__codelineno-0-2686"></a><span class="sd">        in the v3 signing block.</span>
<a id="__codelineno-0-2687" name="__codelineno-0-2687"></a><span class="sd">        Note that we simply extract all certificates regardless of the signer.</span>
<a id="__codelineno-0-2688" name="__codelineno-0-2688"></a><span class="sd">        Therefore this is just a list of all certificates found in all signers.</span>
<a id="__codelineno-0-2689" name="__codelineno-0-2689"></a>
<a id="__codelineno-0-2690" name="__codelineno-0-2690"></a><span class="sd">        :returns: a list of the found `asn1crypto.x509.Certificate`</span>
<a id="__codelineno-0-2691" name="__codelineno-0-2691"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2692" name="__codelineno-0-2692"></a>        <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-2693" name="__codelineno-0-2693"></a>            <span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2694" name="__codelineno-0-2694"></a>            <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificates_der_v3</span><span class="p">()</span>
<a id="__codelineno-0-2695" name="__codelineno-0-2695"></a>        <span class="p">]</span>
<a id="__codelineno-0-2696" name="__codelineno-0-2696"></a>
<a id="__codelineno-0-2697" name="__codelineno-0-2697"></a>    <span class="k">def</span> <span class="nf">get_certificates_v2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">]:</span>
<a id="__codelineno-0-2698" name="__codelineno-0-2698"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2699" name="__codelineno-0-2699"></a><span class="sd">        Return a list of `asn1crypto.x509.Certificate` which are found</span>
<a id="__codelineno-0-2700" name="__codelineno-0-2700"></a><span class="sd">        in the v2 signing block.</span>
<a id="__codelineno-0-2701" name="__codelineno-0-2701"></a><span class="sd">        Note that we simply extract all certificates regardless of the signer.</span>
<a id="__codelineno-0-2702" name="__codelineno-0-2702"></a><span class="sd">        Therefore this is just a list of all certificates found in all signers.</span>
<a id="__codelineno-0-2703" name="__codelineno-0-2703"></a>
<a id="__codelineno-0-2704" name="__codelineno-0-2704"></a><span class="sd">        :returns: a list of the found `asn1crypto.x509.Certificate`</span>
<a id="__codelineno-0-2705" name="__codelineno-0-2705"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2706" name="__codelineno-0-2706"></a>        <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-2707" name="__codelineno-0-2707"></a>            <span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2708" name="__codelineno-0-2708"></a>            <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificates_der_v2</span><span class="p">()</span>
<a id="__codelineno-0-2709" name="__codelineno-0-2709"></a>        <span class="p">]</span>
<a id="__codelineno-0-2710" name="__codelineno-0-2710"></a>
<a id="__codelineno-0-2711" name="__codelineno-0-2711"></a>    <span class="k">def</span> <span class="nf">get_certificates_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]:</span>
<a id="__codelineno-0-2712" name="__codelineno-0-2712"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2713" name="__codelineno-0-2713"></a><span class="sd">        Return a list of verified `asn1crypto.x509.Certificate` which are found</span>
<a id="__codelineno-0-2714" name="__codelineno-0-2714"></a><span class="sd">        in the META-INF folder (v1 signing).</span>
<a id="__codelineno-0-2715" name="__codelineno-0-2715"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2716" name="__codelineno-0-2716"></a>        <span class="n">certs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2717" name="__codelineno-0-2717"></a>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signature_names</span><span class="p">():</span>
<a id="__codelineno-0-2718" name="__codelineno-0-2718"></a>            <span class="n">cc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificate_der</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-2719" name="__codelineno-0-2719"></a>            <span class="k">if</span> <span class="n">cc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2720" name="__codelineno-0-2720"></a>                <span class="n">certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
<a id="__codelineno-0-2721" name="__codelineno-0-2721"></a>        <span class="k">return</span> <span class="n">certs</span>
<a id="__codelineno-0-2722" name="__codelineno-0-2722"></a>
<a id="__codelineno-0-2723" name="__codelineno-0-2723"></a>    <span class="k">def</span> <span class="nf">get_certificates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">]:</span>
<a id="__codelineno-0-2724" name="__codelineno-0-2724"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2725" name="__codelineno-0-2725"></a><span class="sd">        Return a list of unique `asn1crypto.x509.Certificate` which are found</span>
<a id="__codelineno-0-2726" name="__codelineno-0-2726"></a><span class="sd">        in v1, v2 and v3 signing</span>
<a id="__codelineno-0-2727" name="__codelineno-0-2727"></a><span class="sd">        Note that we simply extract all certificates regardless of the signer.</span>
<a id="__codelineno-0-2728" name="__codelineno-0-2728"></a><span class="sd">        Therefore this is just a list of all certificates found in all signers.</span>
<a id="__codelineno-0-2729" name="__codelineno-0-2729"></a><span class="sd">        Exception is v1, for which the certificate returned is verified.</span>
<a id="__codelineno-0-2730" name="__codelineno-0-2730"></a>
<a id="__codelineno-0-2731" name="__codelineno-0-2731"></a><span class="sd">        :returns: a list of the found `asn1crypto.x509.Certificate`</span>
<a id="__codelineno-0-2732" name="__codelineno-0-2732"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2733" name="__codelineno-0-2733"></a>        <span class="n">fps</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2734" name="__codelineno-0-2734"></a>        <span class="n">certs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2735" name="__codelineno-0-2735"></a>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span>
<a id="__codelineno-0-2736" name="__codelineno-0-2736"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_certificates_v1</span><span class="p">()</span>
<a id="__codelineno-0-2737" name="__codelineno-0-2737"></a>            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificates_v2</span><span class="p">()</span>
<a id="__codelineno-0-2738" name="__codelineno-0-2738"></a>            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificates_v3</span><span class="p">()</span>
<a id="__codelineno-0-2739" name="__codelineno-0-2739"></a>        <span class="p">):</span>
<a id="__codelineno-0-2740" name="__codelineno-0-2740"></a>            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">sha256</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fps</span><span class="p">:</span>
<a id="__codelineno-0-2741" name="__codelineno-0-2741"></a>                <span class="n">fps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sha256</span><span class="p">)</span>
<a id="__codelineno-0-2742" name="__codelineno-0-2742"></a>                <span class="n">certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-2743" name="__codelineno-0-2743"></a>        <span class="k">return</span> <span class="n">certs</span>
<a id="__codelineno-0-2744" name="__codelineno-0-2744"></a>
<a id="__codelineno-0-2745" name="__codelineno-0-2745"></a>    <span class="k">def</span> <span class="nf">get_signature_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-2746" name="__codelineno-0-2746"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2747" name="__codelineno-0-2747"></a><span class="sd">        Return the name of the first signature file found.</span>
<a id="__codelineno-0-2748" name="__codelineno-0-2748"></a>
<a id="__codelineno-0-2749" name="__codelineno-0-2749"></a><span class="sd">        :returns: the name of the first signature file, or `None` if not signed</span>
<a id="__codelineno-0-2750" name="__codelineno-0-2750"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2751" name="__codelineno-0-2751"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signature_names</span><span class="p">():</span>
<a id="__codelineno-0-2752" name="__codelineno-0-2752"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signature_names</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2753" name="__codelineno-0-2753"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2754" name="__codelineno-0-2754"></a>            <span class="c1"># Unsigned APK</span>
<a id="__codelineno-0-2755" name="__codelineno-0-2755"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-2756" name="__codelineno-0-2756"></a>
<a id="__codelineno-0-2757" name="__codelineno-0-2757"></a>    <span class="k">def</span> <span class="nf">get_signature_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2758" name="__codelineno-0-2758"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2759" name="__codelineno-0-2759"></a><span class="sd">        Return a list of the signature file names (v1 Signature / JAR</span>
<a id="__codelineno-0-2760" name="__codelineno-0-2760"></a><span class="sd">        Signature)</span>
<a id="__codelineno-0-2761" name="__codelineno-0-2761"></a>
<a id="__codelineno-0-2762" name="__codelineno-0-2762"></a><span class="sd">        :returns: List of filenames matching a Signature</span>
<a id="__codelineno-0-2763" name="__codelineno-0-2763"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2764" name="__codelineno-0-2764"></a>        <span class="n">signature_expr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^(META-INF/)(.*)(\.RSA|\.EC|\.DSA)$&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2765" name="__codelineno-0-2765"></a>        <span class="n">signatures</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2766" name="__codelineno-0-2766"></a>
<a id="__codelineno-0-2767" name="__codelineno-0-2767"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">():</span>
<a id="__codelineno-0-2768" name="__codelineno-0-2768"></a>            <span class="k">if</span> <span class="n">signature_expr</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-2769" name="__codelineno-0-2769"></a>                <span class="k">if</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.SF&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">():</span>
<a id="__codelineno-0-2770" name="__codelineno-0-2770"></a>                    <span class="n">signatures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-2771" name="__codelineno-0-2771"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2772" name="__codelineno-0-2772"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2773" name="__codelineno-0-2773"></a>                        <span class="s2">&quot;v1 signature file </span><span class="si">{}</span><span class="s2"> missing .SF file - Partial signature!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2774" name="__codelineno-0-2774"></a>                            <span class="n">i</span>
<a id="__codelineno-0-2775" name="__codelineno-0-2775"></a>                        <span class="p">)</span>
<a id="__codelineno-0-2776" name="__codelineno-0-2776"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2777" name="__codelineno-0-2777"></a>
<a id="__codelineno-0-2778" name="__codelineno-0-2778"></a>        <span class="k">return</span> <span class="n">signatures</span>
<a id="__codelineno-0-2779" name="__codelineno-0-2779"></a>
<a id="__codelineno-0-2780" name="__codelineno-0-2780"></a>    <span class="k">def</span> <span class="nf">get_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-2781" name="__codelineno-0-2781"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2782" name="__codelineno-0-2782"></a><span class="sd">        Return the data of the first signature file found (v1 Signature / JAR</span>
<a id="__codelineno-0-2783" name="__codelineno-0-2783"></a><span class="sd">        Signature)</span>
<a id="__codelineno-0-2784" name="__codelineno-0-2784"></a>
<a id="__codelineno-0-2785" name="__codelineno-0-2785"></a><span class="sd">        :returns: First signature name or None if not signed</span>
<a id="__codelineno-0-2786" name="__codelineno-0-2786"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2787" name="__codelineno-0-2787"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signatures</span><span class="p">():</span>
<a id="__codelineno-0-2788" name="__codelineno-0-2788"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signatures</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2789" name="__codelineno-0-2789"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2790" name="__codelineno-0-2790"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-2791" name="__codelineno-0-2791"></a>
<a id="__codelineno-0-2792" name="__codelineno-0-2792"></a>    <span class="k">def</span> <span class="nf">get_signatures</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-0-2793" name="__codelineno-0-2793"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2794" name="__codelineno-0-2794"></a><span class="sd">        Return a list of the data of the signature files.</span>
<a id="__codelineno-0-2795" name="__codelineno-0-2795"></a><span class="sd">        Only v1 / JAR Signing.</span>
<a id="__codelineno-0-2796" name="__codelineno-0-2796"></a>
<a id="__codelineno-0-2797" name="__codelineno-0-2797"></a><span class="sd">        :returns: list of bytes</span>
<a id="__codelineno-0-2798" name="__codelineno-0-2798"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2799" name="__codelineno-0-2799"></a>        <span class="n">signature_expr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^(META-INF/)(.*)(\.RSA|\.EC|\.DSA)$&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2800" name="__codelineno-0-2800"></a>        <span class="n">signature_datas</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2801" name="__codelineno-0-2801"></a>
<a id="__codelineno-0-2802" name="__codelineno-0-2802"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">():</span>
<a id="__codelineno-0-2803" name="__codelineno-0-2803"></a>            <span class="k">if</span> <span class="n">signature_expr</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-2804" name="__codelineno-0-2804"></a>                <span class="n">signature_datas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a id="__codelineno-0-2805" name="__codelineno-0-2805"></a>
<a id="__codelineno-0-2806" name="__codelineno-0-2806"></a>        <span class="k">return</span> <span class="n">signature_datas</span>
<a id="__codelineno-0-2807" name="__codelineno-0-2807"></a>
<a id="__codelineno-0-2808" name="__codelineno-0-2808"></a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2809" name="__codelineno-0-2809"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_files_types</span><span class="p">()</span>
<a id="__codelineno-0-2810" name="__codelineno-0-2810"></a>
<a id="__codelineno-0-2811" name="__codelineno-0-2811"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FILES: &quot;</span><span class="p">)</span>
<a id="__codelineno-0-2812" name="__codelineno-0-2812"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">():</span>
<a id="__codelineno-0-2813" name="__codelineno-0-2813"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2814" name="__codelineno-0-2814"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">files_crc32</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-2815" name="__codelineno-0-2815"></a>            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2816" name="__codelineno-0-2816"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">files_crc32</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-2817" name="__codelineno-0-2817"></a>
<a id="__codelineno-0-2818" name="__codelineno-0-2818"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DECLARED PERMISSIONS:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2819" name="__codelineno-0-2819"></a>        <span class="n">declared_permissions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_declared_permissions</span><span class="p">()</span>
<a id="__codelineno-0-2820" name="__codelineno-0-2820"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">declared_permissions</span><span class="p">:</span>
<a id="__codelineno-0-2821" name="__codelineno-0-2821"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-2822" name="__codelineno-0-2822"></a>
<a id="__codelineno-0-2823" name="__codelineno-0-2823"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;REQUESTED PERMISSIONS:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2824" name="__codelineno-0-2824"></a>        <span class="n">requested_permissions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>
<a id="__codelineno-0-2825" name="__codelineno-0-2825"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">requested_permissions</span><span class="p">:</span>
<a id="__codelineno-0-2826" name="__codelineno-0-2826"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-2827" name="__codelineno-0-2827"></a>
<a id="__codelineno-0-2828" name="__codelineno-0-2828"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAIN ACTIVITY: &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_main_activity</span><span class="p">())</span>
<a id="__codelineno-0-2829" name="__codelineno-0-2829"></a>
<a id="__codelineno-0-2830" name="__codelineno-0-2830"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ACTIVITIES: &quot;</span><span class="p">)</span>
<a id="__codelineno-0-2831" name="__codelineno-0-2831"></a>        <span class="n">activities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_activities</span><span class="p">()</span>
<a id="__codelineno-0-2832" name="__codelineno-0-2832"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">activities</span><span class="p">:</span>
<a id="__codelineno-0-2833" name="__codelineno-0-2833"></a>            <span class="n">filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_intent_filters</span><span class="p">(</span><span class="s2">&quot;activity&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-2834" name="__codelineno-0-2834"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">filters</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2835" name="__codelineno-0-2835"></a>
<a id="__codelineno-0-2836" name="__codelineno-0-2836"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SERVICES: &quot;</span><span class="p">)</span>
<a id="__codelineno-0-2837" name="__codelineno-0-2837"></a>        <span class="n">services</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_services</span><span class="p">()</span>
<a id="__codelineno-0-2838" name="__codelineno-0-2838"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">services</span><span class="p">:</span>
<a id="__codelineno-0-2839" name="__codelineno-0-2839"></a>            <span class="n">filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_intent_filters</span><span class="p">(</span><span class="s2">&quot;service&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-2840" name="__codelineno-0-2840"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">filters</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2841" name="__codelineno-0-2841"></a>
<a id="__codelineno-0-2842" name="__codelineno-0-2842"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RECEIVERS: &quot;</span><span class="p">)</span>
<a id="__codelineno-0-2843" name="__codelineno-0-2843"></a>        <span class="n">receivers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_receivers</span><span class="p">()</span>
<a id="__codelineno-0-2844" name="__codelineno-0-2844"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">receivers</span><span class="p">:</span>
<a id="__codelineno-0-2845" name="__codelineno-0-2845"></a>            <span class="n">filters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_intent_filters</span><span class="p">(</span><span class="s2">&quot;receiver&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-2846" name="__codelineno-0-2846"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">filters</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2847" name="__codelineno-0-2847"></a>
<a id="__codelineno-0-2848" name="__codelineno-0-2848"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PROVIDERS: &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_providers</span><span class="p">())</span>
<a id="__codelineno-0-2849" name="__codelineno-0-2849"></a>
<a id="__codelineno-0-2850" name="__codelineno-0-2850"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_signed_v1</span><span class="p">():</span>
<a id="__codelineno-0-2851" name="__codelineno-0-2851"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CERTIFICATES v1:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2852" name="__codelineno-0-2852"></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signature_names</span><span class="p">():</span>
<a id="__codelineno-0-2853" name="__codelineno-0-2853"></a>                <span class="n">show_Certificate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_certificate</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<a id="__codelineno-0-2854" name="__codelineno-0-2854"></a>
<a id="__codelineno-0-2855" name="__codelineno-0-2855"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_signed_v2</span><span class="p">():</span>
<a id="__codelineno-0-2856" name="__codelineno-0-2856"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CERTIFICATES v2:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2857" name="__codelineno-0-2857"></a>            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificates_v2</span><span class="p">():</span>
<a id="__codelineno-0-2858" name="__codelineno-0-2858"></a>                <span class="n">show_Certificate</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="androguard.core.apk.APK.files" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">files</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#androguard.core.apk.APK.files" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns a dictionary of filenames and detected magic type</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary of files and their mime type</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.__getstate__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__getstate__</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.__getstate__" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Function for pickling APK Objects.</p>
<p>We remove the zip from the Object, as it is not pickable
And it does not make any sense to pickle it anyways.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the picklable APK Object without zip.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">    Function for pickling APK Objects.</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">    We remove the zip from the Object, as it is not pickable</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">    And it does not make any sense to pickle it anyways.</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    :returns: the picklable APK Object without zip.</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>    <span class="c1"># Upon pickling, we need to remove the ZipFile</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>    <span class="n">x</span><span class="p">[</span><span class="s1">&#39;axml&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;axml&#39;</span><span class="p">])</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="n">x</span><span class="p">[</span><span class="s1">&#39;xml&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;xml&#39;</span><span class="p">])</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>    <span class="k">del</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;zip&#39;</span><span class="p">]</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">magic_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skip_analysis</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">testzip</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.__init__" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>This class can access to all elements in an APK file</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; APK(&quot;myfile.apk&quot;)
&gt;&gt;&gt; APK(read(&quot;myfile.apk&quot;), raw=True)
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify the path of the file, or raw data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>raw</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify if the filename is a path or raw data (optional)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>magic_file</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify the magic file (not used anymore - legacy only)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skip_analysis</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Skip the analysis, e.g. no manifest files are read. (default: <code>False</code>)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>testzip</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Test the APK for integrity, e.g. if the ZIP file is broken. Throw an exception on failure (default <code>False</code>)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="n">raw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="n">magic_file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="n">skip_analysis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="n">testzip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    This class can access to all elements in an APK file</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        &gt;&gt;&gt; APK(&quot;myfile.apk&quot;)</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        &gt;&gt;&gt; APK(read(&quot;myfile.apk&quot;), raw=True)</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    :param filename: specify the path of the file, or raw data</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    :param raw: specify if the filename is a path or raw data (optional)</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">    :param magic_file: specify the magic file (not used anymore - legacy only)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    :param skip_analysis: Skip the analysis, e.g. no manifest files are read. (default: `False`)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">    :param testzip: Test the APK for integrity, e.g. if the ZIP file is broken. Throw an exception on failure (default `False`)</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="k">if</span> <span class="n">magic_file</span><span class="p">:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>            <span class="s2">&quot;You set magic_file but this parameter is actually unused. You should remove it.&quot;</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="p">)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">xml</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">axml</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">arsc</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">package</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">androidversion</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">uses_permissions</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">declared_permissions</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">valid_apk</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v2</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v3</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_v2_blocks</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_files</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">files_crc32</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="k">if</span> <span class="n">raw</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__raw</span> <span class="o">=</span> <span class="n">filename</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sha256</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__raw</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="c1"># Set the filename to something sane</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;raw_apk_sha256:</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sha256</span><span class="p">)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zip</span> <span class="o">=</span> <span class="n">ZipEntry</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__raw</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">zip</span> <span class="o">=</span> <span class="n">ZipEntry</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="k">if</span> <span class="n">testzip</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>            <span class="s2">&quot;Testing zip file integrity, this might take a while...&quot;</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="p">)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="c1"># Test the zipfile for integrity before continuing.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="c1"># This process might be slow, as the whole file is read.</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="c1"># Therefore it is possible to enable it as a separate feature.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="c1">#</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="c1"># A short benchmark showed, that testing the zip takes about 10 times longer!</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="c1"># e.g. normal zip loading (skip_analysis=True) takes about 0.01s, where</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="c1"># testzip takes 0.1s!</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">test_zip</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__raw</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="n">ret</span> <span class="o">=</span> <span class="n">test_zip</span><span class="o">.</span><span class="n">testzip</span><span class="p">()</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="k">if</span> <span class="n">ret</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>            <span class="c1"># we could print the filename here, but there are zip which are so broken</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="c1"># That the filename is either very very long or does not make any sense.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>            <span class="c1"># Thus we do not do it, the user might find out by using other tools.</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="k">raise</span> <span class="n">BrokenAPKError</span><span class="p">(</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>                <span class="s2">&quot;The APK is probably broken: testzip returned an error.&quot;</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="p">)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_analysis</span><span class="p">:</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_apk_analysis</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.__setstate__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.__setstate__" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Load a pickled APK Object and restore the state</p>
<p>We load the zip file back by reading __raw from the Object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pickled state</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">    Load a pickled APK Object and restore the state</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">    We load the zip file back by reading __raw from the Object.</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">    :param state: pickled state</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>    <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="n">state</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">zip</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_raw</span><span class="p">()),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.canonical_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">canonical_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">android</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.canonical_name" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a> * Method is dual-licensed under the Apache License 2.0 and GPLv3+.
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a> * The original author has granted permission to use this code snippet under the
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a> * Apache License 2.0 for inclusion in this project.
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a> * https://github.com/obfusk/x509_canonical_name.py/blob/master/x509_canonical_name.py
</code></pre></div>
<p>Returns canonical representation of <code>asn1crypto.x509.Name</code> as str (with raw control characters
in places those are not stripped by normalisation).</p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span>
<span class="normal"><a href="#__codelineno-0-2015">2015</a></span>
<span class="normal"><a href="#__codelineno-0-2016">2016</a></span>
<span class="normal"><a href="#__codelineno-0-2017">2017</a></span>
<span class="normal"><a href="#__codelineno-0-2018">2018</a></span>
<span class="normal"><a href="#__codelineno-0-2019">2019</a></span>
<span class="normal"><a href="#__codelineno-0-2020">2020</a></span>
<span class="normal"><a href="#__codelineno-0-2021">2021</a></span>
<span class="normal"><a href="#__codelineno-0-2022">2022</a></span>
<span class="normal"><a href="#__codelineno-0-2023">2023</a></span>
<span class="normal"><a href="#__codelineno-0-2024">2024</a></span>
<span class="normal"><a href="#__codelineno-0-2025">2025</a></span>
<span class="normal"><a href="#__codelineno-0-2026">2026</a></span>
<span class="normal"><a href="#__codelineno-0-2027">2027</a></span>
<span class="normal"><a href="#__codelineno-0-2028">2028</a></span>
<span class="normal"><a href="#__codelineno-0-2029">2029</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2013" name="__codelineno-0-2013"></a><span class="k">def</span> <span class="nf">canonical_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">android</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-2014" name="__codelineno-0-2014"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2015" name="__codelineno-0-2015"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2016" name="__codelineno-0-2016"></a><span class="sd">     * Method is dual-licensed under the Apache License 2.0 and GPLv3+.</span>
<a id="__codelineno-0-2017" name="__codelineno-0-2017"></a><span class="sd">     * The original author has granted permission to use this code snippet under the</span>
<a id="__codelineno-0-2018" name="__codelineno-0-2018"></a><span class="sd">     * Apache License 2.0 for inclusion in this project.</span>
<a id="__codelineno-0-2019" name="__codelineno-0-2019"></a><span class="sd">     * https://github.com/obfusk/x509_canonical_name.py/blob/master/x509_canonical_name.py</span>
<a id="__codelineno-0-2020" name="__codelineno-0-2020"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2021" name="__codelineno-0-2021"></a>
<a id="__codelineno-0-2022" name="__codelineno-0-2022"></a><span class="sd">    Returns canonical representation of `asn1crypto.x509.Name` as str (with raw control characters</span>
<a id="__codelineno-0-2023" name="__codelineno-0-2023"></a><span class="sd">    in places those are not stripped by normalisation).</span>
<a id="__codelineno-0-2024" name="__codelineno-0-2024"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2025" name="__codelineno-0-2025"></a>    <span class="c1"># return &quot;,&quot;.join(&quot;+&quot;.join(f&quot;{t}:{v}&quot; for _, t, v in avas) for avas in self.comparison_name(name))</span>
<a id="__codelineno-0-2026" name="__codelineno-0-2026"></a>    <span class="k">return</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-2027" name="__codelineno-0-2027"></a>        <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">avas</span><span class="p">)</span>
<a id="__codelineno-0-2028" name="__codelineno-0-2028"></a>        <span class="k">for</span> <span class="n">avas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">comparison_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">android</span><span class="o">=</span><span class="n">android</span><span class="p">)</span>
<a id="__codelineno-0-2029" name="__codelineno-0-2029"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.comparison_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">comparison_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">android</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.comparison_name" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a> * Method is dual-licensed under the Apache License 2.0 and GPLv3+.
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a> * The original author has granted permission to use this code snippet under the
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a> * Apache License 2.0 for inclusion in this project.
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a> * https://github.com/obfusk/x509_canonical_name.py/blob/master/x509_canonical_name.py
</code></pre></div>
<p>Canonical representation of x509.Name as nested list.</p>
<p>Returns a list of RDNs which are a list of AVAs which are a (type, value)
tuple, where type is the standard name or dotted OID, and value is the
normalised string representation of the value.</p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2031">2031</a></span>
<span class="normal"><a href="#__codelineno-0-2032">2032</a></span>
<span class="normal"><a href="#__codelineno-0-2033">2033</a></span>
<span class="normal"><a href="#__codelineno-0-2034">2034</a></span>
<span class="normal"><a href="#__codelineno-0-2035">2035</a></span>
<span class="normal"><a href="#__codelineno-0-2036">2036</a></span>
<span class="normal"><a href="#__codelineno-0-2037">2037</a></span>
<span class="normal"><a href="#__codelineno-0-2038">2038</a></span>
<span class="normal"><a href="#__codelineno-0-2039">2039</a></span>
<span class="normal"><a href="#__codelineno-0-2040">2040</a></span>
<span class="normal"><a href="#__codelineno-0-2041">2041</a></span>
<span class="normal"><a href="#__codelineno-0-2042">2042</a></span>
<span class="normal"><a href="#__codelineno-0-2043">2043</a></span>
<span class="normal"><a href="#__codelineno-0-2044">2044</a></span>
<span class="normal"><a href="#__codelineno-0-2045">2045</a></span>
<span class="normal"><a href="#__codelineno-0-2046">2046</a></span>
<span class="normal"><a href="#__codelineno-0-2047">2047</a></span>
<span class="normal"><a href="#__codelineno-0-2048">2048</a></span>
<span class="normal"><a href="#__codelineno-0-2049">2049</a></span>
<span class="normal"><a href="#__codelineno-0-2050">2050</a></span>
<span class="normal"><a href="#__codelineno-0-2051">2051</a></span>
<span class="normal"><a href="#__codelineno-0-2052">2052</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2031" name="__codelineno-0-2031"></a><span class="k">def</span> <span class="nf">comparison_name</span><span class="p">(</span>
<a id="__codelineno-0-2032" name="__codelineno-0-2032"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">x509</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">android</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-2033" name="__codelineno-0-2033"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
<a id="__codelineno-0-2034" name="__codelineno-0-2034"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2035" name="__codelineno-0-2035"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2036" name="__codelineno-0-2036"></a><span class="sd">     * Method is dual-licensed under the Apache License 2.0 and GPLv3+.</span>
<a id="__codelineno-0-2037" name="__codelineno-0-2037"></a><span class="sd">     * The original author has granted permission to use this code snippet under the</span>
<a id="__codelineno-0-2038" name="__codelineno-0-2038"></a><span class="sd">     * Apache License 2.0 for inclusion in this project.</span>
<a id="__codelineno-0-2039" name="__codelineno-0-2039"></a><span class="sd">     * https://github.com/obfusk/x509_canonical_name.py/blob/master/x509_canonical_name.py</span>
<a id="__codelineno-0-2040" name="__codelineno-0-2040"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2041" name="__codelineno-0-2041"></a>
<a id="__codelineno-0-2042" name="__codelineno-0-2042"></a><span class="sd">    Canonical representation of x509.Name as nested list.</span>
<a id="__codelineno-0-2043" name="__codelineno-0-2043"></a>
<a id="__codelineno-0-2044" name="__codelineno-0-2044"></a><span class="sd">    Returns a list of RDNs which are a list of AVAs which are a (type, value)</span>
<a id="__codelineno-0-2045" name="__codelineno-0-2045"></a><span class="sd">    tuple, where type is the standard name or dotted OID, and value is the</span>
<a id="__codelineno-0-2046" name="__codelineno-0-2046"></a><span class="sd">    normalised string representation of the value.</span>
<a id="__codelineno-0-2047" name="__codelineno-0-2047"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2048" name="__codelineno-0-2048"></a>
<a id="__codelineno-0-2049" name="__codelineno-0-2049"></a>    <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-2050" name="__codelineno-0-2050"></a>        <span class="p">[(</span><span class="n">t</span><span class="p">,</span> <span class="n">nv</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">nv</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">avas</span><span class="p">]</span>
<a id="__codelineno-0-2051" name="__codelineno-0-2051"></a>        <span class="k">for</span> <span class="n">avas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">x509_ordered_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">android</span><span class="o">=</span><span class="n">android</span><span class="p">)</span>
<a id="__codelineno-0-2052" name="__codelineno-0-2052"></a>    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.find_certificate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_certificate</span><span class="p">(</span><span class="n">signed_data_certificates</span><span class="p">,</span> <span class="n">signer_info</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.find_certificate" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>From the bag of certs, obtain the certificate referenced by the <code>asn1crypto.cms.SignerInfo</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>signed_data_certificates</code>
            </td>
            <td>
                  <code><span title="asn1crypto.cms.CertificateSet">CertificateSet</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of certificates in the SignedData.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>signer_info</code>
            </td>
            <td>
                  <code><span title="asn1crypto.cms.SignerInfo">SignerInfo</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>SignerInfo</code> object containing the issuer and serial number reference.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="asn1crypto.x509.Certificate">Certificate</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matching certificate if found, otherwise None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1957" name="__codelineno-0-1957"></a><span class="k">def</span> <span class="nf">find_certificate</span><span class="p">(</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1959" name="__codelineno-0-1959"></a>    <span class="n">signed_data_certificates</span><span class="p">:</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">CertificateSet</span><span class="p">,</span>
<a id="__codelineno-0-1960" name="__codelineno-0-1960"></a>    <span class="n">signer_info</span><span class="p">:</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">cms</span><span class="o">.</span><span class="n">SignerInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-1961" name="__codelineno-0-1961"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1962" name="__codelineno-0-1962"></a><span class="sd">    From the bag of certs, obtain the certificate referenced by the `asn1crypto.cms.SignerInfo`.</span>
<a id="__codelineno-0-1963" name="__codelineno-0-1963"></a>
<a id="__codelineno-0-1964" name="__codelineno-0-1964"></a><span class="sd">    :param signed_data_certificates: List of certificates in the SignedData.</span>
<a id="__codelineno-0-1965" name="__codelineno-0-1965"></a><span class="sd">    :param signer_info: `SignerInfo` object containing the issuer and serial number reference.</span>
<a id="__codelineno-0-1966" name="__codelineno-0-1966"></a>
<a id="__codelineno-0-1967" name="__codelineno-0-1967"></a><span class="sd">    :returns: The matching certificate if found, otherwise None.</span>
<a id="__codelineno-0-1968" name="__codelineno-0-1968"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1969" name="__codelineno-0-1969"></a>    <span class="n">matching_certificate</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1970" name="__codelineno-0-1970"></a>    <span class="n">issuer_and_serial_number</span> <span class="o">=</span> <span class="n">signer_info</span><span class="p">[</span><span class="s1">&#39;sid&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1971" name="__codelineno-0-1971"></a>    <span class="n">issuer_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canonical_name</span><span class="p">(</span>
<a id="__codelineno-0-1972" name="__codelineno-0-1972"></a>        <span class="n">issuer_and_serial_number</span><span class="o">.</span><span class="n">chosen</span><span class="p">[</span><span class="s1">&#39;issuer&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1973" name="__codelineno-0-1973"></a>    <span class="p">)</span>
<a id="__codelineno-0-1974" name="__codelineno-0-1974"></a>    <span class="n">serial_number</span> <span class="o">=</span> <span class="n">issuer_and_serial_number</span><span class="o">.</span><span class="n">native</span><span class="p">[</span><span class="s1">&#39;serial_number&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1975" name="__codelineno-0-1975"></a>
<a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>    <span class="c1"># # Create a x509.Name object for the issuer in the SignerInfo</span>
<a id="__codelineno-0-1977" name="__codelineno-0-1977"></a>    <span class="c1"># issuer_name = x509.Name.build(issuer)</span>
<a id="__codelineno-0-1978" name="__codelineno-0-1978"></a>    <span class="c1"># issuer_str = self.canonical_name(issuer_name)</span>
<a id="__codelineno-0-1979" name="__codelineno-0-1979"></a>
<a id="__codelineno-0-1980" name="__codelineno-0-1980"></a>    <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">signed_data_certificates</span><span class="p">:</span>
<a id="__codelineno-0-1981" name="__codelineno-0-1981"></a>        <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;certificate&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1982" name="__codelineno-0-1982"></a>            <span class="n">cert_issuer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canonical_name</span><span class="p">(</span>
<a id="__codelineno-0-1983" name="__codelineno-0-1983"></a>                <span class="n">cert</span><span class="o">.</span><span class="n">chosen</span><span class="p">[</span><span class="s1">&#39;tbs_certificate&#39;</span><span class="p">][</span><span class="s1">&#39;issuer&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1984" name="__codelineno-0-1984"></a>            <span class="p">)</span>
<a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>            <span class="n">cert_serial_number</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">native</span><span class="p">[</span><span class="s1">&#39;tbs_certificate&#39;</span><span class="p">][</span>
<a id="__codelineno-0-1986" name="__codelineno-0-1986"></a>                <span class="s1">&#39;serial_number&#39;</span>
<a id="__codelineno-0-1987" name="__codelineno-0-1987"></a>            <span class="p">]</span>
<a id="__codelineno-0-1988" name="__codelineno-0-1988"></a>
<a id="__codelineno-0-1989" name="__codelineno-0-1989"></a>            <span class="c1"># Compare the canonical string representations of the issuers and the serial numbers</span>
<a id="__codelineno-0-1990" name="__codelineno-0-1990"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1991" name="__codelineno-0-1991"></a>                <span class="n">cert_issuer</span> <span class="o">==</span> <span class="n">issuer_str</span>
<a id="__codelineno-0-1992" name="__codelineno-0-1992"></a>                <span class="ow">and</span> <span class="n">cert_serial_number</span> <span class="o">==</span> <span class="n">serial_number</span>
<a id="__codelineno-0-1993" name="__codelineno-0-1993"></a>            <span class="p">):</span>
<a id="__codelineno-0-1994" name="__codelineno-0-1994"></a>                <span class="n">matching_certificate</span> <span class="o">=</span> <span class="n">cert</span>
<a id="__codelineno-0-1995" name="__codelineno-0-1995"></a>                <span class="k">break</span>
<a id="__codelineno-0-1996" name="__codelineno-0-1996"></a>
<a id="__codelineno-0-1997" name="__codelineno-0-1997"></a>    <span class="k">return</span> <span class="n">matching_certificate</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.find_tags" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_tags</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.find_tags" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of all the matched tags in all available xml</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tag_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify the tag name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the matched tags</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="k">def</span> <span class="nf">find_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">    Return a list of all the matched tags in all available xml</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">    :param tag_name: specify the tag name</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">    :returns: the matched tags</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>    <span class="n">all_tags</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">find_tags_from_xml</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>    <span class="p">]</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">tag</span> <span class="k">for</span> <span class="n">tag_list</span> <span class="ow">in</span> <span class="n">all_tags</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tag_list</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.find_tags_from_xml" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_tags_from_xml</span><span class="p">(</span><span class="n">xml_name</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.find_tags_from_xml" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of all the matched tags in a specific xml</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>xml_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify from which xml to pick the tag from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify the tag name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the matched tags</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="k">def</span> <span class="nf">find_tags_from_xml</span><span class="p">(</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">xml_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">    Return a list of all the matched tags in a specific xml</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">    :param str xml_name: specify from which xml to pick the tag from</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">    :param str tag_name: specify the tag name</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">    :returns: the matched tags</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>    <span class="n">xml</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="n">xml_name</span><span class="p">]</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>    <span class="k">if</span> <span class="n">xml</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>        <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>    <span class="k">if</span> <span class="n">xml</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="n">tag_name</span><span class="p">:</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_tag_matched</span><span class="p">(</span><span class="n">xml</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">):</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">xml</span><span class="p">]</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>        <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>    <span class="n">tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>    <span class="n">tags</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">xml</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//&quot;</span> <span class="o">+</span> <span class="n">tag_name</span><span class="p">))</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>    <span class="c1"># https://github.com/androguard/androguard/pull/1053</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>    <span class="c1"># permission declared using tag &lt;android:uses-permission...</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>    <span class="n">tags</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">xml</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//&quot;</span> <span class="o">+</span> <span class="n">NS_ANDROID</span> <span class="o">+</span> <span class="n">tag_name</span><span class="p">))</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>    <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>        <span class="n">tag</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_tag_matched</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_activities" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_activities</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_activities" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the <code>android:name</code> attribute of all activities</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the list of <code>android:name</code> attribute of all activities</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><span class="k">def</span> <span class="nf">get_activities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">    Return the `android:name` attribute of all activities</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">    :returns: the list of `android:name` attribute of all activities</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="s2">&quot;activity&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_activity_aliases" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_activity_aliases</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_activity_aliases" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the <code>android:name</code> and <code>android:targetActivity</code> attribute of all activity aliases.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[dict[str, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the list of <code>android:name</code> and <code>android:targetActivity</code> attribute of all activitiy aliases</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1290" name="__codelineno-0-1290"></a><span class="k">def</span> <span class="nf">get_activity_aliases</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a><span class="sd">    Return the `android:name` and `android:targetActivity` attribute of all activity aliases.</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a><span class="sd">    :returns: the list of `android:name` and `android:targetActivity` attribute of all activitiy aliases</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>    <span class="n">ali</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>    <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_tags</span><span class="p">(</span><span class="s1">&#39;activity-alias&#39;</span><span class="p">):</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>        <span class="n">activity_alias</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>        <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;targetActivity&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">alias</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> <span class="ow">or</span> <span class="n">alias</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="n">attribute</span><span class="p">))</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>                <span class="k">continue</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>            <span class="n">activity_alias</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>        <span class="k">if</span> <span class="n">activity_alias</span><span class="p">:</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a>            <span class="n">ali</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">activity_alias</span><span class="p">)</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>    <span class="k">return</span> <span class="n">ali</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_all_attribute_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">format_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.get_all_attribute_value" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Yields all the attribute values in xml files which match with the tag name and the specific attribute</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tag_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify the tag name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>attribute</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify the attribute</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>format_value</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify if the value needs to be formatted with packagename</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterator">Iterator</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the attribute values</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><span class="k">def</span> <span class="nf">get_all_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>    <span class="n">tag_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>    <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>    <span class="n">format_value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>    <span class="o">**</span><span class="n">attribute_filter</span><span class="p">,</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">    Yields all the attribute values in xml files which match with the tag name and the specific attribute</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">    :param str tag_name: specify the tag name</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">    :param str attribute: specify the attribute</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">    :param bool format_value: specify if the value needs to be formatted with packagename</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">    :returns: the attribute values</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>    <span class="n">tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_tags</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>    <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="n">attribute</span><span class="p">))</span> <span class="ow">or</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>            <span class="k">if</span> <span class="n">format_value</span><span class="p">:</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>                <span class="k">yield</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_all_dex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_all_dex</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_all_dex" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the raw bytes data of all classes dex files</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterator">Iterator</span>[bytes]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the raw bytes data of all classes dex files</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="k">def</span> <span class="nf">get_all_dex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">    Return the raw bytes data of all classes dex files</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">    :returns: the raw bytes data of all classes dex files</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>    <span class="k">for</span> <span class="n">dex_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dex_names</span><span class="p">():</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">dex_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_android_manifest_axml" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_android_manifest_axml</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_android_manifest_axml" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the <a class="autorefs autorefs-internal" href="../axml/index.html#androguard.core.axml.AXMLPrinter">AXMLPrinter</a> object which corresponds to the <code>AndroidManifest.xml</code> file</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="androguard.core.axml.AXMLPrinter" href="../axml/index.html#androguard.core.axml.AXMLPrinter">AXMLPrinter</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the <code>AXMLPrinter</code> object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2181" name="__codelineno-0-2181"></a><span class="k">def</span> <span class="nf">get_android_manifest_axml</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">AXMLPrinter</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-2182" name="__codelineno-0-2182"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2183" name="__codelineno-0-2183"></a><span class="sd">    Return the [AXMLPrinter][androguard.core.axml.AXMLPrinter] object which corresponds to the `AndroidManifest.xml` file</span>
<a id="__codelineno-0-2184" name="__codelineno-0-2184"></a>
<a id="__codelineno-0-2185" name="__codelineno-0-2185"></a><span class="sd">    :returns: the `AXMLPrinter` object</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2187" name="__codelineno-0-2187"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="p">[</span><span class="s2">&quot;AndroidManifest.xml&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2189" name="__codelineno-0-2189"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2190" name="__codelineno-0-2190"></a>        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_android_manifest_xml" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_android_manifest_xml</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_android_manifest_xml" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the parsed xml object which corresponds to the <code>AndroidManifest.xml</code> file</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="lxml.etree.Element">Element</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the parsed xml object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2192" name="__codelineno-0-2192"></a><span class="k">def</span> <span class="nf">get_android_manifest_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2194" name="__codelineno-0-2194"></a><span class="sd">    Return the parsed xml object which corresponds to the `AndroidManifest.xml` file</span>
<a id="__codelineno-0-2195" name="__codelineno-0-2195"></a>
<a id="__codelineno-0-2196" name="__codelineno-0-2196"></a><span class="sd">    :returns: the parsed xml object</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2199" name="__codelineno-0-2199"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="s2">&quot;AndroidManifest.xml&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2201" name="__codelineno-0-2201"></a>        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_android_resources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_android_resources</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_android_resources" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the <a class="autorefs autorefs-internal" href="../axml/index.html#androguard.core.axml.ARSCParser">ARSCParser</a> object which corresponds to the <code>resources.arsc</code> file</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCParser" href="../axml/index.html#androguard.core.axml.ARSCParser">ARSCParser</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the <code>ARSCParser</code> object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span>
<span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span>
<span class="normal"><a href="#__codelineno-0-2207">2207</a></span>
<span class="normal"><a href="#__codelineno-0-2208">2208</a></span>
<span class="normal"><a href="#__codelineno-0-2209">2209</a></span>
<span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2203" name="__codelineno-0-2203"></a><span class="k">def</span> <span class="nf">get_android_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">ARSCParser</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-2204" name="__codelineno-0-2204"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2205" name="__codelineno-0-2205"></a><span class="sd">    Return the [ARSCParser][androguard.core.axml.ARSCParser] object which corresponds to the `resources.arsc` file</span>
<a id="__codelineno-0-2206" name="__codelineno-0-2206"></a>
<a id="__codelineno-0-2207" name="__codelineno-0-2207"></a><span class="sd">    :returns: the `ARSCParser` object</span>
<a id="__codelineno-0-2208" name="__codelineno-0-2208"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2209" name="__codelineno-0-2209"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2210" name="__codelineno-0-2210"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">arsc</span><span class="p">[</span><span class="s2">&quot;resources.arsc&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2211" name="__codelineno-0-2211"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2212" name="__codelineno-0-2212"></a>        <span class="k">if</span> <span class="s2">&quot;resources.arsc&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">namelist</span><span class="p">():</span>
<a id="__codelineno-0-2213" name="__codelineno-0-2213"></a>            <span class="c1"># There is a rare case, that no resource file is supplied.</span>
<a id="__codelineno-0-2214" name="__codelineno-0-2214"></a>            <span class="c1"># Maybe it was added manually, thus we check here</span>
<a id="__codelineno-0-2215" name="__codelineno-0-2215"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-2216" name="__codelineno-0-2216"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">arsc</span><span class="p">[</span><span class="s2">&quot;resources.arsc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ARSCParser</span><span class="p">(</span>
<a id="__codelineno-0-2217" name="__codelineno-0-2217"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;resources.arsc&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2218" name="__codelineno-0-2218"></a>        <span class="p">)</span>
<a id="__codelineno-0-2219" name="__codelineno-0-2219"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">arsc</span><span class="p">[</span><span class="s2">&quot;resources.arsc&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_androidversion_code" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_androidversion_code</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_androidversion_code" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the android version code</p>
<p>This information is read from the <code>AndroidManifest.xml</code></p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the android version code</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="k">def</span> <span class="nf">get_androidversion_code</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">    Return the android version code</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">    This information is read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">    :returns: the android version code</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">androidversion</span><span class="p">[</span><span class="s2">&quot;Code&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_androidversion_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_androidversion_name</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_androidversion_name" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the android version name</p>
<p>This information is read from the <code>AndroidManifest.xml</code></p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the android version name</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="k">def</span> <span class="nf">get_androidversion_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">    Return the android version name</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">    This information is read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">    :returns: the android version name</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">androidversion</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_app_icon" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_app_icon</span><span class="p">(</span><span class="n">max_dpi</span><span class="o">=</span><span class="mi">65536</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.get_app_icon" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the first icon file name, which density is not greater than max_dpi,
unless exact icon resolution is set in the manifest, in which case
return the exact file.</p>
<p>This information is read from the <code>AndroidManifest.xml</code></p>
<p>From <a href="https://developer.android.com/guide/practices/screens_support.html">https://developer.android.com/guide/practices/screens_support.html</a>
and <a href="https://developer.android.com/ndk/reference/group___configuration.html">https://developer.android.com/ndk/reference/group___configuration.html</a></p>
<ul>
<li>DEFAULT                             0dpi</li>
<li>ldpi (low)                        120dpi</li>
<li>mdpi (medium)                     160dpi</li>
<li>TV                                213dpi</li>
<li>hdpi (high)                       240dpi</li>
<li>xhdpi (extra-high)                320dpi</li>
<li>xxhdpi (extra-extra-high)         480dpi</li>
<li>xxxhdpi (extra-extra-extra-high)  640dpi</li>
<li>anydpi                          65534dpi (0xFFFE)</li>
<li>nodpi                           65535dpi (0xFFFF)</li>
</ul>
<p>There is a difference between nodpi and anydpi:
nodpi will be used if no other density is specified. Or the density does not match.
nodpi is the fallback for everything else. If there is a resource that matches the DPI,
this is used.
anydpi is also valid for all densities but in this case, anydpi will overrule all other files!
Therefore anydpi is usually used with vector graphics and with constraints on the API level.
For example adaptive icons are usually marked as anydpi.</p>
<p>When it comes now to selecting an icon, there is the following flow:</p>
<ol>
<li>is there an anydpi icon?</li>
<li>is there an icon for the dpi of the device?</li>
<li>is there a nodpi icon?</li>
<li>(only on very old devices) is there a icon with dpi 0 (the default)</li>
</ol>
<p>For more information read here: <a href="https://stackoverflow.com/a/34370735/446140">https://stackoverflow.com/a/34370735/446140</a></p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the first icon file name, or None if no resources or app icon exists.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="k">def</span> <span class="nf">get_app_icon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_dpi</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">65536</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">    Return the first icon file name, which density is not greater than max_dpi,</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">    unless exact icon resolution is set in the manifest, in which case</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">    return the exact file.</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">    This information is read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">    From &lt;https://developer.android.com/guide/practices/screens_support.html&gt;</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">    and &lt;https://developer.android.com/ndk/reference/group___configuration.html&gt;</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">    * DEFAULT                             0dpi</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">    * ldpi (low)                        120dpi</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">    * mdpi (medium)                     160dpi</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">    * TV                                213dpi</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a><span class="sd">    * hdpi (high)                       240dpi</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">    * xhdpi (extra-high)                320dpi</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">    * xxhdpi (extra-extra-high)         480dpi</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">    * xxxhdpi (extra-extra-extra-high)  640dpi</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">    * anydpi                          65534dpi (0xFFFE)</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">    * nodpi                           65535dpi (0xFFFF)</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="sd">    There is a difference between nodpi and anydpi:</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">    nodpi will be used if no other density is specified. Or the density does not match.</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">    nodpi is the fallback for everything else. If there is a resource that matches the DPI,</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">    this is used.</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">    anydpi is also valid for all densities but in this case, anydpi will overrule all other files!</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a><span class="sd">    Therefore anydpi is usually used with vector graphics and with constraints on the API level.</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="sd">    For example adaptive icons are usually marked as anydpi.</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">    When it comes now to selecting an icon, there is the following flow:</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a><span class="sd">    1. is there an anydpi icon?</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">    2. is there an icon for the dpi of the device?</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">    3. is there a nodpi icon?</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="sd">    4. (only on very old devices) is there a icon with dpi 0 (the default)</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">    For more information read here: &lt;https://stackoverflow.com/a/34370735/446140&gt;</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">    :returns: the first icon file name, or None if no resources or app icon exists.</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>    <span class="n">main_activity_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_main_activity</span><span class="p">()</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>    <span class="n">app_icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>        <span class="s1">&#39;activity&#39;</span><span class="p">,</span> <span class="s1">&#39;icon&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">main_activity_name</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>    <span class="p">)</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">app_icon</span><span class="p">:</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>        <span class="n">app_icon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span><span class="s1">&#39;application&#39;</span><span class="p">,</span> <span class="s1">&#39;icon&#39;</span><span class="p">)</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>    <span class="n">res_parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_android_resources</span><span class="p">()</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">res_parser</span><span class="p">:</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>        <span class="c1"># Can not do anything below this point to resolve...</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">app_icon</span><span class="p">:</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>        <span class="n">res_id</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">get_res_id_by_key</span><span class="p">(</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">package</span><span class="p">,</span> <span class="s1">&#39;mipmap&#39;</span><span class="p">,</span> <span class="s1">&#39;ic_launcher&#39;</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>        <span class="p">)</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>        <span class="k">if</span> <span class="n">res_id</span><span class="p">:</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>            <span class="n">app_icon</span> <span class="o">=</span> <span class="s2">&quot;@</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">res_id</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">app_icon</span><span class="p">:</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>        <span class="n">res_id</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">get_res_id_by_key</span><span class="p">(</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">package</span><span class="p">,</span> <span class="s1">&#39;drawable&#39;</span><span class="p">,</span> <span class="s1">&#39;ic_launcher&#39;</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="p">)</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="k">if</span> <span class="n">res_id</span><span class="p">:</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="n">app_icon</span> <span class="o">=</span> <span class="s2">&quot;@</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">res_id</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">app_icon</span><span class="p">:</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>        <span class="c1"># If the icon can not be found, return now</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>    <span class="k">if</span> <span class="n">app_icon</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">):</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>        <span class="n">app_icon_id</span> <span class="o">=</span> <span class="n">app_icon</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>        <span class="n">app_icon_id</span> <span class="o">=</span> <span class="n">app_icon_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>        <span class="n">res_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">app_icon_id</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>        <span class="n">candidates</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">get_resolved_res_configs</span><span class="p">(</span><span class="n">res_id</span><span class="p">)</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="n">app_icon</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>        <span class="n">current_dpi</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>            <span class="k">for</span> <span class="n">config</span><span class="p">,</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>                <span class="n">dpi</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_density</span><span class="p">()</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>                <span class="k">if</span> <span class="n">current_dpi</span> <span class="o">&lt;</span> <span class="n">dpi</span> <span class="o">&lt;=</span> <span class="n">max_dpi</span><span class="p">:</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>                    <span class="n">app_icon</span> <span class="o">=</span> <span class="n">file_name</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>                    <span class="n">current_dpi</span> <span class="o">=</span> <span class="n">dpi</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Exception selecting app icon: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>    <span class="k">return</span> <span class="n">app_icon</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_app_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_app_name</span><span class="p">(</span><span class="n">locale</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.get_app_name" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the appname of the APK
This name is read from the <code>AndroidManifest.xml</code>
using the application <code>android:label</code>.
If no label exists, the <code>android:label</code> of the main activity is used.</p>
<p>If there is also no main activity label, an empty string is returned.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the appname of the APK</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="k">def</span> <span class="nf">get_app_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">    Return the appname of the APK</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">    This name is read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">    using the application `android:label`.</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">    If no label exists, the `android:label` of the main activity is used.</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">    If there is also no main activity label, an empty string is returned.</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">    :returns: the appname of the APK</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>    <span class="n">app_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span><span class="s1">&#39;application&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>    <span class="k">if</span> <span class="n">app_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="n">activities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_main_activities</span><span class="p">()</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="n">main_activity_name</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">activities</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>            <span class="n">main_activity_name</span> <span class="o">=</span> <span class="n">activities</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="c1"># FIXME: would need to use _format_value inside get_attribute_value for each returned name!</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="c1"># For example, as the activity name might be foobar.foo.bar but inside the activity it is only .bar</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="n">app_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>            <span class="s1">&#39;activity&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">main_activity_name</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="p">)</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>    <span class="k">if</span> <span class="n">app_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>        <span class="c1"># No App name set</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>        <span class="c1"># TODO return packagename instead?</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>            <span class="s2">&quot;It looks like that no app name is set for the main activity!&quot;</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="p">)</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="k">if</span> <span class="n">app_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">):</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>        <span class="n">res_parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_android_resources</span><span class="p">()</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">res_parser</span><span class="p">:</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>            <span class="c1"># TODO: What should be the correct return value here?</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>            <span class="k">return</span> <span class="n">app_name</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>        <span class="n">res_id</span><span class="p">,</span> <span class="n">package</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">parse_id</span><span class="p">(</span><span class="n">app_name</span><span class="p">)</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>        <span class="c1"># If the package name is the same as the APK package,</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>        <span class="c1"># we should be able to resolve the ID.</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>        <span class="k">if</span> <span class="n">package</span> <span class="ow">and</span> <span class="n">package</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_package</span><span class="p">():</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>            <span class="k">if</span> <span class="n">package</span> <span class="o">==</span> <span class="s1">&#39;android&#39;</span><span class="p">:</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>                <span class="c1"># TODO: we can not resolve this, as we lack framework-res.apk</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>                <span class="c1"># one exception would be when parsing framework-res.apk directly.</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                    <span class="s2">&quot;Resource ID with android package name encountered! &quot;</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>                    <span class="s2">&quot;Will not resolve, framework-res.apk would be required.&quot;</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>                <span class="p">)</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>                <span class="k">return</span> <span class="n">app_name</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>                <span class="c1"># TODO should look this up, might be in the resources</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>                    <span class="s2">&quot;Resource ID with Package name &#39;</span><span class="si">{}</span><span class="s2">&#39; encountered! Will not resolve&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>                        <span class="n">package</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>                    <span class="p">)</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>                <span class="p">)</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>                <span class="k">return</span> <span class="n">app_name</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>            <span class="n">config</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>                <span class="n">ARSCResTableConfig</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="n">locale</span><span class="p">)</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>                <span class="k">if</span> <span class="n">locale</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>                <span class="k">else</span> <span class="n">ARSCResTableConfig</span><span class="o">.</span><span class="n">default_config</span><span class="p">()</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>            <span class="p">)</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>            <span class="n">app_name</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">get_resolved_res_configs</span><span class="p">(</span><span class="n">res_id</span><span class="p">,</span> <span class="n">config</span><span class="p">)[</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>                <span class="mi">0</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>            <span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Exception selecting app name: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>    <span class="k">return</span> <span class="n">app_name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_attribute_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_attribute_value</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">format_value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.get_attribute_value" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the attribute value in xml files which matches the tag name and the specific attribute</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tag_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify the tag name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>attribute</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify the attribute</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>format_value</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify if the value needs to be formatted with packagename</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the attribute value</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="k">def</span> <span class="nf">get_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>    <span class="n">tag_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>    <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>    <span class="n">format_value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>    <span class="o">**</span><span class="n">attribute_filter</span><span class="p">,</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">    Return the attribute value in xml files which matches the tag name and the specific attribute</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">    :param str tag_name: specify the tag name</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">    :param str attribute: specify the attribute</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="sd">    :param bool format_value: specify if the value needs to be formatted with packagename</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">    :returns: the attribute value</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>        <span class="n">tag_name</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">format_value</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>    <span class="p">):</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>            <span class="k">return</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_certificate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_certificate</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.get_certificate" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a X.509 certificate object by giving the name in the apk file</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename of the signature file in the APK</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="asn1crypto.x509.Certificate">Certificate</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the certificate object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1999" name="__codelineno-0-1999"></a><span class="k">def</span> <span class="nf">get_certificate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-2000" name="__codelineno-0-2000"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2001" name="__codelineno-0-2001"></a><span class="sd">    Return a X.509 certificate object by giving the name in the apk file</span>
<a id="__codelineno-0-2002" name="__codelineno-0-2002"></a>
<a id="__codelineno-0-2003" name="__codelineno-0-2003"></a><span class="sd">    :param filename: filename of the signature file in the APK</span>
<a id="__codelineno-0-2004" name="__codelineno-0-2004"></a><span class="sd">    :returns: the certificate object</span>
<a id="__codelineno-0-2005" name="__codelineno-0-2005"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2006" name="__codelineno-0-2006"></a>    <span class="n">cert</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificate_der</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-2007" name="__codelineno-0-2007"></a>    <span class="k">if</span> <span class="n">cert</span><span class="p">:</span>
<a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>        <span class="n">certificate</span> <span class="o">=</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2009" name="__codelineno-0-2009"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2010" name="__codelineno-0-2010"></a>        <span class="n">certificate</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2011" name="__codelineno-0-2011"></a>    <span class="k">return</span> <span class="n">certificate</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_certificate_der" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_certificate_der</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">max_sdk_version</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.get_certificate_der" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the DER coded X.509 certificate from the signature file.
If minSdkVersion is prior to Android N only the first SignerInfo is used.
If signed attributes are present, they are taken into account
Note that unsupported critical extensions and key usage are not verified!
<a href="https://android.googlesource.com/platform/tools/apksig/+/refs/tags/platform-tools-34.0.5/src/main/java/com/android/apksig/internal/apk/v1/V1SchemeVerifier.java#668">V1SchemeVerifier.java</a></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Signature filename in APK</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_sdk_version</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional integer parameter for the max sdk version</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[bytes, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DER coded X.509 certificate as binary or None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1715" name="__codelineno-0-1715"></a><span class="k">def</span> <span class="nf">get_certificate_der</span><span class="p">(</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_sdk_version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a><span class="sd">    Return the DER coded X.509 certificate from the signature file.</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a><span class="sd">    If minSdkVersion is prior to Android N only the first SignerInfo is used.</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a><span class="sd">    If signed attributes are present, they are taken into account</span>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a><span class="sd">    Note that unsupported critical extensions and key usage are not verified!</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a><span class="sd">    [V1SchemeVerifier.java](https://android.googlesource.com/platform/tools/apksig/+/refs/tags/platform-tools-34.0.5/src/main/java/com/android/apksig/internal/apk/v1/V1SchemeVerifier.java#668)</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a><span class="sd">    :param filename: Signature filename in APK</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a><span class="sd">    :param max_sdk_version: An optional integer parameter for the max sdk version</span>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a><span class="sd">    :returns: DER coded X.509 certificate as binary or None</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>    <span class="c1"># Get the signature</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>    <span class="n">pkcs7message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>    <span class="c1"># Get the .SF</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>    <span class="n">sf_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.SF&#39;</span>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>    <span class="n">sf_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">sf_filename</span><span class="p">)</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a>    <span class="c1"># Load the signature</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>    <span class="n">signed_data</span> <span class="o">=</span> <span class="n">cms</span><span class="o">.</span><span class="n">ContentInfo</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pkcs7message</span><span class="p">)</span>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>    <span class="c1"># Locate the SignerInfo structure</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>    <span class="n">signer_infos</span> <span class="o">=</span> <span class="n">signed_data</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">][</span><span class="s1">&#39;signer_infos&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">signer_infos</span><span class="p">:</span>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>            <span class="s1">&#39;No signer information found in the PKCS7 object. The APK may not be properly signed.&#39;</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>        <span class="p">)</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>    <span class="c1"># Prior to Android N, Android attempts to verify only the first SignerInfo. From N onwards, Android attempts</span>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>    <span class="c1"># to verify all SignerInfos and then picks the first verified SignerInfo.</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>    <span class="n">min_sdk_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_min_sdk_version</span><span class="p">()</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>        <span class="n">min_sdk_version</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">min_sdk_version</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">24</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>    <span class="p">):</span>  <span class="c1"># AndroidSdkVersion.N</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>            <span class="sa">f</span><span class="s2">&quot;minSdkVersion: </span><span class="si">{</span><span class="n">min_sdk_version</span><span class="si">}</span><span class="s2"> is less than 24. Getting the first signerInfo only!&quot;</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>        <span class="p">)</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>        <span class="n">unverified_signer_infos_to_try</span> <span class="o">=</span> <span class="p">[</span><span class="n">signer_infos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>        <span class="n">unverified_signer_infos_to_try</span> <span class="o">=</span> <span class="n">signer_infos</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>    <span class="c1"># Extract certificates from the PKCS7 object</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>    <span class="n">certificates</span> <span class="o">=</span> <span class="n">signed_data</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">][</span><span class="s1">&#39;certificates&#39;</span><span class="p">]</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>    <span class="n">return_certificate</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>    <span class="n">list_certificates_verified</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>    <span class="k">for</span> <span class="n">signer_info</span> <span class="ow">in</span> <span class="n">unverified_signer_infos_to_try</span><span class="p">:</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>            <span class="n">matching_certificate_verified</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">verify_signer_info_against_sig_file</span><span class="p">(</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>                    <span class="n">signed_data</span><span class="p">,</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>                    <span class="n">certificates</span><span class="p">,</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>                    <span class="n">signer_info</span><span class="p">,</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>                    <span class="n">sf_object</span><span class="p">,</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>                    <span class="n">max_sdk_version</span><span class="p">,</span>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>                <span class="p">)</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>            <span class="p">)</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">,</span> <span class="n">InvalidSignature</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>                <span class="sa">f</span><span class="s2">&quot;The following exception was raised while verifying the certificate: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a>            <span class="p">)</span>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a>            <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>                <span class="kc">None</span>  <span class="c1"># the validation stops due to the exception raised!</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>            <span class="p">)</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>        <span class="k">if</span> <span class="n">matching_certificate_verified</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>            <span class="n">list_certificates_verified</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>                <span class="n">matching_certificate_verified</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a>            <span class="p">)</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">list_certificates_verified</span><span class="p">:</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>            <span class="sa">f</span><span class="s2">&quot;minSdkVersion: </span><span class="si">{</span><span class="n">min_sdk_version</span><span class="si">}</span><span class="s2">, # of SignerInfos: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">unverified_signer_infos_to_try</span><span class="p">)</span><span class="si">}</span><span class="s2">. None Verified!&quot;</span>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a>        <span class="p">)</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a>        <span class="n">return_certificate</span> <span class="o">=</span> <span class="n">list_certificates_verified</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a>    <span class="k">return</span> <span class="n">return_certificate</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_certificates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_certificates</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_certificates" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of unique <code>asn1crypto.x509.Certificate</code> which are found
in v1, v2 and v3 signing
Note that we simply extract all certificates regardless of the signer.
Therefore this is just a list of all certificates found in all signers.
Exception is v1, for which the certificate returned is verified.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[<span title="asn1crypto.x509.Certificate">Certificate</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of the found <code>asn1crypto.x509.Certificate</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2723">2723</a></span>
<span class="normal"><a href="#__codelineno-0-2724">2724</a></span>
<span class="normal"><a href="#__codelineno-0-2725">2725</a></span>
<span class="normal"><a href="#__codelineno-0-2726">2726</a></span>
<span class="normal"><a href="#__codelineno-0-2727">2727</a></span>
<span class="normal"><a href="#__codelineno-0-2728">2728</a></span>
<span class="normal"><a href="#__codelineno-0-2729">2729</a></span>
<span class="normal"><a href="#__codelineno-0-2730">2730</a></span>
<span class="normal"><a href="#__codelineno-0-2731">2731</a></span>
<span class="normal"><a href="#__codelineno-0-2732">2732</a></span>
<span class="normal"><a href="#__codelineno-0-2733">2733</a></span>
<span class="normal"><a href="#__codelineno-0-2734">2734</a></span>
<span class="normal"><a href="#__codelineno-0-2735">2735</a></span>
<span class="normal"><a href="#__codelineno-0-2736">2736</a></span>
<span class="normal"><a href="#__codelineno-0-2737">2737</a></span>
<span class="normal"><a href="#__codelineno-0-2738">2738</a></span>
<span class="normal"><a href="#__codelineno-0-2739">2739</a></span>
<span class="normal"><a href="#__codelineno-0-2740">2740</a></span>
<span class="normal"><a href="#__codelineno-0-2741">2741</a></span>
<span class="normal"><a href="#__codelineno-0-2742">2742</a></span>
<span class="normal"><a href="#__codelineno-0-2743">2743</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2723" name="__codelineno-0-2723"></a><span class="k">def</span> <span class="nf">get_certificates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">]:</span>
<a id="__codelineno-0-2724" name="__codelineno-0-2724"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2725" name="__codelineno-0-2725"></a><span class="sd">    Return a list of unique `asn1crypto.x509.Certificate` which are found</span>
<a id="__codelineno-0-2726" name="__codelineno-0-2726"></a><span class="sd">    in v1, v2 and v3 signing</span>
<a id="__codelineno-0-2727" name="__codelineno-0-2727"></a><span class="sd">    Note that we simply extract all certificates regardless of the signer.</span>
<a id="__codelineno-0-2728" name="__codelineno-0-2728"></a><span class="sd">    Therefore this is just a list of all certificates found in all signers.</span>
<a id="__codelineno-0-2729" name="__codelineno-0-2729"></a><span class="sd">    Exception is v1, for which the certificate returned is verified.</span>
<a id="__codelineno-0-2730" name="__codelineno-0-2730"></a>
<a id="__codelineno-0-2731" name="__codelineno-0-2731"></a><span class="sd">    :returns: a list of the found `asn1crypto.x509.Certificate`</span>
<a id="__codelineno-0-2732" name="__codelineno-0-2732"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2733" name="__codelineno-0-2733"></a>    <span class="n">fps</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2734" name="__codelineno-0-2734"></a>    <span class="n">certs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2735" name="__codelineno-0-2735"></a>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span>
<a id="__codelineno-0-2736" name="__codelineno-0-2736"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_certificates_v1</span><span class="p">()</span>
<a id="__codelineno-0-2737" name="__codelineno-0-2737"></a>        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificates_v2</span><span class="p">()</span>
<a id="__codelineno-0-2738" name="__codelineno-0-2738"></a>        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificates_v3</span><span class="p">()</span>
<a id="__codelineno-0-2739" name="__codelineno-0-2739"></a>    <span class="p">):</span>
<a id="__codelineno-0-2740" name="__codelineno-0-2740"></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">sha256</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fps</span><span class="p">:</span>
<a id="__codelineno-0-2741" name="__codelineno-0-2741"></a>            <span class="n">fps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sha256</span><span class="p">)</span>
<a id="__codelineno-0-2742" name="__codelineno-0-2742"></a>            <span class="n">certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-2743" name="__codelineno-0-2743"></a>    <span class="k">return</span> <span class="n">certs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_certificates_der_v2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_certificates_der_v2</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_certificates_der_v2" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of DER coded X.509 certificates from the v3 signature block</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[bytes]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the list of public key bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2640">2640</a></span>
<span class="normal"><a href="#__codelineno-0-2641">2641</a></span>
<span class="normal"><a href="#__codelineno-0-2642">2642</a></span>
<span class="normal"><a href="#__codelineno-0-2643">2643</a></span>
<span class="normal"><a href="#__codelineno-0-2644">2644</a></span>
<span class="normal"><a href="#__codelineno-0-2645">2645</a></span>
<span class="normal"><a href="#__codelineno-0-2646">2646</a></span>
<span class="normal"><a href="#__codelineno-0-2647">2647</a></span>
<span class="normal"><a href="#__codelineno-0-2648">2648</a></span>
<span class="normal"><a href="#__codelineno-0-2649">2649</a></span>
<span class="normal"><a href="#__codelineno-0-2650">2650</a></span>
<span class="normal"><a href="#__codelineno-0-2651">2651</a></span>
<span class="normal"><a href="#__codelineno-0-2652">2652</a></span>
<span class="normal"><a href="#__codelineno-0-2653">2653</a></span>
<span class="normal"><a href="#__codelineno-0-2654">2654</a></span>
<span class="normal"><a href="#__codelineno-0-2655">2655</a></span>
<span class="normal"><a href="#__codelineno-0-2656">2656</a></span>
<span class="normal"><a href="#__codelineno-0-2657">2657</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2640" name="__codelineno-0-2640"></a><span class="k">def</span> <span class="nf">get_certificates_der_v2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-0-2641" name="__codelineno-0-2641"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2642" name="__codelineno-0-2642"></a><span class="sd">    Return a list of DER coded X.509 certificates from the v3 signature block</span>
<a id="__codelineno-0-2643" name="__codelineno-0-2643"></a>
<a id="__codelineno-0-2644" name="__codelineno-0-2644"></a><span class="sd">    :returns: the list of public key bytes</span>
<a id="__codelineno-0-2645" name="__codelineno-0-2645"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2646" name="__codelineno-0-2646"></a>
<a id="__codelineno-0-2647" name="__codelineno-0-2647"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2648" name="__codelineno-0-2648"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parse_v2_signing_block</span><span class="p">()</span>
<a id="__codelineno-0-2649" name="__codelineno-0-2649"></a>
<a id="__codelineno-0-2650" name="__codelineno-0-2650"></a>    <span class="n">certs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2651" name="__codelineno-0-2651"></a>    <span class="k">for</span> <span class="n">signed_data</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-2652" name="__codelineno-0-2652"></a>        <span class="n">signer</span><span class="o">.</span><span class="n">signed_data</span> <span class="k">for</span> <span class="n">signer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span>
<a id="__codelineno-0-2653" name="__codelineno-0-2653"></a>    <span class="p">]:</span>
<a id="__codelineno-0-2654" name="__codelineno-0-2654"></a>        <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">certificates</span><span class="p">:</span>
<a id="__codelineno-0-2655" name="__codelineno-0-2655"></a>            <span class="n">certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2656" name="__codelineno-0-2656"></a>
<a id="__codelineno-0-2657" name="__codelineno-0-2657"></a>    <span class="k">return</span> <span class="n">certs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_certificates_der_v3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_certificates_der_v3</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_certificates_der_v3" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of DER coded X.509 certificates from the v3 signature block</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[bytes]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the list of public key bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2621">2621</a></span>
<span class="normal"><a href="#__codelineno-0-2622">2622</a></span>
<span class="normal"><a href="#__codelineno-0-2623">2623</a></span>
<span class="normal"><a href="#__codelineno-0-2624">2624</a></span>
<span class="normal"><a href="#__codelineno-0-2625">2625</a></span>
<span class="normal"><a href="#__codelineno-0-2626">2626</a></span>
<span class="normal"><a href="#__codelineno-0-2627">2627</a></span>
<span class="normal"><a href="#__codelineno-0-2628">2628</a></span>
<span class="normal"><a href="#__codelineno-0-2629">2629</a></span>
<span class="normal"><a href="#__codelineno-0-2630">2630</a></span>
<span class="normal"><a href="#__codelineno-0-2631">2631</a></span>
<span class="normal"><a href="#__codelineno-0-2632">2632</a></span>
<span class="normal"><a href="#__codelineno-0-2633">2633</a></span>
<span class="normal"><a href="#__codelineno-0-2634">2634</a></span>
<span class="normal"><a href="#__codelineno-0-2635">2635</a></span>
<span class="normal"><a href="#__codelineno-0-2636">2636</a></span>
<span class="normal"><a href="#__codelineno-0-2637">2637</a></span>
<span class="normal"><a href="#__codelineno-0-2638">2638</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2621" name="__codelineno-0-2621"></a><span class="k">def</span> <span class="nf">get_certificates_der_v3</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-0-2622" name="__codelineno-0-2622"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2623" name="__codelineno-0-2623"></a><span class="sd">    Return a list of DER coded X.509 certificates from the v3 signature block</span>
<a id="__codelineno-0-2624" name="__codelineno-0-2624"></a>
<a id="__codelineno-0-2625" name="__codelineno-0-2625"></a><span class="sd">    :returns: the list of public key bytes</span>
<a id="__codelineno-0-2626" name="__codelineno-0-2626"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2627" name="__codelineno-0-2627"></a>
<a id="__codelineno-0-2628" name="__codelineno-0-2628"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2629" name="__codelineno-0-2629"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parse_v3_signing_block</span><span class="p">()</span>
<a id="__codelineno-0-2630" name="__codelineno-0-2630"></a>
<a id="__codelineno-0-2631" name="__codelineno-0-2631"></a>    <span class="n">certs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2632" name="__codelineno-0-2632"></a>    <span class="k">for</span> <span class="n">signed_data</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-2633" name="__codelineno-0-2633"></a>        <span class="n">signer</span><span class="o">.</span><span class="n">signed_data</span> <span class="k">for</span> <span class="n">signer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span>
<a id="__codelineno-0-2634" name="__codelineno-0-2634"></a>    <span class="p">]:</span>
<a id="__codelineno-0-2635" name="__codelineno-0-2635"></a>        <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">certificates</span><span class="p">:</span>
<a id="__codelineno-0-2636" name="__codelineno-0-2636"></a>            <span class="n">certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2637" name="__codelineno-0-2637"></a>
<a id="__codelineno-0-2638" name="__codelineno-0-2638"></a>    <span class="k">return</span> <span class="n">certs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_certificates_v1" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_certificates_v1</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_certificates_v1" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of verified <code>asn1crypto.x509.Certificate</code> which are found
in the META-INF folder (v1 signing).</p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2711">2711</a></span>
<span class="normal"><a href="#__codelineno-0-2712">2712</a></span>
<span class="normal"><a href="#__codelineno-0-2713">2713</a></span>
<span class="normal"><a href="#__codelineno-0-2714">2714</a></span>
<span class="normal"><a href="#__codelineno-0-2715">2715</a></span>
<span class="normal"><a href="#__codelineno-0-2716">2716</a></span>
<span class="normal"><a href="#__codelineno-0-2717">2717</a></span>
<span class="normal"><a href="#__codelineno-0-2718">2718</a></span>
<span class="normal"><a href="#__codelineno-0-2719">2719</a></span>
<span class="normal"><a href="#__codelineno-0-2720">2720</a></span>
<span class="normal"><a href="#__codelineno-0-2721">2721</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2711" name="__codelineno-0-2711"></a><span class="k">def</span> <span class="nf">get_certificates_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]:</span>
<a id="__codelineno-0-2712" name="__codelineno-0-2712"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2713" name="__codelineno-0-2713"></a><span class="sd">    Return a list of verified `asn1crypto.x509.Certificate` which are found</span>
<a id="__codelineno-0-2714" name="__codelineno-0-2714"></a><span class="sd">    in the META-INF folder (v1 signing).</span>
<a id="__codelineno-0-2715" name="__codelineno-0-2715"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2716" name="__codelineno-0-2716"></a>    <span class="n">certs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2717" name="__codelineno-0-2717"></a>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signature_names</span><span class="p">():</span>
<a id="__codelineno-0-2718" name="__codelineno-0-2718"></a>        <span class="n">cc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificate_der</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-2719" name="__codelineno-0-2719"></a>        <span class="k">if</span> <span class="n">cc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2720" name="__codelineno-0-2720"></a>            <span class="n">certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
<a id="__codelineno-0-2721" name="__codelineno-0-2721"></a>    <span class="k">return</span> <span class="n">certs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_certificates_v2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_certificates_v2</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_certificates_v2" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of <code>asn1crypto.x509.Certificate</code> which are found
in the v2 signing block.
Note that we simply extract all certificates regardless of the signer.
Therefore this is just a list of all certificates found in all signers.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[<span title="asn1crypto.x509.Certificate">Certificate</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of the found <code>asn1crypto.x509.Certificate</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2697">2697</a></span>
<span class="normal"><a href="#__codelineno-0-2698">2698</a></span>
<span class="normal"><a href="#__codelineno-0-2699">2699</a></span>
<span class="normal"><a href="#__codelineno-0-2700">2700</a></span>
<span class="normal"><a href="#__codelineno-0-2701">2701</a></span>
<span class="normal"><a href="#__codelineno-0-2702">2702</a></span>
<span class="normal"><a href="#__codelineno-0-2703">2703</a></span>
<span class="normal"><a href="#__codelineno-0-2704">2704</a></span>
<span class="normal"><a href="#__codelineno-0-2705">2705</a></span>
<span class="normal"><a href="#__codelineno-0-2706">2706</a></span>
<span class="normal"><a href="#__codelineno-0-2707">2707</a></span>
<span class="normal"><a href="#__codelineno-0-2708">2708</a></span>
<span class="normal"><a href="#__codelineno-0-2709">2709</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2697" name="__codelineno-0-2697"></a><span class="k">def</span> <span class="nf">get_certificates_v2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">]:</span>
<a id="__codelineno-0-2698" name="__codelineno-0-2698"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2699" name="__codelineno-0-2699"></a><span class="sd">    Return a list of `asn1crypto.x509.Certificate` which are found</span>
<a id="__codelineno-0-2700" name="__codelineno-0-2700"></a><span class="sd">    in the v2 signing block.</span>
<a id="__codelineno-0-2701" name="__codelineno-0-2701"></a><span class="sd">    Note that we simply extract all certificates regardless of the signer.</span>
<a id="__codelineno-0-2702" name="__codelineno-0-2702"></a><span class="sd">    Therefore this is just a list of all certificates found in all signers.</span>
<a id="__codelineno-0-2703" name="__codelineno-0-2703"></a>
<a id="__codelineno-0-2704" name="__codelineno-0-2704"></a><span class="sd">    :returns: a list of the found `asn1crypto.x509.Certificate`</span>
<a id="__codelineno-0-2705" name="__codelineno-0-2705"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2706" name="__codelineno-0-2706"></a>    <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-2707" name="__codelineno-0-2707"></a>        <span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2708" name="__codelineno-0-2708"></a>        <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificates_der_v2</span><span class="p">()</span>
<a id="__codelineno-0-2709" name="__codelineno-0-2709"></a>    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_certificates_v3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_certificates_v3</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_certificates_v3" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of <code>asn1crypto.x509.Certificate</code> which are found
in the v3 signing block.
Note that we simply extract all certificates regardless of the signer.
Therefore this is just a list of all certificates found in all signers.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[<span title="asn1crypto.x509.Certificate">Certificate</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of the found <code>asn1crypto.x509.Certificate</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2683">2683</a></span>
<span class="normal"><a href="#__codelineno-0-2684">2684</a></span>
<span class="normal"><a href="#__codelineno-0-2685">2685</a></span>
<span class="normal"><a href="#__codelineno-0-2686">2686</a></span>
<span class="normal"><a href="#__codelineno-0-2687">2687</a></span>
<span class="normal"><a href="#__codelineno-0-2688">2688</a></span>
<span class="normal"><a href="#__codelineno-0-2689">2689</a></span>
<span class="normal"><a href="#__codelineno-0-2690">2690</a></span>
<span class="normal"><a href="#__codelineno-0-2691">2691</a></span>
<span class="normal"><a href="#__codelineno-0-2692">2692</a></span>
<span class="normal"><a href="#__codelineno-0-2693">2693</a></span>
<span class="normal"><a href="#__codelineno-0-2694">2694</a></span>
<span class="normal"><a href="#__codelineno-0-2695">2695</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2683" name="__codelineno-0-2683"></a><span class="k">def</span> <span class="nf">get_certificates_v3</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">]:</span>
<a id="__codelineno-0-2684" name="__codelineno-0-2684"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2685" name="__codelineno-0-2685"></a><span class="sd">    Return a list of `asn1crypto.x509.Certificate` which are found</span>
<a id="__codelineno-0-2686" name="__codelineno-0-2686"></a><span class="sd">    in the v3 signing block.</span>
<a id="__codelineno-0-2687" name="__codelineno-0-2687"></a><span class="sd">    Note that we simply extract all certificates regardless of the signer.</span>
<a id="__codelineno-0-2688" name="__codelineno-0-2688"></a><span class="sd">    Therefore this is just a list of all certificates found in all signers.</span>
<a id="__codelineno-0-2689" name="__codelineno-0-2689"></a>
<a id="__codelineno-0-2690" name="__codelineno-0-2690"></a><span class="sd">    :returns: a list of the found `asn1crypto.x509.Certificate`</span>
<a id="__codelineno-0-2691" name="__codelineno-0-2691"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2692" name="__codelineno-0-2692"></a>    <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-2693" name="__codelineno-0-2693"></a>        <span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2694" name="__codelineno-0-2694"></a>        <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificates_der_v3</span><span class="p">()</span>
<a id="__codelineno-0-2695" name="__codelineno-0-2695"></a>    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_declared_permissions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_declared_permissions</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_declared_permissions" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns list of the declared permissions.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of declared permissions</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1600" name="__codelineno-0-1600"></a><span class="k">def</span> <span class="nf">get_declared_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a><span class="sd">    Returns list of the declared permissions.</span>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a><span class="sd">    :returns: list of declared permissions</span>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">declared_permissions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_declared_permissions_details" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_declared_permissions_details</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_declared_permissions_details" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns declared permissions with the details.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, list[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>declared permissions</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1608" name="__codelineno-0-1608"></a><span class="k">def</span> <span class="nf">get_declared_permissions_details</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a><span class="sd">    Returns declared permissions with the details.</span>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a><span class="sd">    :returns: declared permissions</span>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">declared_permissions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_details_permissions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_details_permissions</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_details_permissions" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return permissions with details.</p>
<p>This can only return details about the permission, if the permission is
defined in the AOSP.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, list[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>permissions with details: dict of <code>{permission: [protectionLevel, label, description]}</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span>
<span class="normal"><a href="#__codelineno-0-1530">1530</a></span>
<span class="normal"><a href="#__codelineno-0-1531">1531</a></span>
<span class="normal"><a href="#__codelineno-0-1532">1532</a></span>
<span class="normal"><a href="#__codelineno-0-1533">1533</a></span>
<span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1525" name="__codelineno-0-1525"></a><span class="k">def</span> <span class="nf">get_details_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-1526" name="__codelineno-0-1526"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1527" name="__codelineno-0-1527"></a><span class="sd">    Return permissions with details.</span>
<a id="__codelineno-0-1528" name="__codelineno-0-1528"></a>
<a id="__codelineno-0-1529" name="__codelineno-0-1529"></a><span class="sd">    This can only return details about the permission, if the permission is</span>
<a id="__codelineno-0-1530" name="__codelineno-0-1530"></a><span class="sd">    defined in the AOSP.</span>
<a id="__codelineno-0-1531" name="__codelineno-0-1531"></a>
<a id="__codelineno-0-1532" name="__codelineno-0-1532"></a><span class="sd">    :returns: permissions with details: dict of `{permission: [protectionLevel, label, description]}`</span>
<a id="__codelineno-0-1533" name="__codelineno-0-1533"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1534" name="__codelineno-0-1534"></a>    <span class="n">l</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1535" name="__codelineno-0-1535"></a>
<a id="__codelineno-0-1536" name="__codelineno-0-1536"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">:</span>
<a id="__codelineno-0-1537" name="__codelineno-0-1537"></a>        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permission_module</span><span class="p">:</span>
<a id="__codelineno-0-1538" name="__codelineno-0-1538"></a>            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permission_module</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-1539" name="__codelineno-0-1539"></a>            <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;protectionLevel&quot;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]]</span>
<a id="__codelineno-0-1540" name="__codelineno-0-1540"></a>        <span class="k">elif</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">declared_permissions</span><span class="p">:</span>
<a id="__codelineno-0-1541" name="__codelineno-0-1541"></a>            <span class="n">protectionLevel_hex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">declared_permissions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span>
<a id="__codelineno-0-1542" name="__codelineno-0-1542"></a>                <span class="s2">&quot;protectionLevel&quot;</span>
<a id="__codelineno-0-1543" name="__codelineno-0-1543"></a>            <span class="p">]</span>
<a id="__codelineno-0-1544" name="__codelineno-0-1544"></a>            <span class="n">protectionLevel</span> <span class="o">=</span> <span class="n">protection_flags_to_attributes</span><span class="p">[</span>
<a id="__codelineno-0-1545" name="__codelineno-0-1545"></a>                <span class="n">protectionLevel_hex</span>
<a id="__codelineno-0-1546" name="__codelineno-0-1546"></a>            <span class="p">]</span>
<a id="__codelineno-0-1547" name="__codelineno-0-1547"></a>            <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-1548" name="__codelineno-0-1548"></a>                <span class="n">protectionLevel</span><span class="p">,</span>
<a id="__codelineno-0-1549" name="__codelineno-0-1549"></a>                <span class="s2">&quot;Unknown permission from android reference&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1550" name="__codelineno-0-1550"></a>                <span class="s2">&quot;Unknown permission from android reference&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1551" name="__codelineno-0-1551"></a>            <span class="p">]</span>
<a id="__codelineno-0-1552" name="__codelineno-0-1552"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1553" name="__codelineno-0-1553"></a>            <span class="c1"># Is there a valid case not belonging to the above two?</span>
<a id="__codelineno-0-1554" name="__codelineno-0-1554"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown permission </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1555" name="__codelineno-0-1555"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_deprecated_permissions</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_dex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_dex</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_dex" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the raw data of the classes dex file</p>
<p>This will give you the data of the file called <code>classes.dex</code>
inside the APK. If the APK has multiple DEX files, you need to use <a class="autorefs autorefs-internal" href="#androguard.core.apk.APK.get_all_dex">get_all_dex</a>.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the raw data of the classes dex file</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>FileNotPresent</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if classes.dex is not found</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span>
<span class="normal"><a href="#__codelineno-0-982">982</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="k">def</span> <span class="nf">get_dex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a><span class="sd">    Return the raw data of the classes dex file</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">    This will give you the data of the file called `classes.dex`</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">    inside the APK. If the APK has multiple DEX files, you need to use [get_all_dex][androguard.core.apk.APK.get_all_dex].</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">    :raises FileNotPresent: if classes.dex is not found</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">    :returns: the raw data of the classes dex file</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="s2">&quot;classes.dex&quot;</span><span class="p">)</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>    <span class="k">except</span> <span class="n">FileNotPresent</span><span class="p">:</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>        <span class="c1"># TODO is this a good idea to return an empty string?</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>        <span class="k">return</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_dex_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_dex_names</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_dex_names" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the names of all DEX files found in the APK.
This method only accounts for "offical" dex files, i.e. all files
in the root directory of the APK named <code>classes.dex</code> or <code>classes[0-9]+.dex</code></p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the names of all DEX files found in the APK</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-984">984</a></span>
<span class="normal"><a href="#__codelineno-0-985">985</a></span>
<span class="normal"><a href="#__codelineno-0-986">986</a></span>
<span class="normal"><a href="#__codelineno-0-987">987</a></span>
<span class="normal"><a href="#__codelineno-0-988">988</a></span>
<span class="normal"><a href="#__codelineno-0-989">989</a></span>
<span class="normal"><a href="#__codelineno-0-990">990</a></span>
<span class="normal"><a href="#__codelineno-0-991">991</a></span>
<span class="normal"><a href="#__codelineno-0-992">992</a></span>
<span class="normal"><a href="#__codelineno-0-993">993</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="k">def</span> <span class="nf">get_dex_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">    Return the names of all DEX files found in the APK.</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">    This method only accounts for &quot;offical&quot; dex files, i.e. all files</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">    in the root directory of the APK named `classes.dex` or `classes[0-9]+.dex`</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">    :returns: the names of all DEX files found in the APK</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>    <span class="n">dexre</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^classes(\d*).dex$&quot;</span><span class="p">)</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>    <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">dexre</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_effective_target_sdk_version" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_effective_target_sdk_version</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_effective_target_sdk_version" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the effective <code>targetSdkVersion</code>, always returns int &gt; 0.</p>
<p>If the <code>targetSdkVersion</code> is not set, it defaults to 1.  This is
set based on defaults as defined in:
<a href="https://developer.android.com/guide/topics/manifest/uses-sdk-element.html">https://developer.android.com/guide/topics/manifest/uses-sdk-element.html</a></p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the effective <code>targetSdkVersion</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1640" name="__codelineno-0-1640"></a><span class="k">def</span> <span class="nf">get_effective_target_sdk_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1642" name="__codelineno-0-1642"></a><span class="sd">    Return the effective `targetSdkVersion`, always returns int &gt; 0.</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a><span class="sd">    If the `targetSdkVersion` is not set, it defaults to 1.  This is</span>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a><span class="sd">    set based on defaults as defined in:</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a><span class="sd">    &lt;https://developer.android.com/guide/topics/manifest/uses-sdk-element.html&gt;</span>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a><span class="sd">    :returns: the effective `targetSdkVersion`</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>    <span class="n">target_sdk_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_target_sdk_version</span><span class="p">()</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">target_sdk_version</span><span class="p">:</span>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>        <span class="n">target_sdk_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_min_sdk_version</span><span class="p">()</span>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">target_sdk_version</span><span class="p">)</span>
<a id="__codelineno-0-1655" name="__codelineno-0-1655"></a>    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
<a id="__codelineno-0-1656" name="__codelineno-0-1656"></a>        <span class="k">return</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_features" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_features</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_features" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of all <code>android:names</code> found for the tag <code>uses-feature</code>
in the <code>AndroidManifest.xml</code></p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the <code>android:names</code> found</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1666" name="__codelineno-0-1666"></a><span class="k">def</span> <span class="nf">get_features</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a><span class="sd">    Return a list of all `android:names` found for the tag `uses-feature`</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><span class="sd">    in the `AndroidManifest.xml`</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a><span class="sd">    :returns: the `android:names` found</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="s2">&quot;uses-feature&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.get_file" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the raw data of the specified filename
inside the APK</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the filename to get</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bytes of the specified filename</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>FileNotPresent</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if filename not found inside the apk</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-954" name="__codelineno-0-954"></a><span class="k">def</span> <span class="nf">get_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="sd">    Return the raw data of the specified filename</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a><span class="sd">    inside the APK</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">    :param filename: the filename to get</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">    :raises FileNotPresent: if filename not found inside the apk</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">    :returns: bytes of the specified filename</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>        <span class="k">raise</span> <span class="n">FileNotPresent</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_filename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_filename</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_filename" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the filename of the APK</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>filename</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="k">def</span> <span class="nf">get_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">    Return the filename of the APK</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">    :returns: filename</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_files" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_files</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_files" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the file names inside the APK.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of filename strings inside the APK</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="k">def</span> <span class="nf">get_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">    Return the file names inside the APK.</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="sd">    :returns: a list of filename strings inside the APK</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">namelist</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_files_crc32" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_files_crc32</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_files_crc32" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Calculates and returns a dictionary of filenames and CRC32</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict of filename: CRC32</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="k">def</span> <span class="nf">get_files_crc32</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">    Calculates and returns a dictionary of filenames and CRC32</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">    :returns: dict of filename: CRC32</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">files_crc32</span> <span class="o">==</span> <span class="p">{}:</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">():</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_get_crc32</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">files_crc32</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_files_information" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_files_information</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_files_information" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the files inside the APK with their associated types and crc32</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterator">Iterator</span>[tuple[str, str, int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the files inside the APK with their associated types and crc32</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="k">def</span> <span class="nf">get_files_information</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">    Return the files inside the APK with their associated types and crc32</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">    :returns: the files inside the APK with their associated types and crc32</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">():</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>        <span class="k">yield</span> <span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files_types</span><span class="p">()[</span><span class="n">k</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files_crc32</span><span class="p">()[</span><span class="n">k</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_files_types" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_files_types</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_files_types" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the files inside the APK with their associated types (by using <a href="https://pypi.org/project/python-magic/">python-magic</a>)</p>
<p>At the same time, the CRC32 are calculated for the files.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the files inside the APK with their associated types</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="k">def</span> <span class="nf">get_files_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">    Return the files inside the APK with their associated types (by using [python-magic](https://pypi.org/project/python-magic/))</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">    At the same time, the CRC32 are calculated for the files.</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">    :returns: the files inside the APK with their associated types</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span> <span class="o">==</span> <span class="p">{}:</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>        <span class="c1"># Generate File Types / CRC List</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">():</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>            <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_crc32</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_file_magic_name</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_intent_filters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_intent_filters</span><span class="p">(</span><span class="n">itemtype</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.get_intent_filters" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Find intent filters for a given item and name.</p>
<p>Intent filter are attached to activities, services or receivers.
You can search for the intent filters of such items and get a dictionary of all
attached actions and intent categories.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>itemtype</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the type of parent item to look for, e.g. <code>activity</code>,  <code>service</code> or <code>receiver</code></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the <code>android:name</code> of the parent item, e.g. activity name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, list[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionary with the keys <code>action</code> and <code>category</code> containing the <code>android:name</code> of those items</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1354" name="__codelineno-0-1354"></a><span class="k">def</span> <span class="nf">get_intent_filters</span><span class="p">(</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">itemtype</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a><span class="sd">    Find intent filters for a given item and name.</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a><span class="sd">    Intent filter are attached to activities, services or receivers.</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a><span class="sd">    You can search for the intent filters of such items and get a dictionary of all</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a><span class="sd">    attached actions and intent categories.</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><span class="sd">    :param itemtype: the type of parent item to look for, e.g. `activity`,  `service` or `receiver`</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a><span class="sd">    :param name: the `android:name` of the parent item, e.g. activity name</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="sd">    :returns: a dictionary with the keys `action` and `category` containing the `android:name` of those items</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>    <span class="n">attributes</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>        <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>            <span class="s1">&#39;scheme&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>            <span class="s1">&#39;host&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>            <span class="s1">&#39;port&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>            <span class="s1">&#39;path&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>            <span class="s1">&#39;pathPattern&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>            <span class="s1">&#39;pathPrefix&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>            <span class="s1">&#39;mimeType&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>        <span class="p">],</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a>    <span class="p">}</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a>        <span class="n">d</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">:</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a>        <span class="c1"># TODO: this can probably be solved using a single xpath</span>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//&quot;</span> <span class="o">+</span> <span class="n">itemtype</span><span class="p">):</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_value</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)))</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>                <span class="k">for</span> <span class="n">sitem</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//intent-filter&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a>                    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a>                        <span class="k">for</span> <span class="n">ssitem</span> <span class="ow">in</span> <span class="n">sitem</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a>                            <span class="k">if</span> <span class="n">element</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>  <span class="c1"># multiple attributes</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a>                                <span class="n">values</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a>                                <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">[</span><span class="n">element</span><span class="p">]:</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a>                                    <span class="n">value</span> <span class="o">=</span> <span class="n">ssitem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="n">attribute</span><span class="p">))</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a>                                    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a>                                        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">):</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a>                                            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_res_value</span><span class="p">(</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>                                                <span class="n">value</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a>                                            <span class="p">)</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a>                                        <span class="n">values</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>                                <span class="k">if</span> <span class="n">values</span><span class="p">:</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>                                    <span class="n">d</span><span class="p">[</span><span class="n">element</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a>                            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a>                                <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">[</span><span class="n">element</span><span class="p">]:</span>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a>                                    <span class="n">value</span> <span class="o">=</span> <span class="n">ssitem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="n">attribute</span><span class="p">))</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>                                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">):</span>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>                                        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_res_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>                                    <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="n">element</span><span class="p">]:</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a>                                        <span class="n">d</span><span class="p">[</span><span class="n">element</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="p">[</span><span class="n">element</span><span class="p">]:</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>            <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>    <span class="k">return</span> <span class="n">d</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_libraries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_libraries</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_libraries" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the <code>android:name</code> attributes for libraries</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the <code>android:name</code> attributes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1658" name="__codelineno-0-1658"></a><span class="k">def</span> <span class="nf">get_libraries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a><span class="sd">    Return the `android:name` attributes for libraries</span>
<a id="__codelineno-0-1661" name="__codelineno-0-1661"></a>
<a id="__codelineno-0-1662" name="__codelineno-0-1662"></a><span class="sd">    :returns: the `android:name` attributes</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="s2">&quot;uses-library&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_main_activities" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_main_activities</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_main_activities" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return names of the main activities</p>
<p>These values are read from the <code>AndroidManifest.xml</code></p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>set[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>names of the main activities</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="k">def</span> <span class="nf">get_main_activities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">    Return names of the main activities</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">    These values are read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><span class="sd">    :returns: names of the main activities</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>    <span class="n">x</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>    <span class="n">y</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">:</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>            <span class="k">continue</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>        <span class="n">activities_and_aliases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>            <span class="s2">&quot;.//activity&quot;</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>        <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//activity-alias&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">activities_and_aliases</span><span class="p">:</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>            <span class="c1"># Some applications have more than one MAIN activity.</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>            <span class="c1"># For example: paid and free content</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>            <span class="n">activityEnabled</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;enabled&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>            <span class="k">if</span> <span class="n">activityEnabled</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>                <span class="k">continue</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>            <span class="k">for</span> <span class="n">sitem</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//action&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>                <span class="n">val</span> <span class="o">=</span> <span class="n">sitem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>                <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;android.intent.action.MAIN&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>                    <span class="n">activity</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>                    <span class="k">if</span> <span class="n">activity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>                        <span class="n">x</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)))</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Main activity without name&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>            <span class="k">for</span> <span class="n">sitem</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">&quot;.//category&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>                <span class="n">val</span> <span class="o">=</span> <span class="n">sitem</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>                <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s2">&quot;android.intent.category.LAUNCHER&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>                    <span class="n">activity</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>                    <span class="k">if</span> <span class="n">activity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>                        <span class="n">y</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)))</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Launcher activity without name&#39;</span><span class="p">)</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_main_activity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_main_activity</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_main_activity" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the name of the main activity</p>
<p>This value is read from the <code>AndroidManifest.xml</code></p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the name of the main activity</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="k">def</span> <span class="nf">get_main_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">    Return the name of the main activity</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">    This value is read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">    :returns: the name of the main activity</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>    <span class="n">activities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_main_activities</span><span class="p">()</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">activities</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_value</span><span class="p">(</span><span class="n">activities</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">activities</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>        <span class="n">main_activities</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_format_value</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span> <span class="k">for</span> <span class="n">ma</span> <span class="ow">in</span> <span class="n">activities</span><span class="p">}</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>        <span class="c1"># sorted is necessary</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>        <span class="c1"># 9fc7d3e8225f6b377f9181a92c551814317b77e1aa0df4c6d508d24b18f0f633</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>        <span class="n">good_main_activities</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>            <span class="n">main_activities</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_activities</span><span class="p">())</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>        <span class="p">)</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>        <span class="k">if</span> <span class="n">good_main_activities</span><span class="p">:</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>            <span class="k">return</span> <span class="n">good_main_activities</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">main_activities</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_max_sdk_version" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_max_sdk_version</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_max_sdk_version" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the <code>android:maxSdkVersion</code> attribute</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the <code>android:maxSdkVersion</code> attribute</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1616" name="__codelineno-0-1616"></a><span class="k">def</span> <span class="nf">get_max_sdk_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a><span class="sd">    Return the `android:maxSdkVersion` attribute</span>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a><span class="sd">    :returns: the `android:maxSdkVersion` attribute</span>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span><span class="s2">&quot;uses-sdk&quot;</span><span class="p">,</span> <span class="s2">&quot;maxSdkVersion&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_min_sdk_version" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_min_sdk_version</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_min_sdk_version" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the <code>android:minSdkVersion</code> attribute</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the <code>android:minSdkVersion</code> attribute</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1624" name="__codelineno-0-1624"></a><span class="k">def</span> <span class="nf">get_min_sdk_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a><span class="sd">      Return the `android:minSdkVersion` attribute</span>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a><span class="sd">      :returns: the `android:minSdkVersion` attribute</span>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span><span class="s2">&quot;uses-sdk&quot;</span><span class="p">,</span> <span class="s2">&quot;minSdkVersion&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_package" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_package</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_package" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the name of the package</p>
<p>This information is read from the <code>AndroidManifest.xml</code></p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the name of the package</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="k">def</span> <span class="nf">get_package</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">    Return the name of the package</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">    This information is read from the `AndroidManifest.xml`</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">    :returns: the name of the package</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">package</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_permissions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_permissions</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_permissions" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return permissions names declared in the <code>AndroidManifest.xml</code>.</p>
<p>It is possible that permissions are returned multiple times,
as this function does not filter the permissions, i.e. it shows you
exactly what was defined in the <code>AndroidManifest.xml</code>.</p>
<p>Implied permissions, which are granted automatically, are not returned
here. Use <a class="autorefs autorefs-internal" href="#androguard.core.apk.APK.get_uses_implied_permission_list">get_uses_implied_permission_list</a> if you need a list
of implied permissions.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of permissions as strings</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1421" name="__codelineno-0-1421"></a><span class="k">def</span> <span class="nf">get_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a><span class="sd">    Return permissions names declared in the `AndroidManifest.xml`.</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a><span class="sd">    It is possible that permissions are returned multiple times,</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a><span class="sd">    as this function does not filter the permissions, i.e. it shows you</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a><span class="sd">    exactly what was defined in the `AndroidManifest.xml`.</span>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a><span class="sd">    Implied permissions, which are granted automatically, are not returned</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a><span class="sd">    here. Use [get_uses_implied_permission_list][androguard.core.apk.APK.get_uses_implied_permission_list] if you need a list</span>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a><span class="sd">    of implied permissions.</span>
<a id="__codelineno-0-1432" name="__codelineno-0-1432"></a>
<a id="__codelineno-0-1433" name="__codelineno-0-1433"></a><span class="sd">    :returns: A list of permissions as strings</span>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_providers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_providers</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_providers" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the <code>android:name</code> attribute of all providers</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the list of the <code>android:name</code> attribute of all providers</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="k">def</span> <span class="nf">get_providers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">    Return the `android:name` attribute of all providers</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">    :returns: the list of the `android:name` attribute of all providers</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="s2">&quot;provider&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_public_keys_der_v2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_public_keys_der_v2</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_public_keys_der_v2" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of DER coded X.509 public keys from the v3 signature block</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[bytes]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the list of public key bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2604">2604</a></span>
<span class="normal"><a href="#__codelineno-0-2605">2605</a></span>
<span class="normal"><a href="#__codelineno-0-2606">2606</a></span>
<span class="normal"><a href="#__codelineno-0-2607">2607</a></span>
<span class="normal"><a href="#__codelineno-0-2608">2608</a></span>
<span class="normal"><a href="#__codelineno-0-2609">2609</a></span>
<span class="normal"><a href="#__codelineno-0-2610">2610</a></span>
<span class="normal"><a href="#__codelineno-0-2611">2611</a></span>
<span class="normal"><a href="#__codelineno-0-2612">2612</a></span>
<span class="normal"><a href="#__codelineno-0-2613">2613</a></span>
<span class="normal"><a href="#__codelineno-0-2614">2614</a></span>
<span class="normal"><a href="#__codelineno-0-2615">2615</a></span>
<span class="normal"><a href="#__codelineno-0-2616">2616</a></span>
<span class="normal"><a href="#__codelineno-0-2617">2617</a></span>
<span class="normal"><a href="#__codelineno-0-2618">2618</a></span>
<span class="normal"><a href="#__codelineno-0-2619">2619</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2604" name="__codelineno-0-2604"></a><span class="k">def</span> <span class="nf">get_public_keys_der_v2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-0-2605" name="__codelineno-0-2605"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2606" name="__codelineno-0-2606"></a><span class="sd">    Return a list of DER coded X.509 public keys from the v3 signature block</span>
<a id="__codelineno-0-2607" name="__codelineno-0-2607"></a>
<a id="__codelineno-0-2608" name="__codelineno-0-2608"></a><span class="sd">    :returns: the list of public key bytes</span>
<a id="__codelineno-0-2609" name="__codelineno-0-2609"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2610" name="__codelineno-0-2610"></a>
<a id="__codelineno-0-2611" name="__codelineno-0-2611"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2612" name="__codelineno-0-2612"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parse_v2_signing_block</span><span class="p">()</span>
<a id="__codelineno-0-2613" name="__codelineno-0-2613"></a>
<a id="__codelineno-0-2614" name="__codelineno-0-2614"></a>    <span class="n">public_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2615" name="__codelineno-0-2615"></a>
<a id="__codelineno-0-2616" name="__codelineno-0-2616"></a>    <span class="k">for</span> <span class="n">signer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span><span class="p">:</span>
<a id="__codelineno-0-2617" name="__codelineno-0-2617"></a>        <span class="n">public_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signer</span><span class="o">.</span><span class="n">public_key</span><span class="p">)</span>
<a id="__codelineno-0-2618" name="__codelineno-0-2618"></a>
<a id="__codelineno-0-2619" name="__codelineno-0-2619"></a>    <span class="k">return</span> <span class="n">public_keys</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_public_keys_der_v3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_public_keys_der_v3</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_public_keys_der_v3" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of DER coded X.509 public keys from the v3 signature block</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[bytes]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the list of public key bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2587">2587</a></span>
<span class="normal"><a href="#__codelineno-0-2588">2588</a></span>
<span class="normal"><a href="#__codelineno-0-2589">2589</a></span>
<span class="normal"><a href="#__codelineno-0-2590">2590</a></span>
<span class="normal"><a href="#__codelineno-0-2591">2591</a></span>
<span class="normal"><a href="#__codelineno-0-2592">2592</a></span>
<span class="normal"><a href="#__codelineno-0-2593">2593</a></span>
<span class="normal"><a href="#__codelineno-0-2594">2594</a></span>
<span class="normal"><a href="#__codelineno-0-2595">2595</a></span>
<span class="normal"><a href="#__codelineno-0-2596">2596</a></span>
<span class="normal"><a href="#__codelineno-0-2597">2597</a></span>
<span class="normal"><a href="#__codelineno-0-2598">2598</a></span>
<span class="normal"><a href="#__codelineno-0-2599">2599</a></span>
<span class="normal"><a href="#__codelineno-0-2600">2600</a></span>
<span class="normal"><a href="#__codelineno-0-2601">2601</a></span>
<span class="normal"><a href="#__codelineno-0-2602">2602</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2587" name="__codelineno-0-2587"></a><span class="k">def</span> <span class="nf">get_public_keys_der_v3</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-0-2588" name="__codelineno-0-2588"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2589" name="__codelineno-0-2589"></a><span class="sd">    Return a list of DER coded X.509 public keys from the v3 signature block</span>
<a id="__codelineno-0-2590" name="__codelineno-0-2590"></a>
<a id="__codelineno-0-2591" name="__codelineno-0-2591"></a><span class="sd">    :returns: the list of public key bytes</span>
<a id="__codelineno-0-2592" name="__codelineno-0-2592"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2593" name="__codelineno-0-2593"></a>
<a id="__codelineno-0-2594" name="__codelineno-0-2594"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2595" name="__codelineno-0-2595"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parse_v3_signing_block</span><span class="p">()</span>
<a id="__codelineno-0-2596" name="__codelineno-0-2596"></a>
<a id="__codelineno-0-2597" name="__codelineno-0-2597"></a>    <span class="n">public_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2598" name="__codelineno-0-2598"></a>
<a id="__codelineno-0-2599" name="__codelineno-0-2599"></a>    <span class="k">for</span> <span class="n">signer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span><span class="p">:</span>
<a id="__codelineno-0-2600" name="__codelineno-0-2600"></a>        <span class="n">public_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signer</span><span class="o">.</span><span class="n">public_key</span><span class="p">)</span>
<a id="__codelineno-0-2601" name="__codelineno-0-2601"></a>
<a id="__codelineno-0-2602" name="__codelineno-0-2602"></a>    <span class="k">return</span> <span class="n">public_keys</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_public_keys_v2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_public_keys_v2</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_public_keys_v2" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of <code>asn1crypto.keys.PublicKeyInfo</code> which are found
in the v2 signing block.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[<span title="asn1crypto.keys.PublicKeyInfo">PublicKeyInfo</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of the found <code>asn1crypto.keys.PublicKeyInfo</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2671">2671</a></span>
<span class="normal"><a href="#__codelineno-0-2672">2672</a></span>
<span class="normal"><a href="#__codelineno-0-2673">2673</a></span>
<span class="normal"><a href="#__codelineno-0-2674">2674</a></span>
<span class="normal"><a href="#__codelineno-0-2675">2675</a></span>
<span class="normal"><a href="#__codelineno-0-2676">2676</a></span>
<span class="normal"><a href="#__codelineno-0-2677">2677</a></span>
<span class="normal"><a href="#__codelineno-0-2678">2678</a></span>
<span class="normal"><a href="#__codelineno-0-2679">2679</a></span>
<span class="normal"><a href="#__codelineno-0-2680">2680</a></span>
<span class="normal"><a href="#__codelineno-0-2681">2681</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2671" name="__codelineno-0-2671"></a><span class="k">def</span> <span class="nf">get_public_keys_v2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">PublicKeyInfo</span><span class="p">]:</span>
<a id="__codelineno-0-2672" name="__codelineno-0-2672"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2673" name="__codelineno-0-2673"></a><span class="sd">    Return a list of `asn1crypto.keys.PublicKeyInfo` which are found</span>
<a id="__codelineno-0-2674" name="__codelineno-0-2674"></a><span class="sd">    in the v2 signing block.</span>
<a id="__codelineno-0-2675" name="__codelineno-0-2675"></a>
<a id="__codelineno-0-2676" name="__codelineno-0-2676"></a><span class="sd">    :returns: a list of the found `asn1crypto.keys.PublicKeyInfo`</span>
<a id="__codelineno-0-2677" name="__codelineno-0-2677"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2678" name="__codelineno-0-2678"></a>    <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-2679" name="__codelineno-0-2679"></a>        <span class="n">keys</span><span class="o">.</span><span class="n">PublicKeyInfo</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pkey</span><span class="p">)</span>
<a id="__codelineno-0-2680" name="__codelineno-0-2680"></a>        <span class="k">for</span> <span class="n">pkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_public_keys_der_v2</span><span class="p">()</span>
<a id="__codelineno-0-2681" name="__codelineno-0-2681"></a>    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_public_keys_v3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_public_keys_v3</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_public_keys_v3" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of <code>asn1crypto.keys.PublicKeyInfo</code> which are found
in the v3 signing block.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[<span title="asn1crypto.keys.PublicKeyInfo">PublicKeyInfo</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of the found <code>asn1crypto.keys.PublicKeyInfo</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2659">2659</a></span>
<span class="normal"><a href="#__codelineno-0-2660">2660</a></span>
<span class="normal"><a href="#__codelineno-0-2661">2661</a></span>
<span class="normal"><a href="#__codelineno-0-2662">2662</a></span>
<span class="normal"><a href="#__codelineno-0-2663">2663</a></span>
<span class="normal"><a href="#__codelineno-0-2664">2664</a></span>
<span class="normal"><a href="#__codelineno-0-2665">2665</a></span>
<span class="normal"><a href="#__codelineno-0-2666">2666</a></span>
<span class="normal"><a href="#__codelineno-0-2667">2667</a></span>
<span class="normal"><a href="#__codelineno-0-2668">2668</a></span>
<span class="normal"><a href="#__codelineno-0-2669">2669</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2659" name="__codelineno-0-2659"></a><span class="k">def</span> <span class="nf">get_public_keys_v3</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">PublicKeyInfo</span><span class="p">]:</span>
<a id="__codelineno-0-2660" name="__codelineno-0-2660"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2661" name="__codelineno-0-2661"></a><span class="sd">    Return a list of `asn1crypto.keys.PublicKeyInfo` which are found</span>
<a id="__codelineno-0-2662" name="__codelineno-0-2662"></a><span class="sd">    in the v3 signing block.</span>
<a id="__codelineno-0-2663" name="__codelineno-0-2663"></a>
<a id="__codelineno-0-2664" name="__codelineno-0-2664"></a><span class="sd">    :returns: a list of the found `asn1crypto.keys.PublicKeyInfo`</span>
<a id="__codelineno-0-2665" name="__codelineno-0-2665"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2666" name="__codelineno-0-2666"></a>    <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-2667" name="__codelineno-0-2667"></a>        <span class="n">keys</span><span class="o">.</span><span class="n">PublicKeyInfo</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pkey</span><span class="p">)</span>
<a id="__codelineno-0-2668" name="__codelineno-0-2668"></a>        <span class="k">for</span> <span class="n">pkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_public_keys_der_v3</span><span class="p">()</span>
<a id="__codelineno-0-2669" name="__codelineno-0-2669"></a>    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_raw" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_raw</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_raw" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return raw bytes of the APK</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bytes of the APK</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="k">def</span> <span class="nf">get_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">    Return raw bytes of the APK</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">    :returns: bytes of the APK</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__raw</span><span class="p">:</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__raw</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__raw</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__raw</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_receivers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_receivers</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_receivers" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the <code>android:name</code> attribute of all receivers</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the list of the <code>android:name</code> attribute of all receivers</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1316" name="__codelineno-0-1316"></a><span class="k">def</span> <span class="nf">get_receivers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><span class="sd">    Return the `android:name` attribute of all receivers</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="sd">    :returns: the list of the `android:name` attribute of all receivers</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="s2">&quot;receiver&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_requested_aosp_permissions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_requested_aosp_permissions</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_requested_aosp_permissions" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns requested permissions declared within AOSP project.</p>
<p>This includes several other permissions as well, which are in the platform apps.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>requested permissions</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1557" name="__codelineno-0-1557"></a><span class="k">def</span> <span class="nf">get_requested_aosp_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1558" name="__codelineno-0-1558"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1559" name="__codelineno-0-1559"></a><span class="sd">    Returns requested permissions declared within AOSP project.</span>
<a id="__codelineno-0-1560" name="__codelineno-0-1560"></a>
<a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><span class="sd">    This includes several other permissions as well, which are in the platform apps.</span>
<a id="__codelineno-0-1562" name="__codelineno-0-1562"></a>
<a id="__codelineno-0-1563" name="__codelineno-0-1563"></a><span class="sd">    :returns: requested permissions</span>
<a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565"></a>    <span class="n">aosp_permissions</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1566" name="__codelineno-0-1566"></a>    <span class="n">all_permissions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>
<a id="__codelineno-0-1567" name="__codelineno-0-1567"></a>    <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">all_permissions</span><span class="p">:</span>
<a id="__codelineno-0-1568" name="__codelineno-0-1568"></a>        <span class="k">if</span> <span class="n">perm</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permission_module</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569"></a>            <span class="n">aosp_permissions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
<a id="__codelineno-0-1570" name="__codelineno-0-1570"></a>    <span class="k">return</span> <span class="n">aosp_permissions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_requested_aosp_permissions_details" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_requested_aosp_permissions_details</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_requested_aosp_permissions_details" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns requested aosp permissions with details.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, list[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>requested aosp permissions</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1572" name="__codelineno-0-1572"></a><span class="k">def</span> <span class="nf">get_requested_aosp_permissions_details</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-1573" name="__codelineno-0-1573"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1574" name="__codelineno-0-1574"></a><span class="sd">    Returns requested aosp permissions with details.</span>
<a id="__codelineno-0-1575" name="__codelineno-0-1575"></a>
<a id="__codelineno-0-1576" name="__codelineno-0-1576"></a><span class="sd">    :returns: requested aosp permissions</span>
<a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578"></a>    <span class="n">l</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1579" name="__codelineno-0-1579"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">:</span>
<a id="__codelineno-0-1580" name="__codelineno-0-1580"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a>            <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permission_module</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a>            <span class="c1"># if we have not found permission do nothing</span>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a>            <span class="k">continue</span>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a>    <span class="k">return</span> <span class="n">l</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_requested_third_party_permissions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_requested_third_party_permissions</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_requested_third_party_permissions" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns list of requested permissions not declared within AOSP project.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>requested permissions</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1587" name="__codelineno-0-1587"></a><span class="k">def</span> <span class="nf">get_requested_third_party_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1588" name="__codelineno-0-1588"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1589" name="__codelineno-0-1589"></a><span class="sd">    Returns list of requested permissions not declared within AOSP project.</span>
<a id="__codelineno-0-1590" name="__codelineno-0-1590"></a>
<a id="__codelineno-0-1591" name="__codelineno-0-1591"></a><span class="sd">    :returns: requested permissions</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>    <span class="n">third_party_permissions</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>    <span class="n">all_permissions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_permissions</span><span class="p">()</span>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>    <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="n">all_permissions</span><span class="p">:</span>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>        <span class="k">if</span> <span class="n">perm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permission_module</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>            <span class="n">third_party_permissions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a>    <span class="k">return</span> <span class="n">third_party_permissions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_res_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_res_value</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.get_res_value" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the literal value with a resource id</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the literal value with a resource id</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1332" name="__codelineno-0-1332"></a><span class="k">def</span> <span class="nf">get_res_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">    Return the literal value with a resource id</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a><span class="sd">    :returns: the literal value with a resource id</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>    <span class="n">res_parser</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_android_resources</span><span class="p">()</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">res_parser</span><span class="p">:</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>        <span class="k">return</span> <span class="n">name</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>    <span class="n">res_id</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">parse_id</span><span class="p">(</span><span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">res_parser</span><span class="o">.</span><span class="n">get_resolved_res_configs</span><span class="p">(</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a>            <span class="n">res_id</span><span class="p">,</span> <span class="n">ARSCResTableConfig</span><span class="o">.</span><span class="n">default_config</span><span class="p">()</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>        <span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Exception get resolved resource id: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>        <span class="k">return</span> <span class="n">name</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>    <span class="k">return</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_services" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_services</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_services" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the <code>android:name</code> attribute of all services</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the list of the <code>android:name</code> attribute of all services</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1308" name="__codelineno-0-1308"></a><span class="k">def</span> <span class="nf">get_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><span class="sd">    Return the `android:name` attribute of all services</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a><span class="sd">    :returns: the list of the `android:name` attribute of all services</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_all_attribute_value</span><span class="p">(</span><span class="s2">&quot;service&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_signature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_signature</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_signature" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the data of the first signature file found (v1 Signature / JAR
Signature)</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First signature name or None if not signed</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2780">2780</a></span>
<span class="normal"><a href="#__codelineno-0-2781">2781</a></span>
<span class="normal"><a href="#__codelineno-0-2782">2782</a></span>
<span class="normal"><a href="#__codelineno-0-2783">2783</a></span>
<span class="normal"><a href="#__codelineno-0-2784">2784</a></span>
<span class="normal"><a href="#__codelineno-0-2785">2785</a></span>
<span class="normal"><a href="#__codelineno-0-2786">2786</a></span>
<span class="normal"><a href="#__codelineno-0-2787">2787</a></span>
<span class="normal"><a href="#__codelineno-0-2788">2788</a></span>
<span class="normal"><a href="#__codelineno-0-2789">2789</a></span>
<span class="normal"><a href="#__codelineno-0-2790">2790</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2780" name="__codelineno-0-2780"></a><span class="k">def</span> <span class="nf">get_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-2781" name="__codelineno-0-2781"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2782" name="__codelineno-0-2782"></a><span class="sd">    Return the data of the first signature file found (v1 Signature / JAR</span>
<a id="__codelineno-0-2783" name="__codelineno-0-2783"></a><span class="sd">    Signature)</span>
<a id="__codelineno-0-2784" name="__codelineno-0-2784"></a>
<a id="__codelineno-0-2785" name="__codelineno-0-2785"></a><span class="sd">    :returns: First signature name or None if not signed</span>
<a id="__codelineno-0-2786" name="__codelineno-0-2786"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2787" name="__codelineno-0-2787"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signatures</span><span class="p">():</span>
<a id="__codelineno-0-2788" name="__codelineno-0-2788"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signatures</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2789" name="__codelineno-0-2789"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2790" name="__codelineno-0-2790"></a>        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_signature_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_signature_name</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_signature_name" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the name of the first signature file found.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the name of the first signature file, or <code>None</code> if not signed</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2745">2745</a></span>
<span class="normal"><a href="#__codelineno-0-2746">2746</a></span>
<span class="normal"><a href="#__codelineno-0-2747">2747</a></span>
<span class="normal"><a href="#__codelineno-0-2748">2748</a></span>
<span class="normal"><a href="#__codelineno-0-2749">2749</a></span>
<span class="normal"><a href="#__codelineno-0-2750">2750</a></span>
<span class="normal"><a href="#__codelineno-0-2751">2751</a></span>
<span class="normal"><a href="#__codelineno-0-2752">2752</a></span>
<span class="normal"><a href="#__codelineno-0-2753">2753</a></span>
<span class="normal"><a href="#__codelineno-0-2754">2754</a></span>
<span class="normal"><a href="#__codelineno-0-2755">2755</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2745" name="__codelineno-0-2745"></a><span class="k">def</span> <span class="nf">get_signature_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-2746" name="__codelineno-0-2746"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2747" name="__codelineno-0-2747"></a><span class="sd">    Return the name of the first signature file found.</span>
<a id="__codelineno-0-2748" name="__codelineno-0-2748"></a>
<a id="__codelineno-0-2749" name="__codelineno-0-2749"></a><span class="sd">    :returns: the name of the first signature file, or `None` if not signed</span>
<a id="__codelineno-0-2750" name="__codelineno-0-2750"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2751" name="__codelineno-0-2751"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signature_names</span><span class="p">():</span>
<a id="__codelineno-0-2752" name="__codelineno-0-2752"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signature_names</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2753" name="__codelineno-0-2753"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2754" name="__codelineno-0-2754"></a>        <span class="c1"># Unsigned APK</span>
<a id="__codelineno-0-2755" name="__codelineno-0-2755"></a>        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_signature_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_signature_names</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_signature_names" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of the signature file names (v1 Signature / JAR
Signature)</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of filenames matching a Signature</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2757">2757</a></span>
<span class="normal"><a href="#__codelineno-0-2758">2758</a></span>
<span class="normal"><a href="#__codelineno-0-2759">2759</a></span>
<span class="normal"><a href="#__codelineno-0-2760">2760</a></span>
<span class="normal"><a href="#__codelineno-0-2761">2761</a></span>
<span class="normal"><a href="#__codelineno-0-2762">2762</a></span>
<span class="normal"><a href="#__codelineno-0-2763">2763</a></span>
<span class="normal"><a href="#__codelineno-0-2764">2764</a></span>
<span class="normal"><a href="#__codelineno-0-2765">2765</a></span>
<span class="normal"><a href="#__codelineno-0-2766">2766</a></span>
<span class="normal"><a href="#__codelineno-0-2767">2767</a></span>
<span class="normal"><a href="#__codelineno-0-2768">2768</a></span>
<span class="normal"><a href="#__codelineno-0-2769">2769</a></span>
<span class="normal"><a href="#__codelineno-0-2770">2770</a></span>
<span class="normal"><a href="#__codelineno-0-2771">2771</a></span>
<span class="normal"><a href="#__codelineno-0-2772">2772</a></span>
<span class="normal"><a href="#__codelineno-0-2773">2773</a></span>
<span class="normal"><a href="#__codelineno-0-2774">2774</a></span>
<span class="normal"><a href="#__codelineno-0-2775">2775</a></span>
<span class="normal"><a href="#__codelineno-0-2776">2776</a></span>
<span class="normal"><a href="#__codelineno-0-2777">2777</a></span>
<span class="normal"><a href="#__codelineno-0-2778">2778</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2757" name="__codelineno-0-2757"></a><span class="k">def</span> <span class="nf">get_signature_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2758" name="__codelineno-0-2758"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2759" name="__codelineno-0-2759"></a><span class="sd">    Return a list of the signature file names (v1 Signature / JAR</span>
<a id="__codelineno-0-2760" name="__codelineno-0-2760"></a><span class="sd">    Signature)</span>
<a id="__codelineno-0-2761" name="__codelineno-0-2761"></a>
<a id="__codelineno-0-2762" name="__codelineno-0-2762"></a><span class="sd">    :returns: List of filenames matching a Signature</span>
<a id="__codelineno-0-2763" name="__codelineno-0-2763"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2764" name="__codelineno-0-2764"></a>    <span class="n">signature_expr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^(META-INF/)(.*)(\.RSA|\.EC|\.DSA)$&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2765" name="__codelineno-0-2765"></a>    <span class="n">signatures</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2766" name="__codelineno-0-2766"></a>
<a id="__codelineno-0-2767" name="__codelineno-0-2767"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">():</span>
<a id="__codelineno-0-2768" name="__codelineno-0-2768"></a>        <span class="k">if</span> <span class="n">signature_expr</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-2769" name="__codelineno-0-2769"></a>            <span class="k">if</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.SF&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">():</span>
<a id="__codelineno-0-2770" name="__codelineno-0-2770"></a>                <span class="n">signatures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-2771" name="__codelineno-0-2771"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2772" name="__codelineno-0-2772"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2773" name="__codelineno-0-2773"></a>                    <span class="s2">&quot;v1 signature file </span><span class="si">{}</span><span class="s2"> missing .SF file - Partial signature!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2774" name="__codelineno-0-2774"></a>                        <span class="n">i</span>
<a id="__codelineno-0-2775" name="__codelineno-0-2775"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2776" name="__codelineno-0-2776"></a>                <span class="p">)</span>
<a id="__codelineno-0-2777" name="__codelineno-0-2777"></a>
<a id="__codelineno-0-2778" name="__codelineno-0-2778"></a>    <span class="k">return</span> <span class="n">signatures</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_signatures" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_signatures</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_signatures" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of the data of the signature files.
Only v1 / JAR Signing.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[bytes]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2792">2792</a></span>
<span class="normal"><a href="#__codelineno-0-2793">2793</a></span>
<span class="normal"><a href="#__codelineno-0-2794">2794</a></span>
<span class="normal"><a href="#__codelineno-0-2795">2795</a></span>
<span class="normal"><a href="#__codelineno-0-2796">2796</a></span>
<span class="normal"><a href="#__codelineno-0-2797">2797</a></span>
<span class="normal"><a href="#__codelineno-0-2798">2798</a></span>
<span class="normal"><a href="#__codelineno-0-2799">2799</a></span>
<span class="normal"><a href="#__codelineno-0-2800">2800</a></span>
<span class="normal"><a href="#__codelineno-0-2801">2801</a></span>
<span class="normal"><a href="#__codelineno-0-2802">2802</a></span>
<span class="normal"><a href="#__codelineno-0-2803">2803</a></span>
<span class="normal"><a href="#__codelineno-0-2804">2804</a></span>
<span class="normal"><a href="#__codelineno-0-2805">2805</a></span>
<span class="normal"><a href="#__codelineno-0-2806">2806</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2792" name="__codelineno-0-2792"></a><span class="k">def</span> <span class="nf">get_signatures</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<a id="__codelineno-0-2793" name="__codelineno-0-2793"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2794" name="__codelineno-0-2794"></a><span class="sd">    Return a list of the data of the signature files.</span>
<a id="__codelineno-0-2795" name="__codelineno-0-2795"></a><span class="sd">    Only v1 / JAR Signing.</span>
<a id="__codelineno-0-2796" name="__codelineno-0-2796"></a>
<a id="__codelineno-0-2797" name="__codelineno-0-2797"></a><span class="sd">    :returns: list of bytes</span>
<a id="__codelineno-0-2798" name="__codelineno-0-2798"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2799" name="__codelineno-0-2799"></a>    <span class="n">signature_expr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^(META-INF/)(.*)(\.RSA|\.EC|\.DSA)$&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2800" name="__codelineno-0-2800"></a>    <span class="n">signature_datas</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2801" name="__codelineno-0-2801"></a>
<a id="__codelineno-0-2802" name="__codelineno-0-2802"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">():</span>
<a id="__codelineno-0-2803" name="__codelineno-0-2803"></a>        <span class="k">if</span> <span class="n">signature_expr</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-2804" name="__codelineno-0-2804"></a>            <span class="n">signature_datas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a id="__codelineno-0-2805" name="__codelineno-0-2805"></a>
<a id="__codelineno-0-2806" name="__codelineno-0-2806"></a>    <span class="k">return</span> <span class="n">signature_datas</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_target_sdk_version" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_target_sdk_version</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_target_sdk_version" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the <code>android:targetSdkVersion</code> attribute</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the <code>android:targetSdkVersion</code> attribute</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1632" name="__codelineno-0-1632"></a><span class="k">def</span> <span class="nf">get_target_sdk_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1634" name="__codelineno-0-1634"></a><span class="sd">    Return the `android:targetSdkVersion` attribute</span>
<a id="__codelineno-0-1635" name="__codelineno-0-1635"></a>
<a id="__codelineno-0-1636" name="__codelineno-0-1636"></a><span class="sd">    :returns: the `android:targetSdkVersion` attribute</span>
<a id="__codelineno-0-1637" name="__codelineno-0-1637"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1638" name="__codelineno-0-1638"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span><span class="s2">&quot;uses-sdk&quot;</span><span class="p">,</span> <span class="s2">&quot;targetSdkVersion&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_uses_implied_permission_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_uses_implied_permission_list</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.get_uses_implied_permission_list" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return all permissions implied by the target SDK or other permissions.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of all permissions implied by the target SDK or other permissions as strings</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1437" name="__codelineno-0-1437"></a><span class="k">def</span> <span class="nf">get_uses_implied_permission_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1438" name="__codelineno-0-1438"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1439" name="__codelineno-0-1439"></a><span class="sd">    Return all permissions implied by the target SDK or other permissions.</span>
<a id="__codelineno-0-1440" name="__codelineno-0-1440"></a>
<a id="__codelineno-0-1441" name="__codelineno-0-1441"></a><span class="sd">    :returns: list of all permissions implied by the target SDK or other permissions as strings</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>    <span class="n">target_sdk_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_effective_target_sdk_version</span><span class="p">()</span>
<a id="__codelineno-0-1444" name="__codelineno-0-1444"></a>
<a id="__codelineno-0-1445" name="__codelineno-0-1445"></a>    <span class="n">READ_CALL_LOG</span> <span class="o">=</span> <span class="s1">&#39;android.permission.READ_CALL_LOG&#39;</span>
<a id="__codelineno-0-1446" name="__codelineno-0-1446"></a>    <span class="n">READ_CONTACTS</span> <span class="o">=</span> <span class="s1">&#39;android.permission.READ_CONTACTS&#39;</span>
<a id="__codelineno-0-1447" name="__codelineno-0-1447"></a>    <span class="n">READ_EXTERNAL_STORAGE</span> <span class="o">=</span> <span class="s1">&#39;android.permission.READ_EXTERNAL_STORAGE&#39;</span>
<a id="__codelineno-0-1448" name="__codelineno-0-1448"></a>    <span class="n">READ_PHONE_STATE</span> <span class="o">=</span> <span class="s1">&#39;android.permission.READ_PHONE_STATE&#39;</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449"></a>    <span class="n">WRITE_CALL_LOG</span> <span class="o">=</span> <span class="s1">&#39;android.permission.WRITE_CALL_LOG&#39;</span>
<a id="__codelineno-0-1450" name="__codelineno-0-1450"></a>    <span class="n">WRITE_CONTACTS</span> <span class="o">=</span> <span class="s1">&#39;android.permission.WRITE_CONTACTS&#39;</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451"></a>    <span class="n">WRITE_EXTERNAL_STORAGE</span> <span class="o">=</span> <span class="s1">&#39;android.permission.WRITE_EXTERNAL_STORAGE&#39;</span>
<a id="__codelineno-0-1452" name="__codelineno-0-1452"></a>
<a id="__codelineno-0-1453" name="__codelineno-0-1453"></a>    <span class="n">implied</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1454" name="__codelineno-0-1454"></a>
<a id="__codelineno-0-1455" name="__codelineno-0-1455"></a>    <span class="n">implied_WRITE_EXTERNAL_STORAGE</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1456" name="__codelineno-0-1456"></a>    <span class="k">if</span> <span class="n">target_sdk_version</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-1457" name="__codelineno-0-1457"></a>        <span class="k">if</span> <span class="n">WRITE_EXTERNAL_STORAGE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">:</span>
<a id="__codelineno-0-1458" name="__codelineno-0-1458"></a>            <span class="n">implied</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">WRITE_EXTERNAL_STORAGE</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<a id="__codelineno-0-1459" name="__codelineno-0-1459"></a>            <span class="n">implied_WRITE_EXTERNAL_STORAGE</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1460" name="__codelineno-0-1460"></a>        <span class="k">if</span> <span class="n">READ_PHONE_STATE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">:</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461"></a>            <span class="n">implied</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">READ_PHONE_STATE</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a>    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a>        <span class="n">WRITE_EXTERNAL_STORAGE</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a>        <span class="ow">or</span> <span class="n">implied_WRITE_EXTERNAL_STORAGE</span>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a>    <span class="p">)</span> <span class="ow">and</span> <span class="n">READ_EXTERNAL_STORAGE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span><span class="p">:</span>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>        <span class="n">maxSdkVersion</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">version</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">uses_permissions</span><span class="p">:</span>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a>            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">WRITE_EXTERNAL_STORAGE</span><span class="p">:</span>
<a id="__codelineno-0-1470" name="__codelineno-0-1470"></a>                <span class="n">maxSdkVersion</span> <span class="o">=</span> <span class="n">version</span>
<a id="__codelineno-0-1471" name="__codelineno-0-1471"></a>                <span class="k">break</span>
<a id="__codelineno-0-1472" name="__codelineno-0-1472"></a>        <span class="n">implied</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">READ_EXTERNAL_STORAGE</span><span class="p">,</span> <span class="n">maxSdkVersion</span><span class="p">])</span>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>    <span class="k">if</span> <span class="n">target_sdk_version</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a>            <span class="n">READ_CONTACTS</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a>            <span class="ow">and</span> <span class="n">READ_CALL_LOG</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a>        <span class="p">):</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a>            <span class="n">implied</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">READ_CALL_LOG</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a>            <span class="n">WRITE_CONTACTS</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a>            <span class="ow">and</span> <span class="n">WRITE_CALL_LOG</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permissions</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>        <span class="p">):</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a>            <span class="n">implied</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">WRITE_CALL_LOG</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a>    <span class="k">return</span> <span class="n">implied</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.get_value_from_tag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_value_from_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.get_value_from_tag" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the value of the android prefixed attribute in a specific tag.</p>
<p>This function will always try to get the attribute with a <code>android:</code> prefix first,
and will try to return the attribute without the prefix, if the attribute could not be found.
This is useful for some broken <code>AndroidManifest.xml</code>, where no android namespace is set,
but could also indicate malicious activity (i.e. wrongly repackaged files).
A warning is printed if the attribute is found without a namespace prefix.</p>
<p>If you require to get the exact result you need to query the tag directly:</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from lxml.etree import Element
&gt;&gt;&gt; tag = Element(&#39;bar&#39;, nsmap={&#39;android&#39;: &#39;http://schemas.android.com/apk/res/android&#39;})
&gt;&gt;&gt; tag.set(&#39;{http://schemas.android.com/apk/res/android}foobar&#39;, &#39;barfoo&#39;)
&gt;&gt;&gt; tag.set(&#39;name&#39;, &#39;baz&#39;)
# Assume that `a` is some APK object
&gt;&gt;&gt; a.get_value_from_tag(tag, &#39;name&#39;)
&#39;baz&#39;
&gt;&gt;&gt; tag.get(&#39;name&#39;)
&#39;baz&#39;
&gt;&gt;&gt; tag.get(&#39;foobar&#39;)
None
&gt;&gt;&gt; a.get_value_from_tag(tag, &#39;foobar&#39;)
&#39;barfoo&#39;
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code>lxml.etree.Element</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify the tag element</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>attribute</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify the attribute name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the attribute's value, or None if the attribute is not present</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1091" name="__codelineno-0-1091"></a><span class="k">def</span> <span class="nf">get_value_from_tag</span><span class="p">(</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">Element</span><span class="p">,</span> <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="sd">    Return the value of the android prefixed attribute in a specific tag.</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">    This function will always try to get the attribute with a `android:` prefix first,</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">    and will try to return the attribute without the prefix, if the attribute could not be found.</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">    This is useful for some broken `AndroidManifest.xml`, where no android namespace is set,</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">    but could also indicate malicious activity (i.e. wrongly repackaged files).</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">    A warning is printed if the attribute is found without a namespace prefix.</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">    If you require to get the exact result you need to query the tag directly:</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">        &gt;&gt;&gt; from lxml.etree import Element</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">        &gt;&gt;&gt; tag = Element(&#39;bar&#39;, nsmap={&#39;android&#39;: &#39;http://schemas.android.com/apk/res/android&#39;})</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">        &gt;&gt;&gt; tag.set(&#39;{http://schemas.android.com/apk/res/android}foobar&#39;, &#39;barfoo&#39;)</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">        &gt;&gt;&gt; tag.set(&#39;name&#39;, &#39;baz&#39;)</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">        # Assume that `a` is some APK object</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">        &gt;&gt;&gt; a.get_value_from_tag(tag, &#39;name&#39;)</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">        &#39;baz&#39;</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">        &gt;&gt;&gt; tag.get(&#39;name&#39;)</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">        &#39;baz&#39;</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">        &gt;&gt;&gt; tag.get(&#39;foobar&#39;)</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">        None</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">        &gt;&gt;&gt; a.get_value_from_tag(tag, &#39;foobar&#39;)</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">        &#39;barfoo&#39;</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">    :param lxml.etree.Element tag: specify the tag element</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">    :param str attribute: specify the attribute name</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">    :returns: the attribute&#39;s value, or None if the attribute is not present</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>    <span class="c1"># TODO: figure out if both android:name and name tag exist which one to give preference:</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a>    <span class="c1"># currently we give preference for the namespace one and fallback to the un-namespaced</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>    <span class="n">value</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ns</span><span class="p">(</span><span class="n">attribute</span><span class="p">))</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>            <span class="c1"># If value is still None, the attribute could not be found, thus is not present</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>                <span class="s2">&quot;Failed to get the attribute &#39;</span><span class="si">{}</span><span class="s2">&#39; on tag &#39;</span><span class="si">{}</span><span class="s2">&#39; with namespace. &quot;</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>                <span class="s2">&quot;But found the same attribute without namespace!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>                    <span class="n">attribute</span><span class="p">,</span> <span class="n">tag</span><span class="o">.</span><span class="n">tag</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>                <span class="p">)</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>            <span class="p">)</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>    <span class="k">return</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.is_androidtv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_androidtv</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.is_androidtv" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Checks if this application does not require a touchscreen,
as this is the rule to get into the TV section of the Play Store
See: https://developer.android.com/training/tv/start/start.html for more information.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if 'android.hardware.touchscreen' is not required, <code>False</code> otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1697" name="__codelineno-0-1697"></a><span class="k">def</span> <span class="nf">is_androidtv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a><span class="sd">    Checks if this application does not require a touchscreen,</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a><span class="sd">    as this is the rule to get into the TV section of the Play Store</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a><span class="sd">    See: https://developer.android.com/training/tv/start/start.html for more information.</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a><span class="sd">    :returns: `True` if &#39;android.hardware.touchscreen&#39; is not required, `False` otherwise</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_value</span><span class="p">(</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>            <span class="s1">&#39;uses-feature&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>            <span class="s1">&#39;name&#39;</span><span class="p">,</span>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>            <span class="n">required</span><span class="o">=</span><span class="s2">&quot;false&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;android.hardware.touchscreen&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>        <span class="p">)</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>        <span class="o">==</span> <span class="s2">&quot;android.hardware.touchscreen&quot;</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.is_leanback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_leanback</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.is_leanback" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Checks if this application is build for TV (Leanback support)
by checkin if it uses the feature 'android.software.leanback'</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if leanback feature is used, <code>False</code> otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1688" name="__codelineno-0-1688"></a><span class="k">def</span> <span class="nf">is_leanback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a><span class="sd">    Checks if this application is build for TV (Leanback support)</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a><span class="sd">    by checkin if it uses the feature &#39;android.software.leanback&#39;</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a><span class="sd">    :returns: `True` if leanback feature is used, `False` otherwise</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a>    <span class="k">return</span> <span class="s1">&#39;android.software.leanback&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.is_multidex" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_multidex</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.is_multidex" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Test if the APK has multiple DEX files</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if multiple dex found, otherwise False</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="k">def</span> <span class="nf">is_multidex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">    Test if the APK has multiple DEX files</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">    :returns: True if multiple dex found, otherwise False</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>    <span class="n">dexre</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^classes(\d+)?.dex$&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>        <span class="nb">len</span><span class="p">(</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>            <span class="p">[</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>                <span class="n">instance</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>                <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_files</span><span class="p">()</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>                <span class="k">if</span> <span class="n">dexre</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>            <span class="p">]</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>        <span class="p">)</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>        <span class="o">&gt;</span> <span class="mi">1</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.is_signed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_signed</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.is_signed" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns true if any of v1, v2, or v3 signatures were found.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if any of v1, v2, or v3 signatures were found, else False</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2221" name="__codelineno-0-2221"></a><span class="k">def</span> <span class="nf">is_signed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2223" name="__codelineno-0-2223"></a><span class="sd">    Returns true if any of v1, v2, or v3 signatures were found.</span>
<a id="__codelineno-0-2224" name="__codelineno-0-2224"></a>
<a id="__codelineno-0-2225" name="__codelineno-0-2225"></a><span class="sd">    :returns: True if any of v1, v2, or v3 signatures were found, else False</span>
<a id="__codelineno-0-2226" name="__codelineno-0-2226"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2227" name="__codelineno-0-2227"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-2228" name="__codelineno-0-2228"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_signed_v1</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_signed_v2</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_signed_v3</span><span class="p">()</span>
<a id="__codelineno-0-2229" name="__codelineno-0-2229"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.is_signed_v1" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_signed_v1</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.is_signed_v1" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns <code>True</code> if a v1 / JAR signature was found.</p>
<p>Returning <code>True</code> does not mean that the file is properly signed!
It just says that there is a signature file which needs to be validated.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if a v1 / JAR signature was found, else <code>False</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2231" name="__codelineno-0-2231"></a><span class="k">def</span> <span class="nf">is_signed_v1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-2232" name="__codelineno-0-2232"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2233" name="__codelineno-0-2233"></a><span class="sd">    Returns `True` if a v1 / JAR signature was found.</span>
<a id="__codelineno-0-2234" name="__codelineno-0-2234"></a>
<a id="__codelineno-0-2235" name="__codelineno-0-2235"></a><span class="sd">    Returning `True` does not mean that the file is properly signed!</span>
<a id="__codelineno-0-2236" name="__codelineno-0-2236"></a><span class="sd">    It just says that there is a signature file which needs to be validated.</span>
<a id="__codelineno-0-2237" name="__codelineno-0-2237"></a>
<a id="__codelineno-0-2238" name="__codelineno-0-2238"></a><span class="sd">    :returns: `True` if a v1 / JAR signature was found, else `False`</span>
<a id="__codelineno-0-2239" name="__codelineno-0-2239"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2240" name="__codelineno-0-2240"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signature_name</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.is_signed_v2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_signed_v2</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.is_signed_v2" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns <code>True</code> of a v2 / APK signature was found.</p>
<p>Returning <code>True</code> does not mean that the file is properly signed!
It just says that there is a signature file which needs to be validated.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> of a v2 / APK signature was found, else <code>False</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span>
<span class="normal"><a href="#__codelineno-0-2247">2247</a></span>
<span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2242" name="__codelineno-0-2242"></a><span class="k">def</span> <span class="nf">is_signed_v2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-2243" name="__codelineno-0-2243"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2244" name="__codelineno-0-2244"></a><span class="sd">    Returns `True` of a v2 / APK signature was found.</span>
<a id="__codelineno-0-2245" name="__codelineno-0-2245"></a>
<a id="__codelineno-0-2246" name="__codelineno-0-2246"></a><span class="sd">    Returning `True` does not mean that the file is properly signed!</span>
<a id="__codelineno-0-2247" name="__codelineno-0-2247"></a><span class="sd">    It just says that there is a signature file which needs to be validated.</span>
<a id="__codelineno-0-2248" name="__codelineno-0-2248"></a>
<a id="__codelineno-0-2249" name="__codelineno-0-2249"></a><span class="sd">    :returns: `True` of a v2 / APK signature was found, else `False`</span>
<a id="__codelineno-0-2250" name="__codelineno-0-2250"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2251" name="__codelineno-0-2251"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2252" name="__codelineno-0-2252"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parse_v2_v3_signature</span><span class="p">()</span>
<a id="__codelineno-0-2253" name="__codelineno-0-2253"></a>
<a id="__codelineno-0-2254" name="__codelineno-0-2254"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.is_signed_v3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_signed_v3</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.is_signed_v3" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns <code>True</code> of a v3 / APK signature was found.</p>
<p>Returning <code>True</code> does not mean that the file is properly signed!
It just says that there is a signature file which needs to be validated.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> of a v3 / APK signature was found, else <code>False</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2256" name="__codelineno-0-2256"></a><span class="k">def</span> <span class="nf">is_signed_v3</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-2257" name="__codelineno-0-2257"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2258" name="__codelineno-0-2258"></a><span class="sd">    Returns `True` of a v3 / APK signature was found.</span>
<a id="__codelineno-0-2259" name="__codelineno-0-2259"></a>
<a id="__codelineno-0-2260" name="__codelineno-0-2260"></a><span class="sd">    Returning `True` does not mean that the file is properly signed!</span>
<a id="__codelineno-0-2261" name="__codelineno-0-2261"></a><span class="sd">    It just says that there is a signature file which needs to be validated.</span>
<a id="__codelineno-0-2262" name="__codelineno-0-2262"></a>
<a id="__codelineno-0-2263" name="__codelineno-0-2263"></a><span class="sd">    :returns: `True` of a v3 / APK signature was found, else `False`</span>
<a id="__codelineno-0-2264" name="__codelineno-0-2264"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2265" name="__codelineno-0-2265"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v3</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2266" name="__codelineno-0-2266"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parse_v2_v3_signature</span><span class="p">()</span>
<a id="__codelineno-0-2267" name="__codelineno-0-2267"></a>
<a id="__codelineno-0-2268" name="__codelineno-0-2268"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_signed_v3</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.is_tag_matched" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_tag_matched</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.is_tag_matched" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return <code>True</code> if the attributes matches in attribute filter.</p>
<p>An attribute filter is a dictionary containing: {attribute_name: value}.
This function will return <code>True</code> if and only if all attributes have the same value.
This function allows to set the dictionary via kwargs, thus you can filter like this:</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; a.is_tag_matched(tag, name=&quot;foobar&quot;, other=&quot;barfoo&quot;)
</code></pre></div>
<p>This function uses a fallback for attribute searching. It will by default use
the namespace variant but fall back to the non-namespace variant.
Thus specifiying <code>{"name": "foobar"}</code> will match on <code>&lt;bla name="foobar" \&gt;</code>
as well as on <code>&lt;bla android:name="foobar" \&gt;</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code><span title="lxml.etree.Element">Element</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify the tag element</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>attribute_filter</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specify the attribute filter as dictionary</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if the attributes matches in attribute filter, else <code>False</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1184" name="__codelineno-0-1184"></a><span class="k">def</span> <span class="nf">is_tag_matched</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">,</span> <span class="o">**</span><span class="n">attribute_filter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a><span class="sd">    Return `True` if the attributes matches in attribute filter.</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="sd">    An attribute filter is a dictionary containing: {attribute_name: value}.</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><span class="sd">    This function will return `True` if and only if all attributes have the same value.</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><span class="sd">    This function allows to set the dictionary via kwargs, thus you can filter like this:</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">        &gt;&gt;&gt; a.is_tag_matched(tag, name=&quot;foobar&quot;, other=&quot;barfoo&quot;)</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><span class="sd">    This function uses a fallback for attribute searching. It will by default use</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><span class="sd">    the namespace variant but fall back to the non-namespace variant.</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="sd">    Thus specifiying `{&quot;name&quot;: &quot;foobar&quot;}` will match on `&lt;bla name=&quot;foobar&quot; \&gt;`</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">    as well as on `&lt;bla android:name=&quot;foobar&quot; \&gt;`.</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="sd">    :param tag: specify the tag element</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="sd">    :param attribute_filter: specify the attribute filter as dictionary</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a><span class="sd">    :returns: `True` if the attributes matches in attribute filter, else `False`</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attribute_filter</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>    <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">attribute_filter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>        <span class="n">_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_value_from_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>        <span class="k">if</span> <span class="n">_value</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.is_valid_APK" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_valid_APK</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.is_valid_APK" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return <code>True</code> if the APK is valid, <code>False</code> otherwise.
An APK is seen as valid, if the <code>AndroidManifest.xml</code> could be successful parsed.
This does not mean that the APK has a valid signature nor that the APK
can be installed on an Android system.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if the APK is valid, <code>False</code> otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="k">def</span> <span class="nf">is_valid_APK</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">    Return `True` if the APK is valid, `False` otherwise.</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">    An APK is seen as valid, if the `AndroidManifest.xml` could be successful parsed.</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">    This does not mean that the APK has a valid signature nor that the APK</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">    can be installed on an Android system.</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">    :returns: `True` if the APK is valid, `False` otherwise.</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid_apk</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.is_wearable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_wearable</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.is_wearable" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Checks if this application is build for wearables by
checking if it uses the feature 'android.hardware.type.watch'
See: https://developer.android.com/training/wearables/apps/creating.html for more information.</p>
<p>Not every app is setting this feature (not even the example Google provides),
so it might be wise to not 100% rely on this feature.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if wearable, <code>False</code> otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1675" name="__codelineno-0-1675"></a><span class="k">def</span> <span class="nf">is_wearable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a><span class="sd">    Checks if this application is build for wearables by</span>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a><span class="sd">    checking if it uses the feature &#39;android.hardware.type.watch&#39;</span>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a><span class="sd">    See: https://developer.android.com/training/wearables/apps/creating.html for more information.</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a><span class="sd">    Not every app is setting this feature (not even the example Google provides),</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a><span class="sd">    so it might be wise to not 100% rely on this feature.</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a><span class="sd">    :returns: `True` if wearable, `False` otherwise</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a>    <span class="k">return</span> <span class="s1">&#39;android.hardware.type.watch&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.new_zip" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">new_zip</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">deleted_files</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">new_files</span><span class="o">=</span><span class="p">{})</span></code>

<a href="#androguard.core.apk.APK.new_zip" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Create a new zip file</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the output filename of the zip</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>deleted_files</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a regex pattern to remove specific file, or <code>None</code></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_files</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a dictionnary of new files (key:filename, value:content of the file)</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2139">2139</a></span>
<span class="normal"><a href="#__codelineno-0-2140">2140</a></span>
<span class="normal"><a href="#__codelineno-0-2141">2141</a></span>
<span class="normal"><a href="#__codelineno-0-2142">2142</a></span>
<span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2139" name="__codelineno-0-2139"></a><span class="k">def</span> <span class="nf">new_zip</span><span class="p">(</span>
<a id="__codelineno-0-2140" name="__codelineno-0-2140"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2141" name="__codelineno-0-2141"></a>    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-2142" name="__codelineno-0-2142"></a>    <span class="n">deleted_files</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2143" name="__codelineno-0-2143"></a>    <span class="n">new_files</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-2144" name="__codelineno-0-2144"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2145" name="__codelineno-0-2145"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2146" name="__codelineno-0-2146"></a><span class="sd">    Create a new zip file</span>
<a id="__codelineno-0-2147" name="__codelineno-0-2147"></a>
<a id="__codelineno-0-2148" name="__codelineno-0-2148"></a><span class="sd">    :param filename: the output filename of the zip</span>
<a id="__codelineno-0-2149" name="__codelineno-0-2149"></a><span class="sd">    :param deleted_files: a regex pattern to remove specific file, or `None`</span>
<a id="__codelineno-0-2150" name="__codelineno-0-2150"></a><span class="sd">    :param new_files: a dictionnary of new files (key:filename, value:content of the file)</span>
<a id="__codelineno-0-2151" name="__codelineno-0-2151"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2152" name="__codelineno-0-2152"></a>    <span class="n">zout</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2153" name="__codelineno-0-2153"></a>
<a id="__codelineno-0-2154" name="__codelineno-0-2154"></a>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">infolist</span><span class="p">():</span>
<a id="__codelineno-0-2155" name="__codelineno-0-2155"></a>        <span class="c1"># Block one: deleted_files, or deleted_files and new_files</span>
<a id="__codelineno-0-2156" name="__codelineno-0-2156"></a>        <span class="k">if</span> <span class="n">deleted_files</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2157" name="__codelineno-0-2157"></a>            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">deleted_files</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2158" name="__codelineno-0-2158"></a>                <span class="c1"># if the regex of deleted_files doesn&#39;t match the filename</span>
<a id="__codelineno-0-2159" name="__codelineno-0-2159"></a>                <span class="k">if</span> <span class="n">new_files</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-2160" name="__codelineno-0-2160"></a>                    <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">new_files</span><span class="p">:</span>
<a id="__codelineno-0-2161" name="__codelineno-0-2161"></a>                        <span class="c1"># and if the filename is in new_files</span>
<a id="__codelineno-0-2162" name="__codelineno-0-2162"></a>                        <span class="n">zout</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">new_files</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
<a id="__codelineno-0-2163" name="__codelineno-0-2163"></a>                        <span class="k">continue</span>
<a id="__codelineno-0-2164" name="__codelineno-0-2164"></a>                <span class="c1"># Otherwise, write the original file.</span>
<a id="__codelineno-0-2165" name="__codelineno-0-2165"></a>                <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<a id="__codelineno-0-2166" name="__codelineno-0-2166"></a>                <span class="n">zout</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<a id="__codelineno-0-2167" name="__codelineno-0-2167"></a>        <span class="c1"># Block two: deleted_files is None, new_files is not empty</span>
<a id="__codelineno-0-2168" name="__codelineno-0-2168"></a>        <span class="k">elif</span> <span class="n">new_files</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a>            <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">new_files</span><span class="p">:</span>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a>                <span class="n">zout</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">new_files</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a>                <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a>                <span class="n">zout</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a>        <span class="c1"># Block three: deleted_files is None, new_files is empty.</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a>        <span class="c1"># Just write out the default zip</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a>            <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a>            <span class="n">zout</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a>    <span class="n">zout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.parse_signatures_or_digests" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_signatures_or_digests</span><span class="p">(</span><span class="n">digest_bytes</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.parse_signatures_or_digests" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Parse digests</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>digest_bytes</code>
            </td>
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the digests bytes</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[tuple[int, bytes]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of tuple where the first element is the <code>algorithm_id</code> and the second is the digest bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2279" name="__codelineno-0-2279"></a><span class="k">def</span> <span class="nf">parse_signatures_or_digests</span><span class="p">(</span>
<a id="__codelineno-0-2280" name="__codelineno-0-2280"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">digest_bytes</span><span class="p">:</span> <span class="nb">bytes</span>
<a id="__codelineno-0-2281" name="__codelineno-0-2281"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]:</span>
<a id="__codelineno-0-2282" name="__codelineno-0-2282"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse digests</span>
<a id="__codelineno-0-2283" name="__codelineno-0-2283"></a>
<a id="__codelineno-0-2284" name="__codelineno-0-2284"></a><span class="sd">    :param digest_bytes: the digests bytes</span>
<a id="__codelineno-0-2285" name="__codelineno-0-2285"></a><span class="sd">    :returns: a list of tuple where the first element is the `algorithm_id` and the second is the digest bytes</span>
<a id="__codelineno-0-2286" name="__codelineno-0-2286"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2287" name="__codelineno-0-2287"></a>
<a id="__codelineno-0-2288" name="__codelineno-0-2288"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">digest_bytes</span><span class="p">):</span>
<a id="__codelineno-0-2289" name="__codelineno-0-2289"></a>        <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-2290" name="__codelineno-0-2290"></a>
<a id="__codelineno-0-2291" name="__codelineno-0-2291"></a>    <span class="n">digests</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2292" name="__codelineno-0-2292"></a>    <span class="n">block</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">digest_bytes</span><span class="p">)</span>
<a id="__codelineno-0-2293" name="__codelineno-0-2293"></a>
<a id="__codelineno-0-2294" name="__codelineno-0-2294"></a>    <span class="n">data_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2295" name="__codelineno-0-2295"></a>    <span class="k">while</span> <span class="n">block</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">data_len</span><span class="p">:</span>
<a id="__codelineno-0-2296" name="__codelineno-0-2296"></a>
<a id="__codelineno-0-2297" name="__codelineno-0-2297"></a>        <span class="n">algorithm_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2298" name="__codelineno-0-2298"></a>        <span class="n">digest_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2299" name="__codelineno-0-2299"></a>        <span class="n">digest</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">digest_len</span><span class="p">)</span>
<a id="__codelineno-0-2300" name="__codelineno-0-2300"></a>
<a id="__codelineno-0-2301" name="__codelineno-0-2301"></a>        <span class="n">digests</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">algorithm_id</span><span class="p">,</span> <span class="n">digest</span><span class="p">))</span>
<a id="__codelineno-0-2302" name="__codelineno-0-2302"></a>
<a id="__codelineno-0-2303" name="__codelineno-0-2303"></a>    <span class="k">return</span> <span class="n">digests</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.parse_v2_signing_block" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_v2_signing_block</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.parse_v2_signing_block" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Parse the V2 signing block and extract all features</p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span>
<span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span>
<span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span>
<span class="normal"><a href="#__codelineno-0-2580">2580</a></span>
<span class="normal"><a href="#__codelineno-0-2581">2581</a></span>
<span class="normal"><a href="#__codelineno-0-2582">2582</a></span>
<span class="normal"><a href="#__codelineno-0-2583">2583</a></span>
<span class="normal"><a href="#__codelineno-0-2584">2584</a></span>
<span class="normal"><a href="#__codelineno-0-2585">2585</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2503" name="__codelineno-0-2503"></a><span class="k">def</span> <span class="nf">parse_v2_signing_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2504" name="__codelineno-0-2504"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2505" name="__codelineno-0-2505"></a><span class="sd">    Parse the V2 signing block and extract all features</span>
<a id="__codelineno-0-2506" name="__codelineno-0-2506"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2507" name="__codelineno-0-2507"></a>
<a id="__codelineno-0-2508" name="__codelineno-0-2508"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2509" name="__codelineno-0-2509"></a>
<a id="__codelineno-0-2510" name="__codelineno-0-2510"></a>    <span class="c1"># calling is_signed_v2 should also load the signature</span>
<a id="__codelineno-0-2511" name="__codelineno-0-2511"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_signed_v2</span><span class="p">():</span>
<a id="__codelineno-0-2512" name="__codelineno-0-2512"></a>        <span class="k">return</span>
<a id="__codelineno-0-2513" name="__codelineno-0-2513"></a>
<a id="__codelineno-0-2514" name="__codelineno-0-2514"></a>    <span class="n">block_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_blocks</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_APK_SIG_KEY_V2_SIGNATURE</span><span class="p">]</span>
<a id="__codelineno-0-2515" name="__codelineno-0-2515"></a>    <span class="n">block</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">block_bytes</span><span class="p">)</span>
<a id="__codelineno-0-2516" name="__codelineno-0-2516"></a>    <span class="n">view</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<a id="__codelineno-0-2517" name="__codelineno-0-2517"></a>
<a id="__codelineno-0-2518" name="__codelineno-0-2518"></a>    <span class="c1"># V2 signature Block data format:</span>
<a id="__codelineno-0-2519" name="__codelineno-0-2519"></a>    <span class="c1">#</span>
<a id="__codelineno-0-2520" name="__codelineno-0-2520"></a>    <span class="c1"># * signer:</span>
<a id="__codelineno-0-2521" name="__codelineno-0-2521"></a>    <span class="c1">#    * signed data:</span>
<a id="__codelineno-0-2522" name="__codelineno-0-2522"></a>    <span class="c1">#        * digests:</span>
<a id="__codelineno-0-2523" name="__codelineno-0-2523"></a>    <span class="c1">#            * signature algorithm ID (uint32)</span>
<a id="__codelineno-0-2524" name="__codelineno-0-2524"></a>    <span class="c1">#            * digest (length-prefixed)</span>
<a id="__codelineno-0-2525" name="__codelineno-0-2525"></a>    <span class="c1">#        * certificates</span>
<a id="__codelineno-0-2526" name="__codelineno-0-2526"></a>    <span class="c1">#        * additional attributes</span>
<a id="__codelineno-0-2527" name="__codelineno-0-2527"></a>    <span class="c1">#    * signatures</span>
<a id="__codelineno-0-2528" name="__codelineno-0-2528"></a>    <span class="c1">#    * publickey</span>
<a id="__codelineno-0-2529" name="__codelineno-0-2529"></a>
<a id="__codelineno-0-2530" name="__codelineno-0-2530"></a>    <span class="n">size_sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2531" name="__codelineno-0-2531"></a>    <span class="k">if</span> <span class="n">size_sequence</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">block_bytes</span><span class="p">):</span>
<a id="__codelineno-0-2532" name="__codelineno-0-2532"></a>        <span class="k">raise</span> <span class="n">BrokenAPKError</span><span class="p">(</span>
<a id="__codelineno-0-2533" name="__codelineno-0-2533"></a>            <span class="s2">&quot;size of sequence and blocksize does not match&quot;</span>
<a id="__codelineno-0-2534" name="__codelineno-0-2534"></a>        <span class="p">)</span>
<a id="__codelineno-0-2535" name="__codelineno-0-2535"></a>
<a id="__codelineno-0-2536" name="__codelineno-0-2536"></a>    <span class="k">while</span> <span class="n">block</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">block_bytes</span><span class="p">):</span>
<a id="__codelineno-0-2537" name="__codelineno-0-2537"></a>        <span class="n">off_signer</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2538" name="__codelineno-0-2538"></a>        <span class="n">size_signer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2539" name="__codelineno-0-2539"></a>
<a id="__codelineno-0-2540" name="__codelineno-0-2540"></a>        <span class="c1"># read whole signed data, since we might to parse</span>
<a id="__codelineno-0-2541" name="__codelineno-0-2541"></a>        <span class="c1"># content within the signed data, and mess up offset</span>
<a id="__codelineno-0-2542" name="__codelineno-0-2542"></a>        <span class="n">len_signed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>        <span class="n">signed_data_bytes</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>        <span class="n">signed_data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">signed_data_bytes</span><span class="p">)</span>
<a id="__codelineno-0-2545" name="__codelineno-0-2545"></a>
<a id="__codelineno-0-2546" name="__codelineno-0-2546"></a>        <span class="c1"># Digests</span>
<a id="__codelineno-0-2547" name="__codelineno-0-2547"></a>        <span class="n">len_digests</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>        <span class="n">raw_digests</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_digests</span><span class="p">)</span>
<a id="__codelineno-0-2549" name="__codelineno-0-2549"></a>        <span class="n">digests</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_signatures_or_digests</span><span class="p">(</span><span class="n">raw_digests</span><span class="p">)</span>
<a id="__codelineno-0-2550" name="__codelineno-0-2550"></a>
<a id="__codelineno-0-2551" name="__codelineno-0-2551"></a>        <span class="c1"># Certs</span>
<a id="__codelineno-0-2552" name="__codelineno-0-2552"></a>        <span class="n">certs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2553" name="__codelineno-0-2553"></a>        <span class="n">len_certs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2554" name="__codelineno-0-2554"></a>        <span class="n">start_certs</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2555" name="__codelineno-0-2555"></a>        <span class="k">while</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">start_certs</span> <span class="o">+</span> <span class="n">len_certs</span><span class="p">:</span>
<a id="__codelineno-0-2556" name="__codelineno-0-2556"></a>            <span class="n">len_cert</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2557" name="__codelineno-0-2557"></a>            <span class="n">cert</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_cert</span><span class="p">)</span>
<a id="__codelineno-0-2558" name="__codelineno-0-2558"></a>            <span class="n">certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2559" name="__codelineno-0-2559"></a>
<a id="__codelineno-0-2560" name="__codelineno-0-2560"></a>        <span class="c1"># Additional attributes</span>
<a id="__codelineno-0-2561" name="__codelineno-0-2561"></a>        <span class="n">len_attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2562" name="__codelineno-0-2562"></a>        <span class="n">attributes</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_attr</span><span class="p">)</span>
<a id="__codelineno-0-2563" name="__codelineno-0-2563"></a>
<a id="__codelineno-0-2564" name="__codelineno-0-2564"></a>        <span class="n">signed_data_object</span> <span class="o">=</span> <span class="n">APKV2SignedData</span><span class="p">()</span>
<a id="__codelineno-0-2565" name="__codelineno-0-2565"></a>        <span class="n">signed_data_object</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="n">signed_data_bytes</span>
<a id="__codelineno-0-2566" name="__codelineno-0-2566"></a>        <span class="n">signed_data_object</span><span class="o">.</span><span class="n">digests</span> <span class="o">=</span> <span class="n">digests</span>
<a id="__codelineno-0-2567" name="__codelineno-0-2567"></a>        <span class="n">signed_data_object</span><span class="o">.</span><span class="n">certificates</span> <span class="o">=</span> <span class="n">certs</span>
<a id="__codelineno-0-2568" name="__codelineno-0-2568"></a>        <span class="n">signed_data_object</span><span class="o">.</span><span class="n">additional_attributes</span> <span class="o">=</span> <span class="n">attributes</span>
<a id="__codelineno-0-2569" name="__codelineno-0-2569"></a>
<a id="__codelineno-0-2570" name="__codelineno-0-2570"></a>        <span class="c1"># Signatures</span>
<a id="__codelineno-0-2571" name="__codelineno-0-2571"></a>        <span class="n">len_sigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2572" name="__codelineno-0-2572"></a>        <span class="n">raw_sigs</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_sigs</span><span class="p">)</span>
<a id="__codelineno-0-2573" name="__codelineno-0-2573"></a>        <span class="n">sigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_signatures_or_digests</span><span class="p">(</span><span class="n">raw_sigs</span><span class="p">)</span>
<a id="__codelineno-0-2574" name="__codelineno-0-2574"></a>
<a id="__codelineno-0-2575" name="__codelineno-0-2575"></a>        <span class="c1"># PublicKey</span>
<a id="__codelineno-0-2576" name="__codelineno-0-2576"></a>        <span class="n">len_publickey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2577" name="__codelineno-0-2577"></a>        <span class="n">publickey</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_publickey</span><span class="p">)</span>
<a id="__codelineno-0-2578" name="__codelineno-0-2578"></a>
<a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>        <span class="n">signer</span> <span class="o">=</span> <span class="n">APKV2Signer</span><span class="p">()</span>
<a id="__codelineno-0-2580" name="__codelineno-0-2580"></a>        <span class="n">signer</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="n">view</span><span class="p">[</span><span class="n">off_signer</span> <span class="p">:</span> <span class="n">off_signer</span> <span class="o">+</span> <span class="n">size_signer</span><span class="p">]</span>
<a id="__codelineno-0-2581" name="__codelineno-0-2581"></a>        <span class="n">signer</span><span class="o">.</span><span class="n">signed_data</span> <span class="o">=</span> <span class="n">signed_data_object</span>
<a id="__codelineno-0-2582" name="__codelineno-0-2582"></a>        <span class="n">signer</span><span class="o">.</span><span class="n">signatures</span> <span class="o">=</span> <span class="n">sigs</span>
<a id="__codelineno-0-2583" name="__codelineno-0-2583"></a>        <span class="n">signer</span><span class="o">.</span><span class="n">public_key</span> <span class="o">=</span> <span class="n">publickey</span>
<a id="__codelineno-0-2584" name="__codelineno-0-2584"></a>
<a id="__codelineno-0-2585" name="__codelineno-0-2585"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_v2_signing_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signer</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.parse_v3_signing_block" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_v3_signing_block</span><span class="p">()</span></code>

<a href="#androguard.core.apk.APK.parse_v3_signing_block" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Parse the V2 signing block and extract all features</p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2403">2403</a></span>
<span class="normal"><a href="#__codelineno-0-2404">2404</a></span>
<span class="normal"><a href="#__codelineno-0-2405">2405</a></span>
<span class="normal"><a href="#__codelineno-0-2406">2406</a></span>
<span class="normal"><a href="#__codelineno-0-2407">2407</a></span>
<span class="normal"><a href="#__codelineno-0-2408">2408</a></span>
<span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2403" name="__codelineno-0-2403"></a><span class="k">def</span> <span class="nf">parse_v3_signing_block</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2404" name="__codelineno-0-2404"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2405" name="__codelineno-0-2405"></a><span class="sd">    Parse the V2 signing block and extract all features</span>
<a id="__codelineno-0-2406" name="__codelineno-0-2406"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2407" name="__codelineno-0-2407"></a>
<a id="__codelineno-0-2408" name="__codelineno-0-2408"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2409" name="__codelineno-0-2409"></a>
<a id="__codelineno-0-2410" name="__codelineno-0-2410"></a>    <span class="c1"># calling is_signed_v3 should also load the signature, if any</span>
<a id="__codelineno-0-2411" name="__codelineno-0-2411"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_signed_v3</span><span class="p">():</span>
<a id="__codelineno-0-2412" name="__codelineno-0-2412"></a>        <span class="k">return</span>
<a id="__codelineno-0-2413" name="__codelineno-0-2413"></a>
<a id="__codelineno-0-2414" name="__codelineno-0-2414"></a>    <span class="n">block_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_v2_blocks</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_APK_SIG_KEY_V3_SIGNATURE</span><span class="p">]</span>
<a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>    <span class="n">block</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">block_bytes</span><span class="p">)</span>
<a id="__codelineno-0-2416" name="__codelineno-0-2416"></a>    <span class="n">view</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<a id="__codelineno-0-2417" name="__codelineno-0-2417"></a>
<a id="__codelineno-0-2418" name="__codelineno-0-2418"></a>    <span class="c1"># V3 signature Block data format:</span>
<a id="__codelineno-0-2419" name="__codelineno-0-2419"></a>    <span class="c1">#</span>
<a id="__codelineno-0-2420" name="__codelineno-0-2420"></a>    <span class="c1"># * signer:</span>
<a id="__codelineno-0-2421" name="__codelineno-0-2421"></a>    <span class="c1">#    * signed data:</span>
<a id="__codelineno-0-2422" name="__codelineno-0-2422"></a>    <span class="c1">#        * digests:</span>
<a id="__codelineno-0-2423" name="__codelineno-0-2423"></a>    <span class="c1">#            * signature algorithm ID (uint32)</span>
<a id="__codelineno-0-2424" name="__codelineno-0-2424"></a>    <span class="c1">#            * digest (length-prefixed)</span>
<a id="__codelineno-0-2425" name="__codelineno-0-2425"></a>    <span class="c1">#        * certificates</span>
<a id="__codelineno-0-2426" name="__codelineno-0-2426"></a>    <span class="c1">#        * minSDK</span>
<a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>    <span class="c1">#        * maxSDK</span>
<a id="__codelineno-0-2428" name="__codelineno-0-2428"></a>    <span class="c1">#        * additional attributes</span>
<a id="__codelineno-0-2429" name="__codelineno-0-2429"></a>    <span class="c1">#    * minSDK</span>
<a id="__codelineno-0-2430" name="__codelineno-0-2430"></a>    <span class="c1">#    * maxSDK</span>
<a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>    <span class="c1">#    * signatures</span>
<a id="__codelineno-0-2432" name="__codelineno-0-2432"></a>    <span class="c1">#    * publickey</span>
<a id="__codelineno-0-2433" name="__codelineno-0-2433"></a>    <span class="n">size_sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2434" name="__codelineno-0-2434"></a>    <span class="k">if</span> <span class="n">size_sequence</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">block_bytes</span><span class="p">):</span>
<a id="__codelineno-0-2435" name="__codelineno-0-2435"></a>        <span class="k">raise</span> <span class="n">BrokenAPKError</span><span class="p">(</span>
<a id="__codelineno-0-2436" name="__codelineno-0-2436"></a>            <span class="s2">&quot;size of sequence and blocksize does not match&quot;</span>
<a id="__codelineno-0-2437" name="__codelineno-0-2437"></a>        <span class="p">)</span>
<a id="__codelineno-0-2438" name="__codelineno-0-2438"></a>
<a id="__codelineno-0-2439" name="__codelineno-0-2439"></a>    <span class="k">while</span> <span class="n">block</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">block_bytes</span><span class="p">):</span>
<a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>        <span class="n">off_signer</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2441" name="__codelineno-0-2441"></a>        <span class="n">size_signer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>
<a id="__codelineno-0-2443" name="__codelineno-0-2443"></a>        <span class="c1"># read whole signed data, since we might to parse</span>
<a id="__codelineno-0-2444" name="__codelineno-0-2444"></a>        <span class="c1"># content within the signed data, and mess up offset</span>
<a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>        <span class="n">len_signed_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2446" name="__codelineno-0-2446"></a>        <span class="n">signed_data_bytes</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2447" name="__codelineno-0-2447"></a>        <span class="n">signed_data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">signed_data_bytes</span><span class="p">)</span>
<a id="__codelineno-0-2448" name="__codelineno-0-2448"></a>
<a id="__codelineno-0-2449" name="__codelineno-0-2449"></a>        <span class="c1"># Digests</span>
<a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>        <span class="n">len_digests</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2451" name="__codelineno-0-2451"></a>        <span class="n">raw_digests</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_digests</span><span class="p">)</span>
<a id="__codelineno-0-2452" name="__codelineno-0-2452"></a>        <span class="n">digests</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_signatures_or_digests</span><span class="p">(</span><span class="n">raw_digests</span><span class="p">)</span>
<a id="__codelineno-0-2453" name="__codelineno-0-2453"></a>
<a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>        <span class="c1"># Certs</span>
<a id="__codelineno-0-2455" name="__codelineno-0-2455"></a>        <span class="n">certs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2456" name="__codelineno-0-2456"></a>        <span class="n">len_certs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2457" name="__codelineno-0-2457"></a>        <span class="n">start_certs</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>        <span class="k">while</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">start_certs</span> <span class="o">+</span> <span class="n">len_certs</span><span class="p">:</span>
<a id="__codelineno-0-2459" name="__codelineno-0-2459"></a>
<a id="__codelineno-0-2460" name="__codelineno-0-2460"></a>            <span class="n">len_cert</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2461" name="__codelineno-0-2461"></a>            <span class="n">cert</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_cert</span><span class="p">)</span>
<a id="__codelineno-0-2462" name="__codelineno-0-2462"></a>            <span class="n">certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-2463" name="__codelineno-0-2463"></a>
<a id="__codelineno-0-2464" name="__codelineno-0-2464"></a>        <span class="c1"># versions</span>
<a id="__codelineno-0-2465" name="__codelineno-0-2465"></a>        <span class="n">signed_data_min_sdk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>        <span class="n">signed_data_max_sdk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>
<a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>        <span class="c1"># Addional attributes</span>
<a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>        <span class="n">len_attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">signed_data</span><span class="p">)</span>
<a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>        <span class="n">attr</span> <span class="o">=</span> <span class="n">signed_data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_attr</span><span class="p">)</span>
<a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>
<a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>        <span class="n">signed_data_object</span> <span class="o">=</span> <span class="n">APKV3SignedData</span><span class="p">()</span>
<a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>        <span class="n">signed_data_object</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="n">signed_data_bytes</span>
<a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>        <span class="n">signed_data_object</span><span class="o">.</span><span class="n">digests</span> <span class="o">=</span> <span class="n">digests</span>
<a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>        <span class="n">signed_data_object</span><span class="o">.</span><span class="n">certificates</span> <span class="o">=</span> <span class="n">certs</span>
<a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>        <span class="n">signed_data_object</span><span class="o">.</span><span class="n">additional_attributes</span> <span class="o">=</span> <span class="n">attr</span>
<a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>        <span class="n">signed_data_object</span><span class="o">.</span><span class="n">minSDK</span> <span class="o">=</span> <span class="n">signed_data_min_sdk</span>
<a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>        <span class="n">signed_data_object</span><span class="o">.</span><span class="n">maxSDK</span> <span class="o">=</span> <span class="n">signed_data_max_sdk</span>
<a id="__codelineno-0-2479" name="__codelineno-0-2479"></a>
<a id="__codelineno-0-2480" name="__codelineno-0-2480"></a>        <span class="c1"># versions (should be the same as signed data&#39;s versions)</span>
<a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>        <span class="n">signer_min_sdk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>        <span class="n">signer_max_sdk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2483" name="__codelineno-0-2483"></a>
<a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>        <span class="c1"># Signatures</span>
<a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>        <span class="n">len_sigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2486" name="__codelineno-0-2486"></a>        <span class="n">raw_sigs</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_sigs</span><span class="p">)</span>
<a id="__codelineno-0-2487" name="__codelineno-0-2487"></a>        <span class="n">sigs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_signatures_or_digests</span><span class="p">(</span><span class="n">raw_sigs</span><span class="p">)</span>
<a id="__codelineno-0-2488" name="__codelineno-0-2488"></a>
<a id="__codelineno-0-2489" name="__codelineno-0-2489"></a>        <span class="c1"># PublicKey</span>
<a id="__codelineno-0-2490" name="__codelineno-0-2490"></a>        <span class="n">len_publickey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-2491" name="__codelineno-0-2491"></a>        <span class="n">publickey</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">len_publickey</span><span class="p">)</span>
<a id="__codelineno-0-2492" name="__codelineno-0-2492"></a>
<a id="__codelineno-0-2493" name="__codelineno-0-2493"></a>        <span class="n">signer</span> <span class="o">=</span> <span class="n">APKV3Signer</span><span class="p">()</span>
<a id="__codelineno-0-2494" name="__codelineno-0-2494"></a>        <span class="n">signer</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="n">view</span><span class="p">[</span><span class="n">off_signer</span> <span class="p">:</span> <span class="n">off_signer</span> <span class="o">+</span> <span class="n">size_signer</span><span class="p">]</span>
<a id="__codelineno-0-2495" name="__codelineno-0-2495"></a>        <span class="n">signer</span><span class="o">.</span><span class="n">signed_data</span> <span class="o">=</span> <span class="n">signed_data_object</span>
<a id="__codelineno-0-2496" name="__codelineno-0-2496"></a>        <span class="n">signer</span><span class="o">.</span><span class="n">signatures</span> <span class="o">=</span> <span class="n">sigs</span>
<a id="__codelineno-0-2497" name="__codelineno-0-2497"></a>        <span class="n">signer</span><span class="o">.</span><span class="n">public_key</span> <span class="o">=</span> <span class="n">publickey</span>
<a id="__codelineno-0-2498" name="__codelineno-0-2498"></a>        <span class="n">signer</span><span class="o">.</span><span class="n">minSDK</span> <span class="o">=</span> <span class="n">signer_min_sdk</span>
<a id="__codelineno-0-2499" name="__codelineno-0-2499"></a>        <span class="n">signer</span><span class="o">.</span><span class="n">maxSDK</span> <span class="o">=</span> <span class="n">signer_max_sdk</span>
<a id="__codelineno-0-2500" name="__codelineno-0-2500"></a>
<a id="__codelineno-0-2501" name="__codelineno-0-2501"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_v3_signing_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signer</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.read_uint32_le" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_uint32_le</span><span class="p">(</span><span class="n">io_stream</span><span class="p">)</span></code>

<a href="#androguard.core.apk.APK.read_uint32_le" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>read a <code>uint32_le</code> from <code>io_stream</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>io_stream</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the stream to get a <code>uint32_le</code> from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the <code>uint32_le</code> value</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2270" name="__codelineno-0-2270"></a><span class="k">def</span> <span class="nf">read_uint32_le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">io_stream</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-2271" name="__codelineno-0-2271"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;read a `uint32_le` from `io_stream`</span>
<a id="__codelineno-0-2272" name="__codelineno-0-2272"></a>
<a id="__codelineno-0-2273" name="__codelineno-0-2273"></a><span class="sd">    :param io_stream: the stream to get a `uint32_le` from</span>
<a id="__codelineno-0-2274" name="__codelineno-0-2274"></a><span class="sd">    :return: the `uint32_le` value</span>
<a id="__codelineno-0-2275" name="__codelineno-0-2275"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2276" name="__codelineno-0-2276"></a>    <span class="p">(</span><span class="n">value</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">io_stream</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-2277" name="__codelineno-0-2277"></a>    <span class="k">return</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.apk.APK.x509_ordered_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">x509_ordered_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">android</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#androguard.core.apk.APK.x509_ordered_name" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a> * Method is dual-licensed under the Apache License 2.0 and GPLv3+.
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a> * The original author has granted permission to use this code snippet under the
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a> * Apache License 2.0 for inclusion in this project.
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a> * https://github.com/obfusk/x509_canonical_name.py/blob/master/x509_canonical_name.py
</code></pre></div>
<p>Representation of <code>x509.Name</code> as nested list, in canonical ordering (but also
including non-canonical pre-normalised string values).</p>
<p>Returns a list of RDNs which are a list of AVAs which are a (oid, type,
normalised_value, esc_value) tuple, where oid is 0 for standard names and 1
for dotted OIDs, type is the standard name or dotted OID, normalised_value
is the normalised string representation of the value, and esc_value is the
string value before normalisation (but after escaping).</p>
<p>NB: control characters are not escaped, only characters in ",+&lt;&gt;;"\" and
"#" at the start (before "whitespace" trimming) are.</p>
<p><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/security/auth/x500/X500Principal.html#getName(java.lang.String)">X500Principal.getName</a>
<a href="https://github.com/openjdk/jdk/blob/jdk-21%2B35/src/java.base/share/classes/sun/security/x509/AVA.java#L805">AVA.java</a>
<a href="https://github.com/openjdk/jdk/blob/jdk-21%2B35/src/java.base/share/classes/sun/security/x509/RDN.java#L472">RDN.java (472)</a>
<a href="https://android.googlesource.com/platform/libcore/+/refs/heads/android14-release/ojluni/src/main/java/sun/security/x509/RDN.java#481">RDN.java (481)</a></p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2054">2054</a></span>
<span class="normal"><a href="#__codelineno-0-2055">2055</a></span>
<span class="normal"><a href="#__codelineno-0-2056">2056</a></span>
<span class="normal"><a href="#__codelineno-0-2057">2057</a></span>
<span class="normal"><a href="#__codelineno-0-2058">2058</a></span>
<span class="normal"><a href="#__codelineno-0-2059">2059</a></span>
<span class="normal"><a href="#__codelineno-0-2060">2060</a></span>
<span class="normal"><a href="#__codelineno-0-2061">2061</a></span>
<span class="normal"><a href="#__codelineno-0-2062">2062</a></span>
<span class="normal"><a href="#__codelineno-0-2063">2063</a></span>
<span class="normal"><a href="#__codelineno-0-2064">2064</a></span>
<span class="normal"><a href="#__codelineno-0-2065">2065</a></span>
<span class="normal"><a href="#__codelineno-0-2066">2066</a></span>
<span class="normal"><a href="#__codelineno-0-2067">2067</a></span>
<span class="normal"><a href="#__codelineno-0-2068">2068</a></span>
<span class="normal"><a href="#__codelineno-0-2069">2069</a></span>
<span class="normal"><a href="#__codelineno-0-2070">2070</a></span>
<span class="normal"><a href="#__codelineno-0-2071">2071</a></span>
<span class="normal"><a href="#__codelineno-0-2072">2072</a></span>
<span class="normal"><a href="#__codelineno-0-2073">2073</a></span>
<span class="normal"><a href="#__codelineno-0-2074">2074</a></span>
<span class="normal"><a href="#__codelineno-0-2075">2075</a></span>
<span class="normal"><a href="#__codelineno-0-2076">2076</a></span>
<span class="normal"><a href="#__codelineno-0-2077">2077</a></span>
<span class="normal"><a href="#__codelineno-0-2078">2078</a></span>
<span class="normal"><a href="#__codelineno-0-2079">2079</a></span>
<span class="normal"><a href="#__codelineno-0-2080">2080</a></span>
<span class="normal"><a href="#__codelineno-0-2081">2081</a></span>
<span class="normal"><a href="#__codelineno-0-2082">2082</a></span>
<span class="normal"><a href="#__codelineno-0-2083">2083</a></span>
<span class="normal"><a href="#__codelineno-0-2084">2084</a></span>
<span class="normal"><a href="#__codelineno-0-2085">2085</a></span>
<span class="normal"><a href="#__codelineno-0-2086">2086</a></span>
<span class="normal"><a href="#__codelineno-0-2087">2087</a></span>
<span class="normal"><a href="#__codelineno-0-2088">2088</a></span>
<span class="normal"><a href="#__codelineno-0-2089">2089</a></span>
<span class="normal"><a href="#__codelineno-0-2090">2090</a></span>
<span class="normal"><a href="#__codelineno-0-2091">2091</a></span>
<span class="normal"><a href="#__codelineno-0-2092">2092</a></span>
<span class="normal"><a href="#__codelineno-0-2093">2093</a></span>
<span class="normal"><a href="#__codelineno-0-2094">2094</a></span>
<span class="normal"><a href="#__codelineno-0-2095">2095</a></span>
<span class="normal"><a href="#__codelineno-0-2096">2096</a></span>
<span class="normal"><a href="#__codelineno-0-2097">2097</a></span>
<span class="normal"><a href="#__codelineno-0-2098">2098</a></span>
<span class="normal"><a href="#__codelineno-0-2099">2099</a></span>
<span class="normal"><a href="#__codelineno-0-2100">2100</a></span>
<span class="normal"><a href="#__codelineno-0-2101">2101</a></span>
<span class="normal"><a href="#__codelineno-0-2102">2102</a></span>
<span class="normal"><a href="#__codelineno-0-2103">2103</a></span>
<span class="normal"><a href="#__codelineno-0-2104">2104</a></span>
<span class="normal"><a href="#__codelineno-0-2105">2105</a></span>
<span class="normal"><a href="#__codelineno-0-2106">2106</a></span>
<span class="normal"><a href="#__codelineno-0-2107">2107</a></span>
<span class="normal"><a href="#__codelineno-0-2108">2108</a></span>
<span class="normal"><a href="#__codelineno-0-2109">2109</a></span>
<span class="normal"><a href="#__codelineno-0-2110">2110</a></span>
<span class="normal"><a href="#__codelineno-0-2111">2111</a></span>
<span class="normal"><a href="#__codelineno-0-2112">2112</a></span>
<span class="normal"><a href="#__codelineno-0-2113">2113</a></span>
<span class="normal"><a href="#__codelineno-0-2114">2114</a></span>
<span class="normal"><a href="#__codelineno-0-2115">2115</a></span>
<span class="normal"><a href="#__codelineno-0-2116">2116</a></span>
<span class="normal"><a href="#__codelineno-0-2117">2117</a></span>
<span class="normal"><a href="#__codelineno-0-2118">2118</a></span>
<span class="normal"><a href="#__codelineno-0-2119">2119</a></span>
<span class="normal"><a href="#__codelineno-0-2120">2120</a></span>
<span class="normal"><a href="#__codelineno-0-2121">2121</a></span>
<span class="normal"><a href="#__codelineno-0-2122">2122</a></span>
<span class="normal"><a href="#__codelineno-0-2123">2123</a></span>
<span class="normal"><a href="#__codelineno-0-2124">2124</a></span>
<span class="normal"><a href="#__codelineno-0-2125">2125</a></span>
<span class="normal"><a href="#__codelineno-0-2126">2126</a></span>
<span class="normal"><a href="#__codelineno-0-2127">2127</a></span>
<span class="normal"><a href="#__codelineno-0-2128">2128</a></span>
<span class="normal"><a href="#__codelineno-0-2129">2129</a></span>
<span class="normal"><a href="#__codelineno-0-2130">2130</a></span>
<span class="normal"><a href="#__codelineno-0-2131">2131</a></span>
<span class="normal"><a href="#__codelineno-0-2132">2132</a></span>
<span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span>
<span class="normal"><a href="#__codelineno-0-2135">2135</a></span>
<span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2054" name="__codelineno-0-2054"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-2055" name="__codelineno-0-2055"></a><span class="k">def</span> <span class="nf">x509_ordered_name</span><span class="p">(</span>
<a id="__codelineno-0-2056" name="__codelineno-0-2056"></a>    <span class="n">name</span><span class="p">:</span> <span class="n">x509</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span>
<a id="__codelineno-0-2057" name="__codelineno-0-2057"></a>    <span class="o">*</span><span class="p">,</span>  <span class="c1"># type: ignore[no-any-unimported]</span>
<a id="__codelineno-0-2058" name="__codelineno-0-2058"></a>    <span class="n">android</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2059" name="__codelineno-0-2059"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]:</span>
<a id="__codelineno-0-2060" name="__codelineno-0-2060"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2061" name="__codelineno-0-2061"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2062" name="__codelineno-0-2062"></a><span class="sd">     * Method is dual-licensed under the Apache License 2.0 and GPLv3+.</span>
<a id="__codelineno-0-2063" name="__codelineno-0-2063"></a><span class="sd">     * The original author has granted permission to use this code snippet under the</span>
<a id="__codelineno-0-2064" name="__codelineno-0-2064"></a><span class="sd">     * Apache License 2.0 for inclusion in this project.</span>
<a id="__codelineno-0-2065" name="__codelineno-0-2065"></a><span class="sd">     * https://github.com/obfusk/x509_canonical_name.py/blob/master/x509_canonical_name.py</span>
<a id="__codelineno-0-2066" name="__codelineno-0-2066"></a><span class="sd">    ```</span>
<a id="__codelineno-0-2067" name="__codelineno-0-2067"></a>
<a id="__codelineno-0-2068" name="__codelineno-0-2068"></a><span class="sd">    Representation of `x509.Name` as nested list, in canonical ordering (but also</span>
<a id="__codelineno-0-2069" name="__codelineno-0-2069"></a><span class="sd">    including non-canonical pre-normalised string values).</span>
<a id="__codelineno-0-2070" name="__codelineno-0-2070"></a>
<a id="__codelineno-0-2071" name="__codelineno-0-2071"></a><span class="sd">    Returns a list of RDNs which are a list of AVAs which are a (oid, type,</span>
<a id="__codelineno-0-2072" name="__codelineno-0-2072"></a><span class="sd">    normalised_value, esc_value) tuple, where oid is 0 for standard names and 1</span>
<a id="__codelineno-0-2073" name="__codelineno-0-2073"></a><span class="sd">    for dotted OIDs, type is the standard name or dotted OID, normalised_value</span>
<a id="__codelineno-0-2074" name="__codelineno-0-2074"></a><span class="sd">    is the normalised string representation of the value, and esc_value is the</span>
<a id="__codelineno-0-2075" name="__codelineno-0-2075"></a><span class="sd">    string value before normalisation (but after escaping).</span>
<a id="__codelineno-0-2076" name="__codelineno-0-2076"></a>
<a id="__codelineno-0-2077" name="__codelineno-0-2077"></a><span class="sd">    NB: control characters are not escaped, only characters in &quot;,+&lt;&gt;;\&quot;\\&quot; and</span>
<a id="__codelineno-0-2078" name="__codelineno-0-2078"></a><span class="sd">    &quot;#&quot; at the start (before &quot;whitespace&quot; trimming) are.</span>
<a id="__codelineno-0-2079" name="__codelineno-0-2079"></a>
<a id="__codelineno-0-2080" name="__codelineno-0-2080"></a><span class="sd">    [X500Principal.getName](https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/security/auth/x500/X500Principal.html#getName(java.lang.String))</span>
<a id="__codelineno-0-2081" name="__codelineno-0-2081"></a><span class="sd">    [AVA.java](https://github.com/openjdk/jdk/blob/jdk-21%2B35/src/java.base/share/classes/sun/security/x509/AVA.java#L805)</span>
<a id="__codelineno-0-2082" name="__codelineno-0-2082"></a><span class="sd">    [RDN.java (472)](https://github.com/openjdk/jdk/blob/jdk-21%2B35/src/java.base/share/classes/sun/security/x509/RDN.java#L472)</span>
<a id="__codelineno-0-2083" name="__codelineno-0-2083"></a><span class="sd">    [RDN.java (481)](https://android.googlesource.com/platform/libcore/+/refs/heads/android14-release/ojluni/src/main/java/sun/security/x509/RDN.java#481)</span>
<a id="__codelineno-0-2084" name="__codelineno-0-2084"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2085" name="__codelineno-0-2085"></a>
<a id="__codelineno-0-2086" name="__codelineno-0-2086"></a>    <span class="k">def</span> <span class="nf">key</span><span class="p">(</span>
<a id="__codelineno-0-2087" name="__codelineno-0-2087"></a>        <span class="n">ava</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-0-2088" name="__codelineno-0-2088"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2089" name="__codelineno-0-2089"></a>        <span class="n">o</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">nv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ava</span>
<a id="__codelineno-0-2090" name="__codelineno-0-2090"></a>        <span class="k">if</span> <span class="n">android</span> <span class="ow">and</span> <span class="n">o</span><span class="p">:</span>
<a id="__codelineno-0-2091" name="__codelineno-0-2091"></a>            <span class="k">return</span> <span class="n">o</span><span class="p">,</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)],</span> <span class="n">nv</span>
<a id="__codelineno-0-2092" name="__codelineno-0-2092"></a>        <span class="k">return</span> <span class="n">o</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">nv</span>
<a id="__codelineno-0-2093" name="__codelineno-0-2093"></a>
<a id="__codelineno-0-2094" name="__codelineno-0-2094"></a>    <span class="n">DS</span><span class="p">,</span> <span class="n">U8</span><span class="p">,</span> <span class="n">PS</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2095" name="__codelineno-0-2095"></a>        <span class="n">x509</span><span class="o">.</span><span class="n">DirectoryString</span><span class="p">,</span>
<a id="__codelineno-0-2096" name="__codelineno-0-2096"></a>        <span class="n">x509</span><span class="o">.</span><span class="n">UTF8String</span><span class="p">,</span>
<a id="__codelineno-0-2097" name="__codelineno-0-2097"></a>        <span class="n">x509</span><span class="o">.</span><span class="n">PrintableString</span><span class="p">,</span>
<a id="__codelineno-0-2098" name="__codelineno-0-2098"></a>    <span class="p">)</span>
<a id="__codelineno-0-2099" name="__codelineno-0-2099"></a>    <span class="n">oids</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-2100" name="__codelineno-0-2100"></a>        <span class="s2">&quot;2.5.4.3&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;common_name&quot;</span><span class="p">,</span> <span class="s2">&quot;cn&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2101" name="__codelineno-0-2101"></a>        <span class="s2">&quot;2.5.4.6&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;country_name&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2102" name="__codelineno-0-2102"></a>        <span class="s2">&quot;2.5.4.7&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;locality_name&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2103" name="__codelineno-0-2103"></a>        <span class="s2">&quot;2.5.4.8&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;state_or_province_name&quot;</span><span class="p">,</span> <span class="s2">&quot;st&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2104" name="__codelineno-0-2104"></a>        <span class="s2">&quot;2.5.4.9&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;street_address&quot;</span><span class="p">,</span> <span class="s2">&quot;street&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2105" name="__codelineno-0-2105"></a>        <span class="s2">&quot;2.5.4.10&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;organization_name&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2106" name="__codelineno-0-2106"></a>        <span class="s2">&quot;2.5.4.11&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;organizational_unit_name&quot;</span><span class="p">,</span> <span class="s2">&quot;ou&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2107" name="__codelineno-0-2107"></a>        <span class="s2">&quot;0.9.2342.19200300.100.1.1&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="s2">&quot;uid&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2108" name="__codelineno-0-2108"></a>        <span class="s2">&quot;0.9.2342.19200300.100.1.25&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;domain_component&quot;</span><span class="p">,</span> <span class="s2">&quot;dc&quot;</span><span class="p">),</span>
<a id="__codelineno-0-2109" name="__codelineno-0-2109"></a>    <span class="p">}</span>
<a id="__codelineno-0-2110" name="__codelineno-0-2110"></a>    <span class="n">esc</span> <span class="o">=</span> <span class="p">{</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">):</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="s2">&quot;,+&lt;&gt;;</span><span class="se">\&quot;\\</span><span class="s2">&quot;</span><span class="p">}</span>
<a id="__codelineno-0-2111" name="__codelineno-0-2111"></a>    <span class="n">cws</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-2112" name="__codelineno-0-2112"></a>        <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-2113" name="__codelineno-0-2113"></a>    <span class="p">)</span>  <span class="c1"># control (but not esc) and whitespace</span>
<a id="__codelineno-0-2114" name="__codelineno-0-2114"></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2115" name="__codelineno-0-2115"></a>    <span class="k">for</span> <span class="n">rdn</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">chosen</span><span class="p">):</span>
<a id="__codelineno-0-2116" name="__codelineno-0-2116"></a>        <span class="n">avas</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2117" name="__codelineno-0-2117"></a>        <span class="k">for</span> <span class="n">ava</span> <span class="ow">in</span> <span class="n">rdn</span><span class="p">:</span>
<a id="__codelineno-0-2118" name="__codelineno-0-2118"></a>            <span class="n">at</span><span class="p">,</span> <span class="n">av</span> <span class="o">=</span> <span class="n">ava</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="n">ava</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2119" name="__codelineno-0-2119"></a>            <span class="k">if</span> <span class="n">at</span><span class="o">.</span><span class="n">dotted</span> <span class="ow">in</span> <span class="n">oids</span><span class="p">:</span>
<a id="__codelineno-0-2120" name="__codelineno-0-2120"></a>                <span class="n">o</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oids</span><span class="p">[</span><span class="n">at</span><span class="o">.</span><span class="n">dotted</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># order standard before OID</span>
<a id="__codelineno-0-2121" name="__codelineno-0-2121"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2122" name="__codelineno-0-2122"></a>                <span class="n">o</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">at</span><span class="o">.</span><span class="n">dotted</span>
<a id="__codelineno-0-2123" name="__codelineno-0-2123"></a>            <span class="k">if</span> <span class="n">o</span> <span class="ow">or</span> <span class="ow">not</span> <span class="p">(</span>
<a id="__codelineno-0-2124" name="__codelineno-0-2124"></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">av</span><span class="p">,</span> <span class="n">DS</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">av</span><span class="o">.</span><span class="n">chosen</span><span class="p">,</span> <span class="p">(</span><span class="n">U8</span><span class="p">,</span> <span class="n">PS</span><span class="p">))</span>
<a id="__codelineno-0-2125" name="__codelineno-0-2125"></a>            <span class="p">):</span>
<a id="__codelineno-0-2126" name="__codelineno-0-2126"></a>                <span class="n">ev</span> <span class="o">=</span> <span class="n">nv</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span> <span class="o">+</span> <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span><span class="n">av</span><span class="o">.</span><span class="n">dump</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
<a id="__codelineno-0-2127" name="__codelineno-0-2127"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2128" name="__codelineno-0-2128"></a>                <span class="n">ev</span> <span class="o">=</span> <span class="p">(</span><span class="n">av</span><span class="o">.</span><span class="n">native</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">esc</span><span class="p">)</span>
<a id="__codelineno-0-2129" name="__codelineno-0-2129"></a>                <span class="k">if</span> <span class="n">ev</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">):</span>
<a id="__codelineno-0-2130" name="__codelineno-0-2130"></a>                    <span class="n">ev</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">ev</span>
<a id="__codelineno-0-2131" name="__codelineno-0-2131"></a>                <span class="n">nv</span> <span class="o">=</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span>
<a id="__codelineno-0-2132" name="__codelineno-0-2132"></a>                    <span class="s2">&quot;NFKD&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2133" name="__codelineno-0-2133"></a>                    <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot; +&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">ev</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">cws</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
<a id="__codelineno-0-2134" name="__codelineno-0-2134"></a>                <span class="p">)</span>
<a id="__codelineno-0-2135" name="__codelineno-0-2135"></a>            <span class="n">avas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">o</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">nv</span><span class="p">,</span> <span class="n">ev</span><span class="p">))</span>
<a id="__codelineno-0-2136" name="__codelineno-0-2136"></a>        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">avas</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">))</span>
<a id="__codelineno-0-2137" name="__codelineno-0-2137"></a>    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.apk.APKV2SignedData" class="doc doc-heading">
            <code>APKV2SignedData</code>


<a href="#androguard.core.apk.APKV2SignedData" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>This class holds all data associated with an APK V3 SigningBlock signed data.
source : <a href="https://source.android.com/security/apksigning/v2.html">apksigning v2</a></p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="k">class</span> <span class="nc">APKV2SignedData</span><span class="p">:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    This class holds all data associated with an APK V3 SigningBlock signed data.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    source : [apksigning v2](https://source.android.com/security/apksigning/v2.html)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">digests</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">certificates</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">additional_attributes</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">certs_infos</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">cert</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">certificates</span><span class="p">):</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="n">x509_cert</span> <span class="o">=</span> <span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="n">certs_infos</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="n">certs_infos</span> <span class="o">+=</span> <span class="s2">&quot; [</span><span class="si">%d</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="n">certs_infos</span> <span class="o">+=</span> <span class="s2">&quot;  - Issuer: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">get_certificate_name_string</span><span class="p">(</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>                <span class="n">x509_cert</span><span class="o">.</span><span class="n">issuer</span><span class="p">,</span> <span class="n">short</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="n">certs_infos</span> <span class="o">+=</span> <span class="s2">&quot;  - Subject: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">get_certificate_name_string</span><span class="p">(</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>                <span class="n">x509_cert</span><span class="o">.</span><span class="n">subject</span><span class="p">,</span> <span class="n">short</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>            <span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="n">certs_infos</span> <span class="o">+=</span> <span class="s2">&quot;  - Serial Number: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">hex</span><span class="p">(</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>                <span class="n">x509_cert</span><span class="o">.</span><span class="n">serial_number</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="n">certs_infos</span> <span class="o">+=</span> <span class="s2">&quot;  - Hash Algorithm: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">x509_cert</span><span class="o">.</span><span class="n">hash_algo</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="n">certs_infos</span> <span class="o">+=</span> <span class="p">(</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                <span class="s2">&quot;  - Signature Algorithm: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">x509_cert</span><span class="o">.</span><span class="n">signature_algo</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="n">certs_infos</span> <span class="o">+=</span> <span class="p">(</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                <span class="s2">&quot;  - Valid not before: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                <span class="o">%</span> <span class="n">x509_cert</span><span class="p">[</span><span class="s1">&#39;tbs_certificate&#39;</span><span class="p">][</span><span class="s1">&#39;validity&#39;</span><span class="p">][</span><span class="s1">&#39;not_before&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">native</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="n">certs_infos</span> <span class="o">+=</span> <span class="p">(</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                <span class="s2">&quot;  - Valid not after: </span><span class="si">%s</span><span class="s2">&quot;</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="o">%</span> <span class="n">x509_cert</span><span class="p">[</span><span class="s1">&#39;tbs_certificate&#39;</span><span class="p">][</span><span class="s1">&#39;validity&#39;</span><span class="p">][</span><span class="s1">&#39;not_after&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">native</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="p">[</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                <span class="s1">&#39;additional_attributes : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                    <span class="n">_dump_additional_attributes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">additional_attributes</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                <span class="p">),</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                <span class="s1">&#39;digests : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                    <span class="n">_dump_digests_or_signatures</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digests</span><span class="p">)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                <span class="p">),</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                <span class="s1">&#39;certificates : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">certs_infos</span><span class="p">),</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="p">]</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.apk.APKV2Signer" class="doc doc-heading">
            <code>APKV2Signer</code>


<a href="#androguard.core.apk.APKV2Signer" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>This class holds all data associated with an APK V2 SigningBlock signer.
source : <a href="https://source.android.com/security/apksigning/v2.html">apksigning v2</a></p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="k">class</span> <span class="nc">APKV2Signer</span><span class="p">:</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">    This class holds all data associated with an APK V2 SigningBlock signer.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    source : [apksigning v2](https://source.android.com/security/apksigning/v2.html)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bytes</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">signed_data</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">signatures</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="p">[</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>                <span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signed_data</span><span class="p">)),</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>                <span class="s1">&#39;signatures : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>                    <span class="n">_dump_digests_or_signatures</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signatures</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>                <span class="p">),</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>                <span class="s1">&#39;public key : </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="p">)),</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="p">]</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.apk.APKV3SignedData" class="doc doc-heading">
            <code>APKV3SignedData</code>


<a href="#androguard.core.apk.APKV3SignedData" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="androguard.core.apk.APKV2SignedData" href="#androguard.core.apk.APKV2SignedData">APKV2SignedData</a></code></p>


        <p>This class holds all data associated with an APK V3 SigningBlock signed data.
source : <a href="https://source.android.com/security/apksigning/v3.html">apksigning v3</a></p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="k">class</span> <span class="nc">APKV3SignedData</span><span class="p">(</span><span class="n">APKV2SignedData</span><span class="p">):</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    This class holds all data associated with an APK V3 SigningBlock signed data.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    source : [apksigning v3](https://source.android.com/security/apksigning/v3.html)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">minSDK</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">maxSDK</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">base_str</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="c1"># maxSDK is set to a negative value if there is no upper bound on the sdk targeted</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="n">max_sdk_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxSDK</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxSDK</span> <span class="o">&gt;=</span> <span class="mh">0x7FFFFFFF</span><span class="p">:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="n">max_sdk_str</span> <span class="o">=</span> <span class="s2">&quot;0x</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxSDK</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="p">[</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>                <span class="s1">&#39;signer minSDK : </span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minSDK</span><span class="p">),</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                <span class="s1">&#39;signer maxSDK : </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">max_sdk_str</span><span class="p">),</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                <span class="n">base_str</span><span class="p">,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="p">]</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.apk.APKV3Signer" class="doc doc-heading">
            <code>APKV3Signer</code>


<a href="#androguard.core.apk.APKV3Signer" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="androguard.core.apk.APKV2Signer" href="#androguard.core.apk.APKV2Signer">APKV2Signer</a></code></p>


        <p>This class holds all data associated with an APK V3 SigningBlock signer.
source : <a href="https://source.android.com/security/apksigning/v3.html">apksigning v3</a></p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="k">class</span> <span class="nc">APKV3Signer</span><span class="p">(</span><span class="n">APKV2Signer</span><span class="p">):</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">    This class holds all data associated with an APK V3 SigningBlock signer.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    source : [apksigning v3](https://source.android.com/security/apksigning/v3.html)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">minSDK</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">maxSDK</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">base_str</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="c1"># maxSDK is set to a negative value if there is no upper bound on the sdk targeted</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">max_sdk_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxSDK</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxSDK</span> <span class="o">&gt;=</span> <span class="mh">0x7FFFFFFF</span><span class="p">:</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="n">max_sdk_str</span> <span class="o">=</span> <span class="s2">&quot;0x</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxSDK</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="p">[</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                <span class="s1">&#39;signer minSDK : </span><span class="si">{:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minSDK</span><span class="p">),</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                <span class="s1">&#39;signer maxSDK : </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">max_sdk_str</span><span class="p">),</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                <span class="n">base_str</span><span class="p">,</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>            <span class="p">]</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.apk.Error" class="doc doc-heading">
            <code>Error</code>


<a href="#androguard.core.apk.Error" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


        <p>Base class for exceptions in this module.</p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="k">class</span> <span class="nc">Error</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for exceptions in this module.&quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="androguard.core.apk.ensure_final_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ensure_final_value</span><span class="p">(</span><span class="n">packageName</span><span class="p">,</span> <span class="n">arsc</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#androguard.core.apk.ensure_final_value" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Ensure incoming value is always the value, not the resid</p>
<p>androguard will sometimes return the Android "resId" aka
Resource ID instead of the actual value.  This checks whether
the value is actually a resId, then performs the Android
Resource lookup as needed.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the final Android Resource value</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2882">2882</a></span>
<span class="normal"><a href="#__codelineno-0-2883">2883</a></span>
<span class="normal"><a href="#__codelineno-0-2884">2884</a></span>
<span class="normal"><a href="#__codelineno-0-2885">2885</a></span>
<span class="normal"><a href="#__codelineno-0-2886">2886</a></span>
<span class="normal"><a href="#__codelineno-0-2887">2887</a></span>
<span class="normal"><a href="#__codelineno-0-2888">2888</a></span>
<span class="normal"><a href="#__codelineno-0-2889">2889</a></span>
<span class="normal"><a href="#__codelineno-0-2890">2890</a></span>
<span class="normal"><a href="#__codelineno-0-2891">2891</a></span>
<span class="normal"><a href="#__codelineno-0-2892">2892</a></span>
<span class="normal"><a href="#__codelineno-0-2893">2893</a></span>
<span class="normal"><a href="#__codelineno-0-2894">2894</a></span>
<span class="normal"><a href="#__codelineno-0-2895">2895</a></span>
<span class="normal"><a href="#__codelineno-0-2896">2896</a></span>
<span class="normal"><a href="#__codelineno-0-2897">2897</a></span>
<span class="normal"><a href="#__codelineno-0-2898">2898</a></span>
<span class="normal"><a href="#__codelineno-0-2899">2899</a></span>
<span class="normal"><a href="#__codelineno-0-2900">2900</a></span>
<span class="normal"><a href="#__codelineno-0-2901">2901</a></span>
<span class="normal"><a href="#__codelineno-0-2902">2902</a></span>
<span class="normal"><a href="#__codelineno-0-2903">2903</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2882" name="__codelineno-0-2882"></a><span class="k">def</span> <span class="nf">ensure_final_value</span><span class="p">(</span><span class="n">packageName</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arsc</span><span class="p">:</span> <span class="n">ARSCParser</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-2883" name="__codelineno-0-2883"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Ensure incoming value is always the value, not the resid</span>
<a id="__codelineno-0-2884" name="__codelineno-0-2884"></a>
<a id="__codelineno-0-2885" name="__codelineno-0-2885"></a><span class="sd">    androguard will sometimes return the Android &quot;resId&quot; aka</span>
<a id="__codelineno-0-2886" name="__codelineno-0-2886"></a><span class="sd">    Resource ID instead of the actual value.  This checks whether</span>
<a id="__codelineno-0-2887" name="__codelineno-0-2887"></a><span class="sd">    the value is actually a resId, then performs the Android</span>
<a id="__codelineno-0-2888" name="__codelineno-0-2888"></a><span class="sd">    Resource lookup as needed.</span>
<a id="__codelineno-0-2889" name="__codelineno-0-2889"></a>
<a id="__codelineno-0-2890" name="__codelineno-0-2890"></a><span class="sd">    :returns: the final Android Resource value</span>
<a id="__codelineno-0-2891" name="__codelineno-0-2891"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2892" name="__codelineno-0-2892"></a>    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-2893" name="__codelineno-0-2893"></a>        <span class="n">returnValue</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-2894" name="__codelineno-0-2894"></a>        <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;@&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2895" name="__codelineno-0-2895"></a>            <span class="c1"># TODO: @packagename:DEADBEEF is not supported here!</span>
<a id="__codelineno-0-2896" name="__codelineno-0-2896"></a>            <span class="k">try</span><span class="p">:</span>  <span class="c1"># can be a literal value or a resId</span>
<a id="__codelineno-0-2897" name="__codelineno-0-2897"></a>                <span class="n">res_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span> <span class="o">+</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-0-2898" name="__codelineno-0-2898"></a>                <span class="n">res_id</span> <span class="o">=</span> <span class="n">arsc</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">packageName</span><span class="p">,</span> <span class="n">res_id</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-2899" name="__codelineno-0-2899"></a>                <span class="n">returnValue</span> <span class="o">=</span> <span class="n">arsc</span><span class="o">.</span><span class="n">get_string</span><span class="p">(</span><span class="n">packageName</span><span class="p">,</span> <span class="n">res_id</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-2900" name="__codelineno-0-2900"></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
<a id="__codelineno-0-2901" name="__codelineno-0-2901"></a>                <span class="k">pass</span>
<a id="__codelineno-0-2902" name="__codelineno-0-2902"></a>        <span class="k">return</span> <span class="n">returnValue</span>
<a id="__codelineno-0-2903" name="__codelineno-0-2903"></a>    <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="androguard.core.apk.get_apkid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_apkid</span><span class="p">(</span><span class="n">apkfile</span><span class="p">)</span></code>

<a href="#androguard.core.apk.get_apkid" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Read (appid, versionCode, versionName) from an APK</p>
<p>This first tries to do quick binary XML parsing to just get the
values that are needed.  It will fallback to full androguard
parsing, which is slow, if it can't find the versionName value or
versionName is set to a Android String Resource (e.g. an integer
hex value that starts with @).</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>tuple[str, str, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple of format (appid, versionCode, versionName) of a given apkfile</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>RuntimeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if manifest is malformed</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2906">2906</a></span>
<span class="normal"><a href="#__codelineno-0-2907">2907</a></span>
<span class="normal"><a href="#__codelineno-0-2908">2908</a></span>
<span class="normal"><a href="#__codelineno-0-2909">2909</a></span>
<span class="normal"><a href="#__codelineno-0-2910">2910</a></span>
<span class="normal"><a href="#__codelineno-0-2911">2911</a></span>
<span class="normal"><a href="#__codelineno-0-2912">2912</a></span>
<span class="normal"><a href="#__codelineno-0-2913">2913</a></span>
<span class="normal"><a href="#__codelineno-0-2914">2914</a></span>
<span class="normal"><a href="#__codelineno-0-2915">2915</a></span>
<span class="normal"><a href="#__codelineno-0-2916">2916</a></span>
<span class="normal"><a href="#__codelineno-0-2917">2917</a></span>
<span class="normal"><a href="#__codelineno-0-2918">2918</a></span>
<span class="normal"><a href="#__codelineno-0-2919">2919</a></span>
<span class="normal"><a href="#__codelineno-0-2920">2920</a></span>
<span class="normal"><a href="#__codelineno-0-2921">2921</a></span>
<span class="normal"><a href="#__codelineno-0-2922">2922</a></span>
<span class="normal"><a href="#__codelineno-0-2923">2923</a></span>
<span class="normal"><a href="#__codelineno-0-2924">2924</a></span>
<span class="normal"><a href="#__codelineno-0-2925">2925</a></span>
<span class="normal"><a href="#__codelineno-0-2926">2926</a></span>
<span class="normal"><a href="#__codelineno-0-2927">2927</a></span>
<span class="normal"><a href="#__codelineno-0-2928">2928</a></span>
<span class="normal"><a href="#__codelineno-0-2929">2929</a></span>
<span class="normal"><a href="#__codelineno-0-2930">2930</a></span>
<span class="normal"><a href="#__codelineno-0-2931">2931</a></span>
<span class="normal"><a href="#__codelineno-0-2932">2932</a></span>
<span class="normal"><a href="#__codelineno-0-2933">2933</a></span>
<span class="normal"><a href="#__codelineno-0-2934">2934</a></span>
<span class="normal"><a href="#__codelineno-0-2935">2935</a></span>
<span class="normal"><a href="#__codelineno-0-2936">2936</a></span>
<span class="normal"><a href="#__codelineno-0-2937">2937</a></span>
<span class="normal"><a href="#__codelineno-0-2938">2938</a></span>
<span class="normal"><a href="#__codelineno-0-2939">2939</a></span>
<span class="normal"><a href="#__codelineno-0-2940">2940</a></span>
<span class="normal"><a href="#__codelineno-0-2941">2941</a></span>
<span class="normal"><a href="#__codelineno-0-2942">2942</a></span>
<span class="normal"><a href="#__codelineno-0-2943">2943</a></span>
<span class="normal"><a href="#__codelineno-0-2944">2944</a></span>
<span class="normal"><a href="#__codelineno-0-2945">2945</a></span>
<span class="normal"><a href="#__codelineno-0-2946">2946</a></span>
<span class="normal"><a href="#__codelineno-0-2947">2947</a></span>
<span class="normal"><a href="#__codelineno-0-2948">2948</a></span>
<span class="normal"><a href="#__codelineno-0-2949">2949</a></span>
<span class="normal"><a href="#__codelineno-0-2950">2950</a></span>
<span class="normal"><a href="#__codelineno-0-2951">2951</a></span>
<span class="normal"><a href="#__codelineno-0-2952">2952</a></span>
<span class="normal"><a href="#__codelineno-0-2953">2953</a></span>
<span class="normal"><a href="#__codelineno-0-2954">2954</a></span>
<span class="normal"><a href="#__codelineno-0-2955">2955</a></span>
<span class="normal"><a href="#__codelineno-0-2956">2956</a></span>
<span class="normal"><a href="#__codelineno-0-2957">2957</a></span>
<span class="normal"><a href="#__codelineno-0-2958">2958</a></span>
<span class="normal"><a href="#__codelineno-0-2959">2959</a></span>
<span class="normal"><a href="#__codelineno-0-2960">2960</a></span>
<span class="normal"><a href="#__codelineno-0-2961">2961</a></span>
<span class="normal"><a href="#__codelineno-0-2962">2962</a></span>
<span class="normal"><a href="#__codelineno-0-2963">2963</a></span>
<span class="normal"><a href="#__codelineno-0-2964">2964</a></span>
<span class="normal"><a href="#__codelineno-0-2965">2965</a></span>
<span class="normal"><a href="#__codelineno-0-2966">2966</a></span>
<span class="normal"><a href="#__codelineno-0-2967">2967</a></span>
<span class="normal"><a href="#__codelineno-0-2968">2968</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2906" name="__codelineno-0-2906"></a><span class="k">def</span> <span class="nf">get_apkid</span><span class="p">(</span><span class="n">apkfile</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2907" name="__codelineno-0-2907"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Read (appid, versionCode, versionName) from an APK</span>
<a id="__codelineno-0-2908" name="__codelineno-0-2908"></a>
<a id="__codelineno-0-2909" name="__codelineno-0-2909"></a><span class="sd">    This first tries to do quick binary XML parsing to just get the</span>
<a id="__codelineno-0-2910" name="__codelineno-0-2910"></a><span class="sd">    values that are needed.  It will fallback to full androguard</span>
<a id="__codelineno-0-2911" name="__codelineno-0-2911"></a><span class="sd">    parsing, which is slow, if it can&#39;t find the versionName value or</span>
<a id="__codelineno-0-2912" name="__codelineno-0-2912"></a><span class="sd">    versionName is set to a Android String Resource (e.g. an integer</span>
<a id="__codelineno-0-2913" name="__codelineno-0-2913"></a><span class="sd">    hex value that starts with @).</span>
<a id="__codelineno-0-2914" name="__codelineno-0-2914"></a>
<a id="__codelineno-0-2915" name="__codelineno-0-2915"></a><span class="sd">    :raises RuntimeError: if manifest is malformed</span>
<a id="__codelineno-0-2916" name="__codelineno-0-2916"></a><span class="sd">    :returns: tuple of format (appid, versionCode, versionName) of a given apkfile</span>
<a id="__codelineno-0-2917" name="__codelineno-0-2917"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2918" name="__codelineno-0-2918"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;GET_APKID&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2919" name="__codelineno-0-2919"></a>
<a id="__codelineno-0-2920" name="__codelineno-0-2920"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">apkfile</span><span class="p">):</span>
<a id="__codelineno-0-2921" name="__codelineno-0-2921"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">{apkfile}</span><span class="s2">&#39; does not exist!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">apkfile</span><span class="o">=</span><span class="n">apkfile</span><span class="p">))</span>
<a id="__codelineno-0-2922" name="__codelineno-0-2922"></a>
<a id="__codelineno-0-2923" name="__codelineno-0-2923"></a>    <span class="n">appid</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2924" name="__codelineno-0-2924"></a>    <span class="n">versionCode</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2925" name="__codelineno-0-2925"></a>    <span class="n">versionName</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2926" name="__codelineno-0-2926"></a>    <span class="n">apk</span> <span class="o">=</span> <span class="n">ZipEntry</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">apkfile</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2927" name="__codelineno-0-2927"></a>    <span class="n">manifest</span> <span class="o">=</span> <span class="n">apk</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;AndroidManifest.xml&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2928" name="__codelineno-0-2928"></a>    <span class="n">axml</span> <span class="o">=</span> <span class="n">AXMLParser</span><span class="p">(</span><span class="n">manifest</span><span class="p">)</span>
<a id="__codelineno-0-2929" name="__codelineno-0-2929"></a>    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-2930" name="__codelineno-0-2930"></a>    <span class="k">while</span> <span class="n">axml</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<a id="__codelineno-0-2931" name="__codelineno-0-2931"></a>        <span class="n">_type</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">axml</span><span class="p">)</span>
<a id="__codelineno-0-2932" name="__codelineno-0-2932"></a>        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-2933" name="__codelineno-0-2933"></a>        <span class="k">if</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">START_TAG</span><span class="p">:</span>
<a id="__codelineno-0-2934" name="__codelineno-0-2934"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">axml</span><span class="o">.</span><span class="n">getAttributeCount</span><span class="p">()):</span>
<a id="__codelineno-0-2935" name="__codelineno-0-2935"></a>                <span class="n">name</span> <span class="o">=</span> <span class="n">axml</span><span class="o">.</span><span class="n">getAttributeName</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-2936" name="__codelineno-0-2936"></a>                <span class="n">_type</span> <span class="o">=</span> <span class="n">axml</span><span class="o">.</span><span class="n">getAttributeValueType</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-2937" name="__codelineno-0-2937"></a>                <span class="n">_data</span> <span class="o">=</span> <span class="n">axml</span><span class="o">.</span><span class="n">getAttributeValueData</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-2938" name="__codelineno-0-2938"></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">format_value</span><span class="p">(</span>
<a id="__codelineno-0-2939" name="__codelineno-0-2939"></a>                    <span class="n">_type</span><span class="p">,</span> <span class="n">_data</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">axml</span><span class="o">.</span><span class="n">getAttributeValue</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-2940" name="__codelineno-0-2940"></a>                <span class="p">)</span>
<a id="__codelineno-0-2941" name="__codelineno-0-2941"></a>                <span class="k">if</span> <span class="n">appid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;package&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2942" name="__codelineno-0-2942"></a>                    <span class="n">appid</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-2943" name="__codelineno-0-2943"></a>                <span class="k">elif</span> <span class="n">versionCode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;versionCode&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2944" name="__codelineno-0-2944"></a>                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">):</span>
<a id="__codelineno-0-2945" name="__codelineno-0-2945"></a>                        <span class="n">versionCode</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<a id="__codelineno-0-2946" name="__codelineno-0-2946"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2947" name="__codelineno-0-2947"></a>                        <span class="n">versionCode</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-2948" name="__codelineno-0-2948"></a>                <span class="k">elif</span> <span class="n">versionName</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;versionName&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2949" name="__codelineno-0-2949"></a>                    <span class="n">versionName</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-2950" name="__codelineno-0-2950"></a>
<a id="__codelineno-0-2951" name="__codelineno-0-2951"></a>            <span class="k">if</span> <span class="n">axml</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;manifest&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2952" name="__codelineno-0-2952"></a>                <span class="k">break</span>
<a id="__codelineno-0-2953" name="__codelineno-0-2953"></a>        <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">END_TAG</span> <span class="ow">or</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">TEXT</span> <span class="ow">or</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">END_DOCUMENT</span><span class="p">:</span>
<a id="__codelineno-0-2954" name="__codelineno-0-2954"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-2955" name="__codelineno-0-2955"></a>                <span class="s1">&#39;</span><span class="si">{path}</span><span class="s1">: &lt;manifest&gt; must be the first element in AndroidManifest.xml&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2956" name="__codelineno-0-2956"></a>                    <span class="n">path</span><span class="o">=</span><span class="n">apkfile</span>
<a id="__codelineno-0-2957" name="__codelineno-0-2957"></a>                <span class="p">)</span>
<a id="__codelineno-0-2958" name="__codelineno-0-2958"></a>            <span class="p">)</span>
<a id="__codelineno-0-2959" name="__codelineno-0-2959"></a>
<a id="__codelineno-0-2960" name="__codelineno-0-2960"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">versionName</span> <span class="ow">or</span> <span class="n">versionName</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;@&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2961" name="__codelineno-0-2961"></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">APK</span><span class="p">(</span><span class="n">apkfile</span><span class="p">)</span>
<a id="__codelineno-0-2962" name="__codelineno-0-2962"></a>        <span class="n">versionName</span> <span class="o">=</span> <span class="n">ensure_final_value</span><span class="p">(</span>
<a id="__codelineno-0-2963" name="__codelineno-0-2963"></a>            <span class="n">a</span><span class="o">.</span><span class="n">package</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">get_android_resources</span><span class="p">(),</span> <span class="n">a</span><span class="o">.</span><span class="n">get_androidversion_name</span><span class="p">()</span>
<a id="__codelineno-0-2964" name="__codelineno-0-2964"></a>        <span class="p">)</span>
<a id="__codelineno-0-2965" name="__codelineno-0-2965"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">versionName</span><span class="p">:</span>
<a id="__codelineno-0-2966" name="__codelineno-0-2966"></a>        <span class="n">versionName</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># versionName is expected to always be a str</span>
<a id="__codelineno-0-2967" name="__codelineno-0-2967"></a>
<a id="__codelineno-0-2968" name="__codelineno-0-2968"></a>    <span class="k">return</span> <span class="n">appid</span><span class="p">,</span> <span class="n">versionCode</span><span class="p">,</span> <span class="n">versionName</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="androguard.core.apk.show_Certificate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show_Certificate</span><span class="p">(</span><span class="n">cert</span><span class="p">,</span> <span class="n">short</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#androguard.core.apk.show_Certificate" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Print Fingerprints, Issuer and Subject of an X509 Certificate.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cert</code>
            </td>
            <td>
                  <code><span title="asn1crypto.x509.Certificate">Certificate</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>asn1crypto.x509.Certificate</code> to print</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>short</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print in shortform for DN (Default: False)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/apk/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2861">2861</a></span>
<span class="normal"><a href="#__codelineno-0-2862">2862</a></span>
<span class="normal"><a href="#__codelineno-0-2863">2863</a></span>
<span class="normal"><a href="#__codelineno-0-2864">2864</a></span>
<span class="normal"><a href="#__codelineno-0-2865">2865</a></span>
<span class="normal"><a href="#__codelineno-0-2866">2866</a></span>
<span class="normal"><a href="#__codelineno-0-2867">2867</a></span>
<span class="normal"><a href="#__codelineno-0-2868">2868</a></span>
<span class="normal"><a href="#__codelineno-0-2869">2869</a></span>
<span class="normal"><a href="#__codelineno-0-2870">2870</a></span>
<span class="normal"><a href="#__codelineno-0-2871">2871</a></span>
<span class="normal"><a href="#__codelineno-0-2872">2872</a></span>
<span class="normal"><a href="#__codelineno-0-2873">2873</a></span>
<span class="normal"><a href="#__codelineno-0-2874">2874</a></span>
<span class="normal"><a href="#__codelineno-0-2875">2875</a></span>
<span class="normal"><a href="#__codelineno-0-2876">2876</a></span>
<span class="normal"><a href="#__codelineno-0-2877">2877</a></span>
<span class="normal"><a href="#__codelineno-0-2878">2878</a></span>
<span class="normal"><a href="#__codelineno-0-2879">2879</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2861" name="__codelineno-0-2861"></a><span class="k">def</span> <span class="nf">show_Certificate</span><span class="p">(</span><span class="n">cert</span><span class="p">:</span><span class="n">asn1crypto</span><span class="o">.</span><span class="n">x509</span><span class="o">.</span><span class="n">Certificate</span><span class="p">,</span> <span class="n">short</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2862" name="__codelineno-0-2862"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2863" name="__codelineno-0-2863"></a><span class="sd">    Print Fingerprints, Issuer and Subject of an X509 Certificate.</span>
<a id="__codelineno-0-2864" name="__codelineno-0-2864"></a>
<a id="__codelineno-0-2865" name="__codelineno-0-2865"></a><span class="sd">    :param cert: `asn1crypto.x509.Certificate` to print</span>
<a id="__codelineno-0-2866" name="__codelineno-0-2866"></a><span class="sd">    :param short: Print in shortform for DN (Default: False)</span>
<a id="__codelineno-0-2867" name="__codelineno-0-2867"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2868" name="__codelineno-0-2868"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SHA1 Fingerprint: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">sha1_fingerprint</span><span class="p">))</span>
<a id="__codelineno-0-2869" name="__codelineno-0-2869"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SHA256 Fingerprint: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">sha256_fingerprint</span><span class="p">))</span>
<a id="__codelineno-0-2870" name="__codelineno-0-2870"></a>    <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-2871" name="__codelineno-0-2871"></a>        <span class="s2">&quot;Issuer: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2872" name="__codelineno-0-2872"></a>            <span class="n">get_certificate_name_string</span><span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">issuer</span><span class="o">.</span><span class="n">native</span><span class="p">,</span> <span class="n">short</span><span class="o">=</span><span class="n">short</span><span class="p">)</span>
<a id="__codelineno-0-2873" name="__codelineno-0-2873"></a>        <span class="p">)</span>
<a id="__codelineno-0-2874" name="__codelineno-0-2874"></a>    <span class="p">)</span>
<a id="__codelineno-0-2875" name="__codelineno-0-2875"></a>    <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-2876" name="__codelineno-0-2876"></a>        <span class="s2">&quot;Subject: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2877" name="__codelineno-0-2877"></a>            <span class="n">get_certificate_name_string</span><span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">native</span><span class="p">,</span> <span class="n">short</span><span class="o">=</span><span class="n">short</span><span class="p">)</span>
<a id="__codelineno-0-2878" name="__codelineno-0-2878"></a>        <span class="p">)</span>
<a id="__codelineno-0-2879" name="__codelineno-0-2879"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2024 androguard
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tracking", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>