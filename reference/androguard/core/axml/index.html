
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="androguard Documentation">
      
      
        <meta name="author" content="androguard">
      
      
        <link rel="canonical" href="https://github.com/androguard/androguard/reference/androguard/core/axml/index.html">
      
      
        <link rel="prev" href="../apk/index.html">
      
      
        <link rel="next" href="types.html">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>axml - androguard</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#androguard.core.axml" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../index.html" title="androguard" class="md-header__button md-logo" aria-label="androguard" data-md-component="logo">
      
  <img src="../../../../assets/androguard.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            androguard
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              axml
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/androguard/androguard" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../index.html" title="androguard" class="md-nav__button md-logo" aria-label="androguard" data-md-component="logo">
      
  <img src="../../../../assets/androguard.png" alt="logo">

    </a>
    androguard
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/androguard/androguard" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    androguard
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            androguard
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cli/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cli
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1" id="__nav_3_1_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            cli
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/cli.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/main.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    main
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    core
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2" id="__nav_3_1_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../analysis/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    analysis
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2_1" id="__nav_3_1_1_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../analysis/analysis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    analysis
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../androconf.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    androconf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_specific_resources/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    api_specific_resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apk/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2_5" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link md-nav__link--active">
              
  
  <span class="md-ellipsis">
    axml
  </span>
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_3_1_1_2_5" id="__nav_3_1_1_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_2_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1_2_5">
            <span class="md-nav__icon md-icon"></span>
            axml
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="types.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    types
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bytecode.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bytecode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../dex/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    dex
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2_7" id="__nav_3_1_1_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2_7">
            <span class="md-nav__icon md-icon"></span>
            dex
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dex/dex_types.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dex_types
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mutf8/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mutf8
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../resources/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    resources
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_2_9" id="__nav_3_1_1_2_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2_9">
            <span class="md-nav__icon md-icon"></span>
            resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../resources/public.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    public
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../decompiler/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    decompiler
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_3" id="__nav_3_1_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            decompiler
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/basic_blocks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic_blocks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/control_flow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    control_flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/dast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dast
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/dataflow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dataflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/decompile.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    decompile
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/decompiler.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    decompiler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/graph.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graph
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/instruction.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    instruction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/node.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    node
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/opcode_ins.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    opcode_ins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/util.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../decompiler/writer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    writer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    misc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../pentest/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    pentest
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_5" id="__nav_3_1_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            pentest
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pentest/adb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    adb
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../session.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../ui/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ui
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_7" id="__nav_3_1_1_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_7">
            <span class="md-nav__icon md-icon"></span>
            ui
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/data_types.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    data_types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/filter.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    filter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/table.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/util.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_7_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../ui/widget/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    widget
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_7_6" id="__nav_3_1_1_7_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_7_6">
            <span class="md-nav__icon md-icon"></span>
            widget
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/widget/details.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    details
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/widget/filters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    filters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/widget/frame.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    frame
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/widget/help.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    help
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/widget/toolbar.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    toolbar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ui/widget/transactions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    transactions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../util.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    util
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml" class="md-nav__link">
    <span class="md-ellipsis">
      axml
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCComplex" class="md-nav__link">
    <span class="md-ellipsis">
      ARSCComplex
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCHeader" class="md-nav__link">
    <span class="md-ellipsis">
      ARSCHeader
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ARSCHeader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCHeader.end" class="md-nav__link">
    <span class="md-ellipsis">
      end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCHeader.header_size" class="md-nav__link">
    <span class="md-ellipsis">
      header_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCHeader.size" class="md-nav__link">
    <span class="md-ellipsis">
      size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCHeader.type" class="md-nav__link">
    <span class="md-ellipsis">
      type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCHeader.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser" class="md-nav__link">
    <span class="md-ellipsis">
      ARSCParser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ARSCParser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.ResourceResolver" class="md-nav__link">
    <span class="md-ellipsis">
      ResourceResolver
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ResourceResolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.ResourceResolver.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.ResourceResolver.put_ate_value" class="md-nav__link">
    <span class="md-ellipsis">
      put_ate_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.ResourceResolver.put_item_value" class="md-nav__link">
    <span class="md-ellipsis">
      put_item_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.ResourceResolver.resolve" class="md-nav__link">
    <span class="md-ellipsis">
      resolve
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_bool_resources" class="md-nav__link">
    <span class="md-ellipsis">
      get_bool_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_color_resources" class="md-nav__link">
    <span class="md-ellipsis">
      get_color_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_dimen_resources" class="md-nav__link">
    <span class="md-ellipsis">
      get_dimen_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_id_resources" class="md-nav__link">
    <span class="md-ellipsis">
      get_id_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_integer_resources" class="md-nav__link">
    <span class="md-ellipsis">
      get_integer_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_locales" class="md-nav__link">
    <span class="md-ellipsis">
      get_locales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_packages_names" class="md-nav__link">
    <span class="md-ellipsis">
      get_packages_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_public_resources" class="md-nav__link">
    <span class="md-ellipsis">
      get_public_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_res_configs" class="md-nav__link">
    <span class="md-ellipsis">
      get_res_configs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_resolved_res_configs" class="md-nav__link">
    <span class="md-ellipsis">
      get_resolved_res_configs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_resource_xml_name" class="md-nav__link">
    <span class="md-ellipsis">
      get_resource_xml_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_string_resources" class="md-nav__link">
    <span class="md-ellipsis">
      get_string_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_strings_resources" class="md-nav__link">
    <span class="md-ellipsis">
      get_strings_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.get_types" class="md-nav__link">
    <span class="md-ellipsis">
      get_types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCParser.parse_id" class="md-nav__link">
    <span class="md-ellipsis">
      parse_id
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCResStringPoolRef" class="md-nav__link">
    <span class="md-ellipsis">
      ARSCResStringPoolRef
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ARSCResStringPoolRef">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCResStringPoolRef.format_value" class="md-nav__link">
    <span class="md-ellipsis">
      format_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCResStringPoolRef.is_reference" class="md-nav__link">
    <span class="md-ellipsis">
      is_reference
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCResTableConfig" class="md-nav__link">
    <span class="md-ellipsis">
      ARSCResTableConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ARSCResTableConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCResTableConfig.get_config_name_friendly" class="md-nav__link">
    <span class="md-ellipsis">
      get_config_name_friendly
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCResTableConfig.get_language_and_region" class="md-nav__link">
    <span class="md-ellipsis">
      get_language_and_region
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCResTableConfig.get_qualifier" class="md-nav__link">
    <span class="md-ellipsis">
      get_qualifier
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCResTableConfig.is_default" class="md-nav__link">
    <span class="md-ellipsis">
      is_default
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCResTableEntry" class="md-nav__link">
    <span class="md-ellipsis">
      ARSCResTableEntry
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCResTablePackage" class="md-nav__link">
    <span class="md-ellipsis">
      ARSCResTablePackage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCResType" class="md-nav__link">
    <span class="md-ellipsis">
      ARSCResType
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.ARSCResTypeSpec" class="md-nav__link">
    <span class="md-ellipsis">
      ARSCResTypeSpec
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser" class="md-nav__link">
    <span class="md-ellipsis">
      AXMLParser
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AXMLParser">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.comment" class="md-nav__link">
    <span class="md-ellipsis">
      comment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.namespace" class="md-nav__link">
    <span class="md-ellipsis">
      namespace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.nsmap" class="md-nav__link">
    <span class="md-ellipsis">
      nsmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.text" class="md-nav__link">
    <span class="md-ellipsis">
      text
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.getAttributeCount" class="md-nav__link">
    <span class="md-ellipsis">
      getAttributeCount
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.getAttributeName" class="md-nav__link">
    <span class="md-ellipsis">
      getAttributeName
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.getAttributeNamespace" class="md-nav__link">
    <span class="md-ellipsis">
      getAttributeNamespace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.getAttributeUri" class="md-nav__link">
    <span class="md-ellipsis">
      getAttributeUri
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.getAttributeValue" class="md-nav__link">
    <span class="md-ellipsis">
      getAttributeValue
    </span>
  </a>
  
    <nav class="md-nav" aria-label="getAttributeValue">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.getAttributeValue--fixme-should-unite-those-functions" class="md-nav__link">
    <span class="md-ellipsis">
      FIXME should unite those functions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.getAttributeValueData" class="md-nav__link">
    <span class="md-ellipsis">
      getAttributeValueData
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.getAttributeValueType" class="md-nav__link">
    <span class="md-ellipsis">
      getAttributeValueType
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.getName" class="md-nav__link">
    <span class="md-ellipsis">
      getName
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.getPrefix" class="md-nav__link">
    <span class="md-ellipsis">
      getPrefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.getText" class="md-nav__link">
    <span class="md-ellipsis">
      getText
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLParser.is_valid" class="md-nav__link">
    <span class="md-ellipsis">
      is_valid
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLPrinter" class="md-nav__link">
    <span class="md-ellipsis">
      AXMLPrinter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AXMLPrinter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLPrinter.get_buff" class="md-nav__link">
    <span class="md-ellipsis">
      get_buff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLPrinter.get_xml" class="md-nav__link">
    <span class="md-ellipsis">
      get_xml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLPrinter.get_xml_obj" class="md-nav__link">
    <span class="md-ellipsis">
      get_xml_obj
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLPrinter.is_packed" class="md-nav__link">
    <span class="md-ellipsis">
      is_packed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.AXMLPrinter.is_valid" class="md-nav__link">
    <span class="md-ellipsis">
      is_valid
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.PackageContext" class="md-nav__link">
    <span class="md-ellipsis">
      PackageContext
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PackageContext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.PackageContext.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.ResParserError" class="md-nav__link">
    <span class="md-ellipsis">
      ResParserError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.StringBlock" class="md-nav__link">
    <span class="md-ellipsis">
      StringBlock
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StringBlock">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.StringBlock.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.StringBlock.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.StringBlock.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.StringBlock.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.StringBlock.getString" class="md-nav__link">
    <span class="md-ellipsis">
      getString
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.StringBlock.getStyle" class="md-nav__link">
    <span class="md-ellipsis">
      getStyle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androguard.core.axml.StringBlock.show" class="md-nav__link">
    <span class="md-ellipsis">
      show
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.complexToFloat" class="md-nav__link">
    <span class="md-ellipsis">
      complexToFloat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.format_value" class="md-nav__link">
    <span class="md-ellipsis">
      format_value
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#androguard.core.axml.get_arsc_info" class="md-nav__link">
    <span class="md-ellipsis">
      get_arsc_info
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>axml</h1>

<div class="doc doc-object doc-module">



<a id="androguard.core.axml"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.ARSCComplex" class="doc doc-heading">
            <code>ARSCComplex</code>


<a href="#androguard.core.axml.ARSCComplex" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>This is actually a <code>ResTable_map_entry</code></p>
<p>It contains a set of {name: value} mappings, which are of type <code>ResTable_map</code>.
A <code>ResTable_map</code> contains two items: <code>ResTable_ref</code> and <code>Res_value</code>.</p>
<p>See <a href="http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#1485">ResourceTypes.h 1485</a> for <code>ResTable_map_entry</code>
and <a href="http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#1498">ResourceTypes.h 1498</a> for <code>ResTable_map</code></p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3616">3616</a></span>
<span class="normal"><a href="#__codelineno-0-3617">3617</a></span>
<span class="normal"><a href="#__codelineno-0-3618">3618</a></span>
<span class="normal"><a href="#__codelineno-0-3619">3619</a></span>
<span class="normal"><a href="#__codelineno-0-3620">3620</a></span>
<span class="normal"><a href="#__codelineno-0-3621">3621</a></span>
<span class="normal"><a href="#__codelineno-0-3622">3622</a></span>
<span class="normal"><a href="#__codelineno-0-3623">3623</a></span>
<span class="normal"><a href="#__codelineno-0-3624">3624</a></span>
<span class="normal"><a href="#__codelineno-0-3625">3625</a></span>
<span class="normal"><a href="#__codelineno-0-3626">3626</a></span>
<span class="normal"><a href="#__codelineno-0-3627">3627</a></span>
<span class="normal"><a href="#__codelineno-0-3628">3628</a></span>
<span class="normal"><a href="#__codelineno-0-3629">3629</a></span>
<span class="normal"><a href="#__codelineno-0-3630">3630</a></span>
<span class="normal"><a href="#__codelineno-0-3631">3631</a></span>
<span class="normal"><a href="#__codelineno-0-3632">3632</a></span>
<span class="normal"><a href="#__codelineno-0-3633">3633</a></span>
<span class="normal"><a href="#__codelineno-0-3634">3634</a></span>
<span class="normal"><a href="#__codelineno-0-3635">3635</a></span>
<span class="normal"><a href="#__codelineno-0-3636">3636</a></span>
<span class="normal"><a href="#__codelineno-0-3637">3637</a></span>
<span class="normal"><a href="#__codelineno-0-3638">3638</a></span>
<span class="normal"><a href="#__codelineno-0-3639">3639</a></span>
<span class="normal"><a href="#__codelineno-0-3640">3640</a></span>
<span class="normal"><a href="#__codelineno-0-3641">3641</a></span>
<span class="normal"><a href="#__codelineno-0-3642">3642</a></span>
<span class="normal"><a href="#__codelineno-0-3643">3643</a></span>
<span class="normal"><a href="#__codelineno-0-3644">3644</a></span>
<span class="normal"><a href="#__codelineno-0-3645">3645</a></span>
<span class="normal"><a href="#__codelineno-0-3646">3646</a></span>
<span class="normal"><a href="#__codelineno-0-3647">3647</a></span>
<span class="normal"><a href="#__codelineno-0-3648">3648</a></span>
<span class="normal"><a href="#__codelineno-0-3649">3649</a></span>
<span class="normal"><a href="#__codelineno-0-3650">3650</a></span>
<span class="normal"><a href="#__codelineno-0-3651">3651</a></span>
<span class="normal"><a href="#__codelineno-0-3652">3652</a></span>
<span class="normal"><a href="#__codelineno-0-3653">3653</a></span>
<span class="normal"><a href="#__codelineno-0-3654">3654</a></span>
<span class="normal"><a href="#__codelineno-0-3655">3655</a></span>
<span class="normal"><a href="#__codelineno-0-3656">3656</a></span>
<span class="normal"><a href="#__codelineno-0-3657">3657</a></span>
<span class="normal"><a href="#__codelineno-0-3658">3658</a></span>
<span class="normal"><a href="#__codelineno-0-3659">3659</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-3616" name="__codelineno-0-3616"></a><span class="k">class</span> <span class="nc">ARSCComplex</span><span class="p">:</span>
<a id="__codelineno-0-3617" name="__codelineno-0-3617"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3618" name="__codelineno-0-3618"></a><span class="sd">    This is actually a `ResTable_map_entry`</span>
<a id="__codelineno-0-3619" name="__codelineno-0-3619"></a>
<a id="__codelineno-0-3620" name="__codelineno-0-3620"></a><span class="sd">    It contains a set of {name: value} mappings, which are of type `ResTable_map`.</span>
<a id="__codelineno-0-3621" name="__codelineno-0-3621"></a><span class="sd">    A `ResTable_map` contains two items: `ResTable_ref` and `Res_value`.</span>
<a id="__codelineno-0-3622" name="__codelineno-0-3622"></a>
<a id="__codelineno-0-3623" name="__codelineno-0-3623"></a><span class="sd">    See [ResourceTypes.h 1485](http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#1485) for `ResTable_map_entry`</span>
<a id="__codelineno-0-3624" name="__codelineno-0-3624"></a><span class="sd">    and [ResourceTypes.h 1498](http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#1498) for `ResTable_map`</span>
<a id="__codelineno-0-3625" name="__codelineno-0-3625"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-3626" name="__codelineno-0-3626"></a>
<a id="__codelineno-0-3627" name="__codelineno-0-3627"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-3628" name="__codelineno-0-3628"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3629" name="__codelineno-0-3629"></a>        <span class="n">buff</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span>
<a id="__codelineno-0-3630" name="__codelineno-0-3630"></a>        <span class="n">expected_end_of_chunk</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-3631" name="__codelineno-0-3631"></a>        <span class="n">parent</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PackageContext</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-3632" name="__codelineno-0-3632"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-3633" name="__codelineno-0-3633"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-3634" name="__codelineno-0-3634"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
<a id="__codelineno-0-3635" name="__codelineno-0-3635"></a>
<a id="__codelineno-0-3636" name="__codelineno-0-3636"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">id_parent</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3637" name="__codelineno-0-3637"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3638" name="__codelineno-0-3638"></a>
<a id="__codelineno-0-3639" name="__codelineno-0-3639"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-3640" name="__codelineno-0-3640"></a>        <span class="c1"># Parse self.count number of `ResTable_map`</span>
<a id="__codelineno-0-3641" name="__codelineno-0-3641"></a>        <span class="c1"># these are structs of ResTable_ref and Res_value</span>
<a id="__codelineno-0-3642" name="__codelineno-0-3642"></a>        <span class="c1"># ResTable_ref is a uint32_t.</span>
<a id="__codelineno-0-3643" name="__codelineno-0-3643"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">):</span>
<a id="__codelineno-0-3644" name="__codelineno-0-3644"></a>            <span class="k">if</span> <span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&gt;</span> <span class="n">expected_end_of_chunk</span><span class="p">:</span>
<a id="__codelineno-0-3645" name="__codelineno-0-3645"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-3646" name="__codelineno-0-3646"></a>                    <span class="sa">f</span><span class="s2">&quot;We are out of bound with this complex entry. Count: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-3647" name="__codelineno-0-3647"></a>                <span class="p">)</span>
<a id="__codelineno-0-3648" name="__codelineno-0-3648"></a>                <span class="k">break</span>
<a id="__codelineno-0-3649" name="__codelineno-0-3649"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-3650" name="__codelineno-0-3650"></a>                <span class="p">(</span>
<a id="__codelineno-0-3651" name="__codelineno-0-3651"></a>                    <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-3652" name="__codelineno-0-3652"></a>                    <span class="n">ARSCResStringPoolRef</span><span class="p">(</span><span class="n">buff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">),</span>
<a id="__codelineno-0-3653" name="__codelineno-0-3653"></a>                <span class="p">)</span>
<a id="__codelineno-0-3654" name="__codelineno-0-3654"></a>            <span class="p">)</span>
<a id="__codelineno-0-3655" name="__codelineno-0-3655"></a>
<a id="__codelineno-0-3656" name="__codelineno-0-3656"></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-3657" name="__codelineno-0-3657"></a>        <span class="k">return</span> <span class="s2">&quot;&lt;ARSCComplex idx=&#39;0x</span><span class="si">{:08x}</span><span class="s2">&#39; parent=&#39;</span><span class="si">{}</span><span class="s2">&#39; count=&#39;</span><span class="si">{}</span><span class="s2">&#39;&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-3658" name="__codelineno-0-3658"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">id_parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>
<a id="__codelineno-0-3659" name="__codelineno-0-3659"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.ARSCHeader" class="doc doc-heading">
            <code>ARSCHeader</code>


<a href="#androguard.core.axml.ARSCHeader" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>Object which contains a Resource Chunk.
This is an implementation of the <code>ResChunk_header</code>.</p>
<p>It will throw an <a class="autorefs autorefs-internal" href="#androguard.core.axml.ResParserError">ResParserError</a> if the header could not be read successfully.</p>
<p>It is not checked if the data is outside the buffer size nor if the current
chunk fits into the parent chunk (if any)!</p>
<p>The parameter <code>expected_type</code> can be used to immediately check the header for the type or raise a <a class="autorefs autorefs-internal" href="#androguard.core.axml.ResParserError">ResParserError</a>.
This is useful if you know what type of chunk must follow.</p>
<p>See http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#196</p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2754">2754</a></span>
<span class="normal"><a href="#__codelineno-0-2755">2755</a></span>
<span class="normal"><a href="#__codelineno-0-2756">2756</a></span>
<span class="normal"><a href="#__codelineno-0-2757">2757</a></span>
<span class="normal"><a href="#__codelineno-0-2758">2758</a></span>
<span class="normal"><a href="#__codelineno-0-2759">2759</a></span>
<span class="normal"><a href="#__codelineno-0-2760">2760</a></span>
<span class="normal"><a href="#__codelineno-0-2761">2761</a></span>
<span class="normal"><a href="#__codelineno-0-2762">2762</a></span>
<span class="normal"><a href="#__codelineno-0-2763">2763</a></span>
<span class="normal"><a href="#__codelineno-0-2764">2764</a></span>
<span class="normal"><a href="#__codelineno-0-2765">2765</a></span>
<span class="normal"><a href="#__codelineno-0-2766">2766</a></span>
<span class="normal"><a href="#__codelineno-0-2767">2767</a></span>
<span class="normal"><a href="#__codelineno-0-2768">2768</a></span>
<span class="normal"><a href="#__codelineno-0-2769">2769</a></span>
<span class="normal"><a href="#__codelineno-0-2770">2770</a></span>
<span class="normal"><a href="#__codelineno-0-2771">2771</a></span>
<span class="normal"><a href="#__codelineno-0-2772">2772</a></span>
<span class="normal"><a href="#__codelineno-0-2773">2773</a></span>
<span class="normal"><a href="#__codelineno-0-2774">2774</a></span>
<span class="normal"><a href="#__codelineno-0-2775">2775</a></span>
<span class="normal"><a href="#__codelineno-0-2776">2776</a></span>
<span class="normal"><a href="#__codelineno-0-2777">2777</a></span>
<span class="normal"><a href="#__codelineno-0-2778">2778</a></span>
<span class="normal"><a href="#__codelineno-0-2779">2779</a></span>
<span class="normal"><a href="#__codelineno-0-2780">2780</a></span>
<span class="normal"><a href="#__codelineno-0-2781">2781</a></span>
<span class="normal"><a href="#__codelineno-0-2782">2782</a></span>
<span class="normal"><a href="#__codelineno-0-2783">2783</a></span>
<span class="normal"><a href="#__codelineno-0-2784">2784</a></span>
<span class="normal"><a href="#__codelineno-0-2785">2785</a></span>
<span class="normal"><a href="#__codelineno-0-2786">2786</a></span>
<span class="normal"><a href="#__codelineno-0-2787">2787</a></span>
<span class="normal"><a href="#__codelineno-0-2788">2788</a></span>
<span class="normal"><a href="#__codelineno-0-2789">2789</a></span>
<span class="normal"><a href="#__codelineno-0-2790">2790</a></span>
<span class="normal"><a href="#__codelineno-0-2791">2791</a></span>
<span class="normal"><a href="#__codelineno-0-2792">2792</a></span>
<span class="normal"><a href="#__codelineno-0-2793">2793</a></span>
<span class="normal"><a href="#__codelineno-0-2794">2794</a></span>
<span class="normal"><a href="#__codelineno-0-2795">2795</a></span>
<span class="normal"><a href="#__codelineno-0-2796">2796</a></span>
<span class="normal"><a href="#__codelineno-0-2797">2797</a></span>
<span class="normal"><a href="#__codelineno-0-2798">2798</a></span>
<span class="normal"><a href="#__codelineno-0-2799">2799</a></span>
<span class="normal"><a href="#__codelineno-0-2800">2800</a></span>
<span class="normal"><a href="#__codelineno-0-2801">2801</a></span>
<span class="normal"><a href="#__codelineno-0-2802">2802</a></span>
<span class="normal"><a href="#__codelineno-0-2803">2803</a></span>
<span class="normal"><a href="#__codelineno-0-2804">2804</a></span>
<span class="normal"><a href="#__codelineno-0-2805">2805</a></span>
<span class="normal"><a href="#__codelineno-0-2806">2806</a></span>
<span class="normal"><a href="#__codelineno-0-2807">2807</a></span>
<span class="normal"><a href="#__codelineno-0-2808">2808</a></span>
<span class="normal"><a href="#__codelineno-0-2809">2809</a></span>
<span class="normal"><a href="#__codelineno-0-2810">2810</a></span>
<span class="normal"><a href="#__codelineno-0-2811">2811</a></span>
<span class="normal"><a href="#__codelineno-0-2812">2812</a></span>
<span class="normal"><a href="#__codelineno-0-2813">2813</a></span>
<span class="normal"><a href="#__codelineno-0-2814">2814</a></span>
<span class="normal"><a href="#__codelineno-0-2815">2815</a></span>
<span class="normal"><a href="#__codelineno-0-2816">2816</a></span>
<span class="normal"><a href="#__codelineno-0-2817">2817</a></span>
<span class="normal"><a href="#__codelineno-0-2818">2818</a></span>
<span class="normal"><a href="#__codelineno-0-2819">2819</a></span>
<span class="normal"><a href="#__codelineno-0-2820">2820</a></span>
<span class="normal"><a href="#__codelineno-0-2821">2821</a></span>
<span class="normal"><a href="#__codelineno-0-2822">2822</a></span>
<span class="normal"><a href="#__codelineno-0-2823">2823</a></span>
<span class="normal"><a href="#__codelineno-0-2824">2824</a></span>
<span class="normal"><a href="#__codelineno-0-2825">2825</a></span>
<span class="normal"><a href="#__codelineno-0-2826">2826</a></span>
<span class="normal"><a href="#__codelineno-0-2827">2827</a></span>
<span class="normal"><a href="#__codelineno-0-2828">2828</a></span>
<span class="normal"><a href="#__codelineno-0-2829">2829</a></span>
<span class="normal"><a href="#__codelineno-0-2830">2830</a></span>
<span class="normal"><a href="#__codelineno-0-2831">2831</a></span>
<span class="normal"><a href="#__codelineno-0-2832">2832</a></span>
<span class="normal"><a href="#__codelineno-0-2833">2833</a></span>
<span class="normal"><a href="#__codelineno-0-2834">2834</a></span>
<span class="normal"><a href="#__codelineno-0-2835">2835</a></span>
<span class="normal"><a href="#__codelineno-0-2836">2836</a></span>
<span class="normal"><a href="#__codelineno-0-2837">2837</a></span>
<span class="normal"><a href="#__codelineno-0-2838">2838</a></span>
<span class="normal"><a href="#__codelineno-0-2839">2839</a></span>
<span class="normal"><a href="#__codelineno-0-2840">2840</a></span>
<span class="normal"><a href="#__codelineno-0-2841">2841</a></span>
<span class="normal"><a href="#__codelineno-0-2842">2842</a></span>
<span class="normal"><a href="#__codelineno-0-2843">2843</a></span>
<span class="normal"><a href="#__codelineno-0-2844">2844</a></span>
<span class="normal"><a href="#__codelineno-0-2845">2845</a></span>
<span class="normal"><a href="#__codelineno-0-2846">2846</a></span>
<span class="normal"><a href="#__codelineno-0-2847">2847</a></span>
<span class="normal"><a href="#__codelineno-0-2848">2848</a></span>
<span class="normal"><a href="#__codelineno-0-2849">2849</a></span>
<span class="normal"><a href="#__codelineno-0-2850">2850</a></span>
<span class="normal"><a href="#__codelineno-0-2851">2851</a></span>
<span class="normal"><a href="#__codelineno-0-2852">2852</a></span>
<span class="normal"><a href="#__codelineno-0-2853">2853</a></span>
<span class="normal"><a href="#__codelineno-0-2854">2854</a></span>
<span class="normal"><a href="#__codelineno-0-2855">2855</a></span>
<span class="normal"><a href="#__codelineno-0-2856">2856</a></span>
<span class="normal"><a href="#__codelineno-0-2857">2857</a></span>
<span class="normal"><a href="#__codelineno-0-2858">2858</a></span>
<span class="normal"><a href="#__codelineno-0-2859">2859</a></span>
<span class="normal"><a href="#__codelineno-0-2860">2860</a></span>
<span class="normal"><a href="#__codelineno-0-2861">2861</a></span>
<span class="normal"><a href="#__codelineno-0-2862">2862</a></span>
<span class="normal"><a href="#__codelineno-0-2863">2863</a></span>
<span class="normal"><a href="#__codelineno-0-2864">2864</a></span>
<span class="normal"><a href="#__codelineno-0-2865">2865</a></span>
<span class="normal"><a href="#__codelineno-0-2866">2866</a></span>
<span class="normal"><a href="#__codelineno-0-2867">2867</a></span>
<span class="normal"><a href="#__codelineno-0-2868">2868</a></span>
<span class="normal"><a href="#__codelineno-0-2869">2869</a></span>
<span class="normal"><a href="#__codelineno-0-2870">2870</a></span>
<span class="normal"><a href="#__codelineno-0-2871">2871</a></span>
<span class="normal"><a href="#__codelineno-0-2872">2872</a></span>
<span class="normal"><a href="#__codelineno-0-2873">2873</a></span>
<span class="normal"><a href="#__codelineno-0-2874">2874</a></span>
<span class="normal"><a href="#__codelineno-0-2875">2875</a></span>
<span class="normal"><a href="#__codelineno-0-2876">2876</a></span>
<span class="normal"><a href="#__codelineno-0-2877">2877</a></span>
<span class="normal"><a href="#__codelineno-0-2878">2878</a></span>
<span class="normal"><a href="#__codelineno-0-2879">2879</a></span>
<span class="normal"><a href="#__codelineno-0-2880">2880</a></span>
<span class="normal"><a href="#__codelineno-0-2881">2881</a></span>
<span class="normal"><a href="#__codelineno-0-2882">2882</a></span>
<span class="normal"><a href="#__codelineno-0-2883">2883</a></span>
<span class="normal"><a href="#__codelineno-0-2884">2884</a></span>
<span class="normal"><a href="#__codelineno-0-2885">2885</a></span>
<span class="normal"><a href="#__codelineno-0-2886">2886</a></span>
<span class="normal"><a href="#__codelineno-0-2887">2887</a></span>
<span class="normal"><a href="#__codelineno-0-2888">2888</a></span>
<span class="normal"><a href="#__codelineno-0-2889">2889</a></span>
<span class="normal"><a href="#__codelineno-0-2890">2890</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2754" name="__codelineno-0-2754"></a><span class="k">class</span> <span class="nc">ARSCHeader</span><span class="p">:</span>
<a id="__codelineno-0-2755" name="__codelineno-0-2755"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2756" name="__codelineno-0-2756"></a><span class="sd">    Object which contains a Resource Chunk.</span>
<a id="__codelineno-0-2757" name="__codelineno-0-2757"></a><span class="sd">    This is an implementation of the `ResChunk_header`.</span>
<a id="__codelineno-0-2758" name="__codelineno-0-2758"></a>
<a id="__codelineno-0-2759" name="__codelineno-0-2759"></a><span class="sd">    It will throw an [ResParserError][androguard.core.axml.ResParserError] if the header could not be read successfully.</span>
<a id="__codelineno-0-2760" name="__codelineno-0-2760"></a>
<a id="__codelineno-0-2761" name="__codelineno-0-2761"></a><span class="sd">    It is not checked if the data is outside the buffer size nor if the current</span>
<a id="__codelineno-0-2762" name="__codelineno-0-2762"></a><span class="sd">    chunk fits into the parent chunk (if any)!</span>
<a id="__codelineno-0-2763" name="__codelineno-0-2763"></a>
<a id="__codelineno-0-2764" name="__codelineno-0-2764"></a><span class="sd">    The parameter `expected_type` can be used to immediately check the header for the type or raise a [ResParserError][androguard.core.axml.ResParserError].</span>
<a id="__codelineno-0-2765" name="__codelineno-0-2765"></a><span class="sd">    This is useful if you know what type of chunk must follow.</span>
<a id="__codelineno-0-2766" name="__codelineno-0-2766"></a>
<a id="__codelineno-0-2767" name="__codelineno-0-2767"></a><span class="sd">    See http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#196</span>
<a id="__codelineno-0-2768" name="__codelineno-0-2768"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2769" name="__codelineno-0-2769"></a>
<a id="__codelineno-0-2770" name="__codelineno-0-2770"></a>    <span class="c1"># This is the minimal size such a header must have. There might be other header data too!</span>
<a id="__codelineno-0-2771" name="__codelineno-0-2771"></a>    <span class="n">SIZE</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span>
<a id="__codelineno-0-2772" name="__codelineno-0-2772"></a>
<a id="__codelineno-0-2773" name="__codelineno-0-2773"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-2774" name="__codelineno-0-2774"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2775" name="__codelineno-0-2775"></a>        <span class="n">buff</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span>
<a id="__codelineno-0-2776" name="__codelineno-0-2776"></a>        <span class="n">expected_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2777" name="__codelineno-0-2777"></a>        <span class="n">possible_types</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2778" name="__codelineno-0-2778"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2779" name="__codelineno-0-2779"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2780" name="__codelineno-0-2780"></a><span class="sd">        :raises ResParserError: if header malformed</span>
<a id="__codelineno-0-2781" name="__codelineno-0-2781"></a><span class="sd">        :param buff: the buffer set to the position where the header starts.</span>
<a id="__codelineno-0-2782" name="__codelineno-0-2782"></a><span class="sd">        :param int expected_type: the type of the header which is expected.</span>
<a id="__codelineno-0-2783" name="__codelineno-0-2783"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2784" name="__codelineno-0-2784"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2785" name="__codelineno-0-2785"></a>        <span class="c1"># Make sure we do not read over the buffer:</span>
<a id="__codelineno-0-2786" name="__codelineno-0-2786"></a>        <span class="k">if</span> <span class="n">buff</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">()</span><span class="o">.</span><span class="n">nbytes</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">:</span>
<a id="__codelineno-0-2787" name="__codelineno-0-2787"></a>            <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-2788" name="__codelineno-0-2788"></a>                <span class="s2">&quot;Can not read over the buffer size! Offset=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2789" name="__codelineno-0-2789"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
<a id="__codelineno-0-2790" name="__codelineno-0-2790"></a>                <span class="p">)</span>
<a id="__codelineno-0-2791" name="__codelineno-0-2791"></a>            <span class="p">)</span>
<a id="__codelineno-0-2792" name="__codelineno-0-2792"></a>
<a id="__codelineno-0-2793" name="__codelineno-0-2793"></a>        <span class="c1"># Checking for dummy data between elements</span>
<a id="__codelineno-0-2794" name="__codelineno-0-2794"></a>        <span class="k">if</span> <span class="n">possible_types</span><span class="p">:</span>
<a id="__codelineno-0-2795" name="__codelineno-0-2795"></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-2796" name="__codelineno-0-2796"></a>                <span class="n">cur_pos</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2797" name="__codelineno-0-2797"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span>
<a id="__codelineno-0-2798" name="__codelineno-0-2798"></a>                    <span class="s1">&#39;&lt;HHL&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">)</span>
<a id="__codelineno-0-2799" name="__codelineno-0-2799"></a>                <span class="p">)</span>
<a id="__codelineno-0-2800" name="__codelineno-0-2800"></a>
<a id="__codelineno-0-2801" name="__codelineno-0-2801"></a>                <span class="c1"># cases where packers set the EndNamespace with zero size: check we are the end and add the prefix + uri</span>
<a id="__codelineno-0-2802" name="__codelineno-0-2802"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span> <span class="ow">and</span> <span class="p">(</span>
<a id="__codelineno-0-2803" name="__codelineno-0-2803"></a>                    <span class="n">buff</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">()</span><span class="o">.</span><span class="n">nbytes</span>
<a id="__codelineno-0-2804" name="__codelineno-0-2804"></a>                    <span class="o">==</span> <span class="n">cur_pos</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">4</span>
<a id="__codelineno-0-2805" name="__codelineno-0-2805"></a>                <span class="p">):</span>
<a id="__codelineno-0-2806" name="__codelineno-0-2806"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="mi">24</span>
<a id="__codelineno-0-2807" name="__codelineno-0-2807"></a>
<a id="__codelineno-0-2808" name="__codelineno-0-2808"></a>                <span class="k">if</span> <span class="n">cur_pos</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span>
<a id="__codelineno-0-2809" name="__codelineno-0-2809"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">in</span> <span class="n">possible_types</span>
<a id="__codelineno-0-2810" name="__codelineno-0-2810"></a>                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span>
<a id="__codelineno-0-2811" name="__codelineno-0-2811"></a>                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span>
<a id="__codelineno-0-2812" name="__codelineno-0-2812"></a>                <span class="p">):</span>
<a id="__codelineno-0-2813" name="__codelineno-0-2813"></a>                    <span class="k">break</span>
<a id="__codelineno-0-2814" name="__codelineno-0-2814"></a>                <span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">cur_pos</span><span class="p">)</span>
<a id="__codelineno-0-2815" name="__codelineno-0-2815"></a>                <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-2816" name="__codelineno-0-2816"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2817" name="__codelineno-0-2817"></a>                    <span class="s2">&quot;Appears that dummy data are found between elements!&quot;</span>
<a id="__codelineno-0-2818" name="__codelineno-0-2818"></a>                <span class="p">)</span>
<a id="__codelineno-0-2819" name="__codelineno-0-2819"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2820" name="__codelineno-0-2820"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span>
<a id="__codelineno-0-2821" name="__codelineno-0-2821"></a>                <span class="s1">&#39;&lt;HHL&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">)</span>
<a id="__codelineno-0-2822" name="__codelineno-0-2822"></a>            <span class="p">)</span>
<a id="__codelineno-0-2823" name="__codelineno-0-2823"></a>
<a id="__codelineno-0-2824" name="__codelineno-0-2824"></a>        <span class="k">if</span> <span class="n">expected_type</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">!=</span> <span class="n">expected_type</span><span class="p">:</span>
<a id="__codelineno-0-2825" name="__codelineno-0-2825"></a>            <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-2826" name="__codelineno-0-2826"></a>                <span class="s2">&quot;Header type is not equal the expected type: Got 0x</span><span class="si">{:04x}</span><span class="s2">, wanted 0x</span><span class="si">{:04x}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2827" name="__codelineno-0-2827"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span> <span class="n">expected_type</span>
<a id="__codelineno-0-2828" name="__codelineno-0-2828"></a>                <span class="p">)</span>
<a id="__codelineno-0-2829" name="__codelineno-0-2829"></a>            <span class="p">)</span>
<a id="__codelineno-0-2830" name="__codelineno-0-2830"></a>
<a id="__codelineno-0-2831" name="__codelineno-0-2831"></a>        <span class="c1"># Assert that the read data will fit into the chunk.</span>
<a id="__codelineno-0-2832" name="__codelineno-0-2832"></a>        <span class="c1"># The total size must be equal or larger than the header size</span>
<a id="__codelineno-0-2833" name="__codelineno-0-2833"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">:</span>
<a id="__codelineno-0-2834" name="__codelineno-0-2834"></a>            <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-2835" name="__codelineno-0-2835"></a>                <span class="s2">&quot;declared header size is smaller than required size of </span><span class="si">{}</span><span class="s2">! Offset=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2836" name="__codelineno-0-2836"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
<a id="__codelineno-0-2837" name="__codelineno-0-2837"></a>                <span class="p">)</span>
<a id="__codelineno-0-2838" name="__codelineno-0-2838"></a>            <span class="p">)</span>
<a id="__codelineno-0-2839" name="__codelineno-0-2839"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">:</span>
<a id="__codelineno-0-2840" name="__codelineno-0-2840"></a>            <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-2841" name="__codelineno-0-2841"></a>                <span class="s2">&quot;declared chunk size is smaller than required size of </span><span class="si">{}</span><span class="s2">! Offset=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2842" name="__codelineno-0-2842"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
<a id="__codelineno-0-2843" name="__codelineno-0-2843"></a>                <span class="p">)</span>
<a id="__codelineno-0-2844" name="__codelineno-0-2844"></a>            <span class="p">)</span>
<a id="__codelineno-0-2845" name="__codelineno-0-2845"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span><span class="p">:</span>
<a id="__codelineno-0-2846" name="__codelineno-0-2846"></a>            <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-2847" name="__codelineno-0-2847"></a>                <span class="s2">&quot;declared chunk size (</span><span class="si">{}</span><span class="s2">) is smaller than header size (</span><span class="si">{}</span><span class="s2">)! Offset=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2848" name="__codelineno-0-2848"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
<a id="__codelineno-0-2849" name="__codelineno-0-2849"></a>                <span class="p">)</span>
<a id="__codelineno-0-2850" name="__codelineno-0-2850"></a>            <span class="p">)</span>
<a id="__codelineno-0-2851" name="__codelineno-0-2851"></a>
<a id="__codelineno-0-2852" name="__codelineno-0-2852"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-2853" name="__codelineno-0-2853"></a>    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-2854" name="__codelineno-0-2854"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2855" name="__codelineno-0-2855"></a><span class="sd">        Type identifier for this chunk</span>
<a id="__codelineno-0-2856" name="__codelineno-0-2856"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2857" name="__codelineno-0-2857"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
<a id="__codelineno-0-2858" name="__codelineno-0-2858"></a>
<a id="__codelineno-0-2859" name="__codelineno-0-2859"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-2860" name="__codelineno-0-2860"></a>    <span class="k">def</span> <span class="nf">header_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-2861" name="__codelineno-0-2861"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2862" name="__codelineno-0-2862"></a><span class="sd">        Size of the chunk header (in bytes).  Adding this value to</span>
<a id="__codelineno-0-2863" name="__codelineno-0-2863"></a><span class="sd">        the address of the chunk allows you to find its associated data</span>
<a id="__codelineno-0-2864" name="__codelineno-0-2864"></a><span class="sd">        (if any).</span>
<a id="__codelineno-0-2865" name="__codelineno-0-2865"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2866" name="__codelineno-0-2866"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span>
<a id="__codelineno-0-2867" name="__codelineno-0-2867"></a>
<a id="__codelineno-0-2868" name="__codelineno-0-2868"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-2869" name="__codelineno-0-2869"></a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-2870" name="__codelineno-0-2870"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2871" name="__codelineno-0-2871"></a><span class="sd">        Total size of this chunk (in bytes).  This is the chunkSize plus</span>
<a id="__codelineno-0-2872" name="__codelineno-0-2872"></a><span class="sd">        the size of any data associated with the chunk.  Adding this value</span>
<a id="__codelineno-0-2873" name="__codelineno-0-2873"></a><span class="sd">        to the chunk allows you to completely skip its contents (including</span>
<a id="__codelineno-0-2874" name="__codelineno-0-2874"></a><span class="sd">        any child chunks).  If this value is the same as chunkSize, there is</span>
<a id="__codelineno-0-2875" name="__codelineno-0-2875"></a><span class="sd">        no data associated with the chunk.</span>
<a id="__codelineno-0-2876" name="__codelineno-0-2876"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2877" name="__codelineno-0-2877"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span>
<a id="__codelineno-0-2878" name="__codelineno-0-2878"></a>
<a id="__codelineno-0-2879" name="__codelineno-0-2879"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-2880" name="__codelineno-0-2880"></a>    <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-2881" name="__codelineno-0-2881"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2882" name="__codelineno-0-2882"></a><span class="sd">        Get the absolute offset inside the file, where the chunk ends.</span>
<a id="__codelineno-0-2883" name="__codelineno-0-2883"></a><span class="sd">        This is equal to `ARSCHeader.start + ARSCHeader.size`.</span>
<a id="__codelineno-0-2884" name="__codelineno-0-2884"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2885" name="__codelineno-0-2885"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-2886" name="__codelineno-0-2886"></a>
<a id="__codelineno-0-2887" name="__codelineno-0-2887"></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2888" name="__codelineno-0-2888"></a>        <span class="k">return</span> <span class="s2">&quot;&lt;ARSCHeader idx=&#39;0x</span><span class="si">{:08x}</span><span class="s2">&#39; type=&#39;</span><span class="si">{}</span><span class="s2">&#39; header_size=&#39;</span><span class="si">{}</span><span class="s2">&#39; size=&#39;</span><span class="si">{}</span><span class="s2">&#39;&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2889" name="__codelineno-0-2889"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-2890" name="__codelineno-0-2890"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="androguard.core.axml.ARSCHeader.end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">end</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#androguard.core.axml.ARSCHeader.end" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Get the absolute offset inside the file, where the chunk ends.
This is equal to <code>ARSCHeader.start + ARSCHeader.size</code>.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="androguard.core.axml.ARSCHeader.header_size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">header_size</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#androguard.core.axml.ARSCHeader.header_size" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Size of the chunk header (in bytes).  Adding this value to
the address of the chunk allows you to find its associated data
(if any).</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="androguard.core.axml.ARSCHeader.size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">size</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#androguard.core.axml.ARSCHeader.size" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Total size of this chunk (in bytes).  This is the chunkSize plus
the size of any data associated with the chunk.  Adding this value
to the chunk allows you to completely skip its contents (including
any child chunks).  If this value is the same as chunkSize, there is
no data associated with the chunk.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="androguard.core.axml.ARSCHeader.type" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#androguard.core.axml.ARSCHeader.type" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Type identifier for this chunk</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCHeader.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">buff</span><span class="p">,</span> <span class="n">expected_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">possible_types</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCHeader.__init__" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>buff</code>
            </td>
            <td>
                  <code><span title="typing.BinaryIO">BinaryIO</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the buffer set to the position where the header starts.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expected_type</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the type of the header which is expected.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ResParserError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if header malformed</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2773">2773</a></span>
<span class="normal"><a href="#__codelineno-0-2774">2774</a></span>
<span class="normal"><a href="#__codelineno-0-2775">2775</a></span>
<span class="normal"><a href="#__codelineno-0-2776">2776</a></span>
<span class="normal"><a href="#__codelineno-0-2777">2777</a></span>
<span class="normal"><a href="#__codelineno-0-2778">2778</a></span>
<span class="normal"><a href="#__codelineno-0-2779">2779</a></span>
<span class="normal"><a href="#__codelineno-0-2780">2780</a></span>
<span class="normal"><a href="#__codelineno-0-2781">2781</a></span>
<span class="normal"><a href="#__codelineno-0-2782">2782</a></span>
<span class="normal"><a href="#__codelineno-0-2783">2783</a></span>
<span class="normal"><a href="#__codelineno-0-2784">2784</a></span>
<span class="normal"><a href="#__codelineno-0-2785">2785</a></span>
<span class="normal"><a href="#__codelineno-0-2786">2786</a></span>
<span class="normal"><a href="#__codelineno-0-2787">2787</a></span>
<span class="normal"><a href="#__codelineno-0-2788">2788</a></span>
<span class="normal"><a href="#__codelineno-0-2789">2789</a></span>
<span class="normal"><a href="#__codelineno-0-2790">2790</a></span>
<span class="normal"><a href="#__codelineno-0-2791">2791</a></span>
<span class="normal"><a href="#__codelineno-0-2792">2792</a></span>
<span class="normal"><a href="#__codelineno-0-2793">2793</a></span>
<span class="normal"><a href="#__codelineno-0-2794">2794</a></span>
<span class="normal"><a href="#__codelineno-0-2795">2795</a></span>
<span class="normal"><a href="#__codelineno-0-2796">2796</a></span>
<span class="normal"><a href="#__codelineno-0-2797">2797</a></span>
<span class="normal"><a href="#__codelineno-0-2798">2798</a></span>
<span class="normal"><a href="#__codelineno-0-2799">2799</a></span>
<span class="normal"><a href="#__codelineno-0-2800">2800</a></span>
<span class="normal"><a href="#__codelineno-0-2801">2801</a></span>
<span class="normal"><a href="#__codelineno-0-2802">2802</a></span>
<span class="normal"><a href="#__codelineno-0-2803">2803</a></span>
<span class="normal"><a href="#__codelineno-0-2804">2804</a></span>
<span class="normal"><a href="#__codelineno-0-2805">2805</a></span>
<span class="normal"><a href="#__codelineno-0-2806">2806</a></span>
<span class="normal"><a href="#__codelineno-0-2807">2807</a></span>
<span class="normal"><a href="#__codelineno-0-2808">2808</a></span>
<span class="normal"><a href="#__codelineno-0-2809">2809</a></span>
<span class="normal"><a href="#__codelineno-0-2810">2810</a></span>
<span class="normal"><a href="#__codelineno-0-2811">2811</a></span>
<span class="normal"><a href="#__codelineno-0-2812">2812</a></span>
<span class="normal"><a href="#__codelineno-0-2813">2813</a></span>
<span class="normal"><a href="#__codelineno-0-2814">2814</a></span>
<span class="normal"><a href="#__codelineno-0-2815">2815</a></span>
<span class="normal"><a href="#__codelineno-0-2816">2816</a></span>
<span class="normal"><a href="#__codelineno-0-2817">2817</a></span>
<span class="normal"><a href="#__codelineno-0-2818">2818</a></span>
<span class="normal"><a href="#__codelineno-0-2819">2819</a></span>
<span class="normal"><a href="#__codelineno-0-2820">2820</a></span>
<span class="normal"><a href="#__codelineno-0-2821">2821</a></span>
<span class="normal"><a href="#__codelineno-0-2822">2822</a></span>
<span class="normal"><a href="#__codelineno-0-2823">2823</a></span>
<span class="normal"><a href="#__codelineno-0-2824">2824</a></span>
<span class="normal"><a href="#__codelineno-0-2825">2825</a></span>
<span class="normal"><a href="#__codelineno-0-2826">2826</a></span>
<span class="normal"><a href="#__codelineno-0-2827">2827</a></span>
<span class="normal"><a href="#__codelineno-0-2828">2828</a></span>
<span class="normal"><a href="#__codelineno-0-2829">2829</a></span>
<span class="normal"><a href="#__codelineno-0-2830">2830</a></span>
<span class="normal"><a href="#__codelineno-0-2831">2831</a></span>
<span class="normal"><a href="#__codelineno-0-2832">2832</a></span>
<span class="normal"><a href="#__codelineno-0-2833">2833</a></span>
<span class="normal"><a href="#__codelineno-0-2834">2834</a></span>
<span class="normal"><a href="#__codelineno-0-2835">2835</a></span>
<span class="normal"><a href="#__codelineno-0-2836">2836</a></span>
<span class="normal"><a href="#__codelineno-0-2837">2837</a></span>
<span class="normal"><a href="#__codelineno-0-2838">2838</a></span>
<span class="normal"><a href="#__codelineno-0-2839">2839</a></span>
<span class="normal"><a href="#__codelineno-0-2840">2840</a></span>
<span class="normal"><a href="#__codelineno-0-2841">2841</a></span>
<span class="normal"><a href="#__codelineno-0-2842">2842</a></span>
<span class="normal"><a href="#__codelineno-0-2843">2843</a></span>
<span class="normal"><a href="#__codelineno-0-2844">2844</a></span>
<span class="normal"><a href="#__codelineno-0-2845">2845</a></span>
<span class="normal"><a href="#__codelineno-0-2846">2846</a></span>
<span class="normal"><a href="#__codelineno-0-2847">2847</a></span>
<span class="normal"><a href="#__codelineno-0-2848">2848</a></span>
<span class="normal"><a href="#__codelineno-0-2849">2849</a></span>
<span class="normal"><a href="#__codelineno-0-2850">2850</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2773" name="__codelineno-0-2773"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-2774" name="__codelineno-0-2774"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2775" name="__codelineno-0-2775"></a>    <span class="n">buff</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span>
<a id="__codelineno-0-2776" name="__codelineno-0-2776"></a>    <span class="n">expected_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2777" name="__codelineno-0-2777"></a>    <span class="n">possible_types</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2778" name="__codelineno-0-2778"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2779" name="__codelineno-0-2779"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2780" name="__codelineno-0-2780"></a><span class="sd">    :raises ResParserError: if header malformed</span>
<a id="__codelineno-0-2781" name="__codelineno-0-2781"></a><span class="sd">    :param buff: the buffer set to the position where the header starts.</span>
<a id="__codelineno-0-2782" name="__codelineno-0-2782"></a><span class="sd">    :param int expected_type: the type of the header which is expected.</span>
<a id="__codelineno-0-2783" name="__codelineno-0-2783"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2784" name="__codelineno-0-2784"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2785" name="__codelineno-0-2785"></a>    <span class="c1"># Make sure we do not read over the buffer:</span>
<a id="__codelineno-0-2786" name="__codelineno-0-2786"></a>    <span class="k">if</span> <span class="n">buff</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">()</span><span class="o">.</span><span class="n">nbytes</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">:</span>
<a id="__codelineno-0-2787" name="__codelineno-0-2787"></a>        <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-2788" name="__codelineno-0-2788"></a>            <span class="s2">&quot;Can not read over the buffer size! Offset=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2789" name="__codelineno-0-2789"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
<a id="__codelineno-0-2790" name="__codelineno-0-2790"></a>            <span class="p">)</span>
<a id="__codelineno-0-2791" name="__codelineno-0-2791"></a>        <span class="p">)</span>
<a id="__codelineno-0-2792" name="__codelineno-0-2792"></a>
<a id="__codelineno-0-2793" name="__codelineno-0-2793"></a>    <span class="c1"># Checking for dummy data between elements</span>
<a id="__codelineno-0-2794" name="__codelineno-0-2794"></a>    <span class="k">if</span> <span class="n">possible_types</span><span class="p">:</span>
<a id="__codelineno-0-2795" name="__codelineno-0-2795"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-2796" name="__codelineno-0-2796"></a>            <span class="n">cur_pos</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2797" name="__codelineno-0-2797"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span>
<a id="__codelineno-0-2798" name="__codelineno-0-2798"></a>                <span class="s1">&#39;&lt;HHL&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">)</span>
<a id="__codelineno-0-2799" name="__codelineno-0-2799"></a>            <span class="p">)</span>
<a id="__codelineno-0-2800" name="__codelineno-0-2800"></a>
<a id="__codelineno-0-2801" name="__codelineno-0-2801"></a>            <span class="c1"># cases where packers set the EndNamespace with zero size: check we are the end and add the prefix + uri</span>
<a id="__codelineno-0-2802" name="__codelineno-0-2802"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span> <span class="ow">and</span> <span class="p">(</span>
<a id="__codelineno-0-2803" name="__codelineno-0-2803"></a>                <span class="n">buff</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">()</span><span class="o">.</span><span class="n">nbytes</span>
<a id="__codelineno-0-2804" name="__codelineno-0-2804"></a>                <span class="o">==</span> <span class="n">cur_pos</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">4</span>
<a id="__codelineno-0-2805" name="__codelineno-0-2805"></a>            <span class="p">):</span>
<a id="__codelineno-0-2806" name="__codelineno-0-2806"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="mi">24</span>
<a id="__codelineno-0-2807" name="__codelineno-0-2807"></a>
<a id="__codelineno-0-2808" name="__codelineno-0-2808"></a>            <span class="k">if</span> <span class="n">cur_pos</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span>
<a id="__codelineno-0-2809" name="__codelineno-0-2809"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">in</span> <span class="n">possible_types</span>
<a id="__codelineno-0-2810" name="__codelineno-0-2810"></a>                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span>
<a id="__codelineno-0-2811" name="__codelineno-0-2811"></a>                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span>
<a id="__codelineno-0-2812" name="__codelineno-0-2812"></a>            <span class="p">):</span>
<a id="__codelineno-0-2813" name="__codelineno-0-2813"></a>                <span class="k">break</span>
<a id="__codelineno-0-2814" name="__codelineno-0-2814"></a>            <span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">cur_pos</span><span class="p">)</span>
<a id="__codelineno-0-2815" name="__codelineno-0-2815"></a>            <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-2816" name="__codelineno-0-2816"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2817" name="__codelineno-0-2817"></a>                <span class="s2">&quot;Appears that dummy data are found between elements!&quot;</span>
<a id="__codelineno-0-2818" name="__codelineno-0-2818"></a>            <span class="p">)</span>
<a id="__codelineno-0-2819" name="__codelineno-0-2819"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2820" name="__codelineno-0-2820"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span>
<a id="__codelineno-0-2821" name="__codelineno-0-2821"></a>            <span class="s1">&#39;&lt;HHL&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">)</span>
<a id="__codelineno-0-2822" name="__codelineno-0-2822"></a>        <span class="p">)</span>
<a id="__codelineno-0-2823" name="__codelineno-0-2823"></a>
<a id="__codelineno-0-2824" name="__codelineno-0-2824"></a>    <span class="k">if</span> <span class="n">expected_type</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">!=</span> <span class="n">expected_type</span><span class="p">:</span>
<a id="__codelineno-0-2825" name="__codelineno-0-2825"></a>        <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-2826" name="__codelineno-0-2826"></a>            <span class="s2">&quot;Header type is not equal the expected type: Got 0x</span><span class="si">{:04x}</span><span class="s2">, wanted 0x</span><span class="si">{:04x}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2827" name="__codelineno-0-2827"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span> <span class="n">expected_type</span>
<a id="__codelineno-0-2828" name="__codelineno-0-2828"></a>            <span class="p">)</span>
<a id="__codelineno-0-2829" name="__codelineno-0-2829"></a>        <span class="p">)</span>
<a id="__codelineno-0-2830" name="__codelineno-0-2830"></a>
<a id="__codelineno-0-2831" name="__codelineno-0-2831"></a>    <span class="c1"># Assert that the read data will fit into the chunk.</span>
<a id="__codelineno-0-2832" name="__codelineno-0-2832"></a>    <span class="c1"># The total size must be equal or larger than the header size</span>
<a id="__codelineno-0-2833" name="__codelineno-0-2833"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">:</span>
<a id="__codelineno-0-2834" name="__codelineno-0-2834"></a>        <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-2835" name="__codelineno-0-2835"></a>            <span class="s2">&quot;declared header size is smaller than required size of </span><span class="si">{}</span><span class="s2">! Offset=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2836" name="__codelineno-0-2836"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
<a id="__codelineno-0-2837" name="__codelineno-0-2837"></a>            <span class="p">)</span>
<a id="__codelineno-0-2838" name="__codelineno-0-2838"></a>        <span class="p">)</span>
<a id="__codelineno-0-2839" name="__codelineno-0-2839"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">:</span>
<a id="__codelineno-0-2840" name="__codelineno-0-2840"></a>        <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-2841" name="__codelineno-0-2841"></a>            <span class="s2">&quot;declared chunk size is smaller than required size of </span><span class="si">{}</span><span class="s2">! Offset=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2842" name="__codelineno-0-2842"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
<a id="__codelineno-0-2843" name="__codelineno-0-2843"></a>            <span class="p">)</span>
<a id="__codelineno-0-2844" name="__codelineno-0-2844"></a>        <span class="p">)</span>
<a id="__codelineno-0-2845" name="__codelineno-0-2845"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span><span class="p">:</span>
<a id="__codelineno-0-2846" name="__codelineno-0-2846"></a>        <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-2847" name="__codelineno-0-2847"></a>            <span class="s2">&quot;declared chunk size (</span><span class="si">{}</span><span class="s2">) is smaller than header size (</span><span class="si">{}</span><span class="s2">)! Offset=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2848" name="__codelineno-0-2848"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
<a id="__codelineno-0-2849" name="__codelineno-0-2849"></a>            <span class="p">)</span>
<a id="__codelineno-0-2850" name="__codelineno-0-2850"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.ARSCParser" class="doc doc-heading">
            <code>ARSCParser</code>


<a href="#androguard.core.axml.ARSCParser" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>Parser for resource.arsc files</p>
<p>The ARSC File is, like the binary XML format, a chunk based format.
Both formats are actually identical but use different chunks in order to store the data.</p>
<p>The most outer chunk in the ARSC file is a chunk of type <code>RES_TABLE_TYPE</code>.
Inside this chunk is a StringPool and at least one package.</p>
<p>Each package is a chunk of type <code>RES_TABLE_PACKAGE_TYPE</code>.
It contains again many more chunks.</p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span>
<span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span>
<span class="normal"><a href="#__codelineno-0-1927">1927</a></span>
<span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span>
<span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span>
<span class="normal"><a href="#__codelineno-0-2012">2012</a></span>
<span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span>
<span class="normal"><a href="#__codelineno-0-2015">2015</a></span>
<span class="normal"><a href="#__codelineno-0-2016">2016</a></span>
<span class="normal"><a href="#__codelineno-0-2017">2017</a></span>
<span class="normal"><a href="#__codelineno-0-2018">2018</a></span>
<span class="normal"><a href="#__codelineno-0-2019">2019</a></span>
<span class="normal"><a href="#__codelineno-0-2020">2020</a></span>
<span class="normal"><a href="#__codelineno-0-2021">2021</a></span>
<span class="normal"><a href="#__codelineno-0-2022">2022</a></span>
<span class="normal"><a href="#__codelineno-0-2023">2023</a></span>
<span class="normal"><a href="#__codelineno-0-2024">2024</a></span>
<span class="normal"><a href="#__codelineno-0-2025">2025</a></span>
<span class="normal"><a href="#__codelineno-0-2026">2026</a></span>
<span class="normal"><a href="#__codelineno-0-2027">2027</a></span>
<span class="normal"><a href="#__codelineno-0-2028">2028</a></span>
<span class="normal"><a href="#__codelineno-0-2029">2029</a></span>
<span class="normal"><a href="#__codelineno-0-2030">2030</a></span>
<span class="normal"><a href="#__codelineno-0-2031">2031</a></span>
<span class="normal"><a href="#__codelineno-0-2032">2032</a></span>
<span class="normal"><a href="#__codelineno-0-2033">2033</a></span>
<span class="normal"><a href="#__codelineno-0-2034">2034</a></span>
<span class="normal"><a href="#__codelineno-0-2035">2035</a></span>
<span class="normal"><a href="#__codelineno-0-2036">2036</a></span>
<span class="normal"><a href="#__codelineno-0-2037">2037</a></span>
<span class="normal"><a href="#__codelineno-0-2038">2038</a></span>
<span class="normal"><a href="#__codelineno-0-2039">2039</a></span>
<span class="normal"><a href="#__codelineno-0-2040">2040</a></span>
<span class="normal"><a href="#__codelineno-0-2041">2041</a></span>
<span class="normal"><a href="#__codelineno-0-2042">2042</a></span>
<span class="normal"><a href="#__codelineno-0-2043">2043</a></span>
<span class="normal"><a href="#__codelineno-0-2044">2044</a></span>
<span class="normal"><a href="#__codelineno-0-2045">2045</a></span>
<span class="normal"><a href="#__codelineno-0-2046">2046</a></span>
<span class="normal"><a href="#__codelineno-0-2047">2047</a></span>
<span class="normal"><a href="#__codelineno-0-2048">2048</a></span>
<span class="normal"><a href="#__codelineno-0-2049">2049</a></span>
<span class="normal"><a href="#__codelineno-0-2050">2050</a></span>
<span class="normal"><a href="#__codelineno-0-2051">2051</a></span>
<span class="normal"><a href="#__codelineno-0-2052">2052</a></span>
<span class="normal"><a href="#__codelineno-0-2053">2053</a></span>
<span class="normal"><a href="#__codelineno-0-2054">2054</a></span>
<span class="normal"><a href="#__codelineno-0-2055">2055</a></span>
<span class="normal"><a href="#__codelineno-0-2056">2056</a></span>
<span class="normal"><a href="#__codelineno-0-2057">2057</a></span>
<span class="normal"><a href="#__codelineno-0-2058">2058</a></span>
<span class="normal"><a href="#__codelineno-0-2059">2059</a></span>
<span class="normal"><a href="#__codelineno-0-2060">2060</a></span>
<span class="normal"><a href="#__codelineno-0-2061">2061</a></span>
<span class="normal"><a href="#__codelineno-0-2062">2062</a></span>
<span class="normal"><a href="#__codelineno-0-2063">2063</a></span>
<span class="normal"><a href="#__codelineno-0-2064">2064</a></span>
<span class="normal"><a href="#__codelineno-0-2065">2065</a></span>
<span class="normal"><a href="#__codelineno-0-2066">2066</a></span>
<span class="normal"><a href="#__codelineno-0-2067">2067</a></span>
<span class="normal"><a href="#__codelineno-0-2068">2068</a></span>
<span class="normal"><a href="#__codelineno-0-2069">2069</a></span>
<span class="normal"><a href="#__codelineno-0-2070">2070</a></span>
<span class="normal"><a href="#__codelineno-0-2071">2071</a></span>
<span class="normal"><a href="#__codelineno-0-2072">2072</a></span>
<span class="normal"><a href="#__codelineno-0-2073">2073</a></span>
<span class="normal"><a href="#__codelineno-0-2074">2074</a></span>
<span class="normal"><a href="#__codelineno-0-2075">2075</a></span>
<span class="normal"><a href="#__codelineno-0-2076">2076</a></span>
<span class="normal"><a href="#__codelineno-0-2077">2077</a></span>
<span class="normal"><a href="#__codelineno-0-2078">2078</a></span>
<span class="normal"><a href="#__codelineno-0-2079">2079</a></span>
<span class="normal"><a href="#__codelineno-0-2080">2080</a></span>
<span class="normal"><a href="#__codelineno-0-2081">2081</a></span>
<span class="normal"><a href="#__codelineno-0-2082">2082</a></span>
<span class="normal"><a href="#__codelineno-0-2083">2083</a></span>
<span class="normal"><a href="#__codelineno-0-2084">2084</a></span>
<span class="normal"><a href="#__codelineno-0-2085">2085</a></span>
<span class="normal"><a href="#__codelineno-0-2086">2086</a></span>
<span class="normal"><a href="#__codelineno-0-2087">2087</a></span>
<span class="normal"><a href="#__codelineno-0-2088">2088</a></span>
<span class="normal"><a href="#__codelineno-0-2089">2089</a></span>
<span class="normal"><a href="#__codelineno-0-2090">2090</a></span>
<span class="normal"><a href="#__codelineno-0-2091">2091</a></span>
<span class="normal"><a href="#__codelineno-0-2092">2092</a></span>
<span class="normal"><a href="#__codelineno-0-2093">2093</a></span>
<span class="normal"><a href="#__codelineno-0-2094">2094</a></span>
<span class="normal"><a href="#__codelineno-0-2095">2095</a></span>
<span class="normal"><a href="#__codelineno-0-2096">2096</a></span>
<span class="normal"><a href="#__codelineno-0-2097">2097</a></span>
<span class="normal"><a href="#__codelineno-0-2098">2098</a></span>
<span class="normal"><a href="#__codelineno-0-2099">2099</a></span>
<span class="normal"><a href="#__codelineno-0-2100">2100</a></span>
<span class="normal"><a href="#__codelineno-0-2101">2101</a></span>
<span class="normal"><a href="#__codelineno-0-2102">2102</a></span>
<span class="normal"><a href="#__codelineno-0-2103">2103</a></span>
<span class="normal"><a href="#__codelineno-0-2104">2104</a></span>
<span class="normal"><a href="#__codelineno-0-2105">2105</a></span>
<span class="normal"><a href="#__codelineno-0-2106">2106</a></span>
<span class="normal"><a href="#__codelineno-0-2107">2107</a></span>
<span class="normal"><a href="#__codelineno-0-2108">2108</a></span>
<span class="normal"><a href="#__codelineno-0-2109">2109</a></span>
<span class="normal"><a href="#__codelineno-0-2110">2110</a></span>
<span class="normal"><a href="#__codelineno-0-2111">2111</a></span>
<span class="normal"><a href="#__codelineno-0-2112">2112</a></span>
<span class="normal"><a href="#__codelineno-0-2113">2113</a></span>
<span class="normal"><a href="#__codelineno-0-2114">2114</a></span>
<span class="normal"><a href="#__codelineno-0-2115">2115</a></span>
<span class="normal"><a href="#__codelineno-0-2116">2116</a></span>
<span class="normal"><a href="#__codelineno-0-2117">2117</a></span>
<span class="normal"><a href="#__codelineno-0-2118">2118</a></span>
<span class="normal"><a href="#__codelineno-0-2119">2119</a></span>
<span class="normal"><a href="#__codelineno-0-2120">2120</a></span>
<span class="normal"><a href="#__codelineno-0-2121">2121</a></span>
<span class="normal"><a href="#__codelineno-0-2122">2122</a></span>
<span class="normal"><a href="#__codelineno-0-2123">2123</a></span>
<span class="normal"><a href="#__codelineno-0-2124">2124</a></span>
<span class="normal"><a href="#__codelineno-0-2125">2125</a></span>
<span class="normal"><a href="#__codelineno-0-2126">2126</a></span>
<span class="normal"><a href="#__codelineno-0-2127">2127</a></span>
<span class="normal"><a href="#__codelineno-0-2128">2128</a></span>
<span class="normal"><a href="#__codelineno-0-2129">2129</a></span>
<span class="normal"><a href="#__codelineno-0-2130">2130</a></span>
<span class="normal"><a href="#__codelineno-0-2131">2131</a></span>
<span class="normal"><a href="#__codelineno-0-2132">2132</a></span>
<span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span>
<span class="normal"><a href="#__codelineno-0-2135">2135</a></span>
<span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span>
<span class="normal"><a href="#__codelineno-0-2138">2138</a></span>
<span class="normal"><a href="#__codelineno-0-2139">2139</a></span>
<span class="normal"><a href="#__codelineno-0-2140">2140</a></span>
<span class="normal"><a href="#__codelineno-0-2141">2141</a></span>
<span class="normal"><a href="#__codelineno-0-2142">2142</a></span>
<span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span>
<span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span>
<span class="normal"><a href="#__codelineno-0-2207">2207</a></span>
<span class="normal"><a href="#__codelineno-0-2208">2208</a></span>
<span class="normal"><a href="#__codelineno-0-2209">2209</a></span>
<span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span>
<span class="normal"><a href="#__codelineno-0-2247">2247</a></span>
<span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span>
<span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span>
<span class="normal"><a href="#__codelineno-0-2315">2315</a></span>
<span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span>
<span class="normal"><a href="#__codelineno-0-2325">2325</a></span>
<span class="normal"><a href="#__codelineno-0-2326">2326</a></span>
<span class="normal"><a href="#__codelineno-0-2327">2327</a></span>
<span class="normal"><a href="#__codelineno-0-2328">2328</a></span>
<span class="normal"><a href="#__codelineno-0-2329">2329</a></span>
<span class="normal"><a href="#__codelineno-0-2330">2330</a></span>
<span class="normal"><a href="#__codelineno-0-2331">2331</a></span>
<span class="normal"><a href="#__codelineno-0-2332">2332</a></span>
<span class="normal"><a href="#__codelineno-0-2333">2333</a></span>
<span class="normal"><a href="#__codelineno-0-2334">2334</a></span>
<span class="normal"><a href="#__codelineno-0-2335">2335</a></span>
<span class="normal"><a href="#__codelineno-0-2336">2336</a></span>
<span class="normal"><a href="#__codelineno-0-2337">2337</a></span>
<span class="normal"><a href="#__codelineno-0-2338">2338</a></span>
<span class="normal"><a href="#__codelineno-0-2339">2339</a></span>
<span class="normal"><a href="#__codelineno-0-2340">2340</a></span>
<span class="normal"><a href="#__codelineno-0-2341">2341</a></span>
<span class="normal"><a href="#__codelineno-0-2342">2342</a></span>
<span class="normal"><a href="#__codelineno-0-2343">2343</a></span>
<span class="normal"><a href="#__codelineno-0-2344">2344</a></span>
<span class="normal"><a href="#__codelineno-0-2345">2345</a></span>
<span class="normal"><a href="#__codelineno-0-2346">2346</a></span>
<span class="normal"><a href="#__codelineno-0-2347">2347</a></span>
<span class="normal"><a href="#__codelineno-0-2348">2348</a></span>
<span class="normal"><a href="#__codelineno-0-2349">2349</a></span>
<span class="normal"><a href="#__codelineno-0-2350">2350</a></span>
<span class="normal"><a href="#__codelineno-0-2351">2351</a></span>
<span class="normal"><a href="#__codelineno-0-2352">2352</a></span>
<span class="normal"><a href="#__codelineno-0-2353">2353</a></span>
<span class="normal"><a href="#__codelineno-0-2354">2354</a></span>
<span class="normal"><a href="#__codelineno-0-2355">2355</a></span>
<span class="normal"><a href="#__codelineno-0-2356">2356</a></span>
<span class="normal"><a href="#__codelineno-0-2357">2357</a></span>
<span class="normal"><a href="#__codelineno-0-2358">2358</a></span>
<span class="normal"><a href="#__codelineno-0-2359">2359</a></span>
<span class="normal"><a href="#__codelineno-0-2360">2360</a></span>
<span class="normal"><a href="#__codelineno-0-2361">2361</a></span>
<span class="normal"><a href="#__codelineno-0-2362">2362</a></span>
<span class="normal"><a href="#__codelineno-0-2363">2363</a></span>
<span class="normal"><a href="#__codelineno-0-2364">2364</a></span>
<span class="normal"><a href="#__codelineno-0-2365">2365</a></span>
<span class="normal"><a href="#__codelineno-0-2366">2366</a></span>
<span class="normal"><a href="#__codelineno-0-2367">2367</a></span>
<span class="normal"><a href="#__codelineno-0-2368">2368</a></span>
<span class="normal"><a href="#__codelineno-0-2369">2369</a></span>
<span class="normal"><a href="#__codelineno-0-2370">2370</a></span>
<span class="normal"><a href="#__codelineno-0-2371">2371</a></span>
<span class="normal"><a href="#__codelineno-0-2372">2372</a></span>
<span class="normal"><a href="#__codelineno-0-2373">2373</a></span>
<span class="normal"><a href="#__codelineno-0-2374">2374</a></span>
<span class="normal"><a href="#__codelineno-0-2375">2375</a></span>
<span class="normal"><a href="#__codelineno-0-2376">2376</a></span>
<span class="normal"><a href="#__codelineno-0-2377">2377</a></span>
<span class="normal"><a href="#__codelineno-0-2378">2378</a></span>
<span class="normal"><a href="#__codelineno-0-2379">2379</a></span>
<span class="normal"><a href="#__codelineno-0-2380">2380</a></span>
<span class="normal"><a href="#__codelineno-0-2381">2381</a></span>
<span class="normal"><a href="#__codelineno-0-2382">2382</a></span>
<span class="normal"><a href="#__codelineno-0-2383">2383</a></span>
<span class="normal"><a href="#__codelineno-0-2384">2384</a></span>
<span class="normal"><a href="#__codelineno-0-2385">2385</a></span>
<span class="normal"><a href="#__codelineno-0-2386">2386</a></span>
<span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span>
<span class="normal"><a href="#__codelineno-0-2403">2403</a></span>
<span class="normal"><a href="#__codelineno-0-2404">2404</a></span>
<span class="normal"><a href="#__codelineno-0-2405">2405</a></span>
<span class="normal"><a href="#__codelineno-0-2406">2406</a></span>
<span class="normal"><a href="#__codelineno-0-2407">2407</a></span>
<span class="normal"><a href="#__codelineno-0-2408">2408</a></span>
<span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span>
<span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span>
<span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span>
<span class="normal"><a href="#__codelineno-0-2580">2580</a></span>
<span class="normal"><a href="#__codelineno-0-2581">2581</a></span>
<span class="normal"><a href="#__codelineno-0-2582">2582</a></span>
<span class="normal"><a href="#__codelineno-0-2583">2583</a></span>
<span class="normal"><a href="#__codelineno-0-2584">2584</a></span>
<span class="normal"><a href="#__codelineno-0-2585">2585</a></span>
<span class="normal"><a href="#__codelineno-0-2586">2586</a></span>
<span class="normal"><a href="#__codelineno-0-2587">2587</a></span>
<span class="normal"><a href="#__codelineno-0-2588">2588</a></span>
<span class="normal"><a href="#__codelineno-0-2589">2589</a></span>
<span class="normal"><a href="#__codelineno-0-2590">2590</a></span>
<span class="normal"><a href="#__codelineno-0-2591">2591</a></span>
<span class="normal"><a href="#__codelineno-0-2592">2592</a></span>
<span class="normal"><a href="#__codelineno-0-2593">2593</a></span>
<span class="normal"><a href="#__codelineno-0-2594">2594</a></span>
<span class="normal"><a href="#__codelineno-0-2595">2595</a></span>
<span class="normal"><a href="#__codelineno-0-2596">2596</a></span>
<span class="normal"><a href="#__codelineno-0-2597">2597</a></span>
<span class="normal"><a href="#__codelineno-0-2598">2598</a></span>
<span class="normal"><a href="#__codelineno-0-2599">2599</a></span>
<span class="normal"><a href="#__codelineno-0-2600">2600</a></span>
<span class="normal"><a href="#__codelineno-0-2601">2601</a></span>
<span class="normal"><a href="#__codelineno-0-2602">2602</a></span>
<span class="normal"><a href="#__codelineno-0-2603">2603</a></span>
<span class="normal"><a href="#__codelineno-0-2604">2604</a></span>
<span class="normal"><a href="#__codelineno-0-2605">2605</a></span>
<span class="normal"><a href="#__codelineno-0-2606">2606</a></span>
<span class="normal"><a href="#__codelineno-0-2607">2607</a></span>
<span class="normal"><a href="#__codelineno-0-2608">2608</a></span>
<span class="normal"><a href="#__codelineno-0-2609">2609</a></span>
<span class="normal"><a href="#__codelineno-0-2610">2610</a></span>
<span class="normal"><a href="#__codelineno-0-2611">2611</a></span>
<span class="normal"><a href="#__codelineno-0-2612">2612</a></span>
<span class="normal"><a href="#__codelineno-0-2613">2613</a></span>
<span class="normal"><a href="#__codelineno-0-2614">2614</a></span>
<span class="normal"><a href="#__codelineno-0-2615">2615</a></span>
<span class="normal"><a href="#__codelineno-0-2616">2616</a></span>
<span class="normal"><a href="#__codelineno-0-2617">2617</a></span>
<span class="normal"><a href="#__codelineno-0-2618">2618</a></span>
<span class="normal"><a href="#__codelineno-0-2619">2619</a></span>
<span class="normal"><a href="#__codelineno-0-2620">2620</a></span>
<span class="normal"><a href="#__codelineno-0-2621">2621</a></span>
<span class="normal"><a href="#__codelineno-0-2622">2622</a></span>
<span class="normal"><a href="#__codelineno-0-2623">2623</a></span>
<span class="normal"><a href="#__codelineno-0-2624">2624</a></span>
<span class="normal"><a href="#__codelineno-0-2625">2625</a></span>
<span class="normal"><a href="#__codelineno-0-2626">2626</a></span>
<span class="normal"><a href="#__codelineno-0-2627">2627</a></span>
<span class="normal"><a href="#__codelineno-0-2628">2628</a></span>
<span class="normal"><a href="#__codelineno-0-2629">2629</a></span>
<span class="normal"><a href="#__codelineno-0-2630">2630</a></span>
<span class="normal"><a href="#__codelineno-0-2631">2631</a></span>
<span class="normal"><a href="#__codelineno-0-2632">2632</a></span>
<span class="normal"><a href="#__codelineno-0-2633">2633</a></span>
<span class="normal"><a href="#__codelineno-0-2634">2634</a></span>
<span class="normal"><a href="#__codelineno-0-2635">2635</a></span>
<span class="normal"><a href="#__codelineno-0-2636">2636</a></span>
<span class="normal"><a href="#__codelineno-0-2637">2637</a></span>
<span class="normal"><a href="#__codelineno-0-2638">2638</a></span>
<span class="normal"><a href="#__codelineno-0-2639">2639</a></span>
<span class="normal"><a href="#__codelineno-0-2640">2640</a></span>
<span class="normal"><a href="#__codelineno-0-2641">2641</a></span>
<span class="normal"><a href="#__codelineno-0-2642">2642</a></span>
<span class="normal"><a href="#__codelineno-0-2643">2643</a></span>
<span class="normal"><a href="#__codelineno-0-2644">2644</a></span>
<span class="normal"><a href="#__codelineno-0-2645">2645</a></span>
<span class="normal"><a href="#__codelineno-0-2646">2646</a></span>
<span class="normal"><a href="#__codelineno-0-2647">2647</a></span>
<span class="normal"><a href="#__codelineno-0-2648">2648</a></span>
<span class="normal"><a href="#__codelineno-0-2649">2649</a></span>
<span class="normal"><a href="#__codelineno-0-2650">2650</a></span>
<span class="normal"><a href="#__codelineno-0-2651">2651</a></span>
<span class="normal"><a href="#__codelineno-0-2652">2652</a></span>
<span class="normal"><a href="#__codelineno-0-2653">2653</a></span>
<span class="normal"><a href="#__codelineno-0-2654">2654</a></span>
<span class="normal"><a href="#__codelineno-0-2655">2655</a></span>
<span class="normal"><a href="#__codelineno-0-2656">2656</a></span>
<span class="normal"><a href="#__codelineno-0-2657">2657</a></span>
<span class="normal"><a href="#__codelineno-0-2658">2658</a></span>
<span class="normal"><a href="#__codelineno-0-2659">2659</a></span>
<span class="normal"><a href="#__codelineno-0-2660">2660</a></span>
<span class="normal"><a href="#__codelineno-0-2661">2661</a></span>
<span class="normal"><a href="#__codelineno-0-2662">2662</a></span>
<span class="normal"><a href="#__codelineno-0-2663">2663</a></span>
<span class="normal"><a href="#__codelineno-0-2664">2664</a></span>
<span class="normal"><a href="#__codelineno-0-2665">2665</a></span>
<span class="normal"><a href="#__codelineno-0-2666">2666</a></span>
<span class="normal"><a href="#__codelineno-0-2667">2667</a></span>
<span class="normal"><a href="#__codelineno-0-2668">2668</a></span>
<span class="normal"><a href="#__codelineno-0-2669">2669</a></span>
<span class="normal"><a href="#__codelineno-0-2670">2670</a></span>
<span class="normal"><a href="#__codelineno-0-2671">2671</a></span>
<span class="normal"><a href="#__codelineno-0-2672">2672</a></span>
<span class="normal"><a href="#__codelineno-0-2673">2673</a></span>
<span class="normal"><a href="#__codelineno-0-2674">2674</a></span>
<span class="normal"><a href="#__codelineno-0-2675">2675</a></span>
<span class="normal"><a href="#__codelineno-0-2676">2676</a></span>
<span class="normal"><a href="#__codelineno-0-2677">2677</a></span>
<span class="normal"><a href="#__codelineno-0-2678">2678</a></span>
<span class="normal"><a href="#__codelineno-0-2679">2679</a></span>
<span class="normal"><a href="#__codelineno-0-2680">2680</a></span>
<span class="normal"><a href="#__codelineno-0-2681">2681</a></span>
<span class="normal"><a href="#__codelineno-0-2682">2682</a></span>
<span class="normal"><a href="#__codelineno-0-2683">2683</a></span>
<span class="normal"><a href="#__codelineno-0-2684">2684</a></span>
<span class="normal"><a href="#__codelineno-0-2685">2685</a></span>
<span class="normal"><a href="#__codelineno-0-2686">2686</a></span>
<span class="normal"><a href="#__codelineno-0-2687">2687</a></span>
<span class="normal"><a href="#__codelineno-0-2688">2688</a></span>
<span class="normal"><a href="#__codelineno-0-2689">2689</a></span>
<span class="normal"><a href="#__codelineno-0-2690">2690</a></span>
<span class="normal"><a href="#__codelineno-0-2691">2691</a></span>
<span class="normal"><a href="#__codelineno-0-2692">2692</a></span>
<span class="normal"><a href="#__codelineno-0-2693">2693</a></span>
<span class="normal"><a href="#__codelineno-0-2694">2694</a></span>
<span class="normal"><a href="#__codelineno-0-2695">2695</a></span>
<span class="normal"><a href="#__codelineno-0-2696">2696</a></span>
<span class="normal"><a href="#__codelineno-0-2697">2697</a></span>
<span class="normal"><a href="#__codelineno-0-2698">2698</a></span>
<span class="normal"><a href="#__codelineno-0-2699">2699</a></span>
<span class="normal"><a href="#__codelineno-0-2700">2700</a></span>
<span class="normal"><a href="#__codelineno-0-2701">2701</a></span>
<span class="normal"><a href="#__codelineno-0-2702">2702</a></span>
<span class="normal"><a href="#__codelineno-0-2703">2703</a></span>
<span class="normal"><a href="#__codelineno-0-2704">2704</a></span>
<span class="normal"><a href="#__codelineno-0-2705">2705</a></span>
<span class="normal"><a href="#__codelineno-0-2706">2706</a></span>
<span class="normal"><a href="#__codelineno-0-2707">2707</a></span>
<span class="normal"><a href="#__codelineno-0-2708">2708</a></span>
<span class="normal"><a href="#__codelineno-0-2709">2709</a></span>
<span class="normal"><a href="#__codelineno-0-2710">2710</a></span>
<span class="normal"><a href="#__codelineno-0-2711">2711</a></span>
<span class="normal"><a href="#__codelineno-0-2712">2712</a></span>
<span class="normal"><a href="#__codelineno-0-2713">2713</a></span>
<span class="normal"><a href="#__codelineno-0-2714">2714</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1624" name="__codelineno-0-1624"></a><span class="k">class</span> <span class="nc">ARSCParser</span><span class="p">:</span>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a><span class="sd">    Parser for resource.arsc files</span>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a><span class="sd">    The ARSC File is, like the binary XML format, a chunk based format.</span>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a><span class="sd">    Both formats are actually identical but use different chunks in order to store the data.</span>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>
<a id="__codelineno-0-1631" name="__codelineno-0-1631"></a><span class="sd">    The most outer chunk in the ARSC file is a chunk of type `RES_TABLE_TYPE`.</span>
<a id="__codelineno-0-1632" name="__codelineno-0-1632"></a><span class="sd">    Inside this chunk is a StringPool and at least one package.</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a>
<a id="__codelineno-0-1634" name="__codelineno-0-1634"></a><span class="sd">    Each package is a chunk of type `RES_TABLE_PACKAGE_TYPE`.</span>
<a id="__codelineno-0-1635" name="__codelineno-0-1635"></a><span class="sd">    It contains again many more chunks.</span>
<a id="__codelineno-0-1636" name="__codelineno-0-1636"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1637" name="__codelineno-0-1637"></a>
<a id="__codelineno-0-1638" name="__codelineno-0-1638"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_buff</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1639" name="__codelineno-0-1639"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1640" name="__codelineno-0-1640"></a><span class="sd">        :param bytes raw_buff: the raw bytes of the file</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1642" name="__codelineno-0-1642"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">buff</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BufferedReader</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">raw_buff</span><span class="p">))</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">()</span><span class="o">.</span><span class="n">nbytes</span>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span> <span class="o">&gt;</span> <span class="mh">0xFFFFFFFF</span><span class="p">:</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a>            <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a>                <span class="s2">&quot;Invalid file size </span><span class="si">{}</span><span class="s2"> for a resources.arsc file!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>                <span class="p">)</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>            <span class="p">)</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">analyzed</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_resolved_strings</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">packages</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-1655" name="__codelineno-0-1655"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1656" name="__codelineno-0-1656"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">resource_values</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">defaultdict</span><span class="p">)</span>
<a id="__codelineno-0-1657" name="__codelineno-0-1657"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">resource_configs</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">))</span>
<a id="__codelineno-0-1658" name="__codelineno-0-1658"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">resource_keys</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">defaultdict</span><span class="p">))</span>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stringpool_main</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a>
<a id="__codelineno-0-1661" name="__codelineno-0-1661"></a>        <span class="c1"># First, there is a ResTable_header.</span>
<a id="__codelineno-0-1662" name="__codelineno-0-1662"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">ARSCHeader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">expected_type</span><span class="o">=</span><span class="n">RES_TABLE_TYPE</span><span class="p">)</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>        <span class="c1"># More sanity checks...</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">header_size</span> <span class="o">!=</span> <span class="mi">12</span><span class="p">:</span>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a>                <span class="s2">&quot;The ResTable_header has an unexpected header size! Expected 12 bytes, got </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">header_size</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a>                <span class="p">)</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a>            <span class="p">)</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span><span class="p">:</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>            <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a>                <span class="s2">&quot;The file seems to be truncated. Refuse to parse the file! Filesize: </span><span class="si">{}</span><span class="s2">, declared size: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a>                <span class="p">)</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a>            <span class="p">)</span>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span><span class="p">:</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a>                <span class="s2">&quot;The Resource file seems to have data appended to it. Filesize: </span><span class="si">{}</span><span class="s2">, declared size: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a>                <span class="p">)</span>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a>            <span class="p">)</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a>        <span class="c1"># The ResTable_header contains the packageCount, i.e. the number of ResTable_package</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">packageCount</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a>        <span class="c1"># Even more sanity checks...</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">packageCount</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>                <span class="s2">&quot;The number of packages is smaller than one. There should be at least one package!&quot;</span>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a>            <span class="p">)</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a>            <span class="s2">&quot;Parsed ResTable_header with </span><span class="si">{}</span><span class="s2"> package(s) inside.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">packageCount</span>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>            <span class="p">)</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>        <span class="p">)</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>        <span class="c1"># skip to the start of the first chunk&#39;s data, skipping trailing header bytes (there should be none)</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">header_size</span><span class="p">)</span>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a>        <span class="c1"># Now parse the data:</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>        <span class="c1"># We should find one ResStringPool_header and one or more ResTable_package chunks inside</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">ARSCHeader</span><span class="o">.</span><span class="n">SIZE</span><span class="p">:</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>            <span class="n">res_header</span> <span class="o">=</span> <span class="n">ARSCHeader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">)</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>            <span class="k">if</span> <span class="n">res_header</span><span class="o">.</span><span class="n">end</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">end</span><span class="p">:</span>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>                <span class="c1"># this inner chunk crosses the boundary of the table chunk</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>                    <span class="s2">&quot;Invalid chunk found! It is larger than the outer chunk: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>                    <span class="n">res_header</span><span class="p">,</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>                <span class="p">)</span>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>                <span class="k">break</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a>            <span class="k">if</span> <span class="n">res_header</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_STRING_POOL_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>                <span class="c1"># There should be only one StringPool per resource table.</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringpool_main</span><span class="p">:</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a>                        <span class="s2">&quot;Already found a ResStringPool_header, but there should be only one! Will not parse the Pool again.&quot;</span>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stringpool_main</span> <span class="o">=</span> <span class="n">StringBlock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">res_header</span><span class="p">)</span>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>                        <span class="s2">&quot;Found the main string pool: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringpool_main</span>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>            <span class="k">elif</span> <span class="n">res_header</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_TABLE_PACKAGE_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">packageCount</span><span class="p">:</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>                    <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>                        <span class="s2">&quot;Got more packages (</span><span class="si">{}</span><span class="s2">) than expected (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>                            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">packageCount</span>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>                <span class="n">current_package</span> <span class="o">=</span> <span class="n">ARSCResTablePackage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">res_header</span><span class="p">)</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>                <span class="n">package_name</span> <span class="o">=</span> <span class="n">current_package</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>                <span class="c1"># After the Header, we have the resource type symbol table</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>                    <span class="n">current_package</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">current_package</span><span class="o">.</span><span class="n">typeStrings</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>                <span class="p">)</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>                <span class="n">type_sp_header</span> <span class="o">=</span> <span class="n">ARSCHeader</span><span class="p">(</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">expected_type</span><span class="o">=</span><span class="n">RES_STRING_POOL_TYPE</span>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>                <span class="p">)</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>                <span class="n">mTableStrings</span> <span class="o">=</span> <span class="n">StringBlock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">type_sp_header</span><span class="p">)</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>                <span class="c1"># Next, we should have the resource key symbol table</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>                    <span class="n">current_package</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">current_package</span><span class="o">.</span><span class="n">keyStrings</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>                <span class="p">)</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>                <span class="n">key_sp_header</span> <span class="o">=</span> <span class="n">ARSCHeader</span><span class="p">(</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">expected_type</span><span class="o">=</span><span class="n">RES_STRING_POOL_TYPE</span>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>                <span class="p">)</span>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>                <span class="n">mKeyStrings</span> <span class="o">=</span> <span class="n">StringBlock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">key_sp_header</span><span class="p">)</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>                <span class="c1"># Add them to the dict of read packages</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_package</span><span class="p">)</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mTableStrings</span><span class="p">)</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mKeyStrings</span><span class="p">)</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>                <span class="n">pc</span> <span class="o">=</span> <span class="n">PackageContext</span><span class="p">(</span>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>                    <span class="n">current_package</span><span class="p">,</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stringpool_main</span><span class="p">,</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>                    <span class="n">mTableStrings</span><span class="p">,</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>                    <span class="n">mKeyStrings</span><span class="p">,</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>                <span class="p">)</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Constructed a PackageContext: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pc</span><span class="p">)</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>                <span class="c1"># skip to the first header in this table package chunk</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>                <span class="c1"># FIXME is this correct? We have already read the first two sections!</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>                <span class="c1"># self.buff.set_idx(res_header.start + res_header.header_size)</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>                <span class="c1"># this looks more like we want: (???)</span>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>                <span class="c1"># FIXME it looks like that the two string pools we have read might not be concatenated to each other,</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a>                <span class="c1"># thus jumping to the sum of the sizes might not be correct...</span>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a>                <span class="n">next_idx</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>                    <span class="n">res_header</span><span class="o">.</span><span class="n">start</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>                    <span class="o">+</span> <span class="n">res_header</span><span class="o">.</span><span class="n">header_size</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>                    <span class="o">+</span> <span class="n">type_sp_header</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>                    <span class="o">+</span> <span class="n">key_sp_header</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>                <span class="p">)</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a>                <span class="k">if</span> <span class="n">next_idx</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">():</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a>                    <span class="c1"># If this happens, we have a testfile ;)</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;This looks like an odd resources.arsc file!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a>                        <span class="s2">&quot;Please report this error including the file you have parsed!&quot;</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a>                        <span class="s2">&quot;next_idx = </span><span class="si">{}</span><span class="s2">, current buffer position = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a>                            <span class="n">next_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a>                        <span class="s2">&quot;Please open a issue at https://github.com/androguard/androguard/issues&quot;</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Thank you!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1799" name="__codelineno-0-1799"></a>
<a id="__codelineno-0-1800" name="__codelineno-0-1800"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">next_idx</span><span class="p">)</span>
<a id="__codelineno-0-1801" name="__codelineno-0-1801"></a>
<a id="__codelineno-0-1802" name="__codelineno-0-1802"></a>                <span class="c1"># Read all other headers</span>
<a id="__codelineno-0-1803" name="__codelineno-0-1803"></a>                <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">res_header</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">ARSCHeader</span><span class="o">.</span><span class="n">SIZE</span><span class="p">:</span>
<a id="__codelineno-0-1804" name="__codelineno-0-1804"></a>                    <span class="n">pkg_chunk_header</span> <span class="o">=</span> <span class="n">ARSCHeader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">)</span>
<a id="__codelineno-0-1805" name="__codelineno-0-1805"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found a header: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pkg_chunk_header</span><span class="p">))</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806"></a>                    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1807" name="__codelineno-0-1807"></a>                        <span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808"></a>                        <span class="o">&gt;</span> <span class="n">res_header</span><span class="o">.</span><span class="n">end</span>
<a id="__codelineno-0-1809" name="__codelineno-0-1809"></a>                    <span class="p">):</span>
<a id="__codelineno-0-1810" name="__codelineno-0-1810"></a>                        <span class="c1"># we are way off the package chunk; bail out</span>
<a id="__codelineno-0-1811" name="__codelineno-0-1811"></a>                        <span class="k">break</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812"></a>
<a id="__codelineno-0-1813" name="__codelineno-0-1813"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pkg_chunk_header</span><span class="p">)</span>
<a id="__codelineno-0-1814" name="__codelineno-0-1814"></a>
<a id="__codelineno-0-1815" name="__codelineno-0-1815"></a>                    <span class="k">if</span> <span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_TABLE_TYPE_SPEC_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-1816" name="__codelineno-0-1816"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-1817" name="__codelineno-0-1817"></a>                            <span class="n">ARSCResTypeSpec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">pc</span><span class="p">)</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819"></a>
<a id="__codelineno-0-1820" name="__codelineno-0-1820"></a>                    <span class="k">elif</span> <span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_TABLE_TYPE_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-1821" name="__codelineno-0-1821"></a>                        <span class="c1"># Parse a RES_TABLE_TYPE</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822"></a>                        <span class="c1"># http://androidxref.com/9.0.0_r3/xref/frameworks/base/tools/aapt2/format/binary/BinaryResourceParser.cpp#311</span>
<a id="__codelineno-0-1823" name="__codelineno-0-1823"></a>                        <span class="n">start_of_chunk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">-</span> <span class="mi">8</span>
<a id="__codelineno-0-1824" name="__codelineno-0-1824"></a>                        <span class="n">expected_end_of_chunk</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1825" name="__codelineno-0-1825"></a>                            <span class="n">start_of_chunk</span> <span class="o">+</span> <span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1827" name="__codelineno-0-1827"></a>                        <span class="n">a_res_type</span> <span class="o">=</span> <span class="n">ARSCResType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">pc</span><span class="p">)</span>
<a id="__codelineno-0-1828" name="__codelineno-0-1828"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a_res_type</span><span class="p">)</span>
<a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">resource_configs</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">a_res_type</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
<a id="__codelineno-0-1830" name="__codelineno-0-1830"></a>                            <span class="n">a_res_type</span><span class="o">.</span><span class="n">config</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>
<a id="__codelineno-0-1833" name="__codelineno-0-1833"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Config: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_res_type</span><span class="o">.</span><span class="n">config</span><span class="p">))</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834"></a>
<a id="__codelineno-0-1835" name="__codelineno-0-1835"></a>                        <span class="n">entries</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836"></a>                        <span class="n">FLAG_OFFSET16</span> <span class="o">=</span> <span class="mh">0x02</span>
<a id="__codelineno-0-1837" name="__codelineno-0-1837"></a>                        <span class="n">NO_ENTRY_16</span> <span class="o">=</span> <span class="mh">0xFFFF</span>
<a id="__codelineno-0-1838" name="__codelineno-0-1838"></a>                        <span class="n">NO_ENTRY_32</span> <span class="o">=</span> <span class="mh">0xFFFFFFFF</span>
<a id="__codelineno-0-1839" name="__codelineno-0-1839"></a>                        <span class="n">expected_entries_start</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1840" name="__codelineno-0-1840"></a>                            <span class="n">start_of_chunk</span> <span class="o">+</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">entriesStart</span>
<a id="__codelineno-0-1841" name="__codelineno-0-1841"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1842" name="__codelineno-0-1842"></a>
<a id="__codelineno-0-1843" name="__codelineno-0-1843"></a>                        <span class="c1"># Helper function to convert 16-bit offset to 32-bit</span>
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a>                        <span class="k">def</span> <span class="nf">offset_from16</span><span class="p">(</span><span class="n">off16</span><span class="p">):</span>
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a>                            <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a>                                <span class="n">NO_ENTRY_16</span>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a>                                <span class="k">if</span> <span class="n">off16</span> <span class="o">==</span> <span class="n">NO_ENTRY_16</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a>                                <span class="k">else</span> <span class="n">off16</span> <span class="o">*</span> <span class="mi">4</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a>                            <span class="p">)</span>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">entryCount</span><span class="p">):</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>                            <span class="n">current_package</span><span class="o">.</span><span class="n">mResId</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>                                <span class="n">current_package</span><span class="o">.</span><span class="n">mResId</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span> <span class="o">|</span> <span class="n">i</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>                            <span class="p">)</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>                            <span class="c1"># Check if FLAG_OFFSET16 is set</span>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>                            <span class="k">if</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">FLAG_OFFSET16</span><span class="p">:</span>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a>                                <span class="c1"># Read as 16-bit offset</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>                                <span class="n">offset_16</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>                                <span class="n">offset</span> <span class="o">=</span> <span class="n">offset_from16</span><span class="p">(</span><span class="n">offset_16</span><span class="p">)</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>                                <span class="k">if</span> <span class="n">offset</span> <span class="o">==</span> <span class="n">NO_ENTRY_16</span><span class="p">:</span>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a>                                    <span class="k">continue</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>                            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>                                <span class="c1"># Read as 32-bit offset</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>                                <span class="n">offset</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>                                <span class="k">if</span> <span class="n">offset</span> <span class="o">==</span> <span class="n">NO_ENTRY_32</span><span class="p">:</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>                                    <span class="k">continue</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>                            <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">offset</span><span class="p">,</span> <span class="n">current_package</span><span class="o">.</span><span class="n">mResId</span><span class="p">))</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a>                        <span class="n">base_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a>                        <span class="k">if</span> <span class="n">base_offset</span> <span class="o">+</span> <span class="p">((</span><span class="mi">4</span> <span class="o">-</span> <span class="p">(</span><span class="n">base_offset</span> <span class="o">%</span> <span class="mi">4</span><span class="p">))</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="n">expected_entries_start</span><span class="p">:</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a>                            <span class="c1"># FIXME: seems like I am missing 2 bytes here in some cases, though it does not affect the result</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a>                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a>                                <span class="s2">&quot;Something is off here! We are not where the entries should start.&quot;</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>                            <span class="p">)</span>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a>                        <span class="n">base_offset</span> <span class="o">=</span> <span class="n">expected_entries_start</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a>                        <span class="k">for</span> <span class="n">entry_offset</span><span class="p">,</span> <span class="n">res_id</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a>                            <span class="k">if</span> <span class="n">entry_offset</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a>                                <span class="n">ate</span> <span class="o">=</span> <span class="n">ARSCResTableEntry</span><span class="p">(</span>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a>                                    <span class="n">base_offset</span> <span class="o">+</span> <span class="n">entry_offset</span><span class="p">,</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a>                                    <span class="n">expected_end_of_chunk</span><span class="p">,</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a>                                    <span class="n">res_id</span><span class="p">,</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a>                                    <span class="n">pc</span><span class="p">,</span>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a>                                <span class="p">)</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ate</span><span class="p">)</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a>                                <span class="k">if</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_weak</span><span class="p">():</span>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a>                                    <span class="c1"># FIXME we are not sure how to implement the FLAG_WEAK!</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a>                                    <span class="c1"># We saw the following: There is just a single Res_value after the ARSCResTableEntry</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a>                                    <span class="c1"># and then comes the next ARSCHeader.</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a>                                    <span class="c1"># Therefore we think this means all entries are somehow replicated?</span>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a>                                    <span class="c1"># So we do some kind of hack here. We set the idx to the entry again...</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a>                                    <span class="c1"># Now we will read all entries!</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a>                                    <span class="c1"># Not sure if this is a good solution though</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">ate</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a>                    <span class="k">elif</span> <span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_TABLE_LIBRARY_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a>                            <span class="s2">&quot;RES_TABLE_LIBRARY_TYPE chunk is not supported&quot;</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a>                        <span class="c1"># Unknown / not-handled chunk type</span>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a>                            <span class="s2">&quot;Unknown chunk type encountered inside RES_TABLE_PACKAGE: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a>                            <span class="n">pkg_chunk_header</span><span class="p">,</span>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>                    <span class="c1"># skip to the next chunk</span>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a>                <span class="c1"># Unknown / not-handled chunk type</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a>                    <span class="s2">&quot;Unknown chunk type encountered: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">res_header</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a>                <span class="p">)</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a>            <span class="c1"># move to the next resource chunk</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">res_header</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
<a id="__codelineno-0-1918" name="__codelineno-0-1918"></a>
<a id="__codelineno-0-1919" name="__codelineno-0-1919"></a>    <span class="k">def</span> <span class="nf">_analyse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzed</span><span class="p">:</span>
<a id="__codelineno-0-1921" name="__codelineno-0-1921"></a>            <span class="k">return</span>
<a id="__codelineno-0-1922" name="__codelineno-0-1922"></a>
<a id="__codelineno-0-1923" name="__codelineno-0-1923"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">analyzed</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1924" name="__codelineno-0-1924"></a>
<a id="__codelineno-0-1925" name="__codelineno-0-1925"></a>        <span class="k">for</span> <span class="n">package_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">:</span>
<a id="__codelineno-0-1926" name="__codelineno-0-1926"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1927" name="__codelineno-0-1927"></a>
<a id="__codelineno-0-1928" name="__codelineno-0-1928"></a>            <span class="n">nb</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-0-1929" name="__codelineno-0-1929"></a>            <span class="k">while</span> <span class="n">nb</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]):</span>
<a id="__codelineno-0-1930" name="__codelineno-0-1930"></a>                <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">nb</span><span class="p">]</span>
<a id="__codelineno-0-1931" name="__codelineno-0-1931"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">ARSCHeader</span><span class="p">):</span>
<a id="__codelineno-0-1932" name="__codelineno-0-1932"></a>                    <span class="k">if</span> <span class="n">header</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_TABLE_TYPE_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-1933" name="__codelineno-0-1933"></a>                        <span class="n">a_res_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">nb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1934" name="__codelineno-0-1934"></a>
<a id="__codelineno-0-1935" name="__codelineno-0-1935"></a>                        <span class="n">locale</span> <span class="o">=</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_language_and_region</span><span class="p">()</span>
<a id="__codelineno-0-1936" name="__codelineno-0-1936"></a>
<a id="__codelineno-0-1937" name="__codelineno-0-1937"></a>                        <span class="n">c_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span>
<a id="__codelineno-0-1938" name="__codelineno-0-1938"></a>                            <span class="n">locale</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;public&quot;</span><span class="p">:</span> <span class="p">[]}</span>
<a id="__codelineno-0-1939" name="__codelineno-0-1939"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1940" name="__codelineno-0-1940"></a>
<a id="__codelineno-0-1941" name="__codelineno-0-1941"></a>                        <span class="n">entries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">nb</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-1942" name="__codelineno-0-1942"></a>                        <span class="n">nb_i</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1943" name="__codelineno-0-1943"></a>                        <span class="k">for</span> <span class="n">entry</span><span class="p">,</span> <span class="n">res_id</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-1944" name="__codelineno-0-1944"></a>                            <span class="k">if</span> <span class="n">entry</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1945" name="__codelineno-0-1945"></a>                                <span class="n">ate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span>
<a id="__codelineno-0-1946" name="__codelineno-0-1946"></a>                                    <span class="n">nb</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">nb_i</span>
<a id="__codelineno-0-1947" name="__codelineno-0-1947"></a>                                <span class="p">]</span>
<a id="__codelineno-0-1948" name="__codelineno-0-1948"></a>
<a id="__codelineno-0-1949" name="__codelineno-0-1949"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">resource_values</span><span class="p">[</span><span class="n">ate</span><span class="o">.</span><span class="n">mResId</span><span class="p">][</span>
<a id="__codelineno-0-1950" name="__codelineno-0-1950"></a>                                    <span class="n">a_res_type</span><span class="o">.</span><span class="n">config</span>
<a id="__codelineno-0-1951" name="__codelineno-0-1951"></a>                                <span class="p">]</span> <span class="o">=</span> <span class="n">ate</span>
<a id="__codelineno-0-1952" name="__codelineno-0-1952"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">resource_keys</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span>
<a id="__codelineno-0-1953" name="__codelineno-0-1953"></a>                                    <span class="n">a_res_type</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span>
<a id="__codelineno-0-1954" name="__codelineno-0-1954"></a>                                <span class="p">][</span><span class="n">ate</span><span class="o">.</span><span class="n">get_value</span><span class="p">()]</span> <span class="o">=</span> <span class="n">ate</span><span class="o">.</span><span class="n">mResId</span>
<a id="__codelineno-0-1955" name="__codelineno-0-1955"></a>
<a id="__codelineno-0-1956" name="__codelineno-0-1956"></a>                                <span class="k">if</span> <span class="n">ate</span><span class="o">.</span><span class="n">get_index</span><span class="p">()</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1957" name="__codelineno-0-1957"></a>                                    <span class="n">c_value</span><span class="p">[</span><span class="s2">&quot;public&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958"></a>                                        <span class="p">(</span>
<a id="__codelineno-0-1959" name="__codelineno-0-1959"></a>                                            <span class="n">a_res_type</span><span class="o">.</span><span class="n">get_type</span><span class="p">(),</span>
<a id="__codelineno-0-1960" name="__codelineno-0-1960"></a>                                            <span class="n">ate</span><span class="o">.</span><span class="n">get_value</span><span class="p">(),</span>
<a id="__codelineno-0-1961" name="__codelineno-0-1961"></a>                                            <span class="n">ate</span><span class="o">.</span><span class="n">mResId</span><span class="p">,</span>
<a id="__codelineno-0-1962" name="__codelineno-0-1962"></a>                                        <span class="p">)</span>
<a id="__codelineno-0-1963" name="__codelineno-0-1963"></a>                                    <span class="p">)</span>
<a id="__codelineno-0-1964" name="__codelineno-0-1964"></a>
<a id="__codelineno-0-1965" name="__codelineno-0-1965"></a>                                <span class="k">if</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">c_value</span><span class="p">:</span>
<a id="__codelineno-0-1966" name="__codelineno-0-1966"></a>                                    <span class="n">c_value</span><span class="p">[</span><span class="n">a_res_type</span><span class="o">.</span><span class="n">get_type</span><span class="p">()]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1967" name="__codelineno-0-1967"></a>
<a id="__codelineno-0-1968" name="__codelineno-0-1968"></a>                                <span class="k">if</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;string&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1969" name="__codelineno-0-1969"></a>                                    <span class="n">c_value</span><span class="p">[</span><span class="s2">&quot;string&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-1970" name="__codelineno-0-1970"></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_string</span><span class="p">(</span><span class="n">ate</span><span class="p">)</span>
<a id="__codelineno-0-1971" name="__codelineno-0-1971"></a>                                    <span class="p">)</span>
<a id="__codelineno-0-1972" name="__codelineno-0-1972"></a>
<a id="__codelineno-0-1973" name="__codelineno-0-1973"></a>                                <span class="k">elif</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1974" name="__codelineno-0-1974"></a>                                    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1975" name="__codelineno-0-1975"></a>                                        <span class="ow">not</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_complex</span><span class="p">()</span>
<a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>                                        <span class="ow">and</span> <span class="ow">not</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_compact</span><span class="p">()</span>
<a id="__codelineno-0-1977" name="__codelineno-0-1977"></a>                                    <span class="p">):</span>
<a id="__codelineno-0-1978" name="__codelineno-0-1978"></a>                                        <span class="n">c_value</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-1979" name="__codelineno-0-1979"></a>                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_id</span><span class="p">(</span><span class="n">ate</span><span class="p">)</span>
<a id="__codelineno-0-1980" name="__codelineno-0-1980"></a>                                        <span class="p">)</span>
<a id="__codelineno-0-1981" name="__codelineno-0-1981"></a>
<a id="__codelineno-0-1982" name="__codelineno-0-1982"></a>                                <span class="k">elif</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;bool&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1983" name="__codelineno-0-1983"></a>                                    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1984" name="__codelineno-0-1984"></a>                                        <span class="ow">not</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_complex</span><span class="p">()</span>
<a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>                                        <span class="ow">and</span> <span class="ow">not</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_compact</span><span class="p">()</span>
<a id="__codelineno-0-1986" name="__codelineno-0-1986"></a>                                    <span class="p">):</span>
<a id="__codelineno-0-1987" name="__codelineno-0-1987"></a>                                        <span class="n">c_value</span><span class="p">[</span><span class="s2">&quot;bool&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-1988" name="__codelineno-0-1988"></a>                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_bool</span><span class="p">(</span><span class="n">ate</span><span class="p">)</span>
<a id="__codelineno-0-1989" name="__codelineno-0-1989"></a>                                        <span class="p">)</span>
<a id="__codelineno-0-1990" name="__codelineno-0-1990"></a>
<a id="__codelineno-0-1991" name="__codelineno-0-1991"></a>                                <span class="k">elif</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;integer&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1992" name="__codelineno-0-1992"></a>                                    <span class="k">if</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_compact</span><span class="p">():</span>
<a id="__codelineno-0-1993" name="__codelineno-0-1993"></a>                                        <span class="n">c_value</span><span class="p">[</span><span class="s2">&quot;integer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ate</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-1994" name="__codelineno-0-1994"></a>                                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1995" name="__codelineno-0-1995"></a>                                        <span class="n">c_value</span><span class="p">[</span><span class="s2">&quot;integer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-1996" name="__codelineno-0-1996"></a>                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_integer</span><span class="p">(</span><span class="n">ate</span><span class="p">)</span>
<a id="__codelineno-0-1997" name="__codelineno-0-1997"></a>                                        <span class="p">)</span>
<a id="__codelineno-0-1998" name="__codelineno-0-1998"></a>
<a id="__codelineno-0-1999" name="__codelineno-0-1999"></a>                                <span class="k">elif</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2000" name="__codelineno-0-2000"></a>                                    <span class="k">if</span> <span class="ow">not</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_compact</span><span class="p">():</span>
<a id="__codelineno-0-2001" name="__codelineno-0-2001"></a>                                        <span class="n">c_value</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-2002" name="__codelineno-0-2002"></a>                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_color</span><span class="p">(</span><span class="n">ate</span><span class="p">)</span>
<a id="__codelineno-0-2003" name="__codelineno-0-2003"></a>                                        <span class="p">)</span>
<a id="__codelineno-0-2004" name="__codelineno-0-2004"></a>
<a id="__codelineno-0-2005" name="__codelineno-0-2005"></a>                                <span class="k">elif</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;dimen&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2006" name="__codelineno-0-2006"></a>                                    <span class="k">if</span> <span class="ow">not</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_compact</span><span class="p">():</span>
<a id="__codelineno-0-2007" name="__codelineno-0-2007"></a>                                        <span class="n">c_value</span><span class="p">[</span><span class="s2">&quot;dimen&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>                                            <span class="bp">self</span><span class="o">.</span><span class="n">get_resource_dimen</span><span class="p">(</span><span class="n">ate</span><span class="p">)</span>
<a id="__codelineno-0-2009" name="__codelineno-0-2009"></a>                                        <span class="p">)</span>
<a id="__codelineno-0-2010" name="__codelineno-0-2010"></a>
<a id="__codelineno-0-2011" name="__codelineno-0-2011"></a>                                <span class="n">nb_i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-2012" name="__codelineno-0-2012"></a>                        <span class="n">nb</span> <span class="o">+=</span> <span class="p">(</span>
<a id="__codelineno-0-2013" name="__codelineno-0-2013"></a>                            <span class="mi">3</span> <span class="o">+</span> <span class="n">nb_i</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-2014" name="__codelineno-0-2014"></a>                        <span class="p">)</span>  <span class="c1"># -1 to account for the nb+=1 on the next line</span>
<a id="__codelineno-0-2015" name="__codelineno-0-2015"></a>                <span class="n">nb</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-2016" name="__codelineno-0-2016"></a>
<a id="__codelineno-0-2017" name="__codelineno-0-2017"></a>    <span class="k">def</span> <span class="nf">get_resource_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ate</span><span class="p">:</span> <span class="n">ARSCResTableEntry</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-0-2018" name="__codelineno-0-2018"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">ate</span><span class="o">.</span><span class="n">get_value</span><span class="p">(),</span> <span class="n">ate</span><span class="o">.</span><span class="n">get_key_data</span><span class="p">()]</span>
<a id="__codelineno-0-2019" name="__codelineno-0-2019"></a>
<a id="__codelineno-0-2020" name="__codelineno-0-2020"></a>    <span class="k">def</span> <span class="nf">get_resource_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ate</span><span class="p">:</span> <span class="n">ARSCResTableEntry</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2021" name="__codelineno-0-2021"></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">ate</span><span class="o">.</span><span class="n">get_value</span><span class="p">()]</span>
<a id="__codelineno-0-2022" name="__codelineno-0-2022"></a>        <span class="k">if</span> <span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-2023" name="__codelineno-0-2023"></a>            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;false&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2024" name="__codelineno-0-2024"></a>        <span class="k">elif</span> <span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-2025" name="__codelineno-0-2025"></a>            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;true&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2026" name="__codelineno-0-2026"></a>        <span class="k">return</span> <span class="n">x</span>
<a id="__codelineno-0-2027" name="__codelineno-0-2027"></a>
<a id="__codelineno-0-2028" name="__codelineno-0-2028"></a>    <span class="k">def</span> <span class="nf">get_resource_bool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ate</span><span class="p">:</span> <span class="n">ARSCResTableEntry</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2029" name="__codelineno-0-2029"></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">ate</span><span class="o">.</span><span class="n">get_value</span><span class="p">()]</span>
<a id="__codelineno-0-2030" name="__codelineno-0-2030"></a>        <span class="k">if</span> <span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-2031" name="__codelineno-0-2031"></a>            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;false&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2032" name="__codelineno-0-2032"></a>        <span class="k">elif</span> <span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-2033" name="__codelineno-0-2033"></a>            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;true&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2034" name="__codelineno-0-2034"></a>        <span class="k">return</span> <span class="n">x</span>
<a id="__codelineno-0-2035" name="__codelineno-0-2035"></a>
<a id="__codelineno-0-2036" name="__codelineno-0-2036"></a>    <span class="k">def</span> <span class="nf">get_resource_integer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ate</span><span class="p">:</span> <span class="n">ARSCResTableEntry</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-0-2037" name="__codelineno-0-2037"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">ate</span><span class="o">.</span><span class="n">get_value</span><span class="p">(),</span> <span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_data</span><span class="p">()]</span>
<a id="__codelineno-0-2038" name="__codelineno-0-2038"></a>
<a id="__codelineno-0-2039" name="__codelineno-0-2039"></a>    <span class="k">def</span> <span class="nf">get_resource_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ate</span><span class="p">:</span> <span class="n">ARSCResTableEntry</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-0-2040" name="__codelineno-0-2040"></a>        <span class="n">entry_data</span> <span class="o">=</span> <span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<a id="__codelineno-0-2041" name="__codelineno-0-2041"></a>        <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-2042" name="__codelineno-0-2042"></a>            <span class="n">ate</span><span class="o">.</span><span class="n">get_value</span><span class="p">(),</span>
<a id="__codelineno-0-2043" name="__codelineno-0-2043"></a>            <span class="s2">&quot;#</span><span class="si">{:02x}{:02x}{:02x}{:02x}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2044" name="__codelineno-0-2044"></a>                <span class="p">((</span><span class="n">entry_data</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">),</span>
<a id="__codelineno-0-2045" name="__codelineno-0-2045"></a>                <span class="p">((</span><span class="n">entry_data</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">),</span>
<a id="__codelineno-0-2046" name="__codelineno-0-2046"></a>                <span class="p">((</span><span class="n">entry_data</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">),</span>
<a id="__codelineno-0-2047" name="__codelineno-0-2047"></a>                <span class="p">(</span><span class="n">entry_data</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">),</span>
<a id="__codelineno-0-2048" name="__codelineno-0-2048"></a>            <span class="p">),</span>
<a id="__codelineno-0-2049" name="__codelineno-0-2049"></a>        <span class="p">]</span>
<a id="__codelineno-0-2050" name="__codelineno-0-2050"></a>
<a id="__codelineno-0-2051" name="__codelineno-0-2051"></a>    <span class="k">def</span> <span class="nf">get_resource_dimen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ate</span><span class="p">:</span> <span class="n">ARSCResTableEntry</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-0-2052" name="__codelineno-0-2052"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2053" name="__codelineno-0-2053"></a>            <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-2054" name="__codelineno-0-2054"></a>                <span class="n">ate</span><span class="o">.</span><span class="n">get_value</span><span class="p">(),</span>
<a id="__codelineno-0-2055" name="__codelineno-0-2055"></a>                <span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2056" name="__codelineno-0-2056"></a>                    <span class="n">complexToFloat</span><span class="p">(</span><span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_data</span><span class="p">()),</span>
<a id="__codelineno-0-2057" name="__codelineno-0-2057"></a>                    <span class="n">DIMENSION_UNITS</span><span class="p">[</span><span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">COMPLEX_UNIT_MASK</span><span class="p">],</span>
<a id="__codelineno-0-2058" name="__codelineno-0-2058"></a>                <span class="p">),</span>
<a id="__codelineno-0-2059" name="__codelineno-0-2059"></a>            <span class="p">]</span>
<a id="__codelineno-0-2060" name="__codelineno-0-2060"></a>        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
<a id="__codelineno-0-2061" name="__codelineno-0-2061"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-2062" name="__codelineno-0-2062"></a>                <span class="s2">&quot;Out of range dimension unit index for </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2063" name="__codelineno-0-2063"></a>                    <span class="n">complexToFloat</span><span class="p">(</span><span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_data</span><span class="p">()),</span>
<a id="__codelineno-0-2064" name="__codelineno-0-2064"></a>                    <span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">COMPLEX_UNIT_MASK</span><span class="p">,</span>
<a id="__codelineno-0-2065" name="__codelineno-0-2065"></a>                <span class="p">)</span>
<a id="__codelineno-0-2066" name="__codelineno-0-2066"></a>            <span class="p">)</span>
<a id="__codelineno-0-2067" name="__codelineno-0-2067"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">ate</span><span class="o">.</span><span class="n">get_value</span><span class="p">(),</span> <span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_data</span><span class="p">()]</span>
<a id="__codelineno-0-2068" name="__codelineno-0-2068"></a>
<a id="__codelineno-0-2069" name="__codelineno-0-2069"></a>    <span class="c1"># FIXME</span>
<a id="__codelineno-0-2070" name="__codelineno-0-2070"></a>    <span class="k">def</span> <span class="nf">get_resource_style</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ate</span><span class="p">:</span> <span class="n">ARSCResTableEntry</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-0-2071" name="__codelineno-0-2071"></a>        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2072" name="__codelineno-0-2072"></a>
<a id="__codelineno-0-2073" name="__codelineno-0-2073"></a>    <span class="k">def</span> <span class="nf">get_packages_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2074" name="__codelineno-0-2074"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2075" name="__codelineno-0-2075"></a><span class="sd">        Retrieve a list of all package names, which are available</span>
<a id="__codelineno-0-2076" name="__codelineno-0-2076"></a><span class="sd">        in the given resources.arsc.</span>
<a id="__codelineno-0-2077" name="__codelineno-0-2077"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2078" name="__codelineno-0-2078"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-2079" name="__codelineno-0-2079"></a>
<a id="__codelineno-0-2080" name="__codelineno-0-2080"></a>    <span class="k">def</span> <span class="nf">get_locales</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2081" name="__codelineno-0-2081"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2082" name="__codelineno-0-2082"></a><span class="sd">        Retrieve a list of all available locales in a given packagename.</span>
<a id="__codelineno-0-2083" name="__codelineno-0-2083"></a>
<a id="__codelineno-0-2084" name="__codelineno-0-2084"></a><span class="sd">        :param package_name: the package name to get locales of</span>
<a id="__codelineno-0-2085" name="__codelineno-0-2085"></a><span class="sd">        :returns: a list of locale strings</span>
<a id="__codelineno-0-2086" name="__codelineno-0-2086"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2087" name="__codelineno-0-2087"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2088" name="__codelineno-0-2088"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-2089" name="__codelineno-0-2089"></a>
<a id="__codelineno-0-2090" name="__codelineno-0-2090"></a>    <span class="k">def</span> <span class="nf">get_types</span><span class="p">(</span>
<a id="__codelineno-0-2091" name="__codelineno-0-2091"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2092" name="__codelineno-0-2092"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2093" name="__codelineno-0-2093"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2094" name="__codelineno-0-2094"></a><span class="sd">        Retrieve a list of all types which are available in the given</span>
<a id="__codelineno-0-2095" name="__codelineno-0-2095"></a><span class="sd">        package and locale.</span>
<a id="__codelineno-0-2096" name="__codelineno-0-2096"></a>
<a id="__codelineno-0-2097" name="__codelineno-0-2097"></a><span class="sd">        :param package_name: the package name to get types of</span>
<a id="__codelineno-0-2098" name="__codelineno-0-2098"></a><span class="sd">        :param locale: the locale to get types of (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2099" name="__codelineno-0-2099"></a><span class="sd">        :returns: a list of type strings</span>
<a id="__codelineno-0-2100" name="__codelineno-0-2100"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2101" name="__codelineno-0-2101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2102" name="__codelineno-0-2102"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-2103" name="__codelineno-0-2103"></a>
<a id="__codelineno-0-2104" name="__codelineno-0-2104"></a>    <span class="k">def</span> <span class="nf">get_public_resources</span><span class="p">(</span>
<a id="__codelineno-0-2105" name="__codelineno-0-2105"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2106" name="__codelineno-0-2106"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2107" name="__codelineno-0-2107"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2108" name="__codelineno-0-2108"></a><span class="sd">        Get the XML (as string) of all resources of type &#39;public&#39;.</span>
<a id="__codelineno-0-2109" name="__codelineno-0-2109"></a>
<a id="__codelineno-0-2110" name="__codelineno-0-2110"></a><span class="sd">        The public resources table contains the IDs for each item.</span>
<a id="__codelineno-0-2111" name="__codelineno-0-2111"></a>
<a id="__codelineno-0-2112" name="__codelineno-0-2112"></a><span class="sd">        :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2113" name="__codelineno-0-2113"></a><span class="sd">        :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2114" name="__codelineno-0-2114"></a><span class="sd">        :returns: the public xml bytes</span>
<a id="__codelineno-0-2115" name="__codelineno-0-2115"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2116" name="__codelineno-0-2116"></a>
<a id="__codelineno-0-2117" name="__codelineno-0-2117"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2118" name="__codelineno-0-2118"></a>
<a id="__codelineno-0-2119" name="__codelineno-0-2119"></a>        <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2120" name="__codelineno-0-2120"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2121" name="__codelineno-0-2121"></a>
<a id="__codelineno-0-2122" name="__codelineno-0-2122"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2123" name="__codelineno-0-2123"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;public&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2124" name="__codelineno-0-2124"></a>                <span class="n">buff</span> <span class="o">+=</span> <span class="p">(</span>
<a id="__codelineno-0-2125" name="__codelineno-0-2125"></a>                    <span class="s1">&#39;&lt;public type=&quot;</span><span class="si">{}</span><span class="s1">&quot; name=&quot;</span><span class="si">{}</span><span class="s1">&quot; id=&quot;0x</span><span class="si">{:08x}</span><span class="s1">&quot; /&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2126" name="__codelineno-0-2126"></a>                        <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-2127" name="__codelineno-0-2127"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2128" name="__codelineno-0-2128"></a>                <span class="p">)</span>
<a id="__codelineno-0-2129" name="__codelineno-0-2129"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2130" name="__codelineno-0-2130"></a>            <span class="k">pass</span>
<a id="__codelineno-0-2131" name="__codelineno-0-2131"></a>
<a id="__codelineno-0-2132" name="__codelineno-0-2132"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2133" name="__codelineno-0-2133"></a>
<a id="__codelineno-0-2134" name="__codelineno-0-2134"></a>        <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2135" name="__codelineno-0-2135"></a>
<a id="__codelineno-0-2136" name="__codelineno-0-2136"></a>    <span class="k">def</span> <span class="nf">get_string_resources</span><span class="p">(</span>
<a id="__codelineno-0-2137" name="__codelineno-0-2137"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2138" name="__codelineno-0-2138"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2139" name="__codelineno-0-2139"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2140" name="__codelineno-0-2140"></a><span class="sd">        Get the XML (as string) of all resources of type &#39;string&#39;.</span>
<a id="__codelineno-0-2141" name="__codelineno-0-2141"></a>
<a id="__codelineno-0-2142" name="__codelineno-0-2142"></a><span class="sd">        Read more about string resources:</span>
<a id="__codelineno-0-2143" name="__codelineno-0-2143"></a><span class="sd">        &lt;https://developer.android.com/guide/topics/resources/string-resource.html&gt;</span>
<a id="__codelineno-0-2144" name="__codelineno-0-2144"></a>
<a id="__codelineno-0-2145" name="__codelineno-0-2145"></a><span class="sd">        :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2146" name="__codelineno-0-2146"></a><span class="sd">        :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2147" name="__codelineno-0-2147"></a><span class="sd">        :returns: the string xml bytes</span>
<a id="__codelineno-0-2148" name="__codelineno-0-2148"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2149" name="__codelineno-0-2149"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2150" name="__codelineno-0-2150"></a>
<a id="__codelineno-0-2151" name="__codelineno-0-2151"></a>        <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2152" name="__codelineno-0-2152"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2153" name="__codelineno-0-2153"></a>
<a id="__codelineno-0-2154" name="__codelineno-0-2154"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2155" name="__codelineno-0-2155"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;string&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2156" name="__codelineno-0-2156"></a>                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">,</span> <span class="s1">&#39;&lt;&amp;&gt;&#39;</span><span class="p">)):</span>
<a id="__codelineno-0-2157" name="__codelineno-0-2157"></a>                    <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&lt;![CDATA[</span><span class="si">%s</span><span class="s1">]]&gt;&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-2158" name="__codelineno-0-2158"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2159" name="__codelineno-0-2159"></a>                    <span class="n">value</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-2160" name="__codelineno-0-2160"></a>                <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;string name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/string&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-2161" name="__codelineno-0-2161"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2162" name="__codelineno-0-2162"></a>            <span class="k">pass</span>
<a id="__codelineno-0-2163" name="__codelineno-0-2163"></a>
<a id="__codelineno-0-2164" name="__codelineno-0-2164"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2165" name="__codelineno-0-2165"></a>
<a id="__codelineno-0-2166" name="__codelineno-0-2166"></a>        <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2167" name="__codelineno-0-2167"></a>
<a id="__codelineno-0-2168" name="__codelineno-0-2168"></a>    <span class="k">def</span> <span class="nf">get_strings_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a><span class="sd">        Get the XML (as string) of all resources of type &#39;string&#39;.</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a><span class="sd">        This is a combined variant, which has all locales and all package names</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a><span class="sd">        stored.</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a><span class="sd">        :returns: the string, locales, and package name xml bytes</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a>        <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a>
<a id="__codelineno-0-2180" name="__codelineno-0-2180"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s2">&quot;&lt;packages&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2181" name="__codelineno-0-2181"></a>        <span class="k">for</span> <span class="n">package_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_packages_names</span><span class="p">():</span>
<a id="__codelineno-0-2182" name="__codelineno-0-2182"></a>            <span class="n">buff</span> <span class="o">+=</span> <span class="s2">&quot;&lt;package name=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">package_name</span>
<a id="__codelineno-0-2183" name="__codelineno-0-2183"></a>
<a id="__codelineno-0-2184" name="__codelineno-0-2184"></a>            <span class="k">for</span> <span class="n">locale</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_locales</span><span class="p">(</span><span class="n">package_name</span><span class="p">):</span>
<a id="__codelineno-0-2185" name="__codelineno-0-2185"></a>                <span class="n">buff</span> <span class="o">+=</span> <span class="s2">&quot;&lt;locale value=</span><span class="si">%s</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">repr</span><span class="p">(</span><span class="n">locale</span><span class="p">)</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186"></a>
<a id="__codelineno-0-2187" name="__codelineno-0-2187"></a>                <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2189" name="__codelineno-0-2189"></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;string&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2190" name="__codelineno-0-2190"></a>                        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;string name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/string&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2191" name="__codelineno-0-2191"></a>                            <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">escape</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-2192" name="__codelineno-0-2192"></a>                        <span class="p">)</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193"></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2194" name="__codelineno-0-2194"></a>                    <span class="k">pass</span>
<a id="__codelineno-0-2195" name="__codelineno-0-2195"></a>
<a id="__codelineno-0-2196" name="__codelineno-0-2196"></a>                <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197"></a>                <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/locale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198"></a>
<a id="__codelineno-0-2199" name="__codelineno-0-2199"></a>            <span class="n">buff</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/package&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200"></a>
<a id="__codelineno-0-2201" name="__codelineno-0-2201"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/packages&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2202" name="__codelineno-0-2202"></a>
<a id="__codelineno-0-2203" name="__codelineno-0-2203"></a>        <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2204" name="__codelineno-0-2204"></a>
<a id="__codelineno-0-2205" name="__codelineno-0-2205"></a>    <span class="k">def</span> <span class="nf">get_id_resources</span><span class="p">(</span>
<a id="__codelineno-0-2206" name="__codelineno-0-2206"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2207" name="__codelineno-0-2207"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2208" name="__codelineno-0-2208"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2209" name="__codelineno-0-2209"></a><span class="sd">        Get the XML (as string) of all resources of type &#39;id&#39;.</span>
<a id="__codelineno-0-2210" name="__codelineno-0-2210"></a>
<a id="__codelineno-0-2211" name="__codelineno-0-2211"></a><span class="sd">        Read more about ID resources:</span>
<a id="__codelineno-0-2212" name="__codelineno-0-2212"></a><span class="sd">        &lt;https://developer.android.com/guide/topics/resources/more-resources.html#Id&gt;</span>
<a id="__codelineno-0-2213" name="__codelineno-0-2213"></a>
<a id="__codelineno-0-2214" name="__codelineno-0-2214"></a><span class="sd">        :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2215" name="__codelineno-0-2215"></a><span class="sd">        :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2216" name="__codelineno-0-2216"></a>
<a id="__codelineno-0-2217" name="__codelineno-0-2217"></a><span class="sd">        :returns: the id resources xml bytes</span>
<a id="__codelineno-0-2218" name="__codelineno-0-2218"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2219" name="__codelineno-0-2219"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2220" name="__codelineno-0-2220"></a>
<a id="__codelineno-0-2221" name="__codelineno-0-2221"></a>        <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2222" name="__codelineno-0-2222"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2223" name="__codelineno-0-2223"></a>
<a id="__codelineno-0-2224" name="__codelineno-0-2224"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2225" name="__codelineno-0-2225"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2226" name="__codelineno-0-2226"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-2227" name="__codelineno-0-2227"></a>                    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;item type=&quot;id&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot;/&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-2228" name="__codelineno-0-2228"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2229" name="__codelineno-0-2229"></a>                    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;item type=&quot;id&quot; name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/item&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2230" name="__codelineno-0-2230"></a>                        <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">escape</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-2231" name="__codelineno-0-2231"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2232" name="__codelineno-0-2232"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2233" name="__codelineno-0-2233"></a>            <span class="k">pass</span>
<a id="__codelineno-0-2234" name="__codelineno-0-2234"></a>
<a id="__codelineno-0-2235" name="__codelineno-0-2235"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2236" name="__codelineno-0-2236"></a>
<a id="__codelineno-0-2237" name="__codelineno-0-2237"></a>        <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2238" name="__codelineno-0-2238"></a>
<a id="__codelineno-0-2239" name="__codelineno-0-2239"></a>    <span class="k">def</span> <span class="nf">get_bool_resources</span><span class="p">(</span>
<a id="__codelineno-0-2240" name="__codelineno-0-2240"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2241" name="__codelineno-0-2241"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2242" name="__codelineno-0-2242"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2243" name="__codelineno-0-2243"></a><span class="sd">        Get the XML (as string) of all resources of type &#39;bool&#39;.</span>
<a id="__codelineno-0-2244" name="__codelineno-0-2244"></a>
<a id="__codelineno-0-2245" name="__codelineno-0-2245"></a><span class="sd">        Read more about bool resources:</span>
<a id="__codelineno-0-2246" name="__codelineno-0-2246"></a><span class="sd">        &lt;https://developer.android.com/guide/topics/resources/more-resources.html#Bool&gt;</span>
<a id="__codelineno-0-2247" name="__codelineno-0-2247"></a>
<a id="__codelineno-0-2248" name="__codelineno-0-2248"></a><span class="sd">        :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2249" name="__codelineno-0-2249"></a><span class="sd">        :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2250" name="__codelineno-0-2250"></a>
<a id="__codelineno-0-2251" name="__codelineno-0-2251"></a><span class="sd">        :returns: the bool resources xml bytes</span>
<a id="__codelineno-0-2252" name="__codelineno-0-2252"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2253" name="__codelineno-0-2253"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2254" name="__codelineno-0-2254"></a>
<a id="__codelineno-0-2255" name="__codelineno-0-2255"></a>        <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2256" name="__codelineno-0-2256"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2257" name="__codelineno-0-2257"></a>
<a id="__codelineno-0-2258" name="__codelineno-0-2258"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2259" name="__codelineno-0-2259"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2260" name="__codelineno-0-2260"></a>                <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;bool name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/bool&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-2261" name="__codelineno-0-2261"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2262" name="__codelineno-0-2262"></a>            <span class="k">pass</span>
<a id="__codelineno-0-2263" name="__codelineno-0-2263"></a>
<a id="__codelineno-0-2264" name="__codelineno-0-2264"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2265" name="__codelineno-0-2265"></a>
<a id="__codelineno-0-2266" name="__codelineno-0-2266"></a>        <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2267" name="__codelineno-0-2267"></a>
<a id="__codelineno-0-2268" name="__codelineno-0-2268"></a>    <span class="k">def</span> <span class="nf">get_integer_resources</span><span class="p">(</span>
<a id="__codelineno-0-2269" name="__codelineno-0-2269"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2270" name="__codelineno-0-2270"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2271" name="__codelineno-0-2271"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2272" name="__codelineno-0-2272"></a><span class="sd">        Get the XML (as string) of all resources of type &#39;integer&#39;.</span>
<a id="__codelineno-0-2273" name="__codelineno-0-2273"></a>
<a id="__codelineno-0-2274" name="__codelineno-0-2274"></a><span class="sd">        Read more about integer resources:</span>
<a id="__codelineno-0-2275" name="__codelineno-0-2275"></a><span class="sd">        &lt;https://developer.android.com/guide/topics/resources/more-resources.html#Integer&gt;</span>
<a id="__codelineno-0-2276" name="__codelineno-0-2276"></a>
<a id="__codelineno-0-2277" name="__codelineno-0-2277"></a><span class="sd">        :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2278" name="__codelineno-0-2278"></a><span class="sd">        :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2279" name="__codelineno-0-2279"></a>
<a id="__codelineno-0-2280" name="__codelineno-0-2280"></a><span class="sd">        :returns: the integer resources xml bytes</span>
<a id="__codelineno-0-2281" name="__codelineno-0-2281"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2282" name="__codelineno-0-2282"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2283" name="__codelineno-0-2283"></a>
<a id="__codelineno-0-2284" name="__codelineno-0-2284"></a>        <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2285" name="__codelineno-0-2285"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2286" name="__codelineno-0-2286"></a>
<a id="__codelineno-0-2287" name="__codelineno-0-2287"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2288" name="__codelineno-0-2288"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;integer&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2289" name="__codelineno-0-2289"></a>                <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;integer name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/integer&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-2290" name="__codelineno-0-2290"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2291" name="__codelineno-0-2291"></a>            <span class="k">pass</span>
<a id="__codelineno-0-2292" name="__codelineno-0-2292"></a>
<a id="__codelineno-0-2293" name="__codelineno-0-2293"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2294" name="__codelineno-0-2294"></a>
<a id="__codelineno-0-2295" name="__codelineno-0-2295"></a>        <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2296" name="__codelineno-0-2296"></a>
<a id="__codelineno-0-2297" name="__codelineno-0-2297"></a>    <span class="k">def</span> <span class="nf">get_color_resources</span><span class="p">(</span>
<a id="__codelineno-0-2298" name="__codelineno-0-2298"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2299" name="__codelineno-0-2299"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2300" name="__codelineno-0-2300"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2301" name="__codelineno-0-2301"></a><span class="sd">        Get the XML (as string) of all resources of type &#39;color&#39;.</span>
<a id="__codelineno-0-2302" name="__codelineno-0-2302"></a>
<a id="__codelineno-0-2303" name="__codelineno-0-2303"></a><span class="sd">        Read more about color resources:</span>
<a id="__codelineno-0-2304" name="__codelineno-0-2304"></a><span class="sd">        &lt;https://developer.android.com/guide/topics/resources/more-resources.html#Color&gt;</span>
<a id="__codelineno-0-2305" name="__codelineno-0-2305"></a>
<a id="__codelineno-0-2306" name="__codelineno-0-2306"></a><span class="sd">        :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2307" name="__codelineno-0-2307"></a><span class="sd">        :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2308" name="__codelineno-0-2308"></a>
<a id="__codelineno-0-2309" name="__codelineno-0-2309"></a><span class="sd">        :returns: the color resources xml bytes</span>
<a id="__codelineno-0-2310" name="__codelineno-0-2310"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2311" name="__codelineno-0-2311"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2312" name="__codelineno-0-2312"></a>
<a id="__codelineno-0-2313" name="__codelineno-0-2313"></a>        <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2314" name="__codelineno-0-2314"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2315" name="__codelineno-0-2315"></a>
<a id="__codelineno-0-2316" name="__codelineno-0-2316"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2317" name="__codelineno-0-2317"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2318" name="__codelineno-0-2318"></a>                <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;color name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/color&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-2319" name="__codelineno-0-2319"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2320" name="__codelineno-0-2320"></a>            <span class="k">pass</span>
<a id="__codelineno-0-2321" name="__codelineno-0-2321"></a>
<a id="__codelineno-0-2322" name="__codelineno-0-2322"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2323" name="__codelineno-0-2323"></a>
<a id="__codelineno-0-2324" name="__codelineno-0-2324"></a>        <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2325" name="__codelineno-0-2325"></a>
<a id="__codelineno-0-2326" name="__codelineno-0-2326"></a>    <span class="k">def</span> <span class="nf">get_dimen_resources</span><span class="p">(</span>
<a id="__codelineno-0-2327" name="__codelineno-0-2327"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2328" name="__codelineno-0-2328"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2329" name="__codelineno-0-2329"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2330" name="__codelineno-0-2330"></a><span class="sd">        Get the XML (as string) of all resources of type &#39;dimen&#39;.</span>
<a id="__codelineno-0-2331" name="__codelineno-0-2331"></a>
<a id="__codelineno-0-2332" name="__codelineno-0-2332"></a><span class="sd">        Read more about Dimension resources:</span>
<a id="__codelineno-0-2333" name="__codelineno-0-2333"></a><span class="sd">        &lt;https://developer.android.com/guide/topics/resources/more-resources.html#Dimension&gt;</span>
<a id="__codelineno-0-2334" name="__codelineno-0-2334"></a>
<a id="__codelineno-0-2335" name="__codelineno-0-2335"></a><span class="sd">        :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2336" name="__codelineno-0-2336"></a><span class="sd">        :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2337" name="__codelineno-0-2337"></a>
<a id="__codelineno-0-2338" name="__codelineno-0-2338"></a><span class="sd">        :returns: the dimen resource xml bytes</span>
<a id="__codelineno-0-2339" name="__codelineno-0-2339"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2340" name="__codelineno-0-2340"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2341" name="__codelineno-0-2341"></a>
<a id="__codelineno-0-2342" name="__codelineno-0-2342"></a>        <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2343" name="__codelineno-0-2343"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2344" name="__codelineno-0-2344"></a>
<a id="__codelineno-0-2345" name="__codelineno-0-2345"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2346" name="__codelineno-0-2346"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;dimen&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2347" name="__codelineno-0-2347"></a>                <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;dimen name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/dimen&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-2348" name="__codelineno-0-2348"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2349" name="__codelineno-0-2349"></a>            <span class="k">pass</span>
<a id="__codelineno-0-2350" name="__codelineno-0-2350"></a>
<a id="__codelineno-0-2351" name="__codelineno-0-2351"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2352" name="__codelineno-0-2352"></a>
<a id="__codelineno-0-2353" name="__codelineno-0-2353"></a>        <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2354" name="__codelineno-0-2354"></a>
<a id="__codelineno-0-2355" name="__codelineno-0-2355"></a>    <span class="k">def</span> <span class="nf">get_id</span><span class="p">(</span>
<a id="__codelineno-0-2356" name="__codelineno-0-2356"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2357" name="__codelineno-0-2357"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<a id="__codelineno-0-2358" name="__codelineno-0-2358"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2359" name="__codelineno-0-2359"></a><span class="sd">        Returns the tuple `(resource_type, resource_name, resource_id)`</span>
<a id="__codelineno-0-2360" name="__codelineno-0-2360"></a><span class="sd">        for the given resource_id.</span>
<a id="__codelineno-0-2361" name="__codelineno-0-2361"></a>
<a id="__codelineno-0-2362" name="__codelineno-0-2362"></a><span class="sd">        :param package_name: package name to query</span>
<a id="__codelineno-0-2363" name="__codelineno-0-2363"></a><span class="sd">        :param rid: the resource_id</span>
<a id="__codelineno-0-2364" name="__codelineno-0-2364"></a><span class="sd">        :param locale: specific locale</span>
<a id="__codelineno-0-2365" name="__codelineno-0-2365"></a><span class="sd">        :returns: tuple of (resource_type, resource_name, resource_id)</span>
<a id="__codelineno-0-2366" name="__codelineno-0-2366"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2367" name="__codelineno-0-2367"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2368" name="__codelineno-0-2368"></a>
<a id="__codelineno-0-2369" name="__codelineno-0-2369"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2370" name="__codelineno-0-2370"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;public&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2371" name="__codelineno-0-2371"></a>                <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">rid</span><span class="p">:</span>
<a id="__codelineno-0-2372" name="__codelineno-0-2372"></a>                    <span class="k">return</span> <span class="n">i</span>
<a id="__codelineno-0-2373" name="__codelineno-0-2373"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2374" name="__codelineno-0-2374"></a>            <span class="k">pass</span>
<a id="__codelineno-0-2375" name="__codelineno-0-2375"></a>        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-2376" name="__codelineno-0-2376"></a>
<a id="__codelineno-0-2377" name="__codelineno-0-2377"></a>    <span class="k">class</span> <span class="nc">ResourceResolver</span><span class="p">:</span>
<a id="__codelineno-0-2378" name="__codelineno-0-2378"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2379" name="__codelineno-0-2379"></a><span class="sd">        Resolves resources by ID and configuration.</span>
<a id="__codelineno-0-2380" name="__codelineno-0-2380"></a><span class="sd">        This resolver deals with complex resources as well as with references.</span>
<a id="__codelineno-0-2381" name="__codelineno-0-2381"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2382" name="__codelineno-0-2382"></a>
<a id="__codelineno-0-2383" name="__codelineno-0-2383"></a>        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-2384" name="__codelineno-0-2384"></a>            <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2385" name="__codelineno-0-2385"></a>            <span class="n">android_resources</span><span class="p">:</span> <span class="n">ARSCParser</span><span class="p">,</span>
<a id="__codelineno-0-2386" name="__codelineno-0-2386"></a>            <span class="n">config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2387" name="__codelineno-0-2387"></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2388" name="__codelineno-0-2388"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2389" name="__codelineno-0-2389"></a><span class="sd">            :param ARSCParser android_resources: A resource parser</span>
<a id="__codelineno-0-2390" name="__codelineno-0-2390"></a><span class="sd">            :param ARSCResTableConfig config: The desired configuration or None to resolve all.</span>
<a id="__codelineno-0-2391" name="__codelineno-0-2391"></a><span class="sd">            &quot;&quot;&quot;</span>
<a id="__codelineno-0-2392" name="__codelineno-0-2392"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="n">android_resources</span>
<a id="__codelineno-0-2393" name="__codelineno-0-2393"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">wanted_config</span> <span class="o">=</span> <span class="n">config</span>
<a id="__codelineno-0-2394" name="__codelineno-0-2394"></a>
<a id="__codelineno-0-2395" name="__codelineno-0-2395"></a>        <span class="k">def</span> <span class="nf">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-2396" name="__codelineno-0-2396"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2397" name="__codelineno-0-2397"></a><span class="sd">            the given ID into the Resource and returns a list of matching resources.</span>
<a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>
<a id="__codelineno-0-2399" name="__codelineno-0-2399"></a><span class="sd">            :param int res_id: numerical ID of the resource</span>
<a id="__codelineno-0-2400" name="__codelineno-0-2400"></a><span class="sd">            :returns: a list of tuples of (ARSCResTableConfig, str)</span>
<a id="__codelineno-0-2401" name="__codelineno-0-2401"></a><span class="sd">            &quot;&quot;&quot;</span>
<a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2403" name="__codelineno-0-2403"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_into_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">res_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wanted_config</span><span class="p">)</span>
<a id="__codelineno-0-2404" name="__codelineno-0-2404"></a>            <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-2405" name="__codelineno-0-2405"></a>
<a id="__codelineno-0-2406" name="__codelineno-0-2406"></a>        <span class="k">def</span> <span class="nf">_resolve_into_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">res_id</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<a id="__codelineno-0-2407" name="__codelineno-0-2407"></a>            <span class="c1"># First: Get all candidates</span>
<a id="__codelineno-0-2408" name="__codelineno-0-2408"></a>            <span class="n">configs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">get_res_configs</span><span class="p">(</span><span class="n">res_id</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-2409" name="__codelineno-0-2409"></a>
<a id="__codelineno-0-2410" name="__codelineno-0-2410"></a>            <span class="k">for</span> <span class="n">config</span><span class="p">,</span> <span class="n">ate</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">:</span>
<a id="__codelineno-0-2411" name="__codelineno-0-2411"></a>                <span class="c1"># deconstruct them and check if more candidates are generated</span>
<a id="__codelineno-0-2412" name="__codelineno-0-2412"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">put_ate_value</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">ate</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-2413" name="__codelineno-0-2413"></a>
<a id="__codelineno-0-2414" name="__codelineno-0-2414"></a>        <span class="k">def</span> <span class="nf">put_ate_value</span><span class="p">(</span>
<a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>            <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2416" name="__codelineno-0-2416"></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-2417" name="__codelineno-0-2417"></a>            <span class="n">ate</span><span class="p">:</span> <span class="n">ARSCResTableEntry</span><span class="p">,</span>
<a id="__codelineno-0-2418" name="__codelineno-0-2418"></a>            <span class="n">config</span><span class="p">:</span> <span class="n">ARSCResTableConfig</span><span class="p">,</span>
<a id="__codelineno-0-2419" name="__codelineno-0-2419"></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2420" name="__codelineno-0-2420"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2421" name="__codelineno-0-2421"></a><span class="sd">            Put a [ARSCResTableEntry][androguard.core.axml.ARSCResTableEntry] into the list of results</span>
<a id="__codelineno-0-2422" name="__codelineno-0-2422"></a><span class="sd">            :param result: results array</span>
<a id="__codelineno-0-2423" name="__codelineno-0-2423"></a><span class="sd">            :param ate:</span>
<a id="__codelineno-0-2424" name="__codelineno-0-2424"></a><span class="sd">            :param config:</span>
<a id="__codelineno-0-2425" name="__codelineno-0-2425"></a><span class="sd">            &quot;&quot;&quot;</span>
<a id="__codelineno-0-2426" name="__codelineno-0-2426"></a>            <span class="k">if</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_complex</span><span class="p">():</span>
<a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>                <span class="n">complex_array</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2428" name="__codelineno-0-2428"></a>                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">config</span><span class="p">,</span> <span class="n">complex_array</span><span class="p">))</span>
<a id="__codelineno-0-2429" name="__codelineno-0-2429"></a>                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ate</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
<a id="__codelineno-0-2430" name="__codelineno-0-2430"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">put_item_value</span><span class="p">(</span>
<a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>                        <span class="n">complex_array</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">ate</span><span class="p">,</span> <span class="n">complex_</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-2432" name="__codelineno-0-2432"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2433" name="__codelineno-0-2433"></a>            <span class="k">elif</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_compact</span><span class="p">():</span>
<a id="__codelineno-0-2434" name="__codelineno-0-2434"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">put_item_value</span><span class="p">(</span>
<a id="__codelineno-0-2435" name="__codelineno-0-2435"></a>                    <span class="n">result</span><span class="p">,</span>
<a id="__codelineno-0-2436" name="__codelineno-0-2436"></a>                    <span class="n">ate</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-2437" name="__codelineno-0-2437"></a>                    <span class="n">config</span><span class="p">,</span>
<a id="__codelineno-0-2438" name="__codelineno-0-2438"></a>                    <span class="n">ate</span><span class="p">,</span>
<a id="__codelineno-0-2439" name="__codelineno-0-2439"></a>                    <span class="n">complex_</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>                    <span class="n">compact_</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2441" name="__codelineno-0-2441"></a>                <span class="p">)</span>
<a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2443" name="__codelineno-0-2443"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">put_item_value</span><span class="p">(</span>
<a id="__codelineno-0-2444" name="__codelineno-0-2444"></a>                    <span class="n">result</span><span class="p">,</span> <span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">ate</span><span class="p">,</span> <span class="n">complex_</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>                <span class="p">)</span>
<a id="__codelineno-0-2446" name="__codelineno-0-2446"></a>
<a id="__codelineno-0-2447" name="__codelineno-0-2447"></a>        <span class="k">def</span> <span class="nf">put_item_value</span><span class="p">(</span>
<a id="__codelineno-0-2448" name="__codelineno-0-2448"></a>            <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2449" name="__codelineno-0-2449"></a>            <span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>            <span class="n">item</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ARSCResStringPoolRef</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-2451" name="__codelineno-0-2451"></a>            <span class="n">config</span><span class="p">:</span> <span class="n">ARSCResTableConfig</span><span class="p">,</span>
<a id="__codelineno-0-2452" name="__codelineno-0-2452"></a>            <span class="n">parent</span><span class="p">:</span> <span class="n">ARSCResTableEntry</span><span class="p">,</span>
<a id="__codelineno-0-2453" name="__codelineno-0-2453"></a>            <span class="n">complex_</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>            <span class="n">compact_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2455" name="__codelineno-0-2455"></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2456" name="__codelineno-0-2456"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2457" name="__codelineno-0-2457"></a><span class="sd">            Put the tuple ([ARSCResTableConfig][androguard.core.axml.ARSCResTableConfig], resolved string) into the result set</span>
<a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>
<a id="__codelineno-0-2459" name="__codelineno-0-2459"></a><span class="sd">            :param result: the result set</span>
<a id="__codelineno-0-2460" name="__codelineno-0-2460"></a><span class="sd">            :param item:</span>
<a id="__codelineno-0-2461" name="__codelineno-0-2461"></a><span class="sd">            :param config:</span>
<a id="__codelineno-0-2462" name="__codelineno-0-2462"></a><span class="sd">            :param parent: the originating entry</span>
<a id="__codelineno-0-2463" name="__codelineno-0-2463"></a><span class="sd">            :param complex_: True if the originating `ARSCResTableEntry` was complex</span>
<a id="__codelineno-0-2464" name="__codelineno-0-2464"></a><span class="sd">            :param bool compact_: True if the originating `ARSCResTableEntry` was compact</span>
<a id="__codelineno-0-2465" name="__codelineno-0-2465"></a><span class="sd">            &quot;&quot;&quot;</span>
<a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">ARSCResStringPoolRef</span><span class="p">):</span>
<a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_reference</span><span class="p">():</span>
<a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>                    <span class="n">res_id</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>                    <span class="k">if</span> <span class="n">res_id</span><span class="p">:</span>
<a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>                        <span class="c1"># Infinite loop detection:</span>
<a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>                        <span class="c1"># TODO should this stay here or should be detect the loop much earlier?</span>
<a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>                        <span class="k">if</span> <span class="n">res_id</span> <span class="o">==</span> <span class="n">parent</span><span class="o">.</span><span class="n">mResId</span><span class="p">:</span>
<a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>                                <span class="s2">&quot;Infinite loop detected at resource item </span><span class="si">{}</span><span class="s2">. It references itself!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>                                    <span class="n">parent</span>
<a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>                                <span class="p">)</span>
<a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>                            <span class="p">)</span>
<a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>                            <span class="k">return</span>
<a id="__codelineno-0-2479" name="__codelineno-0-2479"></a>
<a id="__codelineno-0-2480" name="__codelineno-0-2480"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_into_result</span><span class="p">(</span>
<a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>                            <span class="n">result</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">get_data</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wanted_config</span>
<a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>                        <span class="p">)</span>
<a id="__codelineno-0-2483" name="__codelineno-0-2483"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>                    <span class="k">if</span> <span class="n">complex_</span><span class="p">:</span>
<a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">format_value</span><span class="p">())</span>
<a id="__codelineno-0-2486" name="__codelineno-0-2486"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2487" name="__codelineno-0-2487"></a>                        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">config</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">format_value</span><span class="p">()))</span>
<a id="__codelineno-0-2488" name="__codelineno-0-2488"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2489" name="__codelineno-0-2489"></a>                <span class="k">if</span> <span class="n">compact_</span><span class="p">:</span>
<a id="__codelineno-0-2490" name="__codelineno-0-2490"></a>                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-2491" name="__codelineno-0-2491"></a>                        <span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">stringpool_main</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
<a id="__codelineno-0-2492" name="__codelineno-0-2492"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2493" name="__codelineno-0-2493"></a>
<a id="__codelineno-0-2494" name="__codelineno-0-2494"></a>    <span class="k">def</span> <span class="nf">get_resolved_res_configs</span><span class="p">(</span>
<a id="__codelineno-0-2495" name="__codelineno-0-2495"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2496" name="__codelineno-0-2496"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-2497" name="__codelineno-0-2497"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2498" name="__codelineno-0-2498"></a><span class="sd">        Return a list of resolved resource IDs with their corresponding configuration.</span>
<a id="__codelineno-0-2499" name="__codelineno-0-2499"></a><span class="sd">        It has a similar return type as [get_res_configs][androguard.core.axml.ARSCParser.get_res_configs] but also handles complex entries</span>
<a id="__codelineno-0-2500" name="__codelineno-0-2500"></a><span class="sd">        and references.</span>
<a id="__codelineno-0-2501" name="__codelineno-0-2501"></a><span class="sd">        Also instead of returning [ARSCResTableConfig][androguard.core.axml.ARSCResTableConfig] in the tuple, the actual values are resolved.</span>
<a id="__codelineno-0-2502" name="__codelineno-0-2502"></a>
<a id="__codelineno-0-2503" name="__codelineno-0-2503"></a><span class="sd">        This is the preferred way of resolving resource IDs to their resources.</span>
<a id="__codelineno-0-2504" name="__codelineno-0-2504"></a>
<a id="__codelineno-0-2505" name="__codelineno-0-2505"></a><span class="sd">        :param rid: the numerical ID of the resource</span>
<a id="__codelineno-0-2506" name="__codelineno-0-2506"></a><span class="sd">        :param config: the desired configuration or None to retrieve all</span>
<a id="__codelineno-0-2507" name="__codelineno-0-2507"></a><span class="sd">        :return: A list of tuples of (`ARSCResTableConfig`, str)</span>
<a id="__codelineno-0-2508" name="__codelineno-0-2508"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2509" name="__codelineno-0-2509"></a>        <span class="n">resolver</span> <span class="o">=</span> <span class="n">ARSCParser</span><span class="o">.</span><span class="n">ResourceResolver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-2510" name="__codelineno-0-2510"></a>        <span class="k">return</span> <span class="n">resolver</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">rid</span><span class="p">)</span>
<a id="__codelineno-0-2511" name="__codelineno-0-2511"></a>
<a id="__codelineno-0-2512" name="__codelineno-0-2512"></a>    <span class="k">def</span> <span class="nf">get_resolved_strings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2513" name="__codelineno-0-2513"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2514" name="__codelineno-0-2514"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolved_strings</span><span class="p">:</span>
<a id="__codelineno-0-2515" name="__codelineno-0-2515"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolved_strings</span>
<a id="__codelineno-0-2516" name="__codelineno-0-2516"></a>
<a id="__codelineno-0-2517" name="__codelineno-0-2517"></a>        <span class="n">r</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-2518" name="__codelineno-0-2518"></a>        <span class="k">for</span> <span class="n">package_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_packages_names</span><span class="p">():</span>
<a id="__codelineno-0-2519" name="__codelineno-0-2519"></a>            <span class="n">r</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-2520" name="__codelineno-0-2520"></a>            <span class="n">k</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-2521" name="__codelineno-0-2521"></a>
<a id="__codelineno-0-2522" name="__codelineno-0-2522"></a>            <span class="k">for</span> <span class="n">locale</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">]:</span>
<a id="__codelineno-0-2523" name="__codelineno-0-2523"></a>                <span class="n">v_locale</span> <span class="o">=</span> <span class="n">locale</span>
<a id="__codelineno-0-2524" name="__codelineno-0-2524"></a>                <span class="k">if</span> <span class="n">v_locale</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2525" name="__codelineno-0-2525"></a>                    <span class="n">v_locale</span> <span class="o">=</span> <span class="s1">&#39;DEFAULT&#39;</span>
<a id="__codelineno-0-2526" name="__codelineno-0-2526"></a>
<a id="__codelineno-0-2527" name="__codelineno-0-2527"></a>                <span class="n">r</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">v_locale</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-2528" name="__codelineno-0-2528"></a>
<a id="__codelineno-0-2529" name="__codelineno-0-2529"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2530" name="__codelineno-0-2530"></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;public&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2531" name="__codelineno-0-2531"></a>                        <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;string&#39;</span><span class="p">:</span>
<a id="__codelineno-0-2532" name="__codelineno-0-2532"></a>                            <span class="n">r</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">v_locale</span><span class="p">][</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2533" name="__codelineno-0-2533"></a>                            <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-2534" name="__codelineno-0-2534"></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2535" name="__codelineno-0-2535"></a>                    <span class="k">pass</span>
<a id="__codelineno-0-2536" name="__codelineno-0-2536"></a>
<a id="__codelineno-0-2537" name="__codelineno-0-2537"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2538" name="__codelineno-0-2538"></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;string&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2539" name="__codelineno-0-2539"></a>                        <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
<a id="__codelineno-0-2540" name="__codelineno-0-2540"></a>                            <span class="n">r</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">v_locale</span><span class="p">][</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-2541" name="__codelineno-0-2541"></a>                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2542" name="__codelineno-0-2542"></a>                    <span class="k">pass</span>
<a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>
<a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_resolved_strings</span> <span class="o">=</span> <span class="n">r</span>
<a id="__codelineno-0-2545" name="__codelineno-0-2545"></a>        <span class="k">return</span> <span class="n">r</span>
<a id="__codelineno-0-2546" name="__codelineno-0-2546"></a>
<a id="__codelineno-0-2547" name="__codelineno-0-2547"></a>    <span class="k">def</span> <span class="nf">get_res_configs</span><span class="p">(</span>
<a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2549" name="__codelineno-0-2549"></a>        <span class="n">rid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-2550" name="__codelineno-0-2550"></a>        <span class="n">config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2551" name="__codelineno-0-2551"></a>        <span class="n">fallback</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2552" name="__codelineno-0-2552"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">]:</span>
<a id="__codelineno-0-2553" name="__codelineno-0-2553"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2554" name="__codelineno-0-2554"></a><span class="sd">        Return the resources found with the ID `rid` and select</span>
<a id="__codelineno-0-2555" name="__codelineno-0-2555"></a><span class="sd">        the right one based on the configuration, or return all if no configuration was set.</span>
<a id="__codelineno-0-2556" name="__codelineno-0-2556"></a>
<a id="__codelineno-0-2557" name="__codelineno-0-2557"></a><span class="sd">        But we try to be generous here and at least try to resolve something:</span>
<a id="__codelineno-0-2558" name="__codelineno-0-2558"></a><span class="sd">        This method uses a fallback to return at least one resource (the first one in the list)</span>
<a id="__codelineno-0-2559" name="__codelineno-0-2559"></a><span class="sd">        if more than one items are found and the default config is used and no default entry could be found.</span>
<a id="__codelineno-0-2560" name="__codelineno-0-2560"></a>
<a id="__codelineno-0-2561" name="__codelineno-0-2561"></a><span class="sd">        This is usually a bad sign (i.e. the developer did not follow the android documentation:</span>
<a id="__codelineno-0-2562" name="__codelineno-0-2562"></a><span class="sd">        &lt;https://developer.android.com/guide/topics/resources/localization.html#failing2)&gt;</span>
<a id="__codelineno-0-2563" name="__codelineno-0-2563"></a><span class="sd">        In practise an app might just be designed to run on a single locale and thus only has those locales set.</span>
<a id="__codelineno-0-2564" name="__codelineno-0-2564"></a>
<a id="__codelineno-0-2565" name="__codelineno-0-2565"></a><span class="sd">        You can disable this fallback behaviour, to just return exactly the given result.</span>
<a id="__codelineno-0-2566" name="__codelineno-0-2566"></a>
<a id="__codelineno-0-2567" name="__codelineno-0-2567"></a><span class="sd">        :param rid: resource id as int</span>
<a id="__codelineno-0-2568" name="__codelineno-0-2568"></a><span class="sd">        :param config: a config to resolve from, or None to get all results</span>
<a id="__codelineno-0-2569" name="__codelineno-0-2569"></a><span class="sd">        :param fallback: Enable the fallback for resolving default configuration (default: True)</span>
<a id="__codelineno-0-2570" name="__codelineno-0-2570"></a><span class="sd">        :return: a list of `ARSCResTableConfig`</span>
<a id="__codelineno-0-2571" name="__codelineno-0-2571"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2572" name="__codelineno-0-2572"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2573" name="__codelineno-0-2573"></a>
<a id="__codelineno-0-2574" name="__codelineno-0-2574"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">rid</span><span class="p">:</span>
<a id="__codelineno-0-2575" name="__codelineno-0-2575"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;rid&#39; should be set&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2576" name="__codelineno-0-2576"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-2577" name="__codelineno-0-2577"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;rid&#39; must be an int&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2578" name="__codelineno-0-2578"></a>
<a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>        <span class="k">if</span> <span class="n">rid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource_values</span><span class="p">:</span>
<a id="__codelineno-0-2580" name="__codelineno-0-2580"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2581" name="__codelineno-0-2581"></a>                <span class="s2">&quot;The requested rid &#39;0x</span><span class="si">{:08x}</span><span class="s2">&#39; could not be found in the list of resources.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2582" name="__codelineno-0-2582"></a>                    <span class="n">rid</span>
<a id="__codelineno-0-2583" name="__codelineno-0-2583"></a>                <span class="p">)</span>
<a id="__codelineno-0-2584" name="__codelineno-0-2584"></a>            <span class="p">)</span>
<a id="__codelineno-0-2585" name="__codelineno-0-2585"></a>            <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-2586" name="__codelineno-0-2586"></a>
<a id="__codelineno-0-2587" name="__codelineno-0-2587"></a>        <span class="n">res_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource_values</span><span class="p">[</span><span class="n">rid</span><span class="p">]</span>
<a id="__codelineno-0-2588" name="__codelineno-0-2588"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_options</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">config</span><span class="p">:</span>
<a id="__codelineno-0-2589" name="__codelineno-0-2589"></a>            <span class="k">if</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">res_options</span><span class="p">:</span>
<a id="__codelineno-0-2590" name="__codelineno-0-2590"></a>                <span class="k">return</span> <span class="p">[(</span><span class="n">config</span><span class="p">,</span> <span class="n">res_options</span><span class="p">[</span><span class="n">config</span><span class="p">])]</span>
<a id="__codelineno-0-2591" name="__codelineno-0-2591"></a>            <span class="k">elif</span> <span class="n">fallback</span> <span class="ow">and</span> <span class="n">config</span> <span class="o">==</span> <span class="n">ARSCResTableConfig</span><span class="o">.</span><span class="n">default_config</span><span class="p">():</span>
<a id="__codelineno-0-2592" name="__codelineno-0-2592"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2593" name="__codelineno-0-2593"></a>                    <span class="s2">&quot;No default resource config could be found for the given rid &#39;0x</span><span class="si">{:08x}</span><span class="s2">&#39;, using fallback!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2594" name="__codelineno-0-2594"></a>                        <span class="n">rid</span>
<a id="__codelineno-0-2595" name="__codelineno-0-2595"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2596" name="__codelineno-0-2596"></a>                <span class="p">)</span>
<a id="__codelineno-0-2597" name="__codelineno-0-2597"></a>                <span class="k">return</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_values</span><span class="p">[</span><span class="n">rid</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-2598" name="__codelineno-0-2598"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2599" name="__codelineno-0-2599"></a>                <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-2600" name="__codelineno-0-2600"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2601" name="__codelineno-0-2601"></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">res_options</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<a id="__codelineno-0-2602" name="__codelineno-0-2602"></a>
<a id="__codelineno-0-2603" name="__codelineno-0-2603"></a>    <span class="k">def</span> <span class="nf">get_string</span><span class="p">(</span>
<a id="__codelineno-0-2604" name="__codelineno-0-2604"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2605" name="__codelineno-0-2605"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-2606" name="__codelineno-0-2606"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2607" name="__codelineno-0-2607"></a>
<a id="__codelineno-0-2608" name="__codelineno-0-2608"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2609" name="__codelineno-0-2609"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;string&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2610" name="__codelineno-0-2610"></a>                <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-2611" name="__codelineno-0-2611"></a>                    <span class="k">return</span> <span class="n">i</span>
<a id="__codelineno-0-2612" name="__codelineno-0-2612"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2613" name="__codelineno-0-2613"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-2614" name="__codelineno-0-2614"></a>
<a id="__codelineno-0-2615" name="__codelineno-0-2615"></a>    <span class="k">def</span> <span class="nf">get_res_id_by_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<a id="__codelineno-0-2616" name="__codelineno-0-2616"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2617" name="__codelineno-0-2617"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource_keys</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">resource_type</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
<a id="__codelineno-0-2618" name="__codelineno-0-2618"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2619" name="__codelineno-0-2619"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-2620" name="__codelineno-0-2620"></a>
<a id="__codelineno-0-2621" name="__codelineno-0-2621"></a>    <span class="k">def</span> <span class="nf">get_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">):</span>
<a id="__codelineno-0-2622" name="__codelineno-0-2622"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2623" name="__codelineno-0-2623"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span>
<a id="__codelineno-0-2624" name="__codelineno-0-2624"></a>
<a id="__codelineno-0-2625" name="__codelineno-0-2625"></a>    <span class="k">def</span> <span class="nf">get_type_configs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">,</span> <span class="n">type_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-2626" name="__codelineno-0-2626"></a>        <span class="k">if</span> <span class="n">package_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2627" name="__codelineno-0-2627"></a>            <span class="n">package_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_packages_names</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2628" name="__codelineno-0-2628"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-2629" name="__codelineno-0-2629"></a>
<a id="__codelineno-0-2630" name="__codelineno-0-2630"></a>        <span class="k">for</span> <span class="n">res_type</span><span class="p">,</span> <span class="n">configs</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span>
<a id="__codelineno-0-2631" name="__codelineno-0-2631"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">resource_configs</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-2632" name="__codelineno-0-2632"></a>        <span class="p">):</span>
<a id="__codelineno-0-2633" name="__codelineno-0-2633"></a>            <span class="k">if</span> <span class="n">res_type</span><span class="o">.</span><span class="n">get_package_name</span><span class="p">()</span> <span class="o">==</span> <span class="n">package_name</span> <span class="ow">and</span> <span class="p">(</span>
<a id="__codelineno-0-2634" name="__codelineno-0-2634"></a>                <span class="n">type_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">res_type</span><span class="o">.</span><span class="n">get_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">type_name</span>
<a id="__codelineno-0-2635" name="__codelineno-0-2635"></a>            <span class="p">):</span>
<a id="__codelineno-0-2636" name="__codelineno-0-2636"></a>                <span class="n">result</span><span class="p">[</span><span class="n">res_type</span><span class="o">.</span><span class="n">get_type</span><span class="p">()]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span>
<a id="__codelineno-0-2637" name="__codelineno-0-2637"></a>
<a id="__codelineno-0-2638" name="__codelineno-0-2638"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-2639" name="__codelineno-0-2639"></a>
<a id="__codelineno-0-2640" name="__codelineno-0-2640"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-2641" name="__codelineno-0-2641"></a>    <span class="k">def</span> <span class="nf">parse_id</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2642" name="__codelineno-0-2642"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2643" name="__codelineno-0-2643"></a><span class="sd">        Resolves an id from a binary XML file in the form `@[package:]DEADBEEF`</span>
<a id="__codelineno-0-2644" name="__codelineno-0-2644"></a><span class="sd">        and returns a tuple of package name and resource id.</span>
<a id="__codelineno-0-2645" name="__codelineno-0-2645"></a><span class="sd">        If no package name was given, i.e. the ID has the form `@DEADBEEF`,</span>
<a id="__codelineno-0-2646" name="__codelineno-0-2646"></a><span class="sd">        the package name is set to None.</span>
<a id="__codelineno-0-2647" name="__codelineno-0-2647"></a>
<a id="__codelineno-0-2648" name="__codelineno-0-2648"></a><span class="sd">        :raises ValueError: if the id is malformed.</span>
<a id="__codelineno-0-2649" name="__codelineno-0-2649"></a>
<a id="__codelineno-0-2650" name="__codelineno-0-2650"></a><span class="sd">        :param name: the string of the resource, as in the binary XML file</span>
<a id="__codelineno-0-2651" name="__codelineno-0-2651"></a><span class="sd">        :return: a tuple of (resource_id, package_name).</span>
<a id="__codelineno-0-2652" name="__codelineno-0-2652"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2653" name="__codelineno-0-2653"></a>
<a id="__codelineno-0-2654" name="__codelineno-0-2654"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">):</span>
<a id="__codelineno-0-2655" name="__codelineno-0-2655"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2656" name="__codelineno-0-2656"></a>                <span class="s2">&quot;Not a valid resource ID, must start with @: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-2657" name="__codelineno-0-2657"></a>            <span class="p">)</span>
<a id="__codelineno-0-2658" name="__codelineno-0-2658"></a>
<a id="__codelineno-0-2659" name="__codelineno-0-2659"></a>        <span class="c1"># remove @</span>
<a id="__codelineno-0-2660" name="__codelineno-0-2660"></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-2661" name="__codelineno-0-2661"></a>
<a id="__codelineno-0-2662" name="__codelineno-0-2662"></a>        <span class="n">package</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2663" name="__codelineno-0-2663"></a>        <span class="k">if</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-2664" name="__codelineno-0-2664"></a>            <span class="n">package</span><span class="p">,</span> <span class="n">res_id</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-2665" name="__codelineno-0-2665"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2666" name="__codelineno-0-2666"></a>            <span class="n">res_id</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-2667" name="__codelineno-0-2667"></a>
<a id="__codelineno-0-2668" name="__codelineno-0-2668"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_id</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-0-2669" name="__codelineno-0-2669"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2670" name="__codelineno-0-2670"></a>                <span class="s2">&quot;Numerical ID is not 8 characters long: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res_id</span><span class="p">)</span>
<a id="__codelineno-0-2671" name="__codelineno-0-2671"></a>            <span class="p">)</span>
<a id="__codelineno-0-2672" name="__codelineno-0-2672"></a>
<a id="__codelineno-0-2673" name="__codelineno-0-2673"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2674" name="__codelineno-0-2674"></a>            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">res_id</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">package</span>
<a id="__codelineno-0-2675" name="__codelineno-0-2675"></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-2676" name="__codelineno-0-2676"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ID is not a hex ID: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res_id</span><span class="p">))</span>
<a id="__codelineno-0-2677" name="__codelineno-0-2677"></a>
<a id="__codelineno-0-2678" name="__codelineno-0-2678"></a>    <span class="k">def</span> <span class="nf">get_resource_xml_name</span><span class="p">(</span>
<a id="__codelineno-0-2679" name="__codelineno-0-2679"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">r_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">package</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2680" name="__codelineno-0-2680"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-2681" name="__codelineno-0-2681"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2682" name="__codelineno-0-2682"></a><span class="sd">        Returns the XML name for a resource, including the package name if package is `None`.</span>
<a id="__codelineno-0-2683" name="__codelineno-0-2683"></a><span class="sd">        A full name might look like `@com.example:string/foobar`</span>
<a id="__codelineno-0-2684" name="__codelineno-0-2684"></a><span class="sd">        Otherwise the name is only looked up in the specified package and is returned without</span>
<a id="__codelineno-0-2685" name="__codelineno-0-2685"></a><span class="sd">        the package name.</span>
<a id="__codelineno-0-2686" name="__codelineno-0-2686"></a><span class="sd">        The same example from about without the package name will read as `@string/foobar`.</span>
<a id="__codelineno-0-2687" name="__codelineno-0-2687"></a>
<a id="__codelineno-0-2688" name="__codelineno-0-2688"></a><span class="sd">        If the ID could not be found, `None` is returned.</span>
<a id="__codelineno-0-2689" name="__codelineno-0-2689"></a>
<a id="__codelineno-0-2690" name="__codelineno-0-2690"></a><span class="sd">        A description of the XML name can be found here:</span>
<a id="__codelineno-0-2691" name="__codelineno-0-2691"></a><span class="sd">        &lt;https://developer.android.com/guide/topics/resources/providing-resources#ResourcesFromXml&gt;</span>
<a id="__codelineno-0-2692" name="__codelineno-0-2692"></a>
<a id="__codelineno-0-2693" name="__codelineno-0-2693"></a><span class="sd">        :param r_id: numerical ID if the resource</span>
<a id="__codelineno-0-2694" name="__codelineno-0-2694"></a><span class="sd">        :param package: package name</span>
<a id="__codelineno-0-2695" name="__codelineno-0-2695"></a><span class="sd">        :return: XML name identifier</span>
<a id="__codelineno-0-2696" name="__codelineno-0-2696"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2697" name="__codelineno-0-2697"></a>        <span class="k">if</span> <span class="n">package</span><span class="p">:</span>
<a id="__codelineno-0-2698" name="__codelineno-0-2698"></a>            <span class="n">resource</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">i_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">r_id</span><span class="p">)</span>
<a id="__codelineno-0-2699" name="__codelineno-0-2699"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">i_id</span><span class="p">:</span>
<a id="__codelineno-0-2700" name="__codelineno-0-2700"></a>                <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-2701" name="__codelineno-0-2701"></a>            <span class="k">return</span> <span class="s2">&quot;@</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-2702" name="__codelineno-0-2702"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2703" name="__codelineno-0-2703"></a>            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_packages_names</span><span class="p">():</span>
<a id="__codelineno-0-2704" name="__codelineno-0-2704"></a>                <span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">r_id</span><span class="p">)</span>
<a id="__codelineno-0-2705" name="__codelineno-0-2705"></a>                <span class="k">if</span> <span class="n">i_id</span><span class="p">:</span>
<a id="__codelineno-0-2706" name="__codelineno-0-2706"></a>                    <span class="c1"># found the resource in this package</span>
<a id="__codelineno-0-2707" name="__codelineno-0-2707"></a>                    <span class="n">package</span> <span class="o">=</span> <span class="n">p</span>
<a id="__codelineno-0-2708" name="__codelineno-0-2708"></a>                    <span class="n">resource</span> <span class="o">=</span> <span class="n">r</span>
<a id="__codelineno-0-2709" name="__codelineno-0-2709"></a>                    <span class="n">name</span> <span class="o">=</span> <span class="n">n</span>
<a id="__codelineno-0-2710" name="__codelineno-0-2710"></a>                    <span class="k">break</span>
<a id="__codelineno-0-2711" name="__codelineno-0-2711"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">package</span><span class="p">:</span>
<a id="__codelineno-0-2712" name="__codelineno-0-2712"></a>                <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-2713" name="__codelineno-0-2713"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2714" name="__codelineno-0-2714"></a>                <span class="k">return</span> <span class="s2">&quot;@</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="androguard.core.axml.ARSCParser.ResourceResolver" class="doc doc-heading">
            <code>ResourceResolver</code>


<a href="#androguard.core.axml.ARSCParser.ResourceResolver" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">


        <p>Resolves resources by ID and configuration.
This resolver deals with complex resources as well as with references.</p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2377">2377</a></span>
<span class="normal"><a href="#__codelineno-0-2378">2378</a></span>
<span class="normal"><a href="#__codelineno-0-2379">2379</a></span>
<span class="normal"><a href="#__codelineno-0-2380">2380</a></span>
<span class="normal"><a href="#__codelineno-0-2381">2381</a></span>
<span class="normal"><a href="#__codelineno-0-2382">2382</a></span>
<span class="normal"><a href="#__codelineno-0-2383">2383</a></span>
<span class="normal"><a href="#__codelineno-0-2384">2384</a></span>
<span class="normal"><a href="#__codelineno-0-2385">2385</a></span>
<span class="normal"><a href="#__codelineno-0-2386">2386</a></span>
<span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span>
<span class="normal"><a href="#__codelineno-0-2403">2403</a></span>
<span class="normal"><a href="#__codelineno-0-2404">2404</a></span>
<span class="normal"><a href="#__codelineno-0-2405">2405</a></span>
<span class="normal"><a href="#__codelineno-0-2406">2406</a></span>
<span class="normal"><a href="#__codelineno-0-2407">2407</a></span>
<span class="normal"><a href="#__codelineno-0-2408">2408</a></span>
<span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2377" name="__codelineno-0-2377"></a><span class="k">class</span> <span class="nc">ResourceResolver</span><span class="p">:</span>
<a id="__codelineno-0-2378" name="__codelineno-0-2378"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2379" name="__codelineno-0-2379"></a><span class="sd">    Resolves resources by ID and configuration.</span>
<a id="__codelineno-0-2380" name="__codelineno-0-2380"></a><span class="sd">    This resolver deals with complex resources as well as with references.</span>
<a id="__codelineno-0-2381" name="__codelineno-0-2381"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2382" name="__codelineno-0-2382"></a>
<a id="__codelineno-0-2383" name="__codelineno-0-2383"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-2384" name="__codelineno-0-2384"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2385" name="__codelineno-0-2385"></a>        <span class="n">android_resources</span><span class="p">:</span> <span class="n">ARSCParser</span><span class="p">,</span>
<a id="__codelineno-0-2386" name="__codelineno-0-2386"></a>        <span class="n">config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2387" name="__codelineno-0-2387"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2388" name="__codelineno-0-2388"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2389" name="__codelineno-0-2389"></a><span class="sd">        :param ARSCParser android_resources: A resource parser</span>
<a id="__codelineno-0-2390" name="__codelineno-0-2390"></a><span class="sd">        :param ARSCResTableConfig config: The desired configuration or None to resolve all.</span>
<a id="__codelineno-0-2391" name="__codelineno-0-2391"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2392" name="__codelineno-0-2392"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="n">android_resources</span>
<a id="__codelineno-0-2393" name="__codelineno-0-2393"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">wanted_config</span> <span class="o">=</span> <span class="n">config</span>
<a id="__codelineno-0-2394" name="__codelineno-0-2394"></a>
<a id="__codelineno-0-2395" name="__codelineno-0-2395"></a>    <span class="k">def</span> <span class="nf">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-2396" name="__codelineno-0-2396"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2397" name="__codelineno-0-2397"></a><span class="sd">        the given ID into the Resource and returns a list of matching resources.</span>
<a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>
<a id="__codelineno-0-2399" name="__codelineno-0-2399"></a><span class="sd">        :param int res_id: numerical ID of the resource</span>
<a id="__codelineno-0-2400" name="__codelineno-0-2400"></a><span class="sd">        :returns: a list of tuples of (ARSCResTableConfig, str)</span>
<a id="__codelineno-0-2401" name="__codelineno-0-2401"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2403" name="__codelineno-0-2403"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_into_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">res_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wanted_config</span><span class="p">)</span>
<a id="__codelineno-0-2404" name="__codelineno-0-2404"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-2405" name="__codelineno-0-2405"></a>
<a id="__codelineno-0-2406" name="__codelineno-0-2406"></a>    <span class="k">def</span> <span class="nf">_resolve_into_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">res_id</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<a id="__codelineno-0-2407" name="__codelineno-0-2407"></a>        <span class="c1"># First: Get all candidates</span>
<a id="__codelineno-0-2408" name="__codelineno-0-2408"></a>        <span class="n">configs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">get_res_configs</span><span class="p">(</span><span class="n">res_id</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-2409" name="__codelineno-0-2409"></a>
<a id="__codelineno-0-2410" name="__codelineno-0-2410"></a>        <span class="k">for</span> <span class="n">config</span><span class="p">,</span> <span class="n">ate</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">:</span>
<a id="__codelineno-0-2411" name="__codelineno-0-2411"></a>            <span class="c1"># deconstruct them and check if more candidates are generated</span>
<a id="__codelineno-0-2412" name="__codelineno-0-2412"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">put_ate_value</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">ate</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-2413" name="__codelineno-0-2413"></a>
<a id="__codelineno-0-2414" name="__codelineno-0-2414"></a>    <span class="k">def</span> <span class="nf">put_ate_value</span><span class="p">(</span>
<a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2416" name="__codelineno-0-2416"></a>        <span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-2417" name="__codelineno-0-2417"></a>        <span class="n">ate</span><span class="p">:</span> <span class="n">ARSCResTableEntry</span><span class="p">,</span>
<a id="__codelineno-0-2418" name="__codelineno-0-2418"></a>        <span class="n">config</span><span class="p">:</span> <span class="n">ARSCResTableConfig</span><span class="p">,</span>
<a id="__codelineno-0-2419" name="__codelineno-0-2419"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2420" name="__codelineno-0-2420"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2421" name="__codelineno-0-2421"></a><span class="sd">        Put a [ARSCResTableEntry][androguard.core.axml.ARSCResTableEntry] into the list of results</span>
<a id="__codelineno-0-2422" name="__codelineno-0-2422"></a><span class="sd">        :param result: results array</span>
<a id="__codelineno-0-2423" name="__codelineno-0-2423"></a><span class="sd">        :param ate:</span>
<a id="__codelineno-0-2424" name="__codelineno-0-2424"></a><span class="sd">        :param config:</span>
<a id="__codelineno-0-2425" name="__codelineno-0-2425"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2426" name="__codelineno-0-2426"></a>        <span class="k">if</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_complex</span><span class="p">():</span>
<a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>            <span class="n">complex_array</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2428" name="__codelineno-0-2428"></a>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">config</span><span class="p">,</span> <span class="n">complex_array</span><span class="p">))</span>
<a id="__codelineno-0-2429" name="__codelineno-0-2429"></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ate</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
<a id="__codelineno-0-2430" name="__codelineno-0-2430"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">put_item_value</span><span class="p">(</span>
<a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>                    <span class="n">complex_array</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">ate</span><span class="p">,</span> <span class="n">complex_</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-2432" name="__codelineno-0-2432"></a>                <span class="p">)</span>
<a id="__codelineno-0-2433" name="__codelineno-0-2433"></a>        <span class="k">elif</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_compact</span><span class="p">():</span>
<a id="__codelineno-0-2434" name="__codelineno-0-2434"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">put_item_value</span><span class="p">(</span>
<a id="__codelineno-0-2435" name="__codelineno-0-2435"></a>                <span class="n">result</span><span class="p">,</span>
<a id="__codelineno-0-2436" name="__codelineno-0-2436"></a>                <span class="n">ate</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-2437" name="__codelineno-0-2437"></a>                <span class="n">config</span><span class="p">,</span>
<a id="__codelineno-0-2438" name="__codelineno-0-2438"></a>                <span class="n">ate</span><span class="p">,</span>
<a id="__codelineno-0-2439" name="__codelineno-0-2439"></a>                <span class="n">complex_</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>                <span class="n">compact_</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2441" name="__codelineno-0-2441"></a>            <span class="p">)</span>
<a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2443" name="__codelineno-0-2443"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">put_item_value</span><span class="p">(</span>
<a id="__codelineno-0-2444" name="__codelineno-0-2444"></a>                <span class="n">result</span><span class="p">,</span> <span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">ate</span><span class="p">,</span> <span class="n">complex_</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>            <span class="p">)</span>
<a id="__codelineno-0-2446" name="__codelineno-0-2446"></a>
<a id="__codelineno-0-2447" name="__codelineno-0-2447"></a>    <span class="k">def</span> <span class="nf">put_item_value</span><span class="p">(</span>
<a id="__codelineno-0-2448" name="__codelineno-0-2448"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2449" name="__codelineno-0-2449"></a>        <span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>        <span class="n">item</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ARSCResStringPoolRef</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-2451" name="__codelineno-0-2451"></a>        <span class="n">config</span><span class="p">:</span> <span class="n">ARSCResTableConfig</span><span class="p">,</span>
<a id="__codelineno-0-2452" name="__codelineno-0-2452"></a>        <span class="n">parent</span><span class="p">:</span> <span class="n">ARSCResTableEntry</span><span class="p">,</span>
<a id="__codelineno-0-2453" name="__codelineno-0-2453"></a>        <span class="n">complex_</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>        <span class="n">compact_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2455" name="__codelineno-0-2455"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2456" name="__codelineno-0-2456"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2457" name="__codelineno-0-2457"></a><span class="sd">        Put the tuple ([ARSCResTableConfig][androguard.core.axml.ARSCResTableConfig], resolved string) into the result set</span>
<a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>
<a id="__codelineno-0-2459" name="__codelineno-0-2459"></a><span class="sd">        :param result: the result set</span>
<a id="__codelineno-0-2460" name="__codelineno-0-2460"></a><span class="sd">        :param item:</span>
<a id="__codelineno-0-2461" name="__codelineno-0-2461"></a><span class="sd">        :param config:</span>
<a id="__codelineno-0-2462" name="__codelineno-0-2462"></a><span class="sd">        :param parent: the originating entry</span>
<a id="__codelineno-0-2463" name="__codelineno-0-2463"></a><span class="sd">        :param complex_: True if the originating `ARSCResTableEntry` was complex</span>
<a id="__codelineno-0-2464" name="__codelineno-0-2464"></a><span class="sd">        :param bool compact_: True if the originating `ARSCResTableEntry` was compact</span>
<a id="__codelineno-0-2465" name="__codelineno-0-2465"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">ARSCResStringPoolRef</span><span class="p">):</span>
<a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_reference</span><span class="p">():</span>
<a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>                <span class="n">res_id</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>                <span class="k">if</span> <span class="n">res_id</span><span class="p">:</span>
<a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>                    <span class="c1"># Infinite loop detection:</span>
<a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>                    <span class="c1"># TODO should this stay here or should be detect the loop much earlier?</span>
<a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>                    <span class="k">if</span> <span class="n">res_id</span> <span class="o">==</span> <span class="n">parent</span><span class="o">.</span><span class="n">mResId</span><span class="p">:</span>
<a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>                            <span class="s2">&quot;Infinite loop detected at resource item </span><span class="si">{}</span><span class="s2">. It references itself!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>                                <span class="n">parent</span>
<a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>                            <span class="p">)</span>
<a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>                        <span class="p">)</span>
<a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>                        <span class="k">return</span>
<a id="__codelineno-0-2479" name="__codelineno-0-2479"></a>
<a id="__codelineno-0-2480" name="__codelineno-0-2480"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_into_result</span><span class="p">(</span>
<a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>                        <span class="n">result</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">get_data</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wanted_config</span>
<a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2483" name="__codelineno-0-2483"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>                <span class="k">if</span> <span class="n">complex_</span><span class="p">:</span>
<a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">format_value</span><span class="p">())</span>
<a id="__codelineno-0-2486" name="__codelineno-0-2486"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2487" name="__codelineno-0-2487"></a>                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">config</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">format_value</span><span class="p">()))</span>
<a id="__codelineno-0-2488" name="__codelineno-0-2488"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2489" name="__codelineno-0-2489"></a>            <span class="k">if</span> <span class="n">compact_</span><span class="p">:</span>
<a id="__codelineno-0-2490" name="__codelineno-0-2490"></a>                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-2491" name="__codelineno-0-2491"></a>                    <span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">stringpool_main</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
<a id="__codelineno-0-2492" name="__codelineno-0-2492"></a>                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="androguard.core.axml.ARSCParser.ResourceResolver.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">android_resources</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.ResourceResolver.__init__" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>android_resources</code>
            </td>
            <td>
                  <code>ARSCParser</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A resource parser</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code>ARSCResTableConfig</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired configuration or None to resolve all.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2383">2383</a></span>
<span class="normal"><a href="#__codelineno-0-2384">2384</a></span>
<span class="normal"><a href="#__codelineno-0-2385">2385</a></span>
<span class="normal"><a href="#__codelineno-0-2386">2386</a></span>
<span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2383" name="__codelineno-0-2383"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-2384" name="__codelineno-0-2384"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2385" name="__codelineno-0-2385"></a>    <span class="n">android_resources</span><span class="p">:</span> <span class="n">ARSCParser</span><span class="p">,</span>
<a id="__codelineno-0-2386" name="__codelineno-0-2386"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2387" name="__codelineno-0-2387"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2388" name="__codelineno-0-2388"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2389" name="__codelineno-0-2389"></a><span class="sd">    :param ARSCParser android_resources: A resource parser</span>
<a id="__codelineno-0-2390" name="__codelineno-0-2390"></a><span class="sd">    :param ARSCResTableConfig config: The desired configuration or None to resolve all.</span>
<a id="__codelineno-0-2391" name="__codelineno-0-2391"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2392" name="__codelineno-0-2392"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="n">android_resources</span>
<a id="__codelineno-0-2393" name="__codelineno-0-2393"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">wanted_config</span> <span class="o">=</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="androguard.core.axml.ARSCParser.ResourceResolver.put_ate_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">put_ate_value</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">ate</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.ResourceResolver.put_ate_value" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Put a <a class="autorefs autorefs-internal" href="#androguard.core.axml.ARSCResTableEntry">ARSCResTableEntry</a> into the list of results</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>result</code>
            </td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>results array</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ate</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCResTableEntry" href="#androguard.core.axml.ARSCResTableEntry">ARSCResTableEntry</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCResTableConfig" href="#androguard.core.axml.ARSCResTableConfig">ARSCResTableConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2414" name="__codelineno-0-2414"></a><span class="k">def</span> <span class="nf">put_ate_value</span><span class="p">(</span>
<a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2416" name="__codelineno-0-2416"></a>    <span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-2417" name="__codelineno-0-2417"></a>    <span class="n">ate</span><span class="p">:</span> <span class="n">ARSCResTableEntry</span><span class="p">,</span>
<a id="__codelineno-0-2418" name="__codelineno-0-2418"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">ARSCResTableConfig</span><span class="p">,</span>
<a id="__codelineno-0-2419" name="__codelineno-0-2419"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2420" name="__codelineno-0-2420"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2421" name="__codelineno-0-2421"></a><span class="sd">    Put a [ARSCResTableEntry][androguard.core.axml.ARSCResTableEntry] into the list of results</span>
<a id="__codelineno-0-2422" name="__codelineno-0-2422"></a><span class="sd">    :param result: results array</span>
<a id="__codelineno-0-2423" name="__codelineno-0-2423"></a><span class="sd">    :param ate:</span>
<a id="__codelineno-0-2424" name="__codelineno-0-2424"></a><span class="sd">    :param config:</span>
<a id="__codelineno-0-2425" name="__codelineno-0-2425"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2426" name="__codelineno-0-2426"></a>    <span class="k">if</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_complex</span><span class="p">():</span>
<a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>        <span class="n">complex_array</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2428" name="__codelineno-0-2428"></a>        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">config</span><span class="p">,</span> <span class="n">complex_array</span><span class="p">))</span>
<a id="__codelineno-0-2429" name="__codelineno-0-2429"></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ate</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
<a id="__codelineno-0-2430" name="__codelineno-0-2430"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">put_item_value</span><span class="p">(</span>
<a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>                <span class="n">complex_array</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">ate</span><span class="p">,</span> <span class="n">complex_</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-2432" name="__codelineno-0-2432"></a>            <span class="p">)</span>
<a id="__codelineno-0-2433" name="__codelineno-0-2433"></a>    <span class="k">elif</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_compact</span><span class="p">():</span>
<a id="__codelineno-0-2434" name="__codelineno-0-2434"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">put_item_value</span><span class="p">(</span>
<a id="__codelineno-0-2435" name="__codelineno-0-2435"></a>            <span class="n">result</span><span class="p">,</span>
<a id="__codelineno-0-2436" name="__codelineno-0-2436"></a>            <span class="n">ate</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-2437" name="__codelineno-0-2437"></a>            <span class="n">config</span><span class="p">,</span>
<a id="__codelineno-0-2438" name="__codelineno-0-2438"></a>            <span class="n">ate</span><span class="p">,</span>
<a id="__codelineno-0-2439" name="__codelineno-0-2439"></a>            <span class="n">complex_</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>            <span class="n">compact_</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2441" name="__codelineno-0-2441"></a>        <span class="p">)</span>
<a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2443" name="__codelineno-0-2443"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">put_item_value</span><span class="p">(</span>
<a id="__codelineno-0-2444" name="__codelineno-0-2444"></a>            <span class="n">result</span><span class="p">,</span> <span class="n">ate</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">ate</span><span class="p">,</span> <span class="n">complex_</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="androguard.core.axml.ARSCParser.ResourceResolver.put_item_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">put_item_value</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">complex_</span><span class="p">,</span> <span class="n">compact_</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.ResourceResolver.put_item_value" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Put the tuple (<a class="autorefs autorefs-internal" href="#androguard.core.axml.ARSCResTableConfig">ARSCResTableConfig</a>, resolved string) into the result set</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>result</code>
            </td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the result set</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>item</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCResStringPoolRef" href="#androguard.core.axml.ARSCResStringPoolRef">ARSCResStringPoolRef</a>, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCResTableConfig" href="#androguard.core.axml.ARSCResTableConfig">ARSCResTableConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCResTableEntry" href="#androguard.core.axml.ARSCResTableEntry">ARSCResTableEntry</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the originating entry</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>complex_</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the originating <code>ARSCResTableEntry</code> was complex</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>compact_</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the originating <code>ARSCResTableEntry</code> was compact</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2447" name="__codelineno-0-2447"></a><span class="k">def</span> <span class="nf">put_item_value</span><span class="p">(</span>
<a id="__codelineno-0-2448" name="__codelineno-0-2448"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2449" name="__codelineno-0-2449"></a>    <span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>    <span class="n">item</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ARSCResStringPoolRef</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-2451" name="__codelineno-0-2451"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">ARSCResTableConfig</span><span class="p">,</span>
<a id="__codelineno-0-2452" name="__codelineno-0-2452"></a>    <span class="n">parent</span><span class="p">:</span> <span class="n">ARSCResTableEntry</span><span class="p">,</span>
<a id="__codelineno-0-2453" name="__codelineno-0-2453"></a>    <span class="n">complex_</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>    <span class="n">compact_</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2455" name="__codelineno-0-2455"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2456" name="__codelineno-0-2456"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2457" name="__codelineno-0-2457"></a><span class="sd">    Put the tuple ([ARSCResTableConfig][androguard.core.axml.ARSCResTableConfig], resolved string) into the result set</span>
<a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>
<a id="__codelineno-0-2459" name="__codelineno-0-2459"></a><span class="sd">    :param result: the result set</span>
<a id="__codelineno-0-2460" name="__codelineno-0-2460"></a><span class="sd">    :param item:</span>
<a id="__codelineno-0-2461" name="__codelineno-0-2461"></a><span class="sd">    :param config:</span>
<a id="__codelineno-0-2462" name="__codelineno-0-2462"></a><span class="sd">    :param parent: the originating entry</span>
<a id="__codelineno-0-2463" name="__codelineno-0-2463"></a><span class="sd">    :param complex_: True if the originating `ARSCResTableEntry` was complex</span>
<a id="__codelineno-0-2464" name="__codelineno-0-2464"></a><span class="sd">    :param bool compact_: True if the originating `ARSCResTableEntry` was compact</span>
<a id="__codelineno-0-2465" name="__codelineno-0-2465"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">ARSCResStringPoolRef</span><span class="p">):</span>
<a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_reference</span><span class="p">():</span>
<a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>            <span class="n">res_id</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>            <span class="k">if</span> <span class="n">res_id</span><span class="p">:</span>
<a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>                <span class="c1"># Infinite loop detection:</span>
<a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>                <span class="c1"># TODO should this stay here or should be detect the loop much earlier?</span>
<a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>                <span class="k">if</span> <span class="n">res_id</span> <span class="o">==</span> <span class="n">parent</span><span class="o">.</span><span class="n">mResId</span><span class="p">:</span>
<a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>                        <span class="s2">&quot;Infinite loop detected at resource item </span><span class="si">{}</span><span class="s2">. It references itself!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>                            <span class="n">parent</span>
<a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>                        <span class="p">)</span>
<a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>                    <span class="k">return</span>
<a id="__codelineno-0-2479" name="__codelineno-0-2479"></a>
<a id="__codelineno-0-2480" name="__codelineno-0-2480"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_into_result</span><span class="p">(</span>
<a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>                    <span class="n">result</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">get_data</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">wanted_config</span>
<a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>                <span class="p">)</span>
<a id="__codelineno-0-2483" name="__codelineno-0-2483"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>            <span class="k">if</span> <span class="n">complex_</span><span class="p">:</span>
<a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">format_value</span><span class="p">())</span>
<a id="__codelineno-0-2486" name="__codelineno-0-2486"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2487" name="__codelineno-0-2487"></a>                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">config</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">format_value</span><span class="p">()))</span>
<a id="__codelineno-0-2488" name="__codelineno-0-2488"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2489" name="__codelineno-0-2489"></a>        <span class="k">if</span> <span class="n">compact_</span><span class="p">:</span>
<a id="__codelineno-0-2490" name="__codelineno-0-2490"></a>            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-2491" name="__codelineno-0-2491"></a>                <span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">stringpool_main</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
<a id="__codelineno-0-2492" name="__codelineno-0-2492"></a>            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="androguard.core.axml.ARSCParser.ResourceResolver.resolve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resolve</span><span class="p">(</span><span class="n">res_id</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.ResourceResolver.resolve" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>the given ID into the Resource and returns a list of matching resources.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>res_id</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numerical ID of the resource</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[tuple[<a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCResTableConfig" href="#androguard.core.axml.ARSCResTableConfig">ARSCResTableConfig</a>, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of tuples of (ARSCResTableConfig, str)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span>
<span class="normal"><a href="#__codelineno-0-2403">2403</a></span>
<span class="normal"><a href="#__codelineno-0-2404">2404</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2395" name="__codelineno-0-2395"></a><span class="k">def</span> <span class="nf">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-2396" name="__codelineno-0-2396"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2397" name="__codelineno-0-2397"></a><span class="sd">    the given ID into the Resource and returns a list of matching resources.</span>
<a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>
<a id="__codelineno-0-2399" name="__codelineno-0-2399"></a><span class="sd">    :param int res_id: numerical ID of the resource</span>
<a id="__codelineno-0-2400" name="__codelineno-0-2400"></a><span class="sd">    :returns: a list of tuples of (ARSCResTableConfig, str)</span>
<a id="__codelineno-0-2401" name="__codelineno-0-2401"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2403" name="__codelineno-0-2403"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_into_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">res_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wanted_config</span><span class="p">)</span>
<a id="__codelineno-0-2404" name="__codelineno-0-2404"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">raw_buff</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.__init__" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>raw_buff</code>
            </td>
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the raw bytes of the file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1638" name="__codelineno-0-1638"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_buff</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1639" name="__codelineno-0-1639"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1640" name="__codelineno-0-1640"></a><span class="sd">    :param bytes raw_buff: the raw bytes of the file</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1642" name="__codelineno-0-1642"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">buff</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BufferedReader</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">raw_buff</span><span class="p">))</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">()</span><span class="o">.</span><span class="n">nbytes</span>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span> <span class="o">&gt;</span> <span class="mh">0xFFFFFFFF</span><span class="p">:</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a>        <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a>            <span class="s2">&quot;Invalid file size </span><span class="si">{}</span><span class="s2"> for a resources.arsc file!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>            <span class="p">)</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>        <span class="p">)</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">analyzed</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_resolved_strings</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">packages</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-1655" name="__codelineno-0-1655"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1656" name="__codelineno-0-1656"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">resource_values</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">defaultdict</span><span class="p">)</span>
<a id="__codelineno-0-1657" name="__codelineno-0-1657"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">resource_configs</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">))</span>
<a id="__codelineno-0-1658" name="__codelineno-0-1658"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">resource_keys</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">defaultdict</span><span class="p">))</span>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stringpool_main</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a>
<a id="__codelineno-0-1661" name="__codelineno-0-1661"></a>    <span class="c1"># First, there is a ResTable_header.</span>
<a id="__codelineno-0-1662" name="__codelineno-0-1662"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">ARSCHeader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">expected_type</span><span class="o">=</span><span class="n">RES_TABLE_TYPE</span><span class="p">)</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>    <span class="c1"># More sanity checks...</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">header_size</span> <span class="o">!=</span> <span class="mi">12</span><span class="p">:</span>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a>            <span class="s2">&quot;The ResTable_header has an unexpected header size! Expected 12 bytes, got </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">header_size</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a>            <span class="p">)</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a>        <span class="p">)</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span><span class="p">:</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>        <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a>            <span class="s2">&quot;The file seems to be truncated. Refuse to parse the file! Filesize: </span><span class="si">{}</span><span class="s2">, declared size: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a>            <span class="p">)</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a>        <span class="p">)</span>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span><span class="p">:</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a>            <span class="s2">&quot;The Resource file seems to have data appended to it. Filesize: </span><span class="si">{}</span><span class="s2">, declared size: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a>            <span class="p">)</span>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a>        <span class="p">)</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a>    <span class="c1"># The ResTable_header contains the packageCount, i.e. the number of ResTable_package</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">packageCount</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a>    <span class="c1"># Even more sanity checks...</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">packageCount</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>            <span class="s2">&quot;The number of packages is smaller than one. There should be at least one package!&quot;</span>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a>        <span class="p">)</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a>        <span class="s2">&quot;Parsed ResTable_header with </span><span class="si">{}</span><span class="s2"> package(s) inside.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">packageCount</span>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>        <span class="p">)</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>    <span class="p">)</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>    <span class="c1"># skip to the start of the first chunk&#39;s data, skipping trailing header bytes (there should be none)</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">header_size</span><span class="p">)</span>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a>    <span class="c1"># Now parse the data:</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>    <span class="c1"># We should find one ResStringPool_header and one or more ResTable_package chunks inside</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">ARSCHeader</span><span class="o">.</span><span class="n">SIZE</span><span class="p">:</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>        <span class="n">res_header</span> <span class="o">=</span> <span class="n">ARSCHeader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">)</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>        <span class="k">if</span> <span class="n">res_header</span><span class="o">.</span><span class="n">end</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">end</span><span class="p">:</span>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>            <span class="c1"># this inner chunk crosses the boundary of the table chunk</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>                <span class="s2">&quot;Invalid chunk found! It is larger than the outer chunk: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>                <span class="n">res_header</span><span class="p">,</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>            <span class="p">)</span>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>            <span class="k">break</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a>        <span class="k">if</span> <span class="n">res_header</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_STRING_POOL_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>            <span class="c1"># There should be only one StringPool per resource table.</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringpool_main</span><span class="p">:</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a>                    <span class="s2">&quot;Already found a ResStringPool_header, but there should be only one! Will not parse the Pool again.&quot;</span>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a>                <span class="p">)</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stringpool_main</span> <span class="o">=</span> <span class="n">StringBlock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">res_header</span><span class="p">)</span>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>                    <span class="s2">&quot;Found the main string pool: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringpool_main</span>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a>                <span class="p">)</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>        <span class="k">elif</span> <span class="n">res_header</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_TABLE_PACKAGE_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">packageCount</span><span class="p">:</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>                <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>                    <span class="s2">&quot;Got more packages (</span><span class="si">{}</span><span class="s2">) than expected (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>                        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">packageCount</span>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a>                <span class="p">)</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>            <span class="n">current_package</span> <span class="o">=</span> <span class="n">ARSCResTablePackage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">res_header</span><span class="p">)</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>            <span class="n">package_name</span> <span class="o">=</span> <span class="n">current_package</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>            <span class="c1"># After the Header, we have the resource type symbol table</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>                <span class="n">current_package</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">current_package</span><span class="o">.</span><span class="n">typeStrings</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>            <span class="p">)</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>            <span class="n">type_sp_header</span> <span class="o">=</span> <span class="n">ARSCHeader</span><span class="p">(</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">expected_type</span><span class="o">=</span><span class="n">RES_STRING_POOL_TYPE</span>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>            <span class="p">)</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>            <span class="n">mTableStrings</span> <span class="o">=</span> <span class="n">StringBlock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">type_sp_header</span><span class="p">)</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>            <span class="c1"># Next, we should have the resource key symbol table</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>                <span class="n">current_package</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">current_package</span><span class="o">.</span><span class="n">keyStrings</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>            <span class="p">)</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>            <span class="n">key_sp_header</span> <span class="o">=</span> <span class="n">ARSCHeader</span><span class="p">(</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">expected_type</span><span class="o">=</span><span class="n">RES_STRING_POOL_TYPE</span>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>            <span class="p">)</span>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>            <span class="n">mKeyStrings</span> <span class="o">=</span> <span class="n">StringBlock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">key_sp_header</span><span class="p">)</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>            <span class="c1"># Add them to the dict of read packages</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_package</span><span class="p">)</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mTableStrings</span><span class="p">)</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mKeyStrings</span><span class="p">)</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>            <span class="n">pc</span> <span class="o">=</span> <span class="n">PackageContext</span><span class="p">(</span>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>                <span class="n">current_package</span><span class="p">,</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stringpool_main</span><span class="p">,</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>                <span class="n">mTableStrings</span><span class="p">,</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>                <span class="n">mKeyStrings</span><span class="p">,</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>            <span class="p">)</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Constructed a PackageContext: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">pc</span><span class="p">)</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>            <span class="c1"># skip to the first header in this table package chunk</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>            <span class="c1"># FIXME is this correct? We have already read the first two sections!</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>            <span class="c1"># self.buff.set_idx(res_header.start + res_header.header_size)</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>            <span class="c1"># this looks more like we want: (???)</span>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>            <span class="c1"># FIXME it looks like that the two string pools we have read might not be concatenated to each other,</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a>            <span class="c1"># thus jumping to the sum of the sizes might not be correct...</span>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a>            <span class="n">next_idx</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>                <span class="n">res_header</span><span class="o">.</span><span class="n">start</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>                <span class="o">+</span> <span class="n">res_header</span><span class="o">.</span><span class="n">header_size</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>                <span class="o">+</span> <span class="n">type_sp_header</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>                <span class="o">+</span> <span class="n">key_sp_header</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>            <span class="p">)</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a>            <span class="k">if</span> <span class="n">next_idx</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">():</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a>                <span class="c1"># If this happens, we have a testfile ;)</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;This looks like an odd resources.arsc file!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a>                    <span class="s2">&quot;Please report this error including the file you have parsed!&quot;</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a>                <span class="p">)</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a>                    <span class="s2">&quot;next_idx = </span><span class="si">{}</span><span class="s2">, current buffer position = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a>                        <span class="n">next_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a>                <span class="p">)</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a>                    <span class="s2">&quot;Please open a issue at https://github.com/androguard/androguard/issues&quot;</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a>                <span class="p">)</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Thank you!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1799" name="__codelineno-0-1799"></a>
<a id="__codelineno-0-1800" name="__codelineno-0-1800"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">next_idx</span><span class="p">)</span>
<a id="__codelineno-0-1801" name="__codelineno-0-1801"></a>
<a id="__codelineno-0-1802" name="__codelineno-0-1802"></a>            <span class="c1"># Read all other headers</span>
<a id="__codelineno-0-1803" name="__codelineno-0-1803"></a>            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">res_header</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">ARSCHeader</span><span class="o">.</span><span class="n">SIZE</span><span class="p">:</span>
<a id="__codelineno-0-1804" name="__codelineno-0-1804"></a>                <span class="n">pkg_chunk_header</span> <span class="o">=</span> <span class="n">ARSCHeader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">)</span>
<a id="__codelineno-0-1805" name="__codelineno-0-1805"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Found a header: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pkg_chunk_header</span><span class="p">))</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806"></a>                <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1807" name="__codelineno-0-1807"></a>                    <span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808"></a>                    <span class="o">&gt;</span> <span class="n">res_header</span><span class="o">.</span><span class="n">end</span>
<a id="__codelineno-0-1809" name="__codelineno-0-1809"></a>                <span class="p">):</span>
<a id="__codelineno-0-1810" name="__codelineno-0-1810"></a>                    <span class="c1"># we are way off the package chunk; bail out</span>
<a id="__codelineno-0-1811" name="__codelineno-0-1811"></a>                    <span class="k">break</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812"></a>
<a id="__codelineno-0-1813" name="__codelineno-0-1813"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pkg_chunk_header</span><span class="p">)</span>
<a id="__codelineno-0-1814" name="__codelineno-0-1814"></a>
<a id="__codelineno-0-1815" name="__codelineno-0-1815"></a>                <span class="k">if</span> <span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_TABLE_TYPE_SPEC_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-1816" name="__codelineno-0-1816"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-1817" name="__codelineno-0-1817"></a>                        <span class="n">ARSCResTypeSpec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">pc</span><span class="p">)</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819"></a>
<a id="__codelineno-0-1820" name="__codelineno-0-1820"></a>                <span class="k">elif</span> <span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_TABLE_TYPE_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-1821" name="__codelineno-0-1821"></a>                    <span class="c1"># Parse a RES_TABLE_TYPE</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822"></a>                    <span class="c1"># http://androidxref.com/9.0.0_r3/xref/frameworks/base/tools/aapt2/format/binary/BinaryResourceParser.cpp#311</span>
<a id="__codelineno-0-1823" name="__codelineno-0-1823"></a>                    <span class="n">start_of_chunk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">-</span> <span class="mi">8</span>
<a id="__codelineno-0-1824" name="__codelineno-0-1824"></a>                    <span class="n">expected_end_of_chunk</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1825" name="__codelineno-0-1825"></a>                        <span class="n">start_of_chunk</span> <span class="o">+</span> <span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1827" name="__codelineno-0-1827"></a>                    <span class="n">a_res_type</span> <span class="o">=</span> <span class="n">ARSCResType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">pc</span><span class="p">)</span>
<a id="__codelineno-0-1828" name="__codelineno-0-1828"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a_res_type</span><span class="p">)</span>
<a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">resource_configs</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">a_res_type</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
<a id="__codelineno-0-1830" name="__codelineno-0-1830"></a>                        <span class="n">a_res_type</span><span class="o">.</span><span class="n">config</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>
<a id="__codelineno-0-1833" name="__codelineno-0-1833"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Config: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a_res_type</span><span class="o">.</span><span class="n">config</span><span class="p">))</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834"></a>
<a id="__codelineno-0-1835" name="__codelineno-0-1835"></a>                    <span class="n">entries</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836"></a>                    <span class="n">FLAG_OFFSET16</span> <span class="o">=</span> <span class="mh">0x02</span>
<a id="__codelineno-0-1837" name="__codelineno-0-1837"></a>                    <span class="n">NO_ENTRY_16</span> <span class="o">=</span> <span class="mh">0xFFFF</span>
<a id="__codelineno-0-1838" name="__codelineno-0-1838"></a>                    <span class="n">NO_ENTRY_32</span> <span class="o">=</span> <span class="mh">0xFFFFFFFF</span>
<a id="__codelineno-0-1839" name="__codelineno-0-1839"></a>                    <span class="n">expected_entries_start</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1840" name="__codelineno-0-1840"></a>                        <span class="n">start_of_chunk</span> <span class="o">+</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">entriesStart</span>
<a id="__codelineno-0-1841" name="__codelineno-0-1841"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1842" name="__codelineno-0-1842"></a>
<a id="__codelineno-0-1843" name="__codelineno-0-1843"></a>                    <span class="c1"># Helper function to convert 16-bit offset to 32-bit</span>
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a>                    <span class="k">def</span> <span class="nf">offset_from16</span><span class="p">(</span><span class="n">off16</span><span class="p">):</span>
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a>                        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a>                            <span class="n">NO_ENTRY_16</span>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a>                            <span class="k">if</span> <span class="n">off16</span> <span class="o">==</span> <span class="n">NO_ENTRY_16</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a>                            <span class="k">else</span> <span class="n">off16</span> <span class="o">*</span> <span class="mi">4</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">entryCount</span><span class="p">):</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>                        <span class="n">current_package</span><span class="o">.</span><span class="n">mResId</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>                            <span class="n">current_package</span><span class="o">.</span><span class="n">mResId</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span> <span class="o">|</span> <span class="n">i</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>                        <span class="c1"># Check if FLAG_OFFSET16 is set</span>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>                        <span class="k">if</span> <span class="n">a_res_type</span><span class="o">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">FLAG_OFFSET16</span><span class="p">:</span>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a>                            <span class="c1"># Read as 16-bit offset</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>                            <span class="n">offset_16</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>                            <span class="n">offset</span> <span class="o">=</span> <span class="n">offset_from16</span><span class="p">(</span><span class="n">offset_16</span><span class="p">)</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>                            <span class="k">if</span> <span class="n">offset</span> <span class="o">==</span> <span class="n">NO_ENTRY_16</span><span class="p">:</span>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a>                                <span class="k">continue</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>                        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>                            <span class="c1"># Read as 32-bit offset</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>                            <span class="n">offset</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>                            <span class="k">if</span> <span class="n">offset</span> <span class="o">==</span> <span class="n">NO_ENTRY_32</span><span class="p">:</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>                                <span class="k">continue</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>                        <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">offset</span><span class="p">,</span> <span class="n">current_package</span><span class="o">.</span><span class="n">mResId</span><span class="p">))</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a>                    <span class="n">base_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a>                    <span class="k">if</span> <span class="n">base_offset</span> <span class="o">+</span> <span class="p">((</span><span class="mi">4</span> <span class="o">-</span> <span class="p">(</span><span class="n">base_offset</span> <span class="o">%</span> <span class="mi">4</span><span class="p">))</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="n">expected_entries_start</span><span class="p">:</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a>                        <span class="c1"># FIXME: seems like I am missing 2 bytes here in some cases, though it does not affect the result</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a>                            <span class="s2">&quot;Something is off here! We are not where the entries should start.&quot;</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a>                    <span class="n">base_offset</span> <span class="o">=</span> <span class="n">expected_entries_start</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a>                    <span class="k">for</span> <span class="n">entry_offset</span><span class="p">,</span> <span class="n">res_id</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a>                        <span class="k">if</span> <span class="n">entry_offset</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a>                            <span class="n">ate</span> <span class="o">=</span> <span class="n">ARSCResTableEntry</span><span class="p">(</span>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a>                                <span class="n">base_offset</span> <span class="o">+</span> <span class="n">entry_offset</span><span class="p">,</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a>                                <span class="n">expected_end_of_chunk</span><span class="p">,</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a>                                <span class="n">res_id</span><span class="p">,</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a>                                <span class="n">pc</span><span class="p">,</span>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a>                            <span class="p">)</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ate</span><span class="p">)</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a>                            <span class="k">if</span> <span class="n">ate</span><span class="o">.</span><span class="n">is_weak</span><span class="p">():</span>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a>                                <span class="c1"># FIXME we are not sure how to implement the FLAG_WEAK!</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a>                                <span class="c1"># We saw the following: There is just a single Res_value after the ARSCResTableEntry</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a>                                <span class="c1"># and then comes the next ARSCHeader.</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a>                                <span class="c1"># Therefore we think this means all entries are somehow replicated?</span>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a>                                <span class="c1"># So we do some kind of hack here. We set the idx to the entry again...</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a>                                <span class="c1"># Now we will read all entries!</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a>                                <span class="c1"># Not sure if this is a good solution though</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">ate</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a>                <span class="k">elif</span> <span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_TABLE_LIBRARY_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a>                        <span class="s2">&quot;RES_TABLE_LIBRARY_TYPE chunk is not supported&quot;</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a>                    <span class="c1"># Unknown / not-handled chunk type</span>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a>                        <span class="s2">&quot;Unknown chunk type encountered inside RES_TABLE_PACKAGE: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a>                        <span class="n">pkg_chunk_header</span><span class="p">,</span>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>                <span class="c1"># skip to the next chunk</span>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">pkg_chunk_header</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a>            <span class="c1"># Unknown / not-handled chunk type</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a>                <span class="s2">&quot;Unknown chunk type encountered: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">res_header</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a>            <span class="p">)</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a>        <span class="c1"># move to the next resource chunk</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">res_header</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_bool_resources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_bool_resources</span><span class="p">(</span><span class="n">package_name</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.get_bool_resources" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Get the XML (as string) of all resources of type 'bool'.</p>
<p>Read more about bool resources:
<a href="https://developer.android.com/guide/topics/resources/more-resources.html#Bool">https://developer.android.com/guide/topics/resources/more-resources.html#Bool</a></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>package_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the package name to get the resources for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>locale</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the locale to get the resources for (default: '  ')</p>
              </div>
            </td>
            <td>
                  <code>&#39;\x00\x00&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the bool resources xml bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span>
<span class="normal"><a href="#__codelineno-0-2247">2247</a></span>
<span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2239" name="__codelineno-0-2239"></a><span class="k">def</span> <span class="nf">get_bool_resources</span><span class="p">(</span>
<a id="__codelineno-0-2240" name="__codelineno-0-2240"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2241" name="__codelineno-0-2241"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2242" name="__codelineno-0-2242"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2243" name="__codelineno-0-2243"></a><span class="sd">    Get the XML (as string) of all resources of type &#39;bool&#39;.</span>
<a id="__codelineno-0-2244" name="__codelineno-0-2244"></a>
<a id="__codelineno-0-2245" name="__codelineno-0-2245"></a><span class="sd">    Read more about bool resources:</span>
<a id="__codelineno-0-2246" name="__codelineno-0-2246"></a><span class="sd">    &lt;https://developer.android.com/guide/topics/resources/more-resources.html#Bool&gt;</span>
<a id="__codelineno-0-2247" name="__codelineno-0-2247"></a>
<a id="__codelineno-0-2248" name="__codelineno-0-2248"></a><span class="sd">    :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2249" name="__codelineno-0-2249"></a><span class="sd">    :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2250" name="__codelineno-0-2250"></a>
<a id="__codelineno-0-2251" name="__codelineno-0-2251"></a><span class="sd">    :returns: the bool resources xml bytes</span>
<a id="__codelineno-0-2252" name="__codelineno-0-2252"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2253" name="__codelineno-0-2253"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2254" name="__codelineno-0-2254"></a>
<a id="__codelineno-0-2255" name="__codelineno-0-2255"></a>    <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2256" name="__codelineno-0-2256"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2257" name="__codelineno-0-2257"></a>
<a id="__codelineno-0-2258" name="__codelineno-0-2258"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2259" name="__codelineno-0-2259"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2260" name="__codelineno-0-2260"></a>            <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;bool name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/bool&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-2261" name="__codelineno-0-2261"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2262" name="__codelineno-0-2262"></a>        <span class="k">pass</span>
<a id="__codelineno-0-2263" name="__codelineno-0-2263"></a>
<a id="__codelineno-0-2264" name="__codelineno-0-2264"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2265" name="__codelineno-0-2265"></a>
<a id="__codelineno-0-2266" name="__codelineno-0-2266"></a>    <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_color_resources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_color_resources</span><span class="p">(</span><span class="n">package_name</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.get_color_resources" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Get the XML (as string) of all resources of type 'color'.</p>
<p>Read more about color resources:
<a href="https://developer.android.com/guide/topics/resources/more-resources.html#Color">https://developer.android.com/guide/topics/resources/more-resources.html#Color</a></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>package_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the package name to get the resources for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>locale</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the locale to get the resources for (default: '  ')</p>
              </div>
            </td>
            <td>
                  <code>&#39;\x00\x00&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the color resources xml bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span>
<span class="normal"><a href="#__codelineno-0-2315">2315</a></span>
<span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2297" name="__codelineno-0-2297"></a><span class="k">def</span> <span class="nf">get_color_resources</span><span class="p">(</span>
<a id="__codelineno-0-2298" name="__codelineno-0-2298"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2299" name="__codelineno-0-2299"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2300" name="__codelineno-0-2300"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2301" name="__codelineno-0-2301"></a><span class="sd">    Get the XML (as string) of all resources of type &#39;color&#39;.</span>
<a id="__codelineno-0-2302" name="__codelineno-0-2302"></a>
<a id="__codelineno-0-2303" name="__codelineno-0-2303"></a><span class="sd">    Read more about color resources:</span>
<a id="__codelineno-0-2304" name="__codelineno-0-2304"></a><span class="sd">    &lt;https://developer.android.com/guide/topics/resources/more-resources.html#Color&gt;</span>
<a id="__codelineno-0-2305" name="__codelineno-0-2305"></a>
<a id="__codelineno-0-2306" name="__codelineno-0-2306"></a><span class="sd">    :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2307" name="__codelineno-0-2307"></a><span class="sd">    :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2308" name="__codelineno-0-2308"></a>
<a id="__codelineno-0-2309" name="__codelineno-0-2309"></a><span class="sd">    :returns: the color resources xml bytes</span>
<a id="__codelineno-0-2310" name="__codelineno-0-2310"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2311" name="__codelineno-0-2311"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2312" name="__codelineno-0-2312"></a>
<a id="__codelineno-0-2313" name="__codelineno-0-2313"></a>    <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2314" name="__codelineno-0-2314"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2315" name="__codelineno-0-2315"></a>
<a id="__codelineno-0-2316" name="__codelineno-0-2316"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2317" name="__codelineno-0-2317"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2318" name="__codelineno-0-2318"></a>            <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;color name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/color&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-2319" name="__codelineno-0-2319"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2320" name="__codelineno-0-2320"></a>        <span class="k">pass</span>
<a id="__codelineno-0-2321" name="__codelineno-0-2321"></a>
<a id="__codelineno-0-2322" name="__codelineno-0-2322"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2323" name="__codelineno-0-2323"></a>
<a id="__codelineno-0-2324" name="__codelineno-0-2324"></a>    <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_dimen_resources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_dimen_resources</span><span class="p">(</span><span class="n">package_name</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.get_dimen_resources" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Get the XML (as string) of all resources of type 'dimen'.</p>
<p>Read more about Dimension resources:
<a href="https://developer.android.com/guide/topics/resources/more-resources.html#Dimension">https://developer.android.com/guide/topics/resources/more-resources.html#Dimension</a></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>package_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the package name to get the resources for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>locale</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the locale to get the resources for (default: '  ')</p>
              </div>
            </td>
            <td>
                  <code>&#39;\x00\x00&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the dimen resource xml bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2326">2326</a></span>
<span class="normal"><a href="#__codelineno-0-2327">2327</a></span>
<span class="normal"><a href="#__codelineno-0-2328">2328</a></span>
<span class="normal"><a href="#__codelineno-0-2329">2329</a></span>
<span class="normal"><a href="#__codelineno-0-2330">2330</a></span>
<span class="normal"><a href="#__codelineno-0-2331">2331</a></span>
<span class="normal"><a href="#__codelineno-0-2332">2332</a></span>
<span class="normal"><a href="#__codelineno-0-2333">2333</a></span>
<span class="normal"><a href="#__codelineno-0-2334">2334</a></span>
<span class="normal"><a href="#__codelineno-0-2335">2335</a></span>
<span class="normal"><a href="#__codelineno-0-2336">2336</a></span>
<span class="normal"><a href="#__codelineno-0-2337">2337</a></span>
<span class="normal"><a href="#__codelineno-0-2338">2338</a></span>
<span class="normal"><a href="#__codelineno-0-2339">2339</a></span>
<span class="normal"><a href="#__codelineno-0-2340">2340</a></span>
<span class="normal"><a href="#__codelineno-0-2341">2341</a></span>
<span class="normal"><a href="#__codelineno-0-2342">2342</a></span>
<span class="normal"><a href="#__codelineno-0-2343">2343</a></span>
<span class="normal"><a href="#__codelineno-0-2344">2344</a></span>
<span class="normal"><a href="#__codelineno-0-2345">2345</a></span>
<span class="normal"><a href="#__codelineno-0-2346">2346</a></span>
<span class="normal"><a href="#__codelineno-0-2347">2347</a></span>
<span class="normal"><a href="#__codelineno-0-2348">2348</a></span>
<span class="normal"><a href="#__codelineno-0-2349">2349</a></span>
<span class="normal"><a href="#__codelineno-0-2350">2350</a></span>
<span class="normal"><a href="#__codelineno-0-2351">2351</a></span>
<span class="normal"><a href="#__codelineno-0-2352">2352</a></span>
<span class="normal"><a href="#__codelineno-0-2353">2353</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2326" name="__codelineno-0-2326"></a><span class="k">def</span> <span class="nf">get_dimen_resources</span><span class="p">(</span>
<a id="__codelineno-0-2327" name="__codelineno-0-2327"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2328" name="__codelineno-0-2328"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2329" name="__codelineno-0-2329"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2330" name="__codelineno-0-2330"></a><span class="sd">    Get the XML (as string) of all resources of type &#39;dimen&#39;.</span>
<a id="__codelineno-0-2331" name="__codelineno-0-2331"></a>
<a id="__codelineno-0-2332" name="__codelineno-0-2332"></a><span class="sd">    Read more about Dimension resources:</span>
<a id="__codelineno-0-2333" name="__codelineno-0-2333"></a><span class="sd">    &lt;https://developer.android.com/guide/topics/resources/more-resources.html#Dimension&gt;</span>
<a id="__codelineno-0-2334" name="__codelineno-0-2334"></a>
<a id="__codelineno-0-2335" name="__codelineno-0-2335"></a><span class="sd">    :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2336" name="__codelineno-0-2336"></a><span class="sd">    :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2337" name="__codelineno-0-2337"></a>
<a id="__codelineno-0-2338" name="__codelineno-0-2338"></a><span class="sd">    :returns: the dimen resource xml bytes</span>
<a id="__codelineno-0-2339" name="__codelineno-0-2339"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2340" name="__codelineno-0-2340"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2341" name="__codelineno-0-2341"></a>
<a id="__codelineno-0-2342" name="__codelineno-0-2342"></a>    <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2343" name="__codelineno-0-2343"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2344" name="__codelineno-0-2344"></a>
<a id="__codelineno-0-2345" name="__codelineno-0-2345"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2346" name="__codelineno-0-2346"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;dimen&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2347" name="__codelineno-0-2347"></a>            <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;dimen name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/dimen&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-2348" name="__codelineno-0-2348"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2349" name="__codelineno-0-2349"></a>        <span class="k">pass</span>
<a id="__codelineno-0-2350" name="__codelineno-0-2350"></a>
<a id="__codelineno-0-2351" name="__codelineno-0-2351"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2352" name="__codelineno-0-2352"></a>
<a id="__codelineno-0-2353" name="__codelineno-0-2353"></a>    <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_id</span><span class="p">(</span><span class="n">package_name</span><span class="p">,</span> <span class="n">rid</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.get_id" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the tuple <code>(resource_type, resource_name, resource_id)</code>
for the given resource_id.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>package_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>package name to query</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rid</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the resource_id</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>locale</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>specific locale</p>
              </div>
            </td>
            <td>
                  <code>&#39;\x00\x00&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple of (resource_type, resource_name, resource_id)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2355">2355</a></span>
<span class="normal"><a href="#__codelineno-0-2356">2356</a></span>
<span class="normal"><a href="#__codelineno-0-2357">2357</a></span>
<span class="normal"><a href="#__codelineno-0-2358">2358</a></span>
<span class="normal"><a href="#__codelineno-0-2359">2359</a></span>
<span class="normal"><a href="#__codelineno-0-2360">2360</a></span>
<span class="normal"><a href="#__codelineno-0-2361">2361</a></span>
<span class="normal"><a href="#__codelineno-0-2362">2362</a></span>
<span class="normal"><a href="#__codelineno-0-2363">2363</a></span>
<span class="normal"><a href="#__codelineno-0-2364">2364</a></span>
<span class="normal"><a href="#__codelineno-0-2365">2365</a></span>
<span class="normal"><a href="#__codelineno-0-2366">2366</a></span>
<span class="normal"><a href="#__codelineno-0-2367">2367</a></span>
<span class="normal"><a href="#__codelineno-0-2368">2368</a></span>
<span class="normal"><a href="#__codelineno-0-2369">2369</a></span>
<span class="normal"><a href="#__codelineno-0-2370">2370</a></span>
<span class="normal"><a href="#__codelineno-0-2371">2371</a></span>
<span class="normal"><a href="#__codelineno-0-2372">2372</a></span>
<span class="normal"><a href="#__codelineno-0-2373">2373</a></span>
<span class="normal"><a href="#__codelineno-0-2374">2374</a></span>
<span class="normal"><a href="#__codelineno-0-2375">2375</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2355" name="__codelineno-0-2355"></a><span class="k">def</span> <span class="nf">get_id</span><span class="p">(</span>
<a id="__codelineno-0-2356" name="__codelineno-0-2356"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2357" name="__codelineno-0-2357"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<a id="__codelineno-0-2358" name="__codelineno-0-2358"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2359" name="__codelineno-0-2359"></a><span class="sd">    Returns the tuple `(resource_type, resource_name, resource_id)`</span>
<a id="__codelineno-0-2360" name="__codelineno-0-2360"></a><span class="sd">    for the given resource_id.</span>
<a id="__codelineno-0-2361" name="__codelineno-0-2361"></a>
<a id="__codelineno-0-2362" name="__codelineno-0-2362"></a><span class="sd">    :param package_name: package name to query</span>
<a id="__codelineno-0-2363" name="__codelineno-0-2363"></a><span class="sd">    :param rid: the resource_id</span>
<a id="__codelineno-0-2364" name="__codelineno-0-2364"></a><span class="sd">    :param locale: specific locale</span>
<a id="__codelineno-0-2365" name="__codelineno-0-2365"></a><span class="sd">    :returns: tuple of (resource_type, resource_name, resource_id)</span>
<a id="__codelineno-0-2366" name="__codelineno-0-2366"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2367" name="__codelineno-0-2367"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2368" name="__codelineno-0-2368"></a>
<a id="__codelineno-0-2369" name="__codelineno-0-2369"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2370" name="__codelineno-0-2370"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;public&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2371" name="__codelineno-0-2371"></a>            <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">rid</span><span class="p">:</span>
<a id="__codelineno-0-2372" name="__codelineno-0-2372"></a>                <span class="k">return</span> <span class="n">i</span>
<a id="__codelineno-0-2373" name="__codelineno-0-2373"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2374" name="__codelineno-0-2374"></a>        <span class="k">pass</span>
<a id="__codelineno-0-2375" name="__codelineno-0-2375"></a>    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_id_resources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_id_resources</span><span class="p">(</span><span class="n">package_name</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.get_id_resources" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Get the XML (as string) of all resources of type 'id'.</p>
<p>Read more about ID resources:
<a href="https://developer.android.com/guide/topics/resources/more-resources.html#Id">https://developer.android.com/guide/topics/resources/more-resources.html#Id</a></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>package_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the package name to get the resources for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>locale</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the locale to get the resources for (default: '  ')</p>
              </div>
            </td>
            <td>
                  <code>&#39;\x00\x00&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the id resources xml bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span>
<span class="normal"><a href="#__codelineno-0-2207">2207</a></span>
<span class="normal"><a href="#__codelineno-0-2208">2208</a></span>
<span class="normal"><a href="#__codelineno-0-2209">2209</a></span>
<span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2205" name="__codelineno-0-2205"></a><span class="k">def</span> <span class="nf">get_id_resources</span><span class="p">(</span>
<a id="__codelineno-0-2206" name="__codelineno-0-2206"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2207" name="__codelineno-0-2207"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2208" name="__codelineno-0-2208"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2209" name="__codelineno-0-2209"></a><span class="sd">    Get the XML (as string) of all resources of type &#39;id&#39;.</span>
<a id="__codelineno-0-2210" name="__codelineno-0-2210"></a>
<a id="__codelineno-0-2211" name="__codelineno-0-2211"></a><span class="sd">    Read more about ID resources:</span>
<a id="__codelineno-0-2212" name="__codelineno-0-2212"></a><span class="sd">    &lt;https://developer.android.com/guide/topics/resources/more-resources.html#Id&gt;</span>
<a id="__codelineno-0-2213" name="__codelineno-0-2213"></a>
<a id="__codelineno-0-2214" name="__codelineno-0-2214"></a><span class="sd">    :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2215" name="__codelineno-0-2215"></a><span class="sd">    :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2216" name="__codelineno-0-2216"></a>
<a id="__codelineno-0-2217" name="__codelineno-0-2217"></a><span class="sd">    :returns: the id resources xml bytes</span>
<a id="__codelineno-0-2218" name="__codelineno-0-2218"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2219" name="__codelineno-0-2219"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2220" name="__codelineno-0-2220"></a>
<a id="__codelineno-0-2221" name="__codelineno-0-2221"></a>    <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2222" name="__codelineno-0-2222"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2223" name="__codelineno-0-2223"></a>
<a id="__codelineno-0-2224" name="__codelineno-0-2224"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2225" name="__codelineno-0-2225"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2226" name="__codelineno-0-2226"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-2227" name="__codelineno-0-2227"></a>                <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;item type=&quot;id&quot; name=&quot;</span><span class="si">%s</span><span class="s1">&quot;/&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-2228" name="__codelineno-0-2228"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2229" name="__codelineno-0-2229"></a>                <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;item type=&quot;id&quot; name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/item&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2230" name="__codelineno-0-2230"></a>                    <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">escape</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-2231" name="__codelineno-0-2231"></a>                <span class="p">)</span>
<a id="__codelineno-0-2232" name="__codelineno-0-2232"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2233" name="__codelineno-0-2233"></a>        <span class="k">pass</span>
<a id="__codelineno-0-2234" name="__codelineno-0-2234"></a>
<a id="__codelineno-0-2235" name="__codelineno-0-2235"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2236" name="__codelineno-0-2236"></a>
<a id="__codelineno-0-2237" name="__codelineno-0-2237"></a>    <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_integer_resources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_integer_resources</span><span class="p">(</span><span class="n">package_name</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.get_integer_resources" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Get the XML (as string) of all resources of type 'integer'.</p>
<p>Read more about integer resources:
<a href="https://developer.android.com/guide/topics/resources/more-resources.html#Integer">https://developer.android.com/guide/topics/resources/more-resources.html#Integer</a></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>package_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the package name to get the resources for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>locale</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the locale to get the resources for (default: '  ')</p>
              </div>
            </td>
            <td>
                  <code>&#39;\x00\x00&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the integer resources xml bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span>
<span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2268" name="__codelineno-0-2268"></a><span class="k">def</span> <span class="nf">get_integer_resources</span><span class="p">(</span>
<a id="__codelineno-0-2269" name="__codelineno-0-2269"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2270" name="__codelineno-0-2270"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2271" name="__codelineno-0-2271"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2272" name="__codelineno-0-2272"></a><span class="sd">    Get the XML (as string) of all resources of type &#39;integer&#39;.</span>
<a id="__codelineno-0-2273" name="__codelineno-0-2273"></a>
<a id="__codelineno-0-2274" name="__codelineno-0-2274"></a><span class="sd">    Read more about integer resources:</span>
<a id="__codelineno-0-2275" name="__codelineno-0-2275"></a><span class="sd">    &lt;https://developer.android.com/guide/topics/resources/more-resources.html#Integer&gt;</span>
<a id="__codelineno-0-2276" name="__codelineno-0-2276"></a>
<a id="__codelineno-0-2277" name="__codelineno-0-2277"></a><span class="sd">    :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2278" name="__codelineno-0-2278"></a><span class="sd">    :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2279" name="__codelineno-0-2279"></a>
<a id="__codelineno-0-2280" name="__codelineno-0-2280"></a><span class="sd">    :returns: the integer resources xml bytes</span>
<a id="__codelineno-0-2281" name="__codelineno-0-2281"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2282" name="__codelineno-0-2282"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2283" name="__codelineno-0-2283"></a>
<a id="__codelineno-0-2284" name="__codelineno-0-2284"></a>    <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2285" name="__codelineno-0-2285"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2286" name="__codelineno-0-2286"></a>
<a id="__codelineno-0-2287" name="__codelineno-0-2287"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2288" name="__codelineno-0-2288"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;integer&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2289" name="__codelineno-0-2289"></a>            <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;integer name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/integer&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-2290" name="__codelineno-0-2290"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2291" name="__codelineno-0-2291"></a>        <span class="k">pass</span>
<a id="__codelineno-0-2292" name="__codelineno-0-2292"></a>
<a id="__codelineno-0-2293" name="__codelineno-0-2293"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2294" name="__codelineno-0-2294"></a>
<a id="__codelineno-0-2295" name="__codelineno-0-2295"></a>    <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_locales" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_locales</span><span class="p">(</span><span class="n">package_name</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.get_locales" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve a list of all available locales in a given packagename.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>package_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the package name to get locales of</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of locale strings</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2080">2080</a></span>
<span class="normal"><a href="#__codelineno-0-2081">2081</a></span>
<span class="normal"><a href="#__codelineno-0-2082">2082</a></span>
<span class="normal"><a href="#__codelineno-0-2083">2083</a></span>
<span class="normal"><a href="#__codelineno-0-2084">2084</a></span>
<span class="normal"><a href="#__codelineno-0-2085">2085</a></span>
<span class="normal"><a href="#__codelineno-0-2086">2086</a></span>
<span class="normal"><a href="#__codelineno-0-2087">2087</a></span>
<span class="normal"><a href="#__codelineno-0-2088">2088</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2080" name="__codelineno-0-2080"></a><span class="k">def</span> <span class="nf">get_locales</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2081" name="__codelineno-0-2081"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2082" name="__codelineno-0-2082"></a><span class="sd">    Retrieve a list of all available locales in a given packagename.</span>
<a id="__codelineno-0-2083" name="__codelineno-0-2083"></a>
<a id="__codelineno-0-2084" name="__codelineno-0-2084"></a><span class="sd">    :param package_name: the package name to get locales of</span>
<a id="__codelineno-0-2085" name="__codelineno-0-2085"></a><span class="sd">    :returns: a list of locale strings</span>
<a id="__codelineno-0-2086" name="__codelineno-0-2086"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2087" name="__codelineno-0-2087"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2088" name="__codelineno-0-2088"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_packages_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_packages_names</span><span class="p">()</span></code>

<a href="#androguard.core.axml.ARSCParser.get_packages_names" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve a list of all package names, which are available
in the given resources.arsc.</p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2073">2073</a></span>
<span class="normal"><a href="#__codelineno-0-2074">2074</a></span>
<span class="normal"><a href="#__codelineno-0-2075">2075</a></span>
<span class="normal"><a href="#__codelineno-0-2076">2076</a></span>
<span class="normal"><a href="#__codelineno-0-2077">2077</a></span>
<span class="normal"><a href="#__codelineno-0-2078">2078</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2073" name="__codelineno-0-2073"></a><span class="k">def</span> <span class="nf">get_packages_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2074" name="__codelineno-0-2074"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2075" name="__codelineno-0-2075"></a><span class="sd">    Retrieve a list of all package names, which are available</span>
<a id="__codelineno-0-2076" name="__codelineno-0-2076"></a><span class="sd">    in the given resources.arsc.</span>
<a id="__codelineno-0-2077" name="__codelineno-0-2077"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2078" name="__codelineno-0-2078"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_public_resources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_public_resources</span><span class="p">(</span><span class="n">package_name</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.get_public_resources" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Get the XML (as string) of all resources of type 'public'.</p>
<p>The public resources table contains the IDs for each item.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>package_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the package name to get the resources for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>locale</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the locale to get the resources for (default: '  ')</p>
              </div>
            </td>
            <td>
                  <code>&#39;\x00\x00&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the public xml bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2104">2104</a></span>
<span class="normal"><a href="#__codelineno-0-2105">2105</a></span>
<span class="normal"><a href="#__codelineno-0-2106">2106</a></span>
<span class="normal"><a href="#__codelineno-0-2107">2107</a></span>
<span class="normal"><a href="#__codelineno-0-2108">2108</a></span>
<span class="normal"><a href="#__codelineno-0-2109">2109</a></span>
<span class="normal"><a href="#__codelineno-0-2110">2110</a></span>
<span class="normal"><a href="#__codelineno-0-2111">2111</a></span>
<span class="normal"><a href="#__codelineno-0-2112">2112</a></span>
<span class="normal"><a href="#__codelineno-0-2113">2113</a></span>
<span class="normal"><a href="#__codelineno-0-2114">2114</a></span>
<span class="normal"><a href="#__codelineno-0-2115">2115</a></span>
<span class="normal"><a href="#__codelineno-0-2116">2116</a></span>
<span class="normal"><a href="#__codelineno-0-2117">2117</a></span>
<span class="normal"><a href="#__codelineno-0-2118">2118</a></span>
<span class="normal"><a href="#__codelineno-0-2119">2119</a></span>
<span class="normal"><a href="#__codelineno-0-2120">2120</a></span>
<span class="normal"><a href="#__codelineno-0-2121">2121</a></span>
<span class="normal"><a href="#__codelineno-0-2122">2122</a></span>
<span class="normal"><a href="#__codelineno-0-2123">2123</a></span>
<span class="normal"><a href="#__codelineno-0-2124">2124</a></span>
<span class="normal"><a href="#__codelineno-0-2125">2125</a></span>
<span class="normal"><a href="#__codelineno-0-2126">2126</a></span>
<span class="normal"><a href="#__codelineno-0-2127">2127</a></span>
<span class="normal"><a href="#__codelineno-0-2128">2128</a></span>
<span class="normal"><a href="#__codelineno-0-2129">2129</a></span>
<span class="normal"><a href="#__codelineno-0-2130">2130</a></span>
<span class="normal"><a href="#__codelineno-0-2131">2131</a></span>
<span class="normal"><a href="#__codelineno-0-2132">2132</a></span>
<span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2104" name="__codelineno-0-2104"></a><span class="k">def</span> <span class="nf">get_public_resources</span><span class="p">(</span>
<a id="__codelineno-0-2105" name="__codelineno-0-2105"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2106" name="__codelineno-0-2106"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2107" name="__codelineno-0-2107"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2108" name="__codelineno-0-2108"></a><span class="sd">    Get the XML (as string) of all resources of type &#39;public&#39;.</span>
<a id="__codelineno-0-2109" name="__codelineno-0-2109"></a>
<a id="__codelineno-0-2110" name="__codelineno-0-2110"></a><span class="sd">    The public resources table contains the IDs for each item.</span>
<a id="__codelineno-0-2111" name="__codelineno-0-2111"></a>
<a id="__codelineno-0-2112" name="__codelineno-0-2112"></a><span class="sd">    :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2113" name="__codelineno-0-2113"></a><span class="sd">    :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2114" name="__codelineno-0-2114"></a><span class="sd">    :returns: the public xml bytes</span>
<a id="__codelineno-0-2115" name="__codelineno-0-2115"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2116" name="__codelineno-0-2116"></a>
<a id="__codelineno-0-2117" name="__codelineno-0-2117"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2118" name="__codelineno-0-2118"></a>
<a id="__codelineno-0-2119" name="__codelineno-0-2119"></a>    <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2120" name="__codelineno-0-2120"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2121" name="__codelineno-0-2121"></a>
<a id="__codelineno-0-2122" name="__codelineno-0-2122"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2123" name="__codelineno-0-2123"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;public&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2124" name="__codelineno-0-2124"></a>            <span class="n">buff</span> <span class="o">+=</span> <span class="p">(</span>
<a id="__codelineno-0-2125" name="__codelineno-0-2125"></a>                <span class="s1">&#39;&lt;public type=&quot;</span><span class="si">{}</span><span class="s1">&quot; name=&quot;</span><span class="si">{}</span><span class="s1">&quot; id=&quot;0x</span><span class="si">{:08x}</span><span class="s1">&quot; /&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2126" name="__codelineno-0-2126"></a>                    <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-2127" name="__codelineno-0-2127"></a>                <span class="p">)</span>
<a id="__codelineno-0-2128" name="__codelineno-0-2128"></a>            <span class="p">)</span>
<a id="__codelineno-0-2129" name="__codelineno-0-2129"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2130" name="__codelineno-0-2130"></a>        <span class="k">pass</span>
<a id="__codelineno-0-2131" name="__codelineno-0-2131"></a>
<a id="__codelineno-0-2132" name="__codelineno-0-2132"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2133" name="__codelineno-0-2133"></a>
<a id="__codelineno-0-2134" name="__codelineno-0-2134"></a>    <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_res_configs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_res_configs</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fallback</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.get_res_configs" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the resources found with the ID <code>rid</code> and select
the right one based on the configuration, or return all if no configuration was set.</p>
<p>But we try to be generous here and at least try to resolve something:
This method uses a fallback to return at least one resource (the first one in the list)
if more than one items are found and the default config is used and no default entry could be found.</p>
<p>This is usually a bad sign (i.e. the developer did not follow the android documentation:
<a href="https://developer.android.com/guide/topics/resources/localization.html#failing2)">https://developer.android.com/guide/topics/resources/localization.html#failing2)</a>
In practise an app might just be designed to run on a single locale and thus only has those locales set.</p>
<p>You can disable this fallback behaviour, to just return exactly the given result.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rid</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>resource id as int</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCResTableConfig" href="#androguard.core.axml.ARSCResTableConfig">ARSCResTableConfig</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a config to resolve from, or None to get all results</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fallback</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Enable the fallback for resolving default configuration (default: True)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[<a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCResTableConfig" href="#androguard.core.axml.ARSCResTableConfig">ARSCResTableConfig</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of <code>ARSCResTableConfig</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span>
<span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span>
<span class="normal"><a href="#__codelineno-0-2580">2580</a></span>
<span class="normal"><a href="#__codelineno-0-2581">2581</a></span>
<span class="normal"><a href="#__codelineno-0-2582">2582</a></span>
<span class="normal"><a href="#__codelineno-0-2583">2583</a></span>
<span class="normal"><a href="#__codelineno-0-2584">2584</a></span>
<span class="normal"><a href="#__codelineno-0-2585">2585</a></span>
<span class="normal"><a href="#__codelineno-0-2586">2586</a></span>
<span class="normal"><a href="#__codelineno-0-2587">2587</a></span>
<span class="normal"><a href="#__codelineno-0-2588">2588</a></span>
<span class="normal"><a href="#__codelineno-0-2589">2589</a></span>
<span class="normal"><a href="#__codelineno-0-2590">2590</a></span>
<span class="normal"><a href="#__codelineno-0-2591">2591</a></span>
<span class="normal"><a href="#__codelineno-0-2592">2592</a></span>
<span class="normal"><a href="#__codelineno-0-2593">2593</a></span>
<span class="normal"><a href="#__codelineno-0-2594">2594</a></span>
<span class="normal"><a href="#__codelineno-0-2595">2595</a></span>
<span class="normal"><a href="#__codelineno-0-2596">2596</a></span>
<span class="normal"><a href="#__codelineno-0-2597">2597</a></span>
<span class="normal"><a href="#__codelineno-0-2598">2598</a></span>
<span class="normal"><a href="#__codelineno-0-2599">2599</a></span>
<span class="normal"><a href="#__codelineno-0-2600">2600</a></span>
<span class="normal"><a href="#__codelineno-0-2601">2601</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2547" name="__codelineno-0-2547"></a><span class="k">def</span> <span class="nf">get_res_configs</span><span class="p">(</span>
<a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2549" name="__codelineno-0-2549"></a>    <span class="n">rid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-2550" name="__codelineno-0-2550"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2551" name="__codelineno-0-2551"></a>    <span class="n">fallback</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2552" name="__codelineno-0-2552"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">]:</span>
<a id="__codelineno-0-2553" name="__codelineno-0-2553"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2554" name="__codelineno-0-2554"></a><span class="sd">    Return the resources found with the ID `rid` and select</span>
<a id="__codelineno-0-2555" name="__codelineno-0-2555"></a><span class="sd">    the right one based on the configuration, or return all if no configuration was set.</span>
<a id="__codelineno-0-2556" name="__codelineno-0-2556"></a>
<a id="__codelineno-0-2557" name="__codelineno-0-2557"></a><span class="sd">    But we try to be generous here and at least try to resolve something:</span>
<a id="__codelineno-0-2558" name="__codelineno-0-2558"></a><span class="sd">    This method uses a fallback to return at least one resource (the first one in the list)</span>
<a id="__codelineno-0-2559" name="__codelineno-0-2559"></a><span class="sd">    if more than one items are found and the default config is used and no default entry could be found.</span>
<a id="__codelineno-0-2560" name="__codelineno-0-2560"></a>
<a id="__codelineno-0-2561" name="__codelineno-0-2561"></a><span class="sd">    This is usually a bad sign (i.e. the developer did not follow the android documentation:</span>
<a id="__codelineno-0-2562" name="__codelineno-0-2562"></a><span class="sd">    &lt;https://developer.android.com/guide/topics/resources/localization.html#failing2)&gt;</span>
<a id="__codelineno-0-2563" name="__codelineno-0-2563"></a><span class="sd">    In practise an app might just be designed to run on a single locale and thus only has those locales set.</span>
<a id="__codelineno-0-2564" name="__codelineno-0-2564"></a>
<a id="__codelineno-0-2565" name="__codelineno-0-2565"></a><span class="sd">    You can disable this fallback behaviour, to just return exactly the given result.</span>
<a id="__codelineno-0-2566" name="__codelineno-0-2566"></a>
<a id="__codelineno-0-2567" name="__codelineno-0-2567"></a><span class="sd">    :param rid: resource id as int</span>
<a id="__codelineno-0-2568" name="__codelineno-0-2568"></a><span class="sd">    :param config: a config to resolve from, or None to get all results</span>
<a id="__codelineno-0-2569" name="__codelineno-0-2569"></a><span class="sd">    :param fallback: Enable the fallback for resolving default configuration (default: True)</span>
<a id="__codelineno-0-2570" name="__codelineno-0-2570"></a><span class="sd">    :return: a list of `ARSCResTableConfig`</span>
<a id="__codelineno-0-2571" name="__codelineno-0-2571"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2572" name="__codelineno-0-2572"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2573" name="__codelineno-0-2573"></a>
<a id="__codelineno-0-2574" name="__codelineno-0-2574"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">rid</span><span class="p">:</span>
<a id="__codelineno-0-2575" name="__codelineno-0-2575"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;rid&#39; should be set&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2576" name="__codelineno-0-2576"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-2577" name="__codelineno-0-2577"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;rid&#39; must be an int&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2578" name="__codelineno-0-2578"></a>
<a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>    <span class="k">if</span> <span class="n">rid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource_values</span><span class="p">:</span>
<a id="__codelineno-0-2580" name="__codelineno-0-2580"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2581" name="__codelineno-0-2581"></a>            <span class="s2">&quot;The requested rid &#39;0x</span><span class="si">{:08x}</span><span class="s2">&#39; could not be found in the list of resources.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2582" name="__codelineno-0-2582"></a>                <span class="n">rid</span>
<a id="__codelineno-0-2583" name="__codelineno-0-2583"></a>            <span class="p">)</span>
<a id="__codelineno-0-2584" name="__codelineno-0-2584"></a>        <span class="p">)</span>
<a id="__codelineno-0-2585" name="__codelineno-0-2585"></a>        <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-2586" name="__codelineno-0-2586"></a>
<a id="__codelineno-0-2587" name="__codelineno-0-2587"></a>    <span class="n">res_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource_values</span><span class="p">[</span><span class="n">rid</span><span class="p">]</span>
<a id="__codelineno-0-2588" name="__codelineno-0-2588"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_options</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">config</span><span class="p">:</span>
<a id="__codelineno-0-2589" name="__codelineno-0-2589"></a>        <span class="k">if</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">res_options</span><span class="p">:</span>
<a id="__codelineno-0-2590" name="__codelineno-0-2590"></a>            <span class="k">return</span> <span class="p">[(</span><span class="n">config</span><span class="p">,</span> <span class="n">res_options</span><span class="p">[</span><span class="n">config</span><span class="p">])]</span>
<a id="__codelineno-0-2591" name="__codelineno-0-2591"></a>        <span class="k">elif</span> <span class="n">fallback</span> <span class="ow">and</span> <span class="n">config</span> <span class="o">==</span> <span class="n">ARSCResTableConfig</span><span class="o">.</span><span class="n">default_config</span><span class="p">():</span>
<a id="__codelineno-0-2592" name="__codelineno-0-2592"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-2593" name="__codelineno-0-2593"></a>                <span class="s2">&quot;No default resource config could be found for the given rid &#39;0x</span><span class="si">{:08x}</span><span class="s2">&#39;, using fallback!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2594" name="__codelineno-0-2594"></a>                    <span class="n">rid</span>
<a id="__codelineno-0-2595" name="__codelineno-0-2595"></a>                <span class="p">)</span>
<a id="__codelineno-0-2596" name="__codelineno-0-2596"></a>            <span class="p">)</span>
<a id="__codelineno-0-2597" name="__codelineno-0-2597"></a>            <span class="k">return</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resource_values</span><span class="p">[</span><span class="n">rid</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-2598" name="__codelineno-0-2598"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2599" name="__codelineno-0-2599"></a>            <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-2600" name="__codelineno-0-2600"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2601" name="__codelineno-0-2601"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">res_options</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_resolved_res_configs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_resolved_res_configs</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.get_resolved_res_configs" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return a list of resolved resource IDs with their corresponding configuration.
It has a similar return type as <a class="autorefs autorefs-internal" href="#androguard.core.axml.ARSCParser.get_res_configs">get_res_configs</a> but also handles complex entries
and references.
Also instead of returning <a class="autorefs autorefs-internal" href="#androguard.core.axml.ARSCResTableConfig">ARSCResTableConfig</a> in the tuple, the actual values are resolved.</p>
<p>This is the preferred way of resolving resource IDs to their resources.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rid</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the numerical ID of the resource</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCResTableConfig" href="#androguard.core.axml.ARSCResTableConfig">ARSCResTableConfig</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the desired configuration or None to retrieve all</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[tuple[<a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCResTableConfig" href="#androguard.core.axml.ARSCResTableConfig">ARSCResTableConfig</a>, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of tuples of (<code>ARSCResTableConfig</code>, str)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2494" name="__codelineno-0-2494"></a><span class="k">def</span> <span class="nf">get_resolved_res_configs</span><span class="p">(</span>
<a id="__codelineno-0-2495" name="__codelineno-0-2495"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2496" name="__codelineno-0-2496"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">ARSCResTableConfig</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-2497" name="__codelineno-0-2497"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2498" name="__codelineno-0-2498"></a><span class="sd">    Return a list of resolved resource IDs with their corresponding configuration.</span>
<a id="__codelineno-0-2499" name="__codelineno-0-2499"></a><span class="sd">    It has a similar return type as [get_res_configs][androguard.core.axml.ARSCParser.get_res_configs] but also handles complex entries</span>
<a id="__codelineno-0-2500" name="__codelineno-0-2500"></a><span class="sd">    and references.</span>
<a id="__codelineno-0-2501" name="__codelineno-0-2501"></a><span class="sd">    Also instead of returning [ARSCResTableConfig][androguard.core.axml.ARSCResTableConfig] in the tuple, the actual values are resolved.</span>
<a id="__codelineno-0-2502" name="__codelineno-0-2502"></a>
<a id="__codelineno-0-2503" name="__codelineno-0-2503"></a><span class="sd">    This is the preferred way of resolving resource IDs to their resources.</span>
<a id="__codelineno-0-2504" name="__codelineno-0-2504"></a>
<a id="__codelineno-0-2505" name="__codelineno-0-2505"></a><span class="sd">    :param rid: the numerical ID of the resource</span>
<a id="__codelineno-0-2506" name="__codelineno-0-2506"></a><span class="sd">    :param config: the desired configuration or None to retrieve all</span>
<a id="__codelineno-0-2507" name="__codelineno-0-2507"></a><span class="sd">    :return: A list of tuples of (`ARSCResTableConfig`, str)</span>
<a id="__codelineno-0-2508" name="__codelineno-0-2508"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2509" name="__codelineno-0-2509"></a>    <span class="n">resolver</span> <span class="o">=</span> <span class="n">ARSCParser</span><span class="o">.</span><span class="n">ResourceResolver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-2510" name="__codelineno-0-2510"></a>    <span class="k">return</span> <span class="n">resolver</span><span class="o">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">rid</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_resource_xml_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_resource_xml_name</span><span class="p">(</span><span class="n">r_id</span><span class="p">,</span> <span class="n">package</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.get_resource_xml_name" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the XML name for a resource, including the package name if package is <code>None</code>.
A full name might look like <code>@com.example:string/foobar</code>
Otherwise the name is only looked up in the specified package and is returned without
the package name.
The same example from about without the package name will read as <code>@string/foobar</code>.</p>
<p>If the ID could not be found, <code>None</code> is returned.</p>
<p>A description of the XML name can be found here:
<a href="https://developer.android.com/guide/topics/resources/providing-resources#ResourcesFromXml">https://developer.android.com/guide/topics/resources/providing-resources#ResourcesFromXml</a></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>r_id</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numerical ID if the resource</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>package</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>package name</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>XML name identifier</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2678">2678</a></span>
<span class="normal"><a href="#__codelineno-0-2679">2679</a></span>
<span class="normal"><a href="#__codelineno-0-2680">2680</a></span>
<span class="normal"><a href="#__codelineno-0-2681">2681</a></span>
<span class="normal"><a href="#__codelineno-0-2682">2682</a></span>
<span class="normal"><a href="#__codelineno-0-2683">2683</a></span>
<span class="normal"><a href="#__codelineno-0-2684">2684</a></span>
<span class="normal"><a href="#__codelineno-0-2685">2685</a></span>
<span class="normal"><a href="#__codelineno-0-2686">2686</a></span>
<span class="normal"><a href="#__codelineno-0-2687">2687</a></span>
<span class="normal"><a href="#__codelineno-0-2688">2688</a></span>
<span class="normal"><a href="#__codelineno-0-2689">2689</a></span>
<span class="normal"><a href="#__codelineno-0-2690">2690</a></span>
<span class="normal"><a href="#__codelineno-0-2691">2691</a></span>
<span class="normal"><a href="#__codelineno-0-2692">2692</a></span>
<span class="normal"><a href="#__codelineno-0-2693">2693</a></span>
<span class="normal"><a href="#__codelineno-0-2694">2694</a></span>
<span class="normal"><a href="#__codelineno-0-2695">2695</a></span>
<span class="normal"><a href="#__codelineno-0-2696">2696</a></span>
<span class="normal"><a href="#__codelineno-0-2697">2697</a></span>
<span class="normal"><a href="#__codelineno-0-2698">2698</a></span>
<span class="normal"><a href="#__codelineno-0-2699">2699</a></span>
<span class="normal"><a href="#__codelineno-0-2700">2700</a></span>
<span class="normal"><a href="#__codelineno-0-2701">2701</a></span>
<span class="normal"><a href="#__codelineno-0-2702">2702</a></span>
<span class="normal"><a href="#__codelineno-0-2703">2703</a></span>
<span class="normal"><a href="#__codelineno-0-2704">2704</a></span>
<span class="normal"><a href="#__codelineno-0-2705">2705</a></span>
<span class="normal"><a href="#__codelineno-0-2706">2706</a></span>
<span class="normal"><a href="#__codelineno-0-2707">2707</a></span>
<span class="normal"><a href="#__codelineno-0-2708">2708</a></span>
<span class="normal"><a href="#__codelineno-0-2709">2709</a></span>
<span class="normal"><a href="#__codelineno-0-2710">2710</a></span>
<span class="normal"><a href="#__codelineno-0-2711">2711</a></span>
<span class="normal"><a href="#__codelineno-0-2712">2712</a></span>
<span class="normal"><a href="#__codelineno-0-2713">2713</a></span>
<span class="normal"><a href="#__codelineno-0-2714">2714</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2678" name="__codelineno-0-2678"></a><span class="k">def</span> <span class="nf">get_resource_xml_name</span><span class="p">(</span>
<a id="__codelineno-0-2679" name="__codelineno-0-2679"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">r_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">package</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2680" name="__codelineno-0-2680"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-2681" name="__codelineno-0-2681"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2682" name="__codelineno-0-2682"></a><span class="sd">    Returns the XML name for a resource, including the package name if package is `None`.</span>
<a id="__codelineno-0-2683" name="__codelineno-0-2683"></a><span class="sd">    A full name might look like `@com.example:string/foobar`</span>
<a id="__codelineno-0-2684" name="__codelineno-0-2684"></a><span class="sd">    Otherwise the name is only looked up in the specified package and is returned without</span>
<a id="__codelineno-0-2685" name="__codelineno-0-2685"></a><span class="sd">    the package name.</span>
<a id="__codelineno-0-2686" name="__codelineno-0-2686"></a><span class="sd">    The same example from about without the package name will read as `@string/foobar`.</span>
<a id="__codelineno-0-2687" name="__codelineno-0-2687"></a>
<a id="__codelineno-0-2688" name="__codelineno-0-2688"></a><span class="sd">    If the ID could not be found, `None` is returned.</span>
<a id="__codelineno-0-2689" name="__codelineno-0-2689"></a>
<a id="__codelineno-0-2690" name="__codelineno-0-2690"></a><span class="sd">    A description of the XML name can be found here:</span>
<a id="__codelineno-0-2691" name="__codelineno-0-2691"></a><span class="sd">    &lt;https://developer.android.com/guide/topics/resources/providing-resources#ResourcesFromXml&gt;</span>
<a id="__codelineno-0-2692" name="__codelineno-0-2692"></a>
<a id="__codelineno-0-2693" name="__codelineno-0-2693"></a><span class="sd">    :param r_id: numerical ID if the resource</span>
<a id="__codelineno-0-2694" name="__codelineno-0-2694"></a><span class="sd">    :param package: package name</span>
<a id="__codelineno-0-2695" name="__codelineno-0-2695"></a><span class="sd">    :return: XML name identifier</span>
<a id="__codelineno-0-2696" name="__codelineno-0-2696"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2697" name="__codelineno-0-2697"></a>    <span class="k">if</span> <span class="n">package</span><span class="p">:</span>
<a id="__codelineno-0-2698" name="__codelineno-0-2698"></a>        <span class="n">resource</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">i_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">r_id</span><span class="p">)</span>
<a id="__codelineno-0-2699" name="__codelineno-0-2699"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">i_id</span><span class="p">:</span>
<a id="__codelineno-0-2700" name="__codelineno-0-2700"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-2701" name="__codelineno-0-2701"></a>        <span class="k">return</span> <span class="s2">&quot;@</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-2702" name="__codelineno-0-2702"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2703" name="__codelineno-0-2703"></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_packages_names</span><span class="p">():</span>
<a id="__codelineno-0-2704" name="__codelineno-0-2704"></a>            <span class="n">r</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">r_id</span><span class="p">)</span>
<a id="__codelineno-0-2705" name="__codelineno-0-2705"></a>            <span class="k">if</span> <span class="n">i_id</span><span class="p">:</span>
<a id="__codelineno-0-2706" name="__codelineno-0-2706"></a>                <span class="c1"># found the resource in this package</span>
<a id="__codelineno-0-2707" name="__codelineno-0-2707"></a>                <span class="n">package</span> <span class="o">=</span> <span class="n">p</span>
<a id="__codelineno-0-2708" name="__codelineno-0-2708"></a>                <span class="n">resource</span> <span class="o">=</span> <span class="n">r</span>
<a id="__codelineno-0-2709" name="__codelineno-0-2709"></a>                <span class="n">name</span> <span class="o">=</span> <span class="n">n</span>
<a id="__codelineno-0-2710" name="__codelineno-0-2710"></a>                <span class="k">break</span>
<a id="__codelineno-0-2711" name="__codelineno-0-2711"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">package</span><span class="p">:</span>
<a id="__codelineno-0-2712" name="__codelineno-0-2712"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-2713" name="__codelineno-0-2713"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2714" name="__codelineno-0-2714"></a>            <span class="k">return</span> <span class="s2">&quot;@</span><span class="si">{}</span><span class="s2">:</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_string_resources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_string_resources</span><span class="p">(</span><span class="n">package_name</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.get_string_resources" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Get the XML (as string) of all resources of type 'string'.</p>
<p>Read more about string resources:
<a href="https://developer.android.com/guide/topics/resources/string-resource.html">https://developer.android.com/guide/topics/resources/string-resource.html</a></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>package_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the package name to get the resources for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>locale</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the locale to get the resources for (default: '  ')</p>
              </div>
            </td>
            <td>
                  <code>&#39;\x00\x00&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the string xml bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span>
<span class="normal"><a href="#__codelineno-0-2138">2138</a></span>
<span class="normal"><a href="#__codelineno-0-2139">2139</a></span>
<span class="normal"><a href="#__codelineno-0-2140">2140</a></span>
<span class="normal"><a href="#__codelineno-0-2141">2141</a></span>
<span class="normal"><a href="#__codelineno-0-2142">2142</a></span>
<span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2136" name="__codelineno-0-2136"></a><span class="k">def</span> <span class="nf">get_string_resources</span><span class="p">(</span>
<a id="__codelineno-0-2137" name="__codelineno-0-2137"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2138" name="__codelineno-0-2138"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2139" name="__codelineno-0-2139"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2140" name="__codelineno-0-2140"></a><span class="sd">    Get the XML (as string) of all resources of type &#39;string&#39;.</span>
<a id="__codelineno-0-2141" name="__codelineno-0-2141"></a>
<a id="__codelineno-0-2142" name="__codelineno-0-2142"></a><span class="sd">    Read more about string resources:</span>
<a id="__codelineno-0-2143" name="__codelineno-0-2143"></a><span class="sd">    &lt;https://developer.android.com/guide/topics/resources/string-resource.html&gt;</span>
<a id="__codelineno-0-2144" name="__codelineno-0-2144"></a>
<a id="__codelineno-0-2145" name="__codelineno-0-2145"></a><span class="sd">    :param package_name: the package name to get the resources for</span>
<a id="__codelineno-0-2146" name="__codelineno-0-2146"></a><span class="sd">    :param locale: the locale to get the resources for (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2147" name="__codelineno-0-2147"></a><span class="sd">    :returns: the string xml bytes</span>
<a id="__codelineno-0-2148" name="__codelineno-0-2148"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2149" name="__codelineno-0-2149"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2150" name="__codelineno-0-2150"></a>
<a id="__codelineno-0-2151" name="__codelineno-0-2151"></a>    <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2152" name="__codelineno-0-2152"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2153" name="__codelineno-0-2153"></a>
<a id="__codelineno-0-2154" name="__codelineno-0-2154"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2155" name="__codelineno-0-2155"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;string&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2156" name="__codelineno-0-2156"></a>            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">,</span> <span class="s1">&#39;&lt;&amp;&gt;&#39;</span><span class="p">)):</span>
<a id="__codelineno-0-2157" name="__codelineno-0-2157"></a>                <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&lt;![CDATA[</span><span class="si">%s</span><span class="s1">]]&gt;&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-2158" name="__codelineno-0-2158"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2159" name="__codelineno-0-2159"></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-2160" name="__codelineno-0-2160"></a>            <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;string name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/string&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-2161" name="__codelineno-0-2161"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2162" name="__codelineno-0-2162"></a>        <span class="k">pass</span>
<a id="__codelineno-0-2163" name="__codelineno-0-2163"></a>
<a id="__codelineno-0-2164" name="__codelineno-0-2164"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2165" name="__codelineno-0-2165"></a>
<a id="__codelineno-0-2166" name="__codelineno-0-2166"></a>    <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_strings_resources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_strings_resources</span><span class="p">()</span></code>

<a href="#androguard.core.axml.ARSCParser.get_strings_resources" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Get the XML (as string) of all resources of type 'string'.
This is a combined variant, which has all locales and all package names
stored.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the string, locales, and package name xml bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2168" name="__codelineno-0-2168"></a><span class="k">def</span> <span class="nf">get_strings_resources</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a><span class="sd">    Get the XML (as string) of all resources of type &#39;string&#39;.</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a><span class="sd">    This is a combined variant, which has all locales and all package names</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a><span class="sd">    stored.</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a><span class="sd">    :returns: the string, locales, and package name xml bytes</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a>    <span class="n">buff</span> <span class="o">=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a>
<a id="__codelineno-0-2180" name="__codelineno-0-2180"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s2">&quot;&lt;packages&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2181" name="__codelineno-0-2181"></a>    <span class="k">for</span> <span class="n">package_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_packages_names</span><span class="p">():</span>
<a id="__codelineno-0-2182" name="__codelineno-0-2182"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s2">&quot;&lt;package name=</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">package_name</span>
<a id="__codelineno-0-2183" name="__codelineno-0-2183"></a>
<a id="__codelineno-0-2184" name="__codelineno-0-2184"></a>        <span class="k">for</span> <span class="n">locale</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_locales</span><span class="p">(</span><span class="n">package_name</span><span class="p">):</span>
<a id="__codelineno-0-2185" name="__codelineno-0-2185"></a>            <span class="n">buff</span> <span class="o">+=</span> <span class="s2">&quot;&lt;locale value=</span><span class="si">%s</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">repr</span><span class="p">(</span><span class="n">locale</span><span class="p">)</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186"></a>
<a id="__codelineno-0-2187" name="__codelineno-0-2187"></a>            <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2189" name="__codelineno-0-2189"></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">][</span><span class="s2">&quot;string&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-2190" name="__codelineno-0-2190"></a>                    <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;string name=&quot;</span><span class="si">{}</span><span class="s1">&quot;&gt;</span><span class="si">{}</span><span class="s1">&lt;/string&gt;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2191" name="__codelineno-0-2191"></a>                        <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">escape</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-2192" name="__codelineno-0-2192"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193"></a>            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-2194" name="__codelineno-0-2194"></a>                <span class="k">pass</span>
<a id="__codelineno-0-2195" name="__codelineno-0-2195"></a>
<a id="__codelineno-0-2196" name="__codelineno-0-2196"></a>            <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/resources&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197"></a>            <span class="n">buff</span> <span class="o">+=</span> <span class="s1">&#39;&lt;/locale&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198"></a>
<a id="__codelineno-0-2199" name="__codelineno-0-2199"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/package&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200"></a>
<a id="__codelineno-0-2201" name="__codelineno-0-2201"></a>    <span class="n">buff</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/packages&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2202" name="__codelineno-0-2202"></a>
<a id="__codelineno-0-2203" name="__codelineno-0-2203"></a>    <span class="k">return</span> <span class="n">buff</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.get_types" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_types</span><span class="p">(</span><span class="n">package_name</span><span class="p">,</span> <span class="n">locale</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span><span class="p">)</span></code>

<a href="#androguard.core.axml.ARSCParser.get_types" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve a list of all types which are available in the given
package and locale.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>package_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the package name to get types of</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>locale</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the locale to get types of (default: '  ')</p>
              </div>
            </td>
            <td>
                  <code>&#39;\x00\x00&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of type strings</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2090">2090</a></span>
<span class="normal"><a href="#__codelineno-0-2091">2091</a></span>
<span class="normal"><a href="#__codelineno-0-2092">2092</a></span>
<span class="normal"><a href="#__codelineno-0-2093">2093</a></span>
<span class="normal"><a href="#__codelineno-0-2094">2094</a></span>
<span class="normal"><a href="#__codelineno-0-2095">2095</a></span>
<span class="normal"><a href="#__codelineno-0-2096">2096</a></span>
<span class="normal"><a href="#__codelineno-0-2097">2097</a></span>
<span class="normal"><a href="#__codelineno-0-2098">2098</a></span>
<span class="normal"><a href="#__codelineno-0-2099">2099</a></span>
<span class="normal"><a href="#__codelineno-0-2100">2100</a></span>
<span class="normal"><a href="#__codelineno-0-2101">2101</a></span>
<span class="normal"><a href="#__codelineno-0-2102">2102</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2090" name="__codelineno-0-2090"></a><span class="k">def</span> <span class="nf">get_types</span><span class="p">(</span>
<a id="__codelineno-0-2091" name="__codelineno-0-2091"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">package_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span>
<a id="__codelineno-0-2092" name="__codelineno-0-2092"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2093" name="__codelineno-0-2093"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2094" name="__codelineno-0-2094"></a><span class="sd">    Retrieve a list of all types which are available in the given</span>
<a id="__codelineno-0-2095" name="__codelineno-0-2095"></a><span class="sd">    package and locale.</span>
<a id="__codelineno-0-2096" name="__codelineno-0-2096"></a>
<a id="__codelineno-0-2097" name="__codelineno-0-2097"></a><span class="sd">    :param package_name: the package name to get types of</span>
<a id="__codelineno-0-2098" name="__codelineno-0-2098"></a><span class="sd">    :param locale: the locale to get types of (default: &#39;\x00\x00&#39;)</span>
<a id="__codelineno-0-2099" name="__codelineno-0-2099"></a><span class="sd">    :returns: a list of type strings</span>
<a id="__codelineno-0-2100" name="__codelineno-0-2100"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2101" name="__codelineno-0-2101"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_analyse</span><span class="p">()</span>
<a id="__codelineno-0-2102" name="__codelineno-0-2102"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">package_name</span><span class="p">][</span><span class="n">locale</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCParser.parse_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_id</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#androguard.core.axml.ARSCParser.parse_id" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Resolves an id from a binary XML file in the form <code>@[package:]DEADBEEF</code>
and returns a tuple of package name and resource id.
If no package name was given, i.e. the ID has the form <code>@DEADBEEF</code>,
the package name is set to None.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the string of the resource, as in the binary XML file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>tuple[str, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a tuple of (resource_id, package_name).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the id is malformed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2640">2640</a></span>
<span class="normal"><a href="#__codelineno-0-2641">2641</a></span>
<span class="normal"><a href="#__codelineno-0-2642">2642</a></span>
<span class="normal"><a href="#__codelineno-0-2643">2643</a></span>
<span class="normal"><a href="#__codelineno-0-2644">2644</a></span>
<span class="normal"><a href="#__codelineno-0-2645">2645</a></span>
<span class="normal"><a href="#__codelineno-0-2646">2646</a></span>
<span class="normal"><a href="#__codelineno-0-2647">2647</a></span>
<span class="normal"><a href="#__codelineno-0-2648">2648</a></span>
<span class="normal"><a href="#__codelineno-0-2649">2649</a></span>
<span class="normal"><a href="#__codelineno-0-2650">2650</a></span>
<span class="normal"><a href="#__codelineno-0-2651">2651</a></span>
<span class="normal"><a href="#__codelineno-0-2652">2652</a></span>
<span class="normal"><a href="#__codelineno-0-2653">2653</a></span>
<span class="normal"><a href="#__codelineno-0-2654">2654</a></span>
<span class="normal"><a href="#__codelineno-0-2655">2655</a></span>
<span class="normal"><a href="#__codelineno-0-2656">2656</a></span>
<span class="normal"><a href="#__codelineno-0-2657">2657</a></span>
<span class="normal"><a href="#__codelineno-0-2658">2658</a></span>
<span class="normal"><a href="#__codelineno-0-2659">2659</a></span>
<span class="normal"><a href="#__codelineno-0-2660">2660</a></span>
<span class="normal"><a href="#__codelineno-0-2661">2661</a></span>
<span class="normal"><a href="#__codelineno-0-2662">2662</a></span>
<span class="normal"><a href="#__codelineno-0-2663">2663</a></span>
<span class="normal"><a href="#__codelineno-0-2664">2664</a></span>
<span class="normal"><a href="#__codelineno-0-2665">2665</a></span>
<span class="normal"><a href="#__codelineno-0-2666">2666</a></span>
<span class="normal"><a href="#__codelineno-0-2667">2667</a></span>
<span class="normal"><a href="#__codelineno-0-2668">2668</a></span>
<span class="normal"><a href="#__codelineno-0-2669">2669</a></span>
<span class="normal"><a href="#__codelineno-0-2670">2670</a></span>
<span class="normal"><a href="#__codelineno-0-2671">2671</a></span>
<span class="normal"><a href="#__codelineno-0-2672">2672</a></span>
<span class="normal"><a href="#__codelineno-0-2673">2673</a></span>
<span class="normal"><a href="#__codelineno-0-2674">2674</a></span>
<span class="normal"><a href="#__codelineno-0-2675">2675</a></span>
<span class="normal"><a href="#__codelineno-0-2676">2676</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2640" name="__codelineno-0-2640"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-2641" name="__codelineno-0-2641"></a><span class="k">def</span> <span class="nf">parse_id</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-2642" name="__codelineno-0-2642"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2643" name="__codelineno-0-2643"></a><span class="sd">    Resolves an id from a binary XML file in the form `@[package:]DEADBEEF`</span>
<a id="__codelineno-0-2644" name="__codelineno-0-2644"></a><span class="sd">    and returns a tuple of package name and resource id.</span>
<a id="__codelineno-0-2645" name="__codelineno-0-2645"></a><span class="sd">    If no package name was given, i.e. the ID has the form `@DEADBEEF`,</span>
<a id="__codelineno-0-2646" name="__codelineno-0-2646"></a><span class="sd">    the package name is set to None.</span>
<a id="__codelineno-0-2647" name="__codelineno-0-2647"></a>
<a id="__codelineno-0-2648" name="__codelineno-0-2648"></a><span class="sd">    :raises ValueError: if the id is malformed.</span>
<a id="__codelineno-0-2649" name="__codelineno-0-2649"></a>
<a id="__codelineno-0-2650" name="__codelineno-0-2650"></a><span class="sd">    :param name: the string of the resource, as in the binary XML file</span>
<a id="__codelineno-0-2651" name="__codelineno-0-2651"></a><span class="sd">    :return: a tuple of (resource_id, package_name).</span>
<a id="__codelineno-0-2652" name="__codelineno-0-2652"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2653" name="__codelineno-0-2653"></a>
<a id="__codelineno-0-2654" name="__codelineno-0-2654"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">):</span>
<a id="__codelineno-0-2655" name="__codelineno-0-2655"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2656" name="__codelineno-0-2656"></a>            <span class="s2">&quot;Not a valid resource ID, must start with @: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-2657" name="__codelineno-0-2657"></a>        <span class="p">)</span>
<a id="__codelineno-0-2658" name="__codelineno-0-2658"></a>
<a id="__codelineno-0-2659" name="__codelineno-0-2659"></a>    <span class="c1"># remove @</span>
<a id="__codelineno-0-2660" name="__codelineno-0-2660"></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-2661" name="__codelineno-0-2661"></a>
<a id="__codelineno-0-2662" name="__codelineno-0-2662"></a>    <span class="n">package</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2663" name="__codelineno-0-2663"></a>    <span class="k">if</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
<a id="__codelineno-0-2664" name="__codelineno-0-2664"></a>        <span class="n">package</span><span class="p">,</span> <span class="n">res_id</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-2665" name="__codelineno-0-2665"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2666" name="__codelineno-0-2666"></a>        <span class="n">res_id</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-2667" name="__codelineno-0-2667"></a>
<a id="__codelineno-0-2668" name="__codelineno-0-2668"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_id</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-0-2669" name="__codelineno-0-2669"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2670" name="__codelineno-0-2670"></a>            <span class="s2">&quot;Numerical ID is not 8 characters long: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res_id</span><span class="p">)</span>
<a id="__codelineno-0-2671" name="__codelineno-0-2671"></a>        <span class="p">)</span>
<a id="__codelineno-0-2672" name="__codelineno-0-2672"></a>
<a id="__codelineno-0-2673" name="__codelineno-0-2673"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2674" name="__codelineno-0-2674"></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">res_id</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">package</span>
<a id="__codelineno-0-2675" name="__codelineno-0-2675"></a>    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-2676" name="__codelineno-0-2676"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ID is not a hex ID: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res_id</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.ARSCResStringPoolRef" class="doc doc-heading">
            <code>ARSCResStringPoolRef</code>


<a href="#androguard.core.axml.ARSCResStringPoolRef" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>This is actually a <code>Res_value</code>
It holds information about the stored resource value</p>
<p>See: <a href="http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#262">ResourceTypes.h 262</a></p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3662">3662</a></span>
<span class="normal"><a href="#__codelineno-0-3663">3663</a></span>
<span class="normal"><a href="#__codelineno-0-3664">3664</a></span>
<span class="normal"><a href="#__codelineno-0-3665">3665</a></span>
<span class="normal"><a href="#__codelineno-0-3666">3666</a></span>
<span class="normal"><a href="#__codelineno-0-3667">3667</a></span>
<span class="normal"><a href="#__codelineno-0-3668">3668</a></span>
<span class="normal"><a href="#__codelineno-0-3669">3669</a></span>
<span class="normal"><a href="#__codelineno-0-3670">3670</a></span>
<span class="normal"><a href="#__codelineno-0-3671">3671</a></span>
<span class="normal"><a href="#__codelineno-0-3672">3672</a></span>
<span class="normal"><a href="#__codelineno-0-3673">3673</a></span>
<span class="normal"><a href="#__codelineno-0-3674">3674</a></span>
<span class="normal"><a href="#__codelineno-0-3675">3675</a></span>
<span class="normal"><a href="#__codelineno-0-3676">3676</a></span>
<span class="normal"><a href="#__codelineno-0-3677">3677</a></span>
<span class="normal"><a href="#__codelineno-0-3678">3678</a></span>
<span class="normal"><a href="#__codelineno-0-3679">3679</a></span>
<span class="normal"><a href="#__codelineno-0-3680">3680</a></span>
<span class="normal"><a href="#__codelineno-0-3681">3681</a></span>
<span class="normal"><a href="#__codelineno-0-3682">3682</a></span>
<span class="normal"><a href="#__codelineno-0-3683">3683</a></span>
<span class="normal"><a href="#__codelineno-0-3684">3684</a></span>
<span class="normal"><a href="#__codelineno-0-3685">3685</a></span>
<span class="normal"><a href="#__codelineno-0-3686">3686</a></span>
<span class="normal"><a href="#__codelineno-0-3687">3687</a></span>
<span class="normal"><a href="#__codelineno-0-3688">3688</a></span>
<span class="normal"><a href="#__codelineno-0-3689">3689</a></span>
<span class="normal"><a href="#__codelineno-0-3690">3690</a></span>
<span class="normal"><a href="#__codelineno-0-3691">3691</a></span>
<span class="normal"><a href="#__codelineno-0-3692">3692</a></span>
<span class="normal"><a href="#__codelineno-0-3693">3693</a></span>
<span class="normal"><a href="#__codelineno-0-3694">3694</a></span>
<span class="normal"><a href="#__codelineno-0-3695">3695</a></span>
<span class="normal"><a href="#__codelineno-0-3696">3696</a></span>
<span class="normal"><a href="#__codelineno-0-3697">3697</a></span>
<span class="normal"><a href="#__codelineno-0-3698">3698</a></span>
<span class="normal"><a href="#__codelineno-0-3699">3699</a></span>
<span class="normal"><a href="#__codelineno-0-3700">3700</a></span>
<span class="normal"><a href="#__codelineno-0-3701">3701</a></span>
<span class="normal"><a href="#__codelineno-0-3702">3702</a></span>
<span class="normal"><a href="#__codelineno-0-3703">3703</a></span>
<span class="normal"><a href="#__codelineno-0-3704">3704</a></span>
<span class="normal"><a href="#__codelineno-0-3705">3705</a></span>
<span class="normal"><a href="#__codelineno-0-3706">3706</a></span>
<span class="normal"><a href="#__codelineno-0-3707">3707</a></span>
<span class="normal"><a href="#__codelineno-0-3708">3708</a></span>
<span class="normal"><a href="#__codelineno-0-3709">3709</a></span>
<span class="normal"><a href="#__codelineno-0-3710">3710</a></span>
<span class="normal"><a href="#__codelineno-0-3711">3711</a></span>
<span class="normal"><a href="#__codelineno-0-3712">3712</a></span>
<span class="normal"><a href="#__codelineno-0-3713">3713</a></span>
<span class="normal"><a href="#__codelineno-0-3714">3714</a></span>
<span class="normal"><a href="#__codelineno-0-3715">3715</a></span>
<span class="normal"><a href="#__codelineno-0-3716">3716</a></span>
<span class="normal"><a href="#__codelineno-0-3717">3717</a></span>
<span class="normal"><a href="#__codelineno-0-3718">3718</a></span>
<span class="normal"><a href="#__codelineno-0-3719">3719</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-3662" name="__codelineno-0-3662"></a><span class="k">class</span> <span class="nc">ARSCResStringPoolRef</span><span class="p">:</span>
<a id="__codelineno-0-3663" name="__codelineno-0-3663"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3664" name="__codelineno-0-3664"></a><span class="sd">    This is actually a `Res_value`</span>
<a id="__codelineno-0-3665" name="__codelineno-0-3665"></a><span class="sd">    It holds information about the stored resource value</span>
<a id="__codelineno-0-3666" name="__codelineno-0-3666"></a>
<a id="__codelineno-0-3667" name="__codelineno-0-3667"></a><span class="sd">    See: [ResourceTypes.h 262](http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#262)</span>
<a id="__codelineno-0-3668" name="__codelineno-0-3668"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-3669" name="__codelineno-0-3669"></a>
<a id="__codelineno-0-3670" name="__codelineno-0-3670"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-3671" name="__codelineno-0-3671"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">buff</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PackageContext</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-3672" name="__codelineno-0-3672"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-3673" name="__codelineno-0-3673"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-3674" name="__codelineno-0-3674"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
<a id="__codelineno-0-3675" name="__codelineno-0-3675"></a>
<a id="__codelineno-0-3676" name="__codelineno-0-3676"></a>        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&lt;H&quot;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-3677" name="__codelineno-0-3677"></a>        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">res0</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&lt;B&quot;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-3678" name="__codelineno-0-3678"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-3679" name="__codelineno-0-3679"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">res0</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3680" name="__codelineno-0-3680"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;res0 must be always zero!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3681" name="__codelineno-0-3681"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3682" name="__codelineno-0-3682"></a>            <span class="c1"># data is interpreted according to data_type</span>
<a id="__codelineno-0-3683" name="__codelineno-0-3683"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3684" name="__codelineno-0-3684"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-3685" name="__codelineno-0-3685"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-3686" name="__codelineno-0-3686"></a>
<a id="__codelineno-0-3687" name="__codelineno-0-3687"></a>    <span class="k">def</span> <span class="nf">get_data_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3688" name="__codelineno-0-3688"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">stringpool_main</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-3689" name="__codelineno-0-3689"></a>
<a id="__codelineno-0-3690" name="__codelineno-0-3690"></a>    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-3691" name="__codelineno-0-3691"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
<a id="__codelineno-0-3692" name="__codelineno-0-3692"></a>
<a id="__codelineno-0-3693" name="__codelineno-0-3693"></a>    <span class="k">def</span> <span class="nf">get_data_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-3694" name="__codelineno-0-3694"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span>
<a id="__codelineno-0-3695" name="__codelineno-0-3695"></a>
<a id="__codelineno-0-3696" name="__codelineno-0-3696"></a>    <span class="k">def</span> <span class="nf">get_data_type_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3697" name="__codelineno-0-3697"></a>        <span class="k">return</span> <span class="n">TYPE_TABLE</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data_type</span><span class="p">]</span>
<a id="__codelineno-0-3698" name="__codelineno-0-3698"></a>
<a id="__codelineno-0-3699" name="__codelineno-0-3699"></a>    <span class="k">def</span> <span class="nf">format_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3700" name="__codelineno-0-3700"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3701" name="__codelineno-0-3701"></a><span class="sd">        Return the formatted (interpreted) data according to `data_type`.</span>
<a id="__codelineno-0-3702" name="__codelineno-0-3702"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-3703" name="__codelineno-0-3703"></a>        <span class="k">return</span> <span class="n">format_value</span><span class="p">(</span>
<a id="__codelineno-0-3704" name="__codelineno-0-3704"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">stringpool_main</span><span class="o">.</span><span class="n">getString</span>
<a id="__codelineno-0-3705" name="__codelineno-0-3705"></a>        <span class="p">)</span>
<a id="__codelineno-0-3706" name="__codelineno-0-3706"></a>
<a id="__codelineno-0-3707" name="__codelineno-0-3707"></a>    <span class="k">def</span> <span class="nf">is_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-3708" name="__codelineno-0-3708"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3709" name="__codelineno-0-3709"></a><span class="sd">        Returns True if the Res_value is actually a reference to another resource</span>
<a id="__codelineno-0-3710" name="__codelineno-0-3710"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-3711" name="__codelineno-0-3711"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span> <span class="o">==</span> <span class="n">TYPE_REFERENCE</span>
<a id="__codelineno-0-3712" name="__codelineno-0-3712"></a>
<a id="__codelineno-0-3713" name="__codelineno-0-3713"></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-3714" name="__codelineno-0-3714"></a>        <span class="k">return</span> <span class="s2">&quot;&lt;ARSCResStringPoolRef idx=&#39;0x</span><span class="si">{:08x}</span><span class="s2">&#39; size=&#39;</span><span class="si">{}</span><span class="s2">&#39; type=&#39;</span><span class="si">{}</span><span class="s2">&#39; data=&#39;0x</span><span class="si">{:08x}</span><span class="s2">&#39;&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-3715" name="__codelineno-0-3715"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
<a id="__codelineno-0-3716" name="__codelineno-0-3716"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
<a id="__codelineno-0-3717" name="__codelineno-0-3717"></a>            <span class="n">TYPE_TABLE</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_type</span><span class="p">,</span> <span class="s2">&quot;0x</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span><span class="p">),</span>
<a id="__codelineno-0-3718" name="__codelineno-0-3718"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-3719" name="__codelineno-0-3719"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCResStringPoolRef.format_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">format_value</span><span class="p">()</span></code>

<a href="#androguard.core.axml.ARSCResStringPoolRef.format_value" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the formatted (interpreted) data according to <code>data_type</code>.</p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3699">3699</a></span>
<span class="normal"><a href="#__codelineno-0-3700">3700</a></span>
<span class="normal"><a href="#__codelineno-0-3701">3701</a></span>
<span class="normal"><a href="#__codelineno-0-3702">3702</a></span>
<span class="normal"><a href="#__codelineno-0-3703">3703</a></span>
<span class="normal"><a href="#__codelineno-0-3704">3704</a></span>
<span class="normal"><a href="#__codelineno-0-3705">3705</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-3699" name="__codelineno-0-3699"></a><span class="k">def</span> <span class="nf">format_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3700" name="__codelineno-0-3700"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3701" name="__codelineno-0-3701"></a><span class="sd">    Return the formatted (interpreted) data according to `data_type`.</span>
<a id="__codelineno-0-3702" name="__codelineno-0-3702"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-3703" name="__codelineno-0-3703"></a>    <span class="k">return</span> <span class="n">format_value</span><span class="p">(</span>
<a id="__codelineno-0-3704" name="__codelineno-0-3704"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">stringpool_main</span><span class="o">.</span><span class="n">getString</span>
<a id="__codelineno-0-3705" name="__codelineno-0-3705"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCResStringPoolRef.is_reference" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_reference</span><span class="p">()</span></code>

<a href="#androguard.core.axml.ARSCResStringPoolRef.is_reference" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns True if the Res_value is actually a reference to another resource</p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3707">3707</a></span>
<span class="normal"><a href="#__codelineno-0-3708">3708</a></span>
<span class="normal"><a href="#__codelineno-0-3709">3709</a></span>
<span class="normal"><a href="#__codelineno-0-3710">3710</a></span>
<span class="normal"><a href="#__codelineno-0-3711">3711</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-3707" name="__codelineno-0-3707"></a><span class="k">def</span> <span class="nf">is_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-3708" name="__codelineno-0-3708"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3709" name="__codelineno-0-3709"></a><span class="sd">    Returns True if the Res_value is actually a reference to another resource</span>
<a id="__codelineno-0-3710" name="__codelineno-0-3710"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-3711" name="__codelineno-0-3711"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_type</span> <span class="o">==</span> <span class="n">TYPE_REFERENCE</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.ARSCResTableConfig" class="doc doc-heading">
            <code>ARSCResTableConfig</code>


<a href="#androguard.core.axml.ARSCResTableConfig" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>ARSCResTableConfig contains the configuration for specific resource selection.
This is used on the device to determine which resources should be loaded
based on different properties of the device like locale or displaysize.</p>
<p>See the definition of <code>ResTable_config</code> in
http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#911</p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2996">2996</a></span>
<span class="normal"><a href="#__codelineno-0-2997">2997</a></span>
<span class="normal"><a href="#__codelineno-0-2998">2998</a></span>
<span class="normal"><a href="#__codelineno-0-2999">2999</a></span>
<span class="normal"><a href="#__codelineno-0-3000">3000</a></span>
<span class="normal"><a href="#__codelineno-0-3001">3001</a></span>
<span class="normal"><a href="#__codelineno-0-3002">3002</a></span>
<span class="normal"><a href="#__codelineno-0-3003">3003</a></span>
<span class="normal"><a href="#__codelineno-0-3004">3004</a></span>
<span class="normal"><a href="#__codelineno-0-3005">3005</a></span>
<span class="normal"><a href="#__codelineno-0-3006">3006</a></span>
<span class="normal"><a href="#__codelineno-0-3007">3007</a></span>
<span class="normal"><a href="#__codelineno-0-3008">3008</a></span>
<span class="normal"><a href="#__codelineno-0-3009">3009</a></span>
<span class="normal"><a href="#__codelineno-0-3010">3010</a></span>
<span class="normal"><a href="#__codelineno-0-3011">3011</a></span>
<span class="normal"><a href="#__codelineno-0-3012">3012</a></span>
<span class="normal"><a href="#__codelineno-0-3013">3013</a></span>
<span class="normal"><a href="#__codelineno-0-3014">3014</a></span>
<span class="normal"><a href="#__codelineno-0-3015">3015</a></span>
<span class="normal"><a href="#__codelineno-0-3016">3016</a></span>
<span class="normal"><a href="#__codelineno-0-3017">3017</a></span>
<span class="normal"><a href="#__codelineno-0-3018">3018</a></span>
<span class="normal"><a href="#__codelineno-0-3019">3019</a></span>
<span class="normal"><a href="#__codelineno-0-3020">3020</a></span>
<span class="normal"><a href="#__codelineno-0-3021">3021</a></span>
<span class="normal"><a href="#__codelineno-0-3022">3022</a></span>
<span class="normal"><a href="#__codelineno-0-3023">3023</a></span>
<span class="normal"><a href="#__codelineno-0-3024">3024</a></span>
<span class="normal"><a href="#__codelineno-0-3025">3025</a></span>
<span class="normal"><a href="#__codelineno-0-3026">3026</a></span>
<span class="normal"><a href="#__codelineno-0-3027">3027</a></span>
<span class="normal"><a href="#__codelineno-0-3028">3028</a></span>
<span class="normal"><a href="#__codelineno-0-3029">3029</a></span>
<span class="normal"><a href="#__codelineno-0-3030">3030</a></span>
<span class="normal"><a href="#__codelineno-0-3031">3031</a></span>
<span class="normal"><a href="#__codelineno-0-3032">3032</a></span>
<span class="normal"><a href="#__codelineno-0-3033">3033</a></span>
<span class="normal"><a href="#__codelineno-0-3034">3034</a></span>
<span class="normal"><a href="#__codelineno-0-3035">3035</a></span>
<span class="normal"><a href="#__codelineno-0-3036">3036</a></span>
<span class="normal"><a href="#__codelineno-0-3037">3037</a></span>
<span class="normal"><a href="#__codelineno-0-3038">3038</a></span>
<span class="normal"><a href="#__codelineno-0-3039">3039</a></span>
<span class="normal"><a href="#__codelineno-0-3040">3040</a></span>
<span class="normal"><a href="#__codelineno-0-3041">3041</a></span>
<span class="normal"><a href="#__codelineno-0-3042">3042</a></span>
<span class="normal"><a href="#__codelineno-0-3043">3043</a></span>
<span class="normal"><a href="#__codelineno-0-3044">3044</a></span>
<span class="normal"><a href="#__codelineno-0-3045">3045</a></span>
<span class="normal"><a href="#__codelineno-0-3046">3046</a></span>
<span class="normal"><a href="#__codelineno-0-3047">3047</a></span>
<span class="normal"><a href="#__codelineno-0-3048">3048</a></span>
<span class="normal"><a href="#__codelineno-0-3049">3049</a></span>
<span class="normal"><a href="#__codelineno-0-3050">3050</a></span>
<span class="normal"><a href="#__codelineno-0-3051">3051</a></span>
<span class="normal"><a href="#__codelineno-0-3052">3052</a></span>
<span class="normal"><a href="#__codelineno-0-3053">3053</a></span>
<span class="normal"><a href="#__codelineno-0-3054">3054</a></span>
<span class="normal"><a href="#__codelineno-0-3055">3055</a></span>
<span class="normal"><a href="#__codelineno-0-3056">3056</a></span>
<span class="normal"><a href="#__codelineno-0-3057">3057</a></span>
<span class="normal"><a href="#__codelineno-0-3058">3058</a></span>
<span class="normal"><a href="#__codelineno-0-3059">3059</a></span>
<span class="normal"><a href="#__codelineno-0-3060">3060</a></span>
<span class="normal"><a href="#__codelineno-0-3061">3061</a></span>
<span class="normal"><a href="#__codelineno-0-3062">3062</a></span>
<span class="normal"><a href="#__codelineno-0-3063">3063</a></span>
<span class="normal"><a href="#__codelineno-0-3064">3064</a></span>
<span class="normal"><a href="#__codelineno-0-3065">3065</a></span>
<span class="normal"><a href="#__codelineno-0-3066">3066</a></span>
<span class="normal"><a href="#__codelineno-0-3067">3067</a></span>
<span class="normal"><a href="#__codelineno-0-3068">3068</a></span>
<span class="normal"><a href="#__codelineno-0-3069">3069</a></span>
<span class="normal"><a href="#__codelineno-0-3070">3070</a></span>
<span class="normal"><a href="#__codelineno-0-3071">3071</a></span>
<span class="normal"><a href="#__codelineno-0-3072">3072</a></span>
<span class="normal"><a href="#__codelineno-0-3073">3073</a></span>
<span class="normal"><a href="#__codelineno-0-3074">3074</a></span>
<span class="normal"><a href="#__codelineno-0-3075">3075</a></span>
<span class="normal"><a href="#__codelineno-0-3076">3076</a></span>
<span class="normal"><a href="#__codelineno-0-3077">3077</a></span>
<span class="normal"><a href="#__codelineno-0-3078">3078</a></span>
<span class="normal"><a href="#__codelineno-0-3079">3079</a></span>
<span class="normal"><a href="#__codelineno-0-3080">3080</a></span>
<span class="normal"><a href="#__codelineno-0-3081">3081</a></span>
<span class="normal"><a href="#__codelineno-0-3082">3082</a></span>
<span class="normal"><a href="#__codelineno-0-3083">3083</a></span>
<span class="normal"><a href="#__codelineno-0-3084">3084</a></span>
<span class="normal"><a href="#__codelineno-0-3085">3085</a></span>
<span class="normal"><a href="#__codelineno-0-3086">3086</a></span>
<span class="normal"><a href="#__codelineno-0-3087">3087</a></span>
<span class="normal"><a href="#__codelineno-0-3088">3088</a></span>
<span class="normal"><a href="#__codelineno-0-3089">3089</a></span>
<span class="normal"><a href="#__codelineno-0-3090">3090</a></span>
<span class="normal"><a href="#__codelineno-0-3091">3091</a></span>
<span class="normal"><a href="#__codelineno-0-3092">3092</a></span>
<span class="normal"><a href="#__codelineno-0-3093">3093</a></span>
<span class="normal"><a href="#__codelineno-0-3094">3094</a></span>
<span class="normal"><a href="#__codelineno-0-3095">3095</a></span>
<span class="normal"><a href="#__codelineno-0-3096">3096</a></span>
<span class="normal"><a href="#__codelineno-0-3097">3097</a></span>
<span class="normal"><a href="#__codelineno-0-3098">3098</a></span>
<span class="normal"><a href="#__codelineno-0-3099">3099</a></span>
<span class="normal"><a href="#__codelineno-0-3100">3100</a></span>
<span class="normal"><a href="#__codelineno-0-3101">3101</a></span>
<span class="normal"><a href="#__codelineno-0-3102">3102</a></span>
<span class="normal"><a href="#__codelineno-0-3103">3103</a></span>
<span class="normal"><a href="#__codelineno-0-3104">3104</a></span>
<span class="normal"><a href="#__codelineno-0-3105">3105</a></span>
<span class="normal"><a href="#__codelineno-0-3106">3106</a></span>
<span class="normal"><a href="#__codelineno-0-3107">3107</a></span>
<span class="normal"><a href="#__codelineno-0-3108">3108</a></span>
<span class="normal"><a href="#__codelineno-0-3109">3109</a></span>
<span class="normal"><a href="#__codelineno-0-3110">3110</a></span>
<span class="normal"><a href="#__codelineno-0-3111">3111</a></span>
<span class="normal"><a href="#__codelineno-0-3112">3112</a></span>
<span class="normal"><a href="#__codelineno-0-3113">3113</a></span>
<span class="normal"><a href="#__codelineno-0-3114">3114</a></span>
<span class="normal"><a href="#__codelineno-0-3115">3115</a></span>
<span class="normal"><a href="#__codelineno-0-3116">3116</a></span>
<span class="normal"><a href="#__codelineno-0-3117">3117</a></span>
<span class="normal"><a href="#__codelineno-0-3118">3118</a></span>
<span class="normal"><a href="#__codelineno-0-3119">3119</a></span>
<span class="normal"><a href="#__codelineno-0-3120">3120</a></span>
<span class="normal"><a href="#__codelineno-0-3121">3121</a></span>
<span class="normal"><a href="#__codelineno-0-3122">3122</a></span>
<span class="normal"><a href="#__codelineno-0-3123">3123</a></span>
<span class="normal"><a href="#__codelineno-0-3124">3124</a></span>
<span class="normal"><a href="#__codelineno-0-3125">3125</a></span>
<span class="normal"><a href="#__codelineno-0-3126">3126</a></span>
<span class="normal"><a href="#__codelineno-0-3127">3127</a></span>
<span class="normal"><a href="#__codelineno-0-3128">3128</a></span>
<span class="normal"><a href="#__codelineno-0-3129">3129</a></span>
<span class="normal"><a href="#__codelineno-0-3130">3130</a></span>
<span class="normal"><a href="#__codelineno-0-3131">3131</a></span>
<span class="normal"><a href="#__codelineno-0-3132">3132</a></span>
<span class="normal"><a href="#__codelineno-0-3133">3133</a></span>
<span class="normal"><a href="#__codelineno-0-3134">3134</a></span>
<span class="normal"><a href="#__codelineno-0-3135">3135</a></span>
<span class="normal"><a href="#__codelineno-0-3136">3136</a></span>
<span class="normal"><a href="#__codelineno-0-3137">3137</a></span>
<span class="normal"><a href="#__codelineno-0-3138">3138</a></span>
<span class="normal"><a href="#__codelineno-0-3139">3139</a></span>
<span class="normal"><a href="#__codelineno-0-3140">3140</a></span>
<span class="normal"><a href="#__codelineno-0-3141">3141</a></span>
<span class="normal"><a href="#__codelineno-0-3142">3142</a></span>
<span class="normal"><a href="#__codelineno-0-3143">3143</a></span>
<span class="normal"><a href="#__codelineno-0-3144">3144</a></span>
<span class="normal"><a href="#__codelineno-0-3145">3145</a></span>
<span class="normal"><a href="#__codelineno-0-3146">3146</a></span>
<span class="normal"><a href="#__codelineno-0-3147">3147</a></span>
<span class="normal"><a href="#__codelineno-0-3148">3148</a></span>
<span class="normal"><a href="#__codelineno-0-3149">3149</a></span>
<span class="normal"><a href="#__codelineno-0-3150">3150</a></span>
<span class="normal"><a href="#__codelineno-0-3151">3151</a></span>
<span class="normal"><a href="#__codelineno-0-3152">3152</a></span>
<span class="normal"><a href="#__codelineno-0-3153">3153</a></span>
<span class="normal"><a href="#__codelineno-0-3154">3154</a></span>
<span class="normal"><a href="#__codelineno-0-3155">3155</a></span>
<span class="normal"><a href="#__codelineno-0-3156">3156</a></span>
<span class="normal"><a href="#__codelineno-0-3157">3157</a></span>
<span class="normal"><a href="#__codelineno-0-3158">3158</a></span>
<span class="normal"><a href="#__codelineno-0-3159">3159</a></span>
<span class="normal"><a href="#__codelineno-0-3160">3160</a></span>
<span class="normal"><a href="#__codelineno-0-3161">3161</a></span>
<span class="normal"><a href="#__codelineno-0-3162">3162</a></span>
<span class="normal"><a href="#__codelineno-0-3163">3163</a></span>
<span class="normal"><a href="#__codelineno-0-3164">3164</a></span>
<span class="normal"><a href="#__codelineno-0-3165">3165</a></span>
<span class="normal"><a href="#__codelineno-0-3166">3166</a></span>
<span class="normal"><a href="#__codelineno-0-3167">3167</a></span>
<span class="normal"><a href="#__codelineno-0-3168">3168</a></span>
<span class="normal"><a href="#__codelineno-0-3169">3169</a></span>
<span class="normal"><a href="#__codelineno-0-3170">3170</a></span>
<span class="normal"><a href="#__codelineno-0-3171">3171</a></span>
<span class="normal"><a href="#__codelineno-0-3172">3172</a></span>
<span class="normal"><a href="#__codelineno-0-3173">3173</a></span>
<span class="normal"><a href="#__codelineno-0-3174">3174</a></span>
<span class="normal"><a href="#__codelineno-0-3175">3175</a></span>
<span class="normal"><a href="#__codelineno-0-3176">3176</a></span>
<span class="normal"><a href="#__codelineno-0-3177">3177</a></span>
<span class="normal"><a href="#__codelineno-0-3178">3178</a></span>
<span class="normal"><a href="#__codelineno-0-3179">3179</a></span>
<span class="normal"><a href="#__codelineno-0-3180">3180</a></span>
<span class="normal"><a href="#__codelineno-0-3181">3181</a></span>
<span class="normal"><a href="#__codelineno-0-3182">3182</a></span>
<span class="normal"><a href="#__codelineno-0-3183">3183</a></span>
<span class="normal"><a href="#__codelineno-0-3184">3184</a></span>
<span class="normal"><a href="#__codelineno-0-3185">3185</a></span>
<span class="normal"><a href="#__codelineno-0-3186">3186</a></span>
<span class="normal"><a href="#__codelineno-0-3187">3187</a></span>
<span class="normal"><a href="#__codelineno-0-3188">3188</a></span>
<span class="normal"><a href="#__codelineno-0-3189">3189</a></span>
<span class="normal"><a href="#__codelineno-0-3190">3190</a></span>
<span class="normal"><a href="#__codelineno-0-3191">3191</a></span>
<span class="normal"><a href="#__codelineno-0-3192">3192</a></span>
<span class="normal"><a href="#__codelineno-0-3193">3193</a></span>
<span class="normal"><a href="#__codelineno-0-3194">3194</a></span>
<span class="normal"><a href="#__codelineno-0-3195">3195</a></span>
<span class="normal"><a href="#__codelineno-0-3196">3196</a></span>
<span class="normal"><a href="#__codelineno-0-3197">3197</a></span>
<span class="normal"><a href="#__codelineno-0-3198">3198</a></span>
<span class="normal"><a href="#__codelineno-0-3199">3199</a></span>
<span class="normal"><a href="#__codelineno-0-3200">3200</a></span>
<span class="normal"><a href="#__codelineno-0-3201">3201</a></span>
<span class="normal"><a href="#__codelineno-0-3202">3202</a></span>
<span class="normal"><a href="#__codelineno-0-3203">3203</a></span>
<span class="normal"><a href="#__codelineno-0-3204">3204</a></span>
<span class="normal"><a href="#__codelineno-0-3205">3205</a></span>
<span class="normal"><a href="#__codelineno-0-3206">3206</a></span>
<span class="normal"><a href="#__codelineno-0-3207">3207</a></span>
<span class="normal"><a href="#__codelineno-0-3208">3208</a></span>
<span class="normal"><a href="#__codelineno-0-3209">3209</a></span>
<span class="normal"><a href="#__codelineno-0-3210">3210</a></span>
<span class="normal"><a href="#__codelineno-0-3211">3211</a></span>
<span class="normal"><a href="#__codelineno-0-3212">3212</a></span>
<span class="normal"><a href="#__codelineno-0-3213">3213</a></span>
<span class="normal"><a href="#__codelineno-0-3214">3214</a></span>
<span class="normal"><a href="#__codelineno-0-3215">3215</a></span>
<span class="normal"><a href="#__codelineno-0-3216">3216</a></span>
<span class="normal"><a href="#__codelineno-0-3217">3217</a></span>
<span class="normal"><a href="#__codelineno-0-3218">3218</a></span>
<span class="normal"><a href="#__codelineno-0-3219">3219</a></span>
<span class="normal"><a href="#__codelineno-0-3220">3220</a></span>
<span class="normal"><a href="#__codelineno-0-3221">3221</a></span>
<span class="normal"><a href="#__codelineno-0-3222">3222</a></span>
<span class="normal"><a href="#__codelineno-0-3223">3223</a></span>
<span class="normal"><a href="#__codelineno-0-3224">3224</a></span>
<span class="normal"><a href="#__codelineno-0-3225">3225</a></span>
<span class="normal"><a href="#__codelineno-0-3226">3226</a></span>
<span class="normal"><a href="#__codelineno-0-3227">3227</a></span>
<span class="normal"><a href="#__codelineno-0-3228">3228</a></span>
<span class="normal"><a href="#__codelineno-0-3229">3229</a></span>
<span class="normal"><a href="#__codelineno-0-3230">3230</a></span>
<span class="normal"><a href="#__codelineno-0-3231">3231</a></span>
<span class="normal"><a href="#__codelineno-0-3232">3232</a></span>
<span class="normal"><a href="#__codelineno-0-3233">3233</a></span>
<span class="normal"><a href="#__codelineno-0-3234">3234</a></span>
<span class="normal"><a href="#__codelineno-0-3235">3235</a></span>
<span class="normal"><a href="#__codelineno-0-3236">3236</a></span>
<span class="normal"><a href="#__codelineno-0-3237">3237</a></span>
<span class="normal"><a href="#__codelineno-0-3238">3238</a></span>
<span class="normal"><a href="#__codelineno-0-3239">3239</a></span>
<span class="normal"><a href="#__codelineno-0-3240">3240</a></span>
<span class="normal"><a href="#__codelineno-0-3241">3241</a></span>
<span class="normal"><a href="#__codelineno-0-3242">3242</a></span>
<span class="normal"><a href="#__codelineno-0-3243">3243</a></span>
<span class="normal"><a href="#__codelineno-0-3244">3244</a></span>
<span class="normal"><a href="#__codelineno-0-3245">3245</a></span>
<span class="normal"><a href="#__codelineno-0-3246">3246</a></span>
<span class="normal"><a href="#__codelineno-0-3247">3247</a></span>
<span class="normal"><a href="#__codelineno-0-3248">3248</a></span>
<span class="normal"><a href="#__codelineno-0-3249">3249</a></span>
<span class="normal"><a href="#__codelineno-0-3250">3250</a></span>
<span class="normal"><a href="#__codelineno-0-3251">3251</a></span>
<span class="normal"><a href="#__codelineno-0-3252">3252</a></span>
<span class="normal"><a href="#__codelineno-0-3253">3253</a></span>
<span class="normal"><a href="#__codelineno-0-3254">3254</a></span>
<span class="normal"><a href="#__codelineno-0-3255">3255</a></span>
<span class="normal"><a href="#__codelineno-0-3256">3256</a></span>
<span class="normal"><a href="#__codelineno-0-3257">3257</a></span>
<span class="normal"><a href="#__codelineno-0-3258">3258</a></span>
<span class="normal"><a href="#__codelineno-0-3259">3259</a></span>
<span class="normal"><a href="#__codelineno-0-3260">3260</a></span>
<span class="normal"><a href="#__codelineno-0-3261">3261</a></span>
<span class="normal"><a href="#__codelineno-0-3262">3262</a></span>
<span class="normal"><a href="#__codelineno-0-3263">3263</a></span>
<span class="normal"><a href="#__codelineno-0-3264">3264</a></span>
<span class="normal"><a href="#__codelineno-0-3265">3265</a></span>
<span class="normal"><a href="#__codelineno-0-3266">3266</a></span>
<span class="normal"><a href="#__codelineno-0-3267">3267</a></span>
<span class="normal"><a href="#__codelineno-0-3268">3268</a></span>
<span class="normal"><a href="#__codelineno-0-3269">3269</a></span>
<span class="normal"><a href="#__codelineno-0-3270">3270</a></span>
<span class="normal"><a href="#__codelineno-0-3271">3271</a></span>
<span class="normal"><a href="#__codelineno-0-3272">3272</a></span>
<span class="normal"><a href="#__codelineno-0-3273">3273</a></span>
<span class="normal"><a href="#__codelineno-0-3274">3274</a></span>
<span class="normal"><a href="#__codelineno-0-3275">3275</a></span>
<span class="normal"><a href="#__codelineno-0-3276">3276</a></span>
<span class="normal"><a href="#__codelineno-0-3277">3277</a></span>
<span class="normal"><a href="#__codelineno-0-3278">3278</a></span>
<span class="normal"><a href="#__codelineno-0-3279">3279</a></span>
<span class="normal"><a href="#__codelineno-0-3280">3280</a></span>
<span class="normal"><a href="#__codelineno-0-3281">3281</a></span>
<span class="normal"><a href="#__codelineno-0-3282">3282</a></span>
<span class="normal"><a href="#__codelineno-0-3283">3283</a></span>
<span class="normal"><a href="#__codelineno-0-3284">3284</a></span>
<span class="normal"><a href="#__codelineno-0-3285">3285</a></span>
<span class="normal"><a href="#__codelineno-0-3286">3286</a></span>
<span class="normal"><a href="#__codelineno-0-3287">3287</a></span>
<span class="normal"><a href="#__codelineno-0-3288">3288</a></span>
<span class="normal"><a href="#__codelineno-0-3289">3289</a></span>
<span class="normal"><a href="#__codelineno-0-3290">3290</a></span>
<span class="normal"><a href="#__codelineno-0-3291">3291</a></span>
<span class="normal"><a href="#__codelineno-0-3292">3292</a></span>
<span class="normal"><a href="#__codelineno-0-3293">3293</a></span>
<span class="normal"><a href="#__codelineno-0-3294">3294</a></span>
<span class="normal"><a href="#__codelineno-0-3295">3295</a></span>
<span class="normal"><a href="#__codelineno-0-3296">3296</a></span>
<span class="normal"><a href="#__codelineno-0-3297">3297</a></span>
<span class="normal"><a href="#__codelineno-0-3298">3298</a></span>
<span class="normal"><a href="#__codelineno-0-3299">3299</a></span>
<span class="normal"><a href="#__codelineno-0-3300">3300</a></span>
<span class="normal"><a href="#__codelineno-0-3301">3301</a></span>
<span class="normal"><a href="#__codelineno-0-3302">3302</a></span>
<span class="normal"><a href="#__codelineno-0-3303">3303</a></span>
<span class="normal"><a href="#__codelineno-0-3304">3304</a></span>
<span class="normal"><a href="#__codelineno-0-3305">3305</a></span>
<span class="normal"><a href="#__codelineno-0-3306">3306</a></span>
<span class="normal"><a href="#__codelineno-0-3307">3307</a></span>
<span class="normal"><a href="#__codelineno-0-3308">3308</a></span>
<span class="normal"><a href="#__codelineno-0-3309">3309</a></span>
<span class="normal"><a href="#__codelineno-0-3310">3310</a></span>
<span class="normal"><a href="#__codelineno-0-3311">3311</a></span>
<span class="normal"><a href="#__codelineno-0-3312">3312</a></span>
<span class="normal"><a href="#__codelineno-0-3313">3313</a></span>
<span class="normal"><a href="#__codelineno-0-3314">3314</a></span>
<span class="normal"><a href="#__codelineno-0-3315">3315</a></span>
<span class="normal"><a href="#__codelineno-0-3316">3316</a></span>
<span class="normal"><a href="#__codelineno-0-3317">3317</a></span>
<span class="normal"><a href="#__codelineno-0-3318">3318</a></span>
<span class="normal"><a href="#__codelineno-0-3319">3319</a></span>
<span class="normal"><a href="#__codelineno-0-3320">3320</a></span>
<span class="normal"><a href="#__codelineno-0-3321">3321</a></span>
<span class="normal"><a href="#__codelineno-0-3322">3322</a></span>
<span class="normal"><a href="#__codelineno-0-3323">3323</a></span>
<span class="normal"><a href="#__codelineno-0-3324">3324</a></span>
<span class="normal"><a href="#__codelineno-0-3325">3325</a></span>
<span class="normal"><a href="#__codelineno-0-3326">3326</a></span>
<span class="normal"><a href="#__codelineno-0-3327">3327</a></span>
<span class="normal"><a href="#__codelineno-0-3328">3328</a></span>
<span class="normal"><a href="#__codelineno-0-3329">3329</a></span>
<span class="normal"><a href="#__codelineno-0-3330">3330</a></span>
<span class="normal"><a href="#__codelineno-0-3331">3331</a></span>
<span class="normal"><a href="#__codelineno-0-3332">3332</a></span>
<span class="normal"><a href="#__codelineno-0-3333">3333</a></span>
<span class="normal"><a href="#__codelineno-0-3334">3334</a></span>
<span class="normal"><a href="#__codelineno-0-3335">3335</a></span>
<span class="normal"><a href="#__codelineno-0-3336">3336</a></span>
<span class="normal"><a href="#__codelineno-0-3337">3337</a></span>
<span class="normal"><a href="#__codelineno-0-3338">3338</a></span>
<span class="normal"><a href="#__codelineno-0-3339">3339</a></span>
<span class="normal"><a href="#__codelineno-0-3340">3340</a></span>
<span class="normal"><a href="#__codelineno-0-3341">3341</a></span>
<span class="normal"><a href="#__codelineno-0-3342">3342</a></span>
<span class="normal"><a href="#__codelineno-0-3343">3343</a></span>
<span class="normal"><a href="#__codelineno-0-3344">3344</a></span>
<span class="normal"><a href="#__codelineno-0-3345">3345</a></span>
<span class="normal"><a href="#__codelineno-0-3346">3346</a></span>
<span class="normal"><a href="#__codelineno-0-3347">3347</a></span>
<span class="normal"><a href="#__codelineno-0-3348">3348</a></span>
<span class="normal"><a href="#__codelineno-0-3349">3349</a></span>
<span class="normal"><a href="#__codelineno-0-3350">3350</a></span>
<span class="normal"><a href="#__codelineno-0-3351">3351</a></span>
<span class="normal"><a href="#__codelineno-0-3352">3352</a></span>
<span class="normal"><a href="#__codelineno-0-3353">3353</a></span>
<span class="normal"><a href="#__codelineno-0-3354">3354</a></span>
<span class="normal"><a href="#__codelineno-0-3355">3355</a></span>
<span class="normal"><a href="#__codelineno-0-3356">3356</a></span>
<span class="normal"><a href="#__codelineno-0-3357">3357</a></span>
<span class="normal"><a href="#__codelineno-0-3358">3358</a></span>
<span class="normal"><a href="#__codelineno-0-3359">3359</a></span>
<span class="normal"><a href="#__codelineno-0-3360">3360</a></span>
<span class="normal"><a href="#__codelineno-0-3361">3361</a></span>
<span class="normal"><a href="#__codelineno-0-3362">3362</a></span>
<span class="normal"><a href="#__codelineno-0-3363">3363</a></span>
<span class="normal"><a href="#__codelineno-0-3364">3364</a></span>
<span class="normal"><a href="#__codelineno-0-3365">3365</a></span>
<span class="normal"><a href="#__codelineno-0-3366">3366</a></span>
<span class="normal"><a href="#__codelineno-0-3367">3367</a></span>
<span class="normal"><a href="#__codelineno-0-3368">3368</a></span>
<span class="normal"><a href="#__codelineno-0-3369">3369</a></span>
<span class="normal"><a href="#__codelineno-0-3370">3370</a></span>
<span class="normal"><a href="#__codelineno-0-3371">3371</a></span>
<span class="normal"><a href="#__codelineno-0-3372">3372</a></span>
<span class="normal"><a href="#__codelineno-0-3373">3373</a></span>
<span class="normal"><a href="#__codelineno-0-3374">3374</a></span>
<span class="normal"><a href="#__codelineno-0-3375">3375</a></span>
<span class="normal"><a href="#__codelineno-0-3376">3376</a></span>
<span class="normal"><a href="#__codelineno-0-3377">3377</a></span>
<span class="normal"><a href="#__codelineno-0-3378">3378</a></span>
<span class="normal"><a href="#__codelineno-0-3379">3379</a></span>
<span class="normal"><a href="#__codelineno-0-3380">3380</a></span>
<span class="normal"><a href="#__codelineno-0-3381">3381</a></span>
<span class="normal"><a href="#__codelineno-0-3382">3382</a></span>
<span class="normal"><a href="#__codelineno-0-3383">3383</a></span>
<span class="normal"><a href="#__codelineno-0-3384">3384</a></span>
<span class="normal"><a href="#__codelineno-0-3385">3385</a></span>
<span class="normal"><a href="#__codelineno-0-3386">3386</a></span>
<span class="normal"><a href="#__codelineno-0-3387">3387</a></span>
<span class="normal"><a href="#__codelineno-0-3388">3388</a></span>
<span class="normal"><a href="#__codelineno-0-3389">3389</a></span>
<span class="normal"><a href="#__codelineno-0-3390">3390</a></span>
<span class="normal"><a href="#__codelineno-0-3391">3391</a></span>
<span class="normal"><a href="#__codelineno-0-3392">3392</a></span>
<span class="normal"><a href="#__codelineno-0-3393">3393</a></span>
<span class="normal"><a href="#__codelineno-0-3394">3394</a></span>
<span class="normal"><a href="#__codelineno-0-3395">3395</a></span>
<span class="normal"><a href="#__codelineno-0-3396">3396</a></span>
<span class="normal"><a href="#__codelineno-0-3397">3397</a></span>
<span class="normal"><a href="#__codelineno-0-3398">3398</a></span>
<span class="normal"><a href="#__codelineno-0-3399">3399</a></span>
<span class="normal"><a href="#__codelineno-0-3400">3400</a></span>
<span class="normal"><a href="#__codelineno-0-3401">3401</a></span>
<span class="normal"><a href="#__codelineno-0-3402">3402</a></span>
<span class="normal"><a href="#__codelineno-0-3403">3403</a></span>
<span class="normal"><a href="#__codelineno-0-3404">3404</a></span>
<span class="normal"><a href="#__codelineno-0-3405">3405</a></span>
<span class="normal"><a href="#__codelineno-0-3406">3406</a></span>
<span class="normal"><a href="#__codelineno-0-3407">3407</a></span>
<span class="normal"><a href="#__codelineno-0-3408">3408</a></span>
<span class="normal"><a href="#__codelineno-0-3409">3409</a></span>
<span class="normal"><a href="#__codelineno-0-3410">3410</a></span>
<span class="normal"><a href="#__codelineno-0-3411">3411</a></span>
<span class="normal"><a href="#__codelineno-0-3412">3412</a></span>
<span class="normal"><a href="#__codelineno-0-3413">3413</a></span>
<span class="normal"><a href="#__codelineno-0-3414">3414</a></span>
<span class="normal"><a href="#__codelineno-0-3415">3415</a></span>
<span class="normal"><a href="#__codelineno-0-3416">3416</a></span>
<span class="normal"><a href="#__codelineno-0-3417">3417</a></span>
<span class="normal"><a href="#__codelineno-0-3418">3418</a></span>
<span class="normal"><a href="#__codelineno-0-3419">3419</a></span>
<span class="normal"><a href="#__codelineno-0-3420">3420</a></span>
<span class="normal"><a href="#__codelineno-0-3421">3421</a></span>
<span class="normal"><a href="#__codelineno-0-3422">3422</a></span>
<span class="normal"><a href="#__codelineno-0-3423">3423</a></span>
<span class="normal"><a href="#__codelineno-0-3424">3424</a></span>
<span class="normal"><a href="#__codelineno-0-3425">3425</a></span>
<span class="normal"><a href="#__codelineno-0-3426">3426</a></span>
<span class="normal"><a href="#__codelineno-0-3427">3427</a></span>
<span class="normal"><a href="#__codelineno-0-3428">3428</a></span>
<span class="normal"><a href="#__codelineno-0-3429">3429</a></span>
<span class="normal"><a href="#__codelineno-0-3430">3430</a></span>
<span class="normal"><a href="#__codelineno-0-3431">3431</a></span>
<span class="normal"><a href="#__codelineno-0-3432">3432</a></span>
<span class="normal"><a href="#__codelineno-0-3433">3433</a></span>
<span class="normal"><a href="#__codelineno-0-3434">3434</a></span>
<span class="normal"><a href="#__codelineno-0-3435">3435</a></span>
<span class="normal"><a href="#__codelineno-0-3436">3436</a></span>
<span class="normal"><a href="#__codelineno-0-3437">3437</a></span>
<span class="normal"><a href="#__codelineno-0-3438">3438</a></span>
<span class="normal"><a href="#__codelineno-0-3439">3439</a></span>
<span class="normal"><a href="#__codelineno-0-3440">3440</a></span>
<span class="normal"><a href="#__codelineno-0-3441">3441</a></span>
<span class="normal"><a href="#__codelineno-0-3442">3442</a></span>
<span class="normal"><a href="#__codelineno-0-3443">3443</a></span>
<span class="normal"><a href="#__codelineno-0-3444">3444</a></span>
<span class="normal"><a href="#__codelineno-0-3445">3445</a></span>
<span class="normal"><a href="#__codelineno-0-3446">3446</a></span>
<span class="normal"><a href="#__codelineno-0-3447">3447</a></span>
<span class="normal"><a href="#__codelineno-0-3448">3448</a></span>
<span class="normal"><a href="#__codelineno-0-3449">3449</a></span>
<span class="normal"><a href="#__codelineno-0-3450">3450</a></span>
<span class="normal"><a href="#__codelineno-0-3451">3451</a></span>
<span class="normal"><a href="#__codelineno-0-3452">3452</a></span>
<span class="normal"><a href="#__codelineno-0-3453">3453</a></span>
<span class="normal"><a href="#__codelineno-0-3454">3454</a></span>
<span class="normal"><a href="#__codelineno-0-3455">3455</a></span>
<span class="normal"><a href="#__codelineno-0-3456">3456</a></span>
<span class="normal"><a href="#__codelineno-0-3457">3457</a></span>
<span class="normal"><a href="#__codelineno-0-3458">3458</a></span>
<span class="normal"><a href="#__codelineno-0-3459">3459</a></span>
<span class="normal"><a href="#__codelineno-0-3460">3460</a></span>
<span class="normal"><a href="#__codelineno-0-3461">3461</a></span>
<span class="normal"><a href="#__codelineno-0-3462">3462</a></span>
<span class="normal"><a href="#__codelineno-0-3463">3463</a></span>
<span class="normal"><a href="#__codelineno-0-3464">3464</a></span>
<span class="normal"><a href="#__codelineno-0-3465">3465</a></span>
<span class="normal"><a href="#__codelineno-0-3466">3466</a></span>
<span class="normal"><a href="#__codelineno-0-3467">3467</a></span>
<span class="normal"><a href="#__codelineno-0-3468">3468</a></span>
<span class="normal"><a href="#__codelineno-0-3469">3469</a></span>
<span class="normal"><a href="#__codelineno-0-3470">3470</a></span>
<span class="normal"><a href="#__codelineno-0-3471">3471</a></span>
<span class="normal"><a href="#__codelineno-0-3472">3472</a></span>
<span class="normal"><a href="#__codelineno-0-3473">3473</a></span>
<span class="normal"><a href="#__codelineno-0-3474">3474</a></span>
<span class="normal"><a href="#__codelineno-0-3475">3475</a></span>
<span class="normal"><a href="#__codelineno-0-3476">3476</a></span>
<span class="normal"><a href="#__codelineno-0-3477">3477</a></span>
<span class="normal"><a href="#__codelineno-0-3478">3478</a></span>
<span class="normal"><a href="#__codelineno-0-3479">3479</a></span>
<span class="normal"><a href="#__codelineno-0-3480">3480</a></span>
<span class="normal"><a href="#__codelineno-0-3481">3481</a></span>
<span class="normal"><a href="#__codelineno-0-3482">3482</a></span>
<span class="normal"><a href="#__codelineno-0-3483">3483</a></span>
<span class="normal"><a href="#__codelineno-0-3484">3484</a></span>
<span class="normal"><a href="#__codelineno-0-3485">3485</a></span>
<span class="normal"><a href="#__codelineno-0-3486">3486</a></span>
<span class="normal"><a href="#__codelineno-0-3487">3487</a></span>
<span class="normal"><a href="#__codelineno-0-3488">3488</a></span>
<span class="normal"><a href="#__codelineno-0-3489">3489</a></span>
<span class="normal"><a href="#__codelineno-0-3490">3490</a></span>
<span class="normal"><a href="#__codelineno-0-3491">3491</a></span>
<span class="normal"><a href="#__codelineno-0-3492">3492</a></span>
<span class="normal"><a href="#__codelineno-0-3493">3493</a></span>
<span class="normal"><a href="#__codelineno-0-3494">3494</a></span>
<span class="normal"><a href="#__codelineno-0-3495">3495</a></span>
<span class="normal"><a href="#__codelineno-0-3496">3496</a></span>
<span class="normal"><a href="#__codelineno-0-3497">3497</a></span>
<span class="normal"><a href="#__codelineno-0-3498">3498</a></span>
<span class="normal"><a href="#__codelineno-0-3499">3499</a></span>
<span class="normal"><a href="#__codelineno-0-3500">3500</a></span>
<span class="normal"><a href="#__codelineno-0-3501">3501</a></span>
<span class="normal"><a href="#__codelineno-0-3502">3502</a></span>
<span class="normal"><a href="#__codelineno-0-3503">3503</a></span>
<span class="normal"><a href="#__codelineno-0-3504">3504</a></span>
<span class="normal"><a href="#__codelineno-0-3505">3505</a></span>
<span class="normal"><a href="#__codelineno-0-3506">3506</a></span>
<span class="normal"><a href="#__codelineno-0-3507">3507</a></span>
<span class="normal"><a href="#__codelineno-0-3508">3508</a></span>
<span class="normal"><a href="#__codelineno-0-3509">3509</a></span>
<span class="normal"><a href="#__codelineno-0-3510">3510</a></span>
<span class="normal"><a href="#__codelineno-0-3511">3511</a></span>
<span class="normal"><a href="#__codelineno-0-3512">3512</a></span>
<span class="normal"><a href="#__codelineno-0-3513">3513</a></span>
<span class="normal"><a href="#__codelineno-0-3514">3514</a></span>
<span class="normal"><a href="#__codelineno-0-3515">3515</a></span>
<span class="normal"><a href="#__codelineno-0-3516">3516</a></span>
<span class="normal"><a href="#__codelineno-0-3517">3517</a></span>
<span class="normal"><a href="#__codelineno-0-3518">3518</a></span>
<span class="normal"><a href="#__codelineno-0-3519">3519</a></span>
<span class="normal"><a href="#__codelineno-0-3520">3520</a></span>
<span class="normal"><a href="#__codelineno-0-3521">3521</a></span>
<span class="normal"><a href="#__codelineno-0-3522">3522</a></span>
<span class="normal"><a href="#__codelineno-0-3523">3523</a></span>
<span class="normal"><a href="#__codelineno-0-3524">3524</a></span>
<span class="normal"><a href="#__codelineno-0-3525">3525</a></span>
<span class="normal"><a href="#__codelineno-0-3526">3526</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2996" name="__codelineno-0-2996"></a><span class="k">class</span> <span class="nc">ARSCResTableConfig</span><span class="p">:</span>
<a id="__codelineno-0-2997" name="__codelineno-0-2997"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2998" name="__codelineno-0-2998"></a><span class="sd">    ARSCResTableConfig contains the configuration for specific resource selection.</span>
<a id="__codelineno-0-2999" name="__codelineno-0-2999"></a><span class="sd">    This is used on the device to determine which resources should be loaded</span>
<a id="__codelineno-0-3000" name="__codelineno-0-3000"></a><span class="sd">    based on different properties of the device like locale or displaysize.</span>
<a id="__codelineno-0-3001" name="__codelineno-0-3001"></a>
<a id="__codelineno-0-3002" name="__codelineno-0-3002"></a><span class="sd">    See the definition of `ResTable_config` in</span>
<a id="__codelineno-0-3003" name="__codelineno-0-3003"></a><span class="sd">    http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#911</span>
<a id="__codelineno-0-3004" name="__codelineno-0-3004"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-3005" name="__codelineno-0-3005"></a>
<a id="__codelineno-0-3006" name="__codelineno-0-3006"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-3007" name="__codelineno-0-3007"></a>    <span class="k">def</span> <span class="nf">default_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<a id="__codelineno-0-3008" name="__codelineno-0-3008"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;DEFAULT&#39;</span><span class="p">):</span>
<a id="__codelineno-0-3009" name="__codelineno-0-3009"></a>            <span class="bp">cls</span><span class="o">.</span><span class="n">DEFAULT</span> <span class="o">=</span> <span class="n">ARSCResTableConfig</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-3010" name="__codelineno-0-3010"></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">DEFAULT</span>
<a id="__codelineno-0-3011" name="__codelineno-0-3011"></a>
<a id="__codelineno-0-3012" name="__codelineno-0-3012"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buff</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BinaryIO</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-3013" name="__codelineno-0-3013"></a>        <span class="k">if</span> <span class="n">buff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-3014" name="__codelineno-0-3014"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-3015" name="__codelineno-0-3015"></a>
<a id="__codelineno-0-3016" name="__codelineno-0-3016"></a>            <span class="c1"># uint32_t</span>
<a id="__codelineno-0-3017" name="__codelineno-0-3017"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3018" name="__codelineno-0-3018"></a>
<a id="__codelineno-0-3019" name="__codelineno-0-3019"></a>            <span class="c1"># union: uint16_t mcc, uint16_t mnc</span>
<a id="__codelineno-0-3020" name="__codelineno-0-3020"></a>            <span class="c1"># 0 means any</span>
<a id="__codelineno-0-3021" name="__codelineno-0-3021"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">imsi</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3022" name="__codelineno-0-3022"></a>
<a id="__codelineno-0-3023" name="__codelineno-0-3023"></a>            <span class="c1"># uint32_t as chars \0\0 means any</span>
<a id="__codelineno-0-3024" name="__codelineno-0-3024"></a>            <span class="c1"># either two 7bit ASCII representing the ISO-639-1 language code</span>
<a id="__codelineno-0-3025" name="__codelineno-0-3025"></a>            <span class="c1"># or a single 16bit LE value representing ISO-639-2 3 letter code</span>
<a id="__codelineno-0-3026" name="__codelineno-0-3026"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3027" name="__codelineno-0-3027"></a>
<a id="__codelineno-0-3028" name="__codelineno-0-3028"></a>            <span class="c1"># struct of:</span>
<a id="__codelineno-0-3029" name="__codelineno-0-3029"></a>            <span class="c1"># uint8_t orientation</span>
<a id="__codelineno-0-3030" name="__codelineno-0-3030"></a>            <span class="c1"># uint8_t touchscreen</span>
<a id="__codelineno-0-3031" name="__codelineno-0-3031"></a>            <span class="c1"># uint16_t density</span>
<a id="__codelineno-0-3032" name="__codelineno-0-3032"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">screenType</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3033" name="__codelineno-0-3033"></a>
<a id="__codelineno-0-3034" name="__codelineno-0-3034"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">20</span><span class="p">:</span>
<a id="__codelineno-0-3035" name="__codelineno-0-3035"></a>                <span class="c1"># struct of</span>
<a id="__codelineno-0-3036" name="__codelineno-0-3036"></a>                <span class="c1"># uint8_t keyboard</span>
<a id="__codelineno-0-3037" name="__codelineno-0-3037"></a>                <span class="c1"># uint8_t navigation</span>
<a id="__codelineno-0-3038" name="__codelineno-0-3038"></a>                <span class="c1"># uint8_t inputFlags</span>
<a id="__codelineno-0-3039" name="__codelineno-0-3039"></a>                <span class="c1"># uint8_t inputPad0</span>
<a id="__codelineno-0-3040" name="__codelineno-0-3040"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3041" name="__codelineno-0-3041"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3042" name="__codelineno-0-3042"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-3043" name="__codelineno-0-3043"></a>                    <span class="s2">&quot;This file does not have input flags! size=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-3044" name="__codelineno-0-3044"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-3045" name="__codelineno-0-3045"></a>                    <span class="p">)</span>
<a id="__codelineno-0-3046" name="__codelineno-0-3046"></a>                <span class="p">)</span>
<a id="__codelineno-0-3047" name="__codelineno-0-3047"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-3048" name="__codelineno-0-3048"></a>
<a id="__codelineno-0-3049" name="__codelineno-0-3049"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">24</span><span class="p">:</span>
<a id="__codelineno-0-3050" name="__codelineno-0-3050"></a>                <span class="c1"># struct of</span>
<a id="__codelineno-0-3051" name="__codelineno-0-3051"></a>                <span class="c1"># uint16_t screenWidth</span>
<a id="__codelineno-0-3052" name="__codelineno-0-3052"></a>                <span class="c1"># uint16_t screenHeight</span>
<a id="__codelineno-0-3053" name="__codelineno-0-3053"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">screenSize</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3054" name="__codelineno-0-3054"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3055" name="__codelineno-0-3055"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-3056" name="__codelineno-0-3056"></a>                    <span class="s2">&quot;This file does not have screenSize! size=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-3057" name="__codelineno-0-3057"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-3058" name="__codelineno-0-3058"></a>                    <span class="p">)</span>
<a id="__codelineno-0-3059" name="__codelineno-0-3059"></a>                <span class="p">)</span>
<a id="__codelineno-0-3060" name="__codelineno-0-3060"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">screenSize</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-3061" name="__codelineno-0-3061"></a>
<a id="__codelineno-0-3062" name="__codelineno-0-3062"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">28</span><span class="p">:</span>
<a id="__codelineno-0-3063" name="__codelineno-0-3063"></a>                <span class="c1"># struct of</span>
<a id="__codelineno-0-3064" name="__codelineno-0-3064"></a>                <span class="c1"># uint16_t sdkVersion</span>
<a id="__codelineno-0-3065" name="__codelineno-0-3065"></a>                <span class="c1"># uint16_t minorVersion  which should be always 0, as the meaning is not defined</span>
<a id="__codelineno-0-3066" name="__codelineno-0-3066"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3067" name="__codelineno-0-3067"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3068" name="__codelineno-0-3068"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-3069" name="__codelineno-0-3069"></a>                    <span class="s2">&quot;This file does not have version! size=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-3070" name="__codelineno-0-3070"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-3071" name="__codelineno-0-3071"></a>                    <span class="p">)</span>
<a id="__codelineno-0-3072" name="__codelineno-0-3072"></a>                <span class="p">)</span>
<a id="__codelineno-0-3073" name="__codelineno-0-3073"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-3074" name="__codelineno-0-3074"></a>
<a id="__codelineno-0-3075" name="__codelineno-0-3075"></a>            <span class="c1"># The next three fields seems to be optional</span>
<a id="__codelineno-0-3076" name="__codelineno-0-3076"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">32</span><span class="p">:</span>
<a id="__codelineno-0-3077" name="__codelineno-0-3077"></a>                <span class="c1"># struct of</span>
<a id="__codelineno-0-3078" name="__codelineno-0-3078"></a>                <span class="c1"># uint8_t screenLayout</span>
<a id="__codelineno-0-3079" name="__codelineno-0-3079"></a>                <span class="c1"># uint8_t uiMode</span>
<a id="__codelineno-0-3080" name="__codelineno-0-3080"></a>                <span class="c1"># uint16_t smallestScreenWidthDp</span>
<a id="__codelineno-0-3081" name="__codelineno-0-3081"></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenConfig</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-3082" name="__codelineno-0-3082"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3083" name="__codelineno-0-3083"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-3084" name="__codelineno-0-3084"></a>                    <span class="s2">&quot;This file does not have a screenConfig! size=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-3085" name="__codelineno-0-3085"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-3086" name="__codelineno-0-3086"></a>                    <span class="p">)</span>
<a id="__codelineno-0-3087" name="__codelineno-0-3087"></a>                <span class="p">)</span>
<a id="__codelineno-0-3088" name="__codelineno-0-3088"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">screenConfig</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-3089" name="__codelineno-0-3089"></a>
<a id="__codelineno-0-3090" name="__codelineno-0-3090"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">36</span><span class="p">:</span>
<a id="__codelineno-0-3091" name="__codelineno-0-3091"></a>                <span class="c1"># struct of</span>
<a id="__codelineno-0-3092" name="__codelineno-0-3092"></a>                <span class="c1"># uint16_t screenWidthDp</span>
<a id="__codelineno-0-3093" name="__codelineno-0-3093"></a>                <span class="c1"># uint16_t screenHeightDp</span>
<a id="__codelineno-0-3094" name="__codelineno-0-3094"></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenSizeDp</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-3095" name="__codelineno-0-3095"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3096" name="__codelineno-0-3096"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-3097" name="__codelineno-0-3097"></a>                    <span class="s2">&quot;This file does not have a screenSizeDp! size=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-3098" name="__codelineno-0-3098"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-3099" name="__codelineno-0-3099"></a>                    <span class="p">)</span>
<a id="__codelineno-0-3100" name="__codelineno-0-3100"></a>                <span class="p">)</span>
<a id="__codelineno-0-3101" name="__codelineno-0-3101"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">screenSizeDp</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-3102" name="__codelineno-0-3102"></a>
<a id="__codelineno-0-3103" name="__codelineno-0-3103"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">40</span><span class="p">:</span>
<a id="__codelineno-0-3104" name="__codelineno-0-3104"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">localeScript</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-3105" name="__codelineno-0-3105"></a>
<a id="__codelineno-0-3106" name="__codelineno-0-3106"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">44</span><span class="p">:</span>
<a id="__codelineno-0-3107" name="__codelineno-0-3107"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">localeVariant</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-3108" name="__codelineno-0-3108"></a>
<a id="__codelineno-0-3109" name="__codelineno-0-3109"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="mi">52</span><span class="p">:</span>
<a id="__codelineno-0-3110" name="__codelineno-0-3110"></a>                <span class="c1"># struct of</span>
<a id="__codelineno-0-3111" name="__codelineno-0-3111"></a>                <span class="c1"># uint8_t screenLayout2</span>
<a id="__codelineno-0-3112" name="__codelineno-0-3112"></a>                <span class="c1"># uint8_t colorMode</span>
<a id="__codelineno-0-3113" name="__codelineno-0-3113"></a>                <span class="c1"># uint16_t screenConfigPad2</span>
<a id="__codelineno-0-3114" name="__codelineno-0-3114"></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenConfig2</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&lt;I&quot;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-3115" name="__codelineno-0-3115"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3116" name="__codelineno-0-3116"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-3117" name="__codelineno-0-3117"></a>                    <span class="s2">&quot;This file does not have a screenConfig2! size=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-3118" name="__codelineno-0-3118"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-3119" name="__codelineno-0-3119"></a>                    <span class="p">)</span>
<a id="__codelineno-0-3120" name="__codelineno-0-3120"></a>                <span class="p">)</span>
<a id="__codelineno-0-3121" name="__codelineno-0-3121"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">screenConfig2</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-3122" name="__codelineno-0-3122"></a>
<a id="__codelineno-0-3123" name="__codelineno-0-3123"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exceedingSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="p">(</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
<a id="__codelineno-0-3124" name="__codelineno-0-3124"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exceedingSize</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3125" name="__codelineno-0-3125"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Skipping padding bytes!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3126" name="__codelineno-0-3126"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exceedingSize</span><span class="p">)</span>
<a id="__codelineno-0-3127" name="__codelineno-0-3127"></a>
<a id="__codelineno-0-3128" name="__codelineno-0-3128"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3129" name="__codelineno-0-3129"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-3130" name="__codelineno-0-3130"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-3131" name="__codelineno-0-3131"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">imsi</span> <span class="o">=</span> <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;mcc&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
<a id="__codelineno-0-3132" name="__codelineno-0-3132"></a>                <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;mnc&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3133" name="__codelineno-0-3133"></a>            <span class="p">)</span>
<a id="__codelineno-0-3134" name="__codelineno-0-3134"></a>
<a id="__codelineno-0-3135" name="__codelineno-0-3135"></a>            <span class="n">temp_locale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;locale&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-3136" name="__codelineno-0-3136"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">temp_locale</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-3137" name="__codelineno-0-3137"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_language_and_region</span><span class="p">(</span><span class="n">temp_locale</span><span class="p">)</span>
<a id="__codelineno-0-3138" name="__codelineno-0-3138"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3139" name="__codelineno-0-3139"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">=</span> <span class="n">temp_locale</span>
<a id="__codelineno-0-3140" name="__codelineno-0-3140"></a>
<a id="__codelineno-0-3141" name="__codelineno-0-3141"></a>            <span class="k">for</span> <span class="n">char_ix</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;locale&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]:</span>
<a id="__codelineno-0-3142" name="__codelineno-0-3142"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">+=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">char_ix</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-3143" name="__codelineno-0-3143"></a>
<a id="__codelineno-0-3144" name="__codelineno-0-3144"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">screenType</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-3145" name="__codelineno-0-3145"></a>                <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;orientation&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-3146" name="__codelineno-0-3146"></a>                <span class="o">+</span> <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;touchscreen&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-3147" name="__codelineno-0-3147"></a>                <span class="o">+</span> <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-0-3148" name="__codelineno-0-3148"></a>            <span class="p">)</span>
<a id="__codelineno-0-3149" name="__codelineno-0-3149"></a>
<a id="__codelineno-0-3150" name="__codelineno-0-3150"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-3151" name="__codelineno-0-3151"></a>                <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;keyboard&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-3152" name="__codelineno-0-3152"></a>                <span class="o">+</span> <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;navigation&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-3153" name="__codelineno-0-3153"></a>                <span class="o">+</span> <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;inputFlags&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-0-3154" name="__codelineno-0-3154"></a>                <span class="o">+</span> <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;inputPad0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span>
<a id="__codelineno-0-3155" name="__codelineno-0-3155"></a>            <span class="p">)</span>
<a id="__codelineno-0-3156" name="__codelineno-0-3156"></a>
<a id="__codelineno-0-3157" name="__codelineno-0-3157"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">screenSize</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-3158" name="__codelineno-0-3158"></a>                <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;screenWidth&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span>
<a id="__codelineno-0-3159" name="__codelineno-0-3159"></a>            <span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;screenHeight&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-0-3160" name="__codelineno-0-3160"></a>
<a id="__codelineno-0-3161" name="__codelineno-0-3161"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;sdkVersion&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
<a id="__codelineno-0-3162" name="__codelineno-0-3162"></a>                <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;minorVersion&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3163" name="__codelineno-0-3163"></a>            <span class="p">)</span>
<a id="__codelineno-0-3164" name="__codelineno-0-3164"></a>
<a id="__codelineno-0-3165" name="__codelineno-0-3165"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">screenConfig</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-3166" name="__codelineno-0-3166"></a>                <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;screenLayout&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-3167" name="__codelineno-0-3167"></a>                <span class="o">+</span> <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;uiMode&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-3168" name="__codelineno-0-3168"></a>                <span class="o">+</span> <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;smallestScreenWidthDp&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-0-3169" name="__codelineno-0-3169"></a>            <span class="p">)</span>
<a id="__codelineno-0-3170" name="__codelineno-0-3170"></a>
<a id="__codelineno-0-3171" name="__codelineno-0-3171"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">screenSizeDp</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-3172" name="__codelineno-0-3172"></a>                <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;screenWidthDp&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span>
<a id="__codelineno-0-3173" name="__codelineno-0-3173"></a>            <span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;screenHeightDp&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-0-3174" name="__codelineno-0-3174"></a>
<a id="__codelineno-0-3175" name="__codelineno-0-3175"></a>            <span class="c1"># TODO add this some day...</span>
<a id="__codelineno-0-3176" name="__codelineno-0-3176"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">screenConfig2</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-3177" name="__codelineno-0-3177"></a>
<a id="__codelineno-0-3178" name="__codelineno-0-3178"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exceedingSize</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-3179" name="__codelineno-0-3179"></a>
<a id="__codelineno-0-3180" name="__codelineno-0-3180"></a>    <span class="k">def</span> <span class="nf">_unpack_language_or_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char_in</span><span class="p">,</span> <span class="n">char_base</span><span class="p">):</span>
<a id="__codelineno-0-3181" name="__codelineno-0-3181"></a>        <span class="n">char_out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-3182" name="__codelineno-0-3182"></a>        <span class="k">if</span> <span class="n">char_in</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x80</span><span class="p">:</span>
<a id="__codelineno-0-3183" name="__codelineno-0-3183"></a>            <span class="n">first</span> <span class="o">=</span> <span class="n">char_in</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x1F</span>
<a id="__codelineno-0-3184" name="__codelineno-0-3184"></a>            <span class="n">second</span> <span class="o">=</span> <span class="p">((</span><span class="n">char_in</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xE0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">char_in</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x03</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-3185" name="__codelineno-0-3185"></a>            <span class="n">third</span> <span class="o">=</span> <span class="p">(</span><span class="n">char_in</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x7C</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span>
<a id="__codelineno-0-3186" name="__codelineno-0-3186"></a>            <span class="n">char_out</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">char_base</span><span class="p">)</span>
<a id="__codelineno-0-3187" name="__codelineno-0-3187"></a>            <span class="n">char_out</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">second</span> <span class="o">+</span> <span class="n">char_base</span><span class="p">)</span>
<a id="__codelineno-0-3188" name="__codelineno-0-3188"></a>            <span class="n">char_out</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">third</span> <span class="o">+</span> <span class="n">char_base</span><span class="p">)</span>
<a id="__codelineno-0-3189" name="__codelineno-0-3189"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3190" name="__codelineno-0-3190"></a>            <span class="k">if</span> <span class="n">char_in</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-3191" name="__codelineno-0-3191"></a>                <span class="n">char_out</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">char_in</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-3192" name="__codelineno-0-3192"></a>            <span class="k">if</span> <span class="n">char_in</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<a id="__codelineno-0-3193" name="__codelineno-0-3193"></a>                <span class="n">char_out</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">char_in</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-3194" name="__codelineno-0-3194"></a>        <span class="k">return</span> <span class="n">char_out</span>
<a id="__codelineno-0-3195" name="__codelineno-0-3195"></a>
<a id="__codelineno-0-3196" name="__codelineno-0-3196"></a>    <span class="k">def</span> <span class="nf">_pack_language_or_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char_in</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-3197" name="__codelineno-0-3197"></a>        <span class="n">char_out</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">]</span>
<a id="__codelineno-0-3198" name="__codelineno-0-3198"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">char_in</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-3199" name="__codelineno-0-3199"></a>            <span class="k">return</span> <span class="n">char_out</span>
<a id="__codelineno-0-3200" name="__codelineno-0-3200"></a>        <span class="n">char_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char_in</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-3201" name="__codelineno-0-3201"></a>        <span class="n">char_out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char_in</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-3202" name="__codelineno-0-3202"></a>        <span class="k">return</span> <span class="n">char_out</span>
<a id="__codelineno-0-3203" name="__codelineno-0-3203"></a>
<a id="__codelineno-0-3204" name="__codelineno-0-3204"></a>    <span class="k">def</span> <span class="nf">set_language_and_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">language_region</span><span class="p">):</span>
<a id="__codelineno-0-3205" name="__codelineno-0-3205"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-3206" name="__codelineno-0-3206"></a>            <span class="n">language</span><span class="p">,</span> <span class="n">region</span> <span class="o">=</span> <span class="n">language_region</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-r&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3207" name="__codelineno-0-3207"></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-3208" name="__codelineno-0-3208"></a>            <span class="n">language</span><span class="p">,</span> <span class="n">region</span> <span class="o">=</span> <span class="n">language_region</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-3209" name="__codelineno-0-3209"></a>        <span class="n">language_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pack_language_or_region</span><span class="p">(</span><span class="n">language</span><span class="p">)</span>
<a id="__codelineno-0-3210" name="__codelineno-0-3210"></a>        <span class="k">if</span> <span class="n">region</span><span class="p">:</span>
<a id="__codelineno-0-3211" name="__codelineno-0-3211"></a>            <span class="n">region_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pack_language_or_region</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
<a id="__codelineno-0-3212" name="__codelineno-0-3212"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3213" name="__codelineno-0-3213"></a>            <span class="n">region_bytes</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">]</span>
<a id="__codelineno-0-3214" name="__codelineno-0-3214"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-3215" name="__codelineno-0-3215"></a>            <span class="n">language_bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3216" name="__codelineno-0-3216"></a>            <span class="o">|</span> <span class="p">(</span><span class="n">language_bytes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-3217" name="__codelineno-0-3217"></a>            <span class="o">|</span> <span class="p">(</span><span class="n">region_bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-0-3218" name="__codelineno-0-3218"></a>            <span class="o">|</span> <span class="p">(</span><span class="n">region_bytes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span>
<a id="__codelineno-0-3219" name="__codelineno-0-3219"></a>        <span class="p">)</span>
<a id="__codelineno-0-3220" name="__codelineno-0-3220"></a>
<a id="__codelineno-0-3221" name="__codelineno-0-3221"></a>    <span class="k">def</span> <span class="nf">get_language_and_region</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3222" name="__codelineno-0-3222"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3223" name="__codelineno-0-3223"></a><span class="sd">        Returns the combined language+region string or \x00\x00 for the default locale</span>
<a id="__codelineno-0-3224" name="__codelineno-0-3224"></a><span class="sd">        :returns: the combined language and region string</span>
<a id="__codelineno-0-3225" name="__codelineno-0-3225"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-3226" name="__codelineno-0-3226"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3227" name="__codelineno-0-3227"></a>            <span class="n">_language</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_language_or_region</span><span class="p">(</span>
<a id="__codelineno-0-3228" name="__codelineno-0-3228"></a>                <span class="p">[</span>
<a id="__codelineno-0-3229" name="__codelineno-0-3229"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span>
<a id="__codelineno-0-3230" name="__codelineno-0-3230"></a>                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">,</span>
<a id="__codelineno-0-3231" name="__codelineno-0-3231"></a>                <span class="p">],</span>
<a id="__codelineno-0-3232" name="__codelineno-0-3232"></a>                <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span>
<a id="__codelineno-0-3233" name="__codelineno-0-3233"></a>            <span class="p">)</span>
<a id="__codelineno-0-3234" name="__codelineno-0-3234"></a>            <span class="n">_region</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_language_or_region</span><span class="p">(</span>
<a id="__codelineno-0-3235" name="__codelineno-0-3235"></a>                <span class="p">[</span>
<a id="__codelineno-0-3236" name="__codelineno-0-3236"></a>                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">&amp;</span> <span class="mh">0xFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">,</span>
<a id="__codelineno-0-3237" name="__codelineno-0-3237"></a>                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">&amp;</span> <span class="mh">0xFF000000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">,</span>
<a id="__codelineno-0-3238" name="__codelineno-0-3238"></a>                <span class="p">],</span>
<a id="__codelineno-0-3239" name="__codelineno-0-3239"></a>                <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span>
<a id="__codelineno-0-3240" name="__codelineno-0-3240"></a>            <span class="p">)</span>
<a id="__codelineno-0-3241" name="__codelineno-0-3241"></a>            <span class="k">return</span> <span class="p">(</span><span class="n">_language</span> <span class="o">+</span> <span class="s2">&quot;-r&quot;</span> <span class="o">+</span> <span class="n">_region</span><span class="p">)</span> <span class="k">if</span> <span class="n">_region</span> <span class="k">else</span> <span class="n">_language</span>
<a id="__codelineno-0-3242" name="__codelineno-0-3242"></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\x00\x00</span><span class="s2">&quot;</span>
<a id="__codelineno-0-3243" name="__codelineno-0-3243"></a>
<a id="__codelineno-0-3244" name="__codelineno-0-3244"></a>    <span class="k">def</span> <span class="nf">get_config_name_friendly</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3245" name="__codelineno-0-3245"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3246" name="__codelineno-0-3246"></a><span class="sd">        Here for legacy reasons.</span>
<a id="__codelineno-0-3247" name="__codelineno-0-3247"></a>
<a id="__codelineno-0-3248" name="__codelineno-0-3248"></a><span class="sd">        use [get_qualifier][androguard.core.axml.ARSCResTableConfig.get_qualifier] instead.</span>
<a id="__codelineno-0-3249" name="__codelineno-0-3249"></a><span class="sd">        :returns: the qualifier string</span>
<a id="__codelineno-0-3250" name="__codelineno-0-3250"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-3251" name="__codelineno-0-3251"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_qualifier</span><span class="p">()</span>
<a id="__codelineno-0-3252" name="__codelineno-0-3252"></a>
<a id="__codelineno-0-3253" name="__codelineno-0-3253"></a>    <span class="k">def</span> <span class="nf">get_qualifier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3254" name="__codelineno-0-3254"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3255" name="__codelineno-0-3255"></a><span class="sd">        Return resource name qualifier for the current configuration.</span>
<a id="__codelineno-0-3256" name="__codelineno-0-3256"></a><span class="sd">        for example</span>
<a id="__codelineno-0-3257" name="__codelineno-0-3257"></a>
<a id="__codelineno-0-3258" name="__codelineno-0-3258"></a><span class="sd">        * `ldpi-v4`</span>
<a id="__codelineno-0-3259" name="__codelineno-0-3259"></a><span class="sd">        * `hdpi-v4`</span>
<a id="__codelineno-0-3260" name="__codelineno-0-3260"></a>
<a id="__codelineno-0-3261" name="__codelineno-0-3261"></a><span class="sd">        All possible qualifiers are listed in table 2 of &lt;https://developer.android.com/guide/topics/resources/providing-resources&gt;</span>
<a id="__codelineno-0-3262" name="__codelineno-0-3262"></a>
<a id="__codelineno-0-3263" name="__codelineno-0-3263"></a><span class="sd">        You can find how android process this at [ResourceTypes 3243](http://aospxref.com/android-13.0.0_r3/xref/frameworks/base/libs/androidfw/ResourceTypes.cpp#3243)</span>
<a id="__codelineno-0-3264" name="__codelineno-0-3264"></a>
<a id="__codelineno-0-3265" name="__codelineno-0-3265"></a><span class="sd">        :return: the resource name qualifer string</span>
<a id="__codelineno-0-3266" name="__codelineno-0-3266"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-3267" name="__codelineno-0-3267"></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-3268" name="__codelineno-0-3268"></a>
<a id="__codelineno-0-3269" name="__codelineno-0-3269"></a>        <span class="n">mcc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">imsi</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>
<a id="__codelineno-0-3270" name="__codelineno-0-3270"></a>        <span class="n">mnc</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imsi</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3271" name="__codelineno-0-3271"></a>        <span class="k">if</span> <span class="n">mcc</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3272" name="__codelineno-0-3272"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;mcc</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mcc</span><span class="p">)</span>
<a id="__codelineno-0-3273" name="__codelineno-0-3273"></a>        <span class="k">if</span> <span class="n">mnc</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3274" name="__codelineno-0-3274"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;mnc</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mnc</span><span class="p">)</span>
<a id="__codelineno-0-3275" name="__codelineno-0-3275"></a>
<a id="__codelineno-0-3276" name="__codelineno-0-3276"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3277" name="__codelineno-0-3277"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_language_and_region</span><span class="p">())</span>
<a id="__codelineno-0-3278" name="__codelineno-0-3278"></a>
<a id="__codelineno-0-3279" name="__codelineno-0-3279"></a>        <span class="n">screenLayout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenConfig</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
<a id="__codelineno-0-3280" name="__codelineno-0-3280"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_LAYOUTDIR</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3281" name="__codelineno-0-3281"></a>            <span class="k">if</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_LAYOUTDIR</span> <span class="o">==</span> <span class="n">LAYOUTDIR_LTR</span><span class="p">:</span>
<a id="__codelineno-0-3282" name="__codelineno-0-3282"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ldltr&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3283" name="__codelineno-0-3283"></a>            <span class="k">elif</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_LAYOUTDIR</span> <span class="o">==</span> <span class="n">LAYOUTDIR_RTL</span><span class="p">:</span>
<a id="__codelineno-0-3284" name="__codelineno-0-3284"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ldrtl&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3285" name="__codelineno-0-3285"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3286" name="__codelineno-0-3286"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;layoutDir_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_LAYOUTDIR</span><span class="p">))</span>
<a id="__codelineno-0-3287" name="__codelineno-0-3287"></a>
<a id="__codelineno-0-3288" name="__codelineno-0-3288"></a>        <span class="n">smallestScreenWidthDp</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenConfig</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3289" name="__codelineno-0-3289"></a>        <span class="k">if</span> <span class="n">smallestScreenWidthDp</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3290" name="__codelineno-0-3290"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;sw</span><span class="si">%d</span><span class="s2">dp&quot;</span> <span class="o">%</span> <span class="n">smallestScreenWidthDp</span><span class="p">)</span>
<a id="__codelineno-0-3291" name="__codelineno-0-3291"></a>
<a id="__codelineno-0-3292" name="__codelineno-0-3292"></a>        <span class="n">screenWidthDp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenSizeDp</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>
<a id="__codelineno-0-3293" name="__codelineno-0-3293"></a>        <span class="n">screenHeightDp</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenSizeDp</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3294" name="__codelineno-0-3294"></a>        <span class="k">if</span> <span class="n">screenWidthDp</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3295" name="__codelineno-0-3295"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;w</span><span class="si">%d</span><span class="s2">dp&quot;</span> <span class="o">%</span> <span class="n">screenWidthDp</span><span class="p">)</span>
<a id="__codelineno-0-3296" name="__codelineno-0-3296"></a>        <span class="k">if</span> <span class="n">screenHeightDp</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3297" name="__codelineno-0-3297"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;h</span><span class="si">%d</span><span class="s2">dp&quot;</span> <span class="o">%</span> <span class="n">screenHeightDp</span><span class="p">)</span>
<a id="__codelineno-0-3298" name="__codelineno-0-3298"></a>
<a id="__codelineno-0-3299" name="__codelineno-0-3299"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENSIZE</span><span class="p">)</span> <span class="o">!=</span> <span class="n">SCREENSIZE_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3300" name="__codelineno-0-3300"></a>            <span class="k">if</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENSIZE</span> <span class="o">==</span> <span class="n">SCREENSIZE_SMALL</span><span class="p">:</span>
<a id="__codelineno-0-3301" name="__codelineno-0-3301"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;small&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3302" name="__codelineno-0-3302"></a>            <span class="k">elif</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENSIZE</span> <span class="o">==</span> <span class="n">SCREENSIZE_NORMAL</span><span class="p">:</span>
<a id="__codelineno-0-3303" name="__codelineno-0-3303"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3304" name="__codelineno-0-3304"></a>            <span class="k">elif</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENSIZE</span> <span class="o">==</span> <span class="n">SCREENSIZE_LARGE</span><span class="p">:</span>
<a id="__codelineno-0-3305" name="__codelineno-0-3305"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3306" name="__codelineno-0-3306"></a>            <span class="k">elif</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENSIZE</span> <span class="o">==</span> <span class="n">SCREENSIZE_XLARGE</span><span class="p">:</span>
<a id="__codelineno-0-3307" name="__codelineno-0-3307"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;xlarge&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3308" name="__codelineno-0-3308"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3309" name="__codelineno-0-3309"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-3310" name="__codelineno-0-3310"></a>                    <span class="s2">&quot;screenLayoutSize_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENSIZE</span><span class="p">)</span>
<a id="__codelineno-0-3311" name="__codelineno-0-3311"></a>                <span class="p">)</span>
<a id="__codelineno-0-3312" name="__codelineno-0-3312"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENLONG</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3313" name="__codelineno-0-3313"></a>            <span class="k">if</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENLONG</span> <span class="o">==</span> <span class="n">SCREENLONG_NO</span><span class="p">:</span>
<a id="__codelineno-0-3314" name="__codelineno-0-3314"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;notlong&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3315" name="__codelineno-0-3315"></a>            <span class="k">elif</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENLONG</span> <span class="o">==</span> <span class="n">SCREENLONG_YES</span><span class="p">:</span>
<a id="__codelineno-0-3316" name="__codelineno-0-3316"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;long&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3317" name="__codelineno-0-3317"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3318" name="__codelineno-0-3318"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-3319" name="__codelineno-0-3319"></a>                    <span class="s2">&quot;screenLayoutLong_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENLONG</span><span class="p">)</span>
<a id="__codelineno-0-3320" name="__codelineno-0-3320"></a>                <span class="p">)</span>
<a id="__codelineno-0-3321" name="__codelineno-0-3321"></a>
<a id="__codelineno-0-3322" name="__codelineno-0-3322"></a>        <span class="n">screenLayout2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenConfig2</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
<a id="__codelineno-0-3323" name="__codelineno-0-3323"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">screenLayout2</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENROUND</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3324" name="__codelineno-0-3324"></a>            <span class="k">if</span> <span class="n">screenLayout2</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENROUND</span> <span class="o">==</span> <span class="n">SCREENROUND_NO</span><span class="p">:</span>
<a id="__codelineno-0-3325" name="__codelineno-0-3325"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;notround&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3326" name="__codelineno-0-3326"></a>            <span class="k">elif</span> <span class="n">screenLayout2</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENROUND</span> <span class="o">==</span> <span class="n">SCREENROUND_YES</span><span class="p">:</span>
<a id="__codelineno-0-3327" name="__codelineno-0-3327"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;round&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3328" name="__codelineno-0-3328"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3329" name="__codelineno-0-3329"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-3330" name="__codelineno-0-3330"></a>                    <span class="s2">&quot;screenRound_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">screenLayout2</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENROUND</span><span class="p">)</span>
<a id="__codelineno-0-3331" name="__codelineno-0-3331"></a>                <span class="p">)</span>
<a id="__codelineno-0-3332" name="__codelineno-0-3332"></a>
<a id="__codelineno-0-3333" name="__codelineno-0-3333"></a>        <span class="n">colorMode</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenConfig2</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
<a id="__codelineno-0-3334" name="__codelineno-0-3334"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_WIDE_COLOR_GAMUT</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3335" name="__codelineno-0-3335"></a>            <span class="k">if</span> <span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_WIDE_COLOR_GAMUT</span> <span class="o">==</span> <span class="n">WIDE_COLOR_GAMUT_NO</span><span class="p">:</span>
<a id="__codelineno-0-3336" name="__codelineno-0-3336"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;nowidecg&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3337" name="__codelineno-0-3337"></a>            <span class="k">elif</span> <span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_WIDE_COLOR_GAMUT</span> <span class="o">==</span> <span class="n">WIDE_COLOR_GAMUT_YES</span><span class="p">:</span>
<a id="__codelineno-0-3338" name="__codelineno-0-3338"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;widecg&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3339" name="__codelineno-0-3339"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3340" name="__codelineno-0-3340"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-3341" name="__codelineno-0-3341"></a>                    <span class="s2">&quot;wideColorGamut_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_WIDE_COLOR_GAMUT</span><span class="p">)</span>
<a id="__codelineno-0-3342" name="__codelineno-0-3342"></a>                <span class="p">)</span>
<a id="__codelineno-0-3343" name="__codelineno-0-3343"></a>
<a id="__codelineno-0-3344" name="__codelineno-0-3344"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_HDR</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3345" name="__codelineno-0-3345"></a>            <span class="k">if</span> <span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_HDR</span> <span class="o">==</span> <span class="n">HDR_NO</span><span class="p">:</span>
<a id="__codelineno-0-3346" name="__codelineno-0-3346"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;lowdr&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3347" name="__codelineno-0-3347"></a>            <span class="k">elif</span> <span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_HDR</span> <span class="o">==</span> <span class="n">HDR_YES</span><span class="p">:</span>
<a id="__codelineno-0-3348" name="__codelineno-0-3348"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;highdr&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3349" name="__codelineno-0-3349"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3350" name="__codelineno-0-3350"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;hdr_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_HDR</span><span class="p">))</span>
<a id="__codelineno-0-3351" name="__codelineno-0-3351"></a>
<a id="__codelineno-0-3352" name="__codelineno-0-3352"></a>        <span class="n">orientation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenType</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
<a id="__codelineno-0-3353" name="__codelineno-0-3353"></a>        <span class="k">if</span> <span class="n">orientation</span> <span class="o">!=</span> <span class="n">ORIENTATION_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3354" name="__codelineno-0-3354"></a>            <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="n">ORIENTATION_PORT</span><span class="p">:</span>
<a id="__codelineno-0-3355" name="__codelineno-0-3355"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;port&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3356" name="__codelineno-0-3356"></a>            <span class="k">elif</span> <span class="n">orientation</span> <span class="o">==</span> <span class="n">ORIENTATION_LAND</span><span class="p">:</span>
<a id="__codelineno-0-3357" name="__codelineno-0-3357"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;land&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3358" name="__codelineno-0-3358"></a>            <span class="k">elif</span> <span class="n">orientation</span> <span class="o">==</span> <span class="n">ORIENTATION_SQUARE</span><span class="p">:</span>
<a id="__codelineno-0-3359" name="__codelineno-0-3359"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;square&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3360" name="__codelineno-0-3360"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3361" name="__codelineno-0-3361"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;orientation_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">orientation</span><span class="p">)</span>
<a id="__codelineno-0-3362" name="__codelineno-0-3362"></a>
<a id="__codelineno-0-3363" name="__codelineno-0-3363"></a>        <span class="n">uiMode</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenConfig</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
<a id="__codelineno-0-3364" name="__codelineno-0-3364"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">uiMode</span> <span class="o">&amp;</span> <span class="n">MASK_UI_MODE_TYPE</span><span class="p">)</span> <span class="o">!=</span> <span class="n">UI_MODE_TYPE_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3365" name="__codelineno-0-3365"></a>            <span class="n">ui_mode</span> <span class="o">=</span> <span class="n">uiMode</span> <span class="o">&amp;</span> <span class="n">MASK_UI_MODE_TYPE</span>
<a id="__codelineno-0-3366" name="__codelineno-0-3366"></a>            <span class="k">if</span> <span class="n">ui_mode</span> <span class="o">==</span> <span class="n">UI_MODE_TYPE_DESK</span><span class="p">:</span>
<a id="__codelineno-0-3367" name="__codelineno-0-3367"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;desk&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3368" name="__codelineno-0-3368"></a>            <span class="k">elif</span> <span class="n">ui_mode</span> <span class="o">==</span> <span class="n">UI_MODE_TYPE_CAR</span><span class="p">:</span>
<a id="__codelineno-0-3369" name="__codelineno-0-3369"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;car&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3370" name="__codelineno-0-3370"></a>            <span class="k">elif</span> <span class="n">ui_mode</span> <span class="o">==</span> <span class="n">UI_MODE_TYPE_TELEVISION</span><span class="p">:</span>
<a id="__codelineno-0-3371" name="__codelineno-0-3371"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;television&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3372" name="__codelineno-0-3372"></a>            <span class="k">elif</span> <span class="n">ui_mode</span> <span class="o">==</span> <span class="n">UI_MODE_TYPE_APPLIANCE</span><span class="p">:</span>
<a id="__codelineno-0-3373" name="__codelineno-0-3373"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;appliance&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3374" name="__codelineno-0-3374"></a>            <span class="k">elif</span> <span class="n">ui_mode</span> <span class="o">==</span> <span class="n">UI_MODE_TYPE_WATCH</span><span class="p">:</span>
<a id="__codelineno-0-3375" name="__codelineno-0-3375"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;watch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3376" name="__codelineno-0-3376"></a>            <span class="k">elif</span> <span class="n">ui_mode</span> <span class="o">==</span> <span class="n">UI_MODE_TYPE_VR_HEADSET</span><span class="p">:</span>
<a id="__codelineno-0-3377" name="__codelineno-0-3377"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;vrheadset&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3378" name="__codelineno-0-3378"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3379" name="__codelineno-0-3379"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;uiModeType_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ui_mode</span><span class="p">)</span>
<a id="__codelineno-0-3380" name="__codelineno-0-3380"></a>
<a id="__codelineno-0-3381" name="__codelineno-0-3381"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">uiMode</span> <span class="o">&amp;</span> <span class="n">MASK_UI_MODE_NIGHT</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3382" name="__codelineno-0-3382"></a>            <span class="k">if</span> <span class="n">uiMode</span> <span class="o">&amp;</span> <span class="n">MASK_UI_MODE_NIGHT</span> <span class="o">==</span> <span class="n">UI_MODE_NIGHT_NO</span><span class="p">:</span>
<a id="__codelineno-0-3383" name="__codelineno-0-3383"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;notnight&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3384" name="__codelineno-0-3384"></a>            <span class="k">elif</span> <span class="n">uiMode</span> <span class="o">&amp;</span> <span class="n">MASK_UI_MODE_NIGHT</span> <span class="o">==</span> <span class="n">UI_MODE_NIGHT_YES</span><span class="p">:</span>
<a id="__codelineno-0-3385" name="__codelineno-0-3385"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;night&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3386" name="__codelineno-0-3386"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3387" name="__codelineno-0-3387"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;uiModeNight_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">uiMode</span> <span class="o">&amp;</span> <span class="n">MASK_UI_MODE_NIGHT</span><span class="p">))</span>
<a id="__codelineno-0-3388" name="__codelineno-0-3388"></a>
<a id="__codelineno-0-3389" name="__codelineno-0-3389"></a>        <span class="n">density</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenType</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3390" name="__codelineno-0-3390"></a>        <span class="k">if</span> <span class="n">density</span> <span class="o">!=</span> <span class="n">DENSITY_DEFAULT</span><span class="p">:</span>
<a id="__codelineno-0-3391" name="__codelineno-0-3391"></a>            <span class="k">if</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_LOW</span><span class="p">:</span>
<a id="__codelineno-0-3392" name="__codelineno-0-3392"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ldpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3393" name="__codelineno-0-3393"></a>            <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_MEDIUM</span><span class="p">:</span>
<a id="__codelineno-0-3394" name="__codelineno-0-3394"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;mdpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3395" name="__codelineno-0-3395"></a>            <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_TV</span><span class="p">:</span>
<a id="__codelineno-0-3396" name="__codelineno-0-3396"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;tvdpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3397" name="__codelineno-0-3397"></a>            <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_HIGH</span><span class="p">:</span>
<a id="__codelineno-0-3398" name="__codelineno-0-3398"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;hdpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3399" name="__codelineno-0-3399"></a>            <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_XHIGH</span><span class="p">:</span>
<a id="__codelineno-0-3400" name="__codelineno-0-3400"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;xhdpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3401" name="__codelineno-0-3401"></a>            <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_XXHIGH</span><span class="p">:</span>
<a id="__codelineno-0-3402" name="__codelineno-0-3402"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;xxhdpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3403" name="__codelineno-0-3403"></a>            <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_XXXHIGH</span><span class="p">:</span>
<a id="__codelineno-0-3404" name="__codelineno-0-3404"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;xxxhdpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3405" name="__codelineno-0-3405"></a>            <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_NONE</span><span class="p">:</span>
<a id="__codelineno-0-3406" name="__codelineno-0-3406"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;nodpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3407" name="__codelineno-0-3407"></a>            <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3408" name="__codelineno-0-3408"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;anydpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3409" name="__codelineno-0-3409"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3410" name="__codelineno-0-3410"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">dpi&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">density</span><span class="p">))</span>
<a id="__codelineno-0-3411" name="__codelineno-0-3411"></a>
<a id="__codelineno-0-3412" name="__codelineno-0-3412"></a>        <span class="n">touchscreen</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenType</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
<a id="__codelineno-0-3413" name="__codelineno-0-3413"></a>        <span class="k">if</span> <span class="n">touchscreen</span> <span class="o">!=</span> <span class="n">TOUCHSCREEN_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3414" name="__codelineno-0-3414"></a>            <span class="k">if</span> <span class="n">touchscreen</span> <span class="o">==</span> <span class="n">TOUCHSCREEN_NOTOUCH</span><span class="p">:</span>
<a id="__codelineno-0-3415" name="__codelineno-0-3415"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;notouch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3416" name="__codelineno-0-3416"></a>            <span class="k">elif</span> <span class="n">touchscreen</span> <span class="o">==</span> <span class="n">TOUCHSCREEN_FINGER</span><span class="p">:</span>
<a id="__codelineno-0-3417" name="__codelineno-0-3417"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;finger&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3418" name="__codelineno-0-3418"></a>            <span class="k">elif</span> <span class="n">touchscreen</span> <span class="o">==</span> <span class="n">TOUCHSCREEN_STYLUS</span><span class="p">:</span>
<a id="__codelineno-0-3419" name="__codelineno-0-3419"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;stylus&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3420" name="__codelineno-0-3420"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3421" name="__codelineno-0-3421"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;touchscreen_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">touchscreen</span><span class="p">)</span>
<a id="__codelineno-0-3422" name="__codelineno-0-3422"></a>
<a id="__codelineno-0-3423" name="__codelineno-0-3423"></a>        <span class="n">keyboard</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
<a id="__codelineno-0-3424" name="__codelineno-0-3424"></a>        <span class="n">navigation</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
<a id="__codelineno-0-3425" name="__codelineno-0-3425"></a>        <span class="n">inputFlags</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">&amp;</span> <span class="mh">0xFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3426" name="__codelineno-0-3426"></a>
<a id="__codelineno-0-3427" name="__codelineno-0-3427"></a>        <span class="k">if</span> <span class="n">inputFlags</span> <span class="o">&amp;</span> <span class="n">MASK_KEYSHIDDEN</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3428" name="__codelineno-0-3428"></a>            <span class="n">input_flags</span> <span class="o">=</span> <span class="n">inputFlags</span> <span class="o">&amp;</span> <span class="n">MASK_KEYSHIDDEN</span>
<a id="__codelineno-0-3429" name="__codelineno-0-3429"></a>            <span class="k">if</span> <span class="n">input_flags</span> <span class="o">==</span> <span class="n">KEYSHIDDEN_NO</span><span class="p">:</span>
<a id="__codelineno-0-3430" name="__codelineno-0-3430"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;keysexposed&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3431" name="__codelineno-0-3431"></a>            <span class="k">elif</span> <span class="n">input_flags</span> <span class="o">==</span> <span class="n">KEYSHIDDEN_YES</span><span class="p">:</span>
<a id="__codelineno-0-3432" name="__codelineno-0-3432"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;keyshidden&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3433" name="__codelineno-0-3433"></a>            <span class="k">elif</span> <span class="n">input_flags</span> <span class="o">==</span> <span class="n">KEYSHIDDEN_SOFT</span><span class="p">:</span>
<a id="__codelineno-0-3434" name="__codelineno-0-3434"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;keyssoft&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3435" name="__codelineno-0-3435"></a>
<a id="__codelineno-0-3436" name="__codelineno-0-3436"></a>        <span class="k">if</span> <span class="n">keyboard</span> <span class="o">!=</span> <span class="n">KEYBOARD_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3437" name="__codelineno-0-3437"></a>            <span class="k">if</span> <span class="n">keyboard</span> <span class="o">==</span> <span class="n">KEYBOARD_NOKEYS</span><span class="p">:</span>
<a id="__codelineno-0-3438" name="__codelineno-0-3438"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;nokeys&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3439" name="__codelineno-0-3439"></a>            <span class="k">elif</span> <span class="n">keyboard</span> <span class="o">==</span> <span class="n">KEYBOARD_QWERTY</span><span class="p">:</span>
<a id="__codelineno-0-3440" name="__codelineno-0-3440"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;qwerty&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3441" name="__codelineno-0-3441"></a>            <span class="k">elif</span> <span class="n">keyboard</span> <span class="o">==</span> <span class="n">KEYBOARD_12KEY</span><span class="p">:</span>
<a id="__codelineno-0-3442" name="__codelineno-0-3442"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;12key&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3443" name="__codelineno-0-3443"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3444" name="__codelineno-0-3444"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;keyboard_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">keyboard</span><span class="p">)</span>
<a id="__codelineno-0-3445" name="__codelineno-0-3445"></a>
<a id="__codelineno-0-3446" name="__codelineno-0-3446"></a>        <span class="k">if</span> <span class="n">inputFlags</span> <span class="o">&amp;</span> <span class="n">MASK_NAVHIDDEN</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3447" name="__codelineno-0-3447"></a>            <span class="n">input_flags</span> <span class="o">=</span> <span class="n">inputFlags</span> <span class="o">&amp;</span> <span class="n">MASK_NAVHIDDEN</span>
<a id="__codelineno-0-3448" name="__codelineno-0-3448"></a>            <span class="k">if</span> <span class="n">input_flags</span> <span class="o">==</span> <span class="n">NAVHIDDEN_NO</span><span class="p">:</span>
<a id="__codelineno-0-3449" name="__codelineno-0-3449"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;navexposed&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3450" name="__codelineno-0-3450"></a>            <span class="k">elif</span> <span class="n">input_flags</span> <span class="o">==</span> <span class="n">NAVHIDDEN_YES</span><span class="p">:</span>
<a id="__codelineno-0-3451" name="__codelineno-0-3451"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;navhidden&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3452" name="__codelineno-0-3452"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3453" name="__codelineno-0-3453"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;inputFlagsNavHidden_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">input_flags</span><span class="p">)</span>
<a id="__codelineno-0-3454" name="__codelineno-0-3454"></a>
<a id="__codelineno-0-3455" name="__codelineno-0-3455"></a>        <span class="k">if</span> <span class="n">navigation</span> <span class="o">!=</span> <span class="n">NAVIGATION_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3456" name="__codelineno-0-3456"></a>            <span class="k">if</span> <span class="n">navigation</span> <span class="o">==</span> <span class="n">NAVIGATION_NONAV</span><span class="p">:</span>
<a id="__codelineno-0-3457" name="__codelineno-0-3457"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;nonav&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3458" name="__codelineno-0-3458"></a>            <span class="k">elif</span> <span class="n">navigation</span> <span class="o">==</span> <span class="n">NAVIGATION_DPAD</span><span class="p">:</span>
<a id="__codelineno-0-3459" name="__codelineno-0-3459"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;dpad&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3460" name="__codelineno-0-3460"></a>            <span class="k">elif</span> <span class="n">navigation</span> <span class="o">==</span> <span class="n">NAVIGATION_TRACKBALL</span><span class="p">:</span>
<a id="__codelineno-0-3461" name="__codelineno-0-3461"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;trackball&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3462" name="__codelineno-0-3462"></a>            <span class="k">elif</span> <span class="n">navigation</span> <span class="o">==</span> <span class="n">NAVIGATION_WHEEL</span><span class="p">:</span>
<a id="__codelineno-0-3463" name="__codelineno-0-3463"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;wheel&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3464" name="__codelineno-0-3464"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3465" name="__codelineno-0-3465"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;navigation_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">navigation</span><span class="p">)</span>
<a id="__codelineno-0-3466" name="__codelineno-0-3466"></a>
<a id="__codelineno-0-3467" name="__codelineno-0-3467"></a>        <span class="n">screenSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenSize</span>
<a id="__codelineno-0-3468" name="__codelineno-0-3468"></a>        <span class="k">if</span> <span class="n">screenSize</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3469" name="__codelineno-0-3469"></a>            <span class="n">screenWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenSize</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>
<a id="__codelineno-0-3470" name="__codelineno-0-3470"></a>            <span class="n">screenHeight</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenSize</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3471" name="__codelineno-0-3471"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">x</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">screenWidth</span><span class="p">,</span> <span class="n">screenHeight</span><span class="p">))</span>
<a id="__codelineno-0-3472" name="__codelineno-0-3472"></a>
<a id="__codelineno-0-3473" name="__codelineno-0-3473"></a>        <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span>
<a id="__codelineno-0-3474" name="__codelineno-0-3474"></a>        <span class="k">if</span> <span class="n">version</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3475" name="__codelineno-0-3475"></a>            <span class="n">sdkVersion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>
<a id="__codelineno-0-3476" name="__codelineno-0-3476"></a>            <span class="n">minorVersion</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3477" name="__codelineno-0-3477"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;v</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sdkVersion</span><span class="p">)</span>
<a id="__codelineno-0-3478" name="__codelineno-0-3478"></a>            <span class="k">if</span> <span class="n">minorVersion</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3479" name="__codelineno-0-3479"></a>                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;.</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">minorVersion</span><span class="p">)</span>
<a id="__codelineno-0-3480" name="__codelineno-0-3480"></a>
<a id="__codelineno-0-3481" name="__codelineno-0-3481"></a>        <span class="k">return</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<a id="__codelineno-0-3482" name="__codelineno-0-3482"></a>
<a id="__codelineno-0-3483" name="__codelineno-0-3483"></a>    <span class="k">def</span> <span class="nf">get_language</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3484" name="__codelineno-0-3484"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">&amp;</span> <span class="mh">0x0000FFFF</span>
<a id="__codelineno-0-3485" name="__codelineno-0-3485"></a>        <span class="k">return</span> <span class="nb">chr</span><span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mh">0x00FF</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">((</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-3486" name="__codelineno-0-3486"></a>
<a id="__codelineno-0-3487" name="__codelineno-0-3487"></a>    <span class="k">def</span> <span class="nf">get_country</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3488" name="__codelineno-0-3488"></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3489" name="__codelineno-0-3489"></a>        <span class="k">return</span> <span class="nb">chr</span><span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mh">0x00FF</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">((</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-3490" name="__codelineno-0-3490"></a>
<a id="__codelineno-0-3491" name="__codelineno-0-3491"></a>    <span class="k">def</span> <span class="nf">get_density</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3492" name="__codelineno-0-3492"></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenType</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>
<a id="__codelineno-0-3493" name="__codelineno-0-3493"></a>        <span class="k">return</span> <span class="n">x</span>
<a id="__codelineno-0-3494" name="__codelineno-0-3494"></a>
<a id="__codelineno-0-3495" name="__codelineno-0-3495"></a>    <span class="k">def</span> <span class="nf">is_default</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-3496" name="__codelineno-0-3496"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3497" name="__codelineno-0-3497"></a><span class="sd">        Test if this is a default resource, which matches all</span>
<a id="__codelineno-0-3498" name="__codelineno-0-3498"></a>
<a id="__codelineno-0-3499" name="__codelineno-0-3499"></a><span class="sd">        This is indicated that all fields are zero.</span>
<a id="__codelineno-0-3500" name="__codelineno-0-3500"></a><span class="sd">        :returns: True if default, False otherwise</span>
<a id="__codelineno-0-3501" name="__codelineno-0-3501"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-3502" name="__codelineno-0-3502"></a>        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_tuple</span><span class="p">()))</span>
<a id="__codelineno-0-3503" name="__codelineno-0-3503"></a>
<a id="__codelineno-0-3504" name="__codelineno-0-3504"></a>    <span class="k">def</span> <span class="nf">_get_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-3505" name="__codelineno-0-3505"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-3506" name="__codelineno-0-3506"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">imsi</span><span class="p">,</span>
<a id="__codelineno-0-3507" name="__codelineno-0-3507"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">locale</span><span class="p">,</span>
<a id="__codelineno-0-3508" name="__codelineno-0-3508"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">screenType</span><span class="p">,</span>
<a id="__codelineno-0-3509" name="__codelineno-0-3509"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">,</span>
<a id="__codelineno-0-3510" name="__codelineno-0-3510"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">screenSize</span><span class="p">,</span>
<a id="__codelineno-0-3511" name="__codelineno-0-3511"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
<a id="__codelineno-0-3512" name="__codelineno-0-3512"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">screenConfig</span><span class="p">,</span>
<a id="__codelineno-0-3513" name="__codelineno-0-3513"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">screenSizeDp</span><span class="p">,</span>
<a id="__codelineno-0-3514" name="__codelineno-0-3514"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">screenConfig2</span><span class="p">,</span>
<a id="__codelineno-0-3515" name="__codelineno-0-3515"></a>        <span class="p">)</span>
<a id="__codelineno-0-3516" name="__codelineno-0-3516"></a>
<a id="__codelineno-0-3517" name="__codelineno-0-3517"></a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-3518" name="__codelineno-0-3518"></a>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_tuple</span><span class="p">())</span>
<a id="__codelineno-0-3519" name="__codelineno-0-3519"></a>
<a id="__codelineno-0-3520" name="__codelineno-0-3520"></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<a id="__codelineno-0-3521" name="__codelineno-0-3521"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_tuple</span><span class="p">()</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_get_tuple</span><span class="p">()</span>
<a id="__codelineno-0-3522" name="__codelineno-0-3522"></a>
<a id="__codelineno-0-3523" name="__codelineno-0-3523"></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-3524" name="__codelineno-0-3524"></a>        <span class="k">return</span> <span class="s2">&quot;&lt;ARSCResTableConfig &#39;</span><span class="si">{}</span><span class="s2">&#39;=</span><span class="si">{}</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-3525" name="__codelineno-0-3525"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_qualifier</span><span class="p">(),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_tuple</span><span class="p">())</span>
<a id="__codelineno-0-3526" name="__codelineno-0-3526"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCResTableConfig.get_config_name_friendly" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_config_name_friendly</span><span class="p">()</span></code>

<a href="#androguard.core.axml.ARSCResTableConfig.get_config_name_friendly" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Here for legacy reasons.</p>
<p>use <a class="autorefs autorefs-internal" href="#androguard.core.axml.ARSCResTableConfig.get_qualifier">get_qualifier</a> instead.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the qualifier string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3244">3244</a></span>
<span class="normal"><a href="#__codelineno-0-3245">3245</a></span>
<span class="normal"><a href="#__codelineno-0-3246">3246</a></span>
<span class="normal"><a href="#__codelineno-0-3247">3247</a></span>
<span class="normal"><a href="#__codelineno-0-3248">3248</a></span>
<span class="normal"><a href="#__codelineno-0-3249">3249</a></span>
<span class="normal"><a href="#__codelineno-0-3250">3250</a></span>
<span class="normal"><a href="#__codelineno-0-3251">3251</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-3244" name="__codelineno-0-3244"></a><span class="k">def</span> <span class="nf">get_config_name_friendly</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3245" name="__codelineno-0-3245"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3246" name="__codelineno-0-3246"></a><span class="sd">    Here for legacy reasons.</span>
<a id="__codelineno-0-3247" name="__codelineno-0-3247"></a>
<a id="__codelineno-0-3248" name="__codelineno-0-3248"></a><span class="sd">    use [get_qualifier][androguard.core.axml.ARSCResTableConfig.get_qualifier] instead.</span>
<a id="__codelineno-0-3249" name="__codelineno-0-3249"></a><span class="sd">    :returns: the qualifier string</span>
<a id="__codelineno-0-3250" name="__codelineno-0-3250"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-3251" name="__codelineno-0-3251"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_qualifier</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCResTableConfig.get_language_and_region" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_language_and_region</span><span class="p">()</span></code>

<a href="#androguard.core.axml.ARSCResTableConfig.get_language_and_region" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the combined language+region string or    for the default locale</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the combined language and region string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3221">3221</a></span>
<span class="normal"><a href="#__codelineno-0-3222">3222</a></span>
<span class="normal"><a href="#__codelineno-0-3223">3223</a></span>
<span class="normal"><a href="#__codelineno-0-3224">3224</a></span>
<span class="normal"><a href="#__codelineno-0-3225">3225</a></span>
<span class="normal"><a href="#__codelineno-0-3226">3226</a></span>
<span class="normal"><a href="#__codelineno-0-3227">3227</a></span>
<span class="normal"><a href="#__codelineno-0-3228">3228</a></span>
<span class="normal"><a href="#__codelineno-0-3229">3229</a></span>
<span class="normal"><a href="#__codelineno-0-3230">3230</a></span>
<span class="normal"><a href="#__codelineno-0-3231">3231</a></span>
<span class="normal"><a href="#__codelineno-0-3232">3232</a></span>
<span class="normal"><a href="#__codelineno-0-3233">3233</a></span>
<span class="normal"><a href="#__codelineno-0-3234">3234</a></span>
<span class="normal"><a href="#__codelineno-0-3235">3235</a></span>
<span class="normal"><a href="#__codelineno-0-3236">3236</a></span>
<span class="normal"><a href="#__codelineno-0-3237">3237</a></span>
<span class="normal"><a href="#__codelineno-0-3238">3238</a></span>
<span class="normal"><a href="#__codelineno-0-3239">3239</a></span>
<span class="normal"><a href="#__codelineno-0-3240">3240</a></span>
<span class="normal"><a href="#__codelineno-0-3241">3241</a></span>
<span class="normal"><a href="#__codelineno-0-3242">3242</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-3221" name="__codelineno-0-3221"></a><span class="k">def</span> <span class="nf">get_language_and_region</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3222" name="__codelineno-0-3222"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3223" name="__codelineno-0-3223"></a><span class="sd">    Returns the combined language+region string or \x00\x00 for the default locale</span>
<a id="__codelineno-0-3224" name="__codelineno-0-3224"></a><span class="sd">    :returns: the combined language and region string</span>
<a id="__codelineno-0-3225" name="__codelineno-0-3225"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-3226" name="__codelineno-0-3226"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3227" name="__codelineno-0-3227"></a>        <span class="n">_language</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_language_or_region</span><span class="p">(</span>
<a id="__codelineno-0-3228" name="__codelineno-0-3228"></a>            <span class="p">[</span>
<a id="__codelineno-0-3229" name="__codelineno-0-3229"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span>
<a id="__codelineno-0-3230" name="__codelineno-0-3230"></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">,</span>
<a id="__codelineno-0-3231" name="__codelineno-0-3231"></a>            <span class="p">],</span>
<a id="__codelineno-0-3232" name="__codelineno-0-3232"></a>            <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span>
<a id="__codelineno-0-3233" name="__codelineno-0-3233"></a>        <span class="p">)</span>
<a id="__codelineno-0-3234" name="__codelineno-0-3234"></a>        <span class="n">_region</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_language_or_region</span><span class="p">(</span>
<a id="__codelineno-0-3235" name="__codelineno-0-3235"></a>            <span class="p">[</span>
<a id="__codelineno-0-3236" name="__codelineno-0-3236"></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">&amp;</span> <span class="mh">0xFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">,</span>
<a id="__codelineno-0-3237" name="__codelineno-0-3237"></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">&amp;</span> <span class="mh">0xFF000000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">,</span>
<a id="__codelineno-0-3238" name="__codelineno-0-3238"></a>            <span class="p">],</span>
<a id="__codelineno-0-3239" name="__codelineno-0-3239"></a>            <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span>
<a id="__codelineno-0-3240" name="__codelineno-0-3240"></a>        <span class="p">)</span>
<a id="__codelineno-0-3241" name="__codelineno-0-3241"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">_language</span> <span class="o">+</span> <span class="s2">&quot;-r&quot;</span> <span class="o">+</span> <span class="n">_region</span><span class="p">)</span> <span class="k">if</span> <span class="n">_region</span> <span class="k">else</span> <span class="n">_language</span>
<a id="__codelineno-0-3242" name="__codelineno-0-3242"></a>    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\x00\x00</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCResTableConfig.get_qualifier" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_qualifier</span><span class="p">()</span></code>

<a href="#androguard.core.axml.ARSCResTableConfig.get_qualifier" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return resource name qualifier for the current configuration.
for example</p>
<ul>
<li><code>ldpi-v4</code></li>
<li><code>hdpi-v4</code></li>
</ul>
<p>All possible qualifiers are listed in table 2 of <a href="https://developer.android.com/guide/topics/resources/providing-resources">https://developer.android.com/guide/topics/resources/providing-resources</a></p>
<p>You can find how android process this at <a href="http://aospxref.com/android-13.0.0_r3/xref/frameworks/base/libs/androidfw/ResourceTypes.cpp#3243">ResourceTypes 3243</a></p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the resource name qualifer string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3253">3253</a></span>
<span class="normal"><a href="#__codelineno-0-3254">3254</a></span>
<span class="normal"><a href="#__codelineno-0-3255">3255</a></span>
<span class="normal"><a href="#__codelineno-0-3256">3256</a></span>
<span class="normal"><a href="#__codelineno-0-3257">3257</a></span>
<span class="normal"><a href="#__codelineno-0-3258">3258</a></span>
<span class="normal"><a href="#__codelineno-0-3259">3259</a></span>
<span class="normal"><a href="#__codelineno-0-3260">3260</a></span>
<span class="normal"><a href="#__codelineno-0-3261">3261</a></span>
<span class="normal"><a href="#__codelineno-0-3262">3262</a></span>
<span class="normal"><a href="#__codelineno-0-3263">3263</a></span>
<span class="normal"><a href="#__codelineno-0-3264">3264</a></span>
<span class="normal"><a href="#__codelineno-0-3265">3265</a></span>
<span class="normal"><a href="#__codelineno-0-3266">3266</a></span>
<span class="normal"><a href="#__codelineno-0-3267">3267</a></span>
<span class="normal"><a href="#__codelineno-0-3268">3268</a></span>
<span class="normal"><a href="#__codelineno-0-3269">3269</a></span>
<span class="normal"><a href="#__codelineno-0-3270">3270</a></span>
<span class="normal"><a href="#__codelineno-0-3271">3271</a></span>
<span class="normal"><a href="#__codelineno-0-3272">3272</a></span>
<span class="normal"><a href="#__codelineno-0-3273">3273</a></span>
<span class="normal"><a href="#__codelineno-0-3274">3274</a></span>
<span class="normal"><a href="#__codelineno-0-3275">3275</a></span>
<span class="normal"><a href="#__codelineno-0-3276">3276</a></span>
<span class="normal"><a href="#__codelineno-0-3277">3277</a></span>
<span class="normal"><a href="#__codelineno-0-3278">3278</a></span>
<span class="normal"><a href="#__codelineno-0-3279">3279</a></span>
<span class="normal"><a href="#__codelineno-0-3280">3280</a></span>
<span class="normal"><a href="#__codelineno-0-3281">3281</a></span>
<span class="normal"><a href="#__codelineno-0-3282">3282</a></span>
<span class="normal"><a href="#__codelineno-0-3283">3283</a></span>
<span class="normal"><a href="#__codelineno-0-3284">3284</a></span>
<span class="normal"><a href="#__codelineno-0-3285">3285</a></span>
<span class="normal"><a href="#__codelineno-0-3286">3286</a></span>
<span class="normal"><a href="#__codelineno-0-3287">3287</a></span>
<span class="normal"><a href="#__codelineno-0-3288">3288</a></span>
<span class="normal"><a href="#__codelineno-0-3289">3289</a></span>
<span class="normal"><a href="#__codelineno-0-3290">3290</a></span>
<span class="normal"><a href="#__codelineno-0-3291">3291</a></span>
<span class="normal"><a href="#__codelineno-0-3292">3292</a></span>
<span class="normal"><a href="#__codelineno-0-3293">3293</a></span>
<span class="normal"><a href="#__codelineno-0-3294">3294</a></span>
<span class="normal"><a href="#__codelineno-0-3295">3295</a></span>
<span class="normal"><a href="#__codelineno-0-3296">3296</a></span>
<span class="normal"><a href="#__codelineno-0-3297">3297</a></span>
<span class="normal"><a href="#__codelineno-0-3298">3298</a></span>
<span class="normal"><a href="#__codelineno-0-3299">3299</a></span>
<span class="normal"><a href="#__codelineno-0-3300">3300</a></span>
<span class="normal"><a href="#__codelineno-0-3301">3301</a></span>
<span class="normal"><a href="#__codelineno-0-3302">3302</a></span>
<span class="normal"><a href="#__codelineno-0-3303">3303</a></span>
<span class="normal"><a href="#__codelineno-0-3304">3304</a></span>
<span class="normal"><a href="#__codelineno-0-3305">3305</a></span>
<span class="normal"><a href="#__codelineno-0-3306">3306</a></span>
<span class="normal"><a href="#__codelineno-0-3307">3307</a></span>
<span class="normal"><a href="#__codelineno-0-3308">3308</a></span>
<span class="normal"><a href="#__codelineno-0-3309">3309</a></span>
<span class="normal"><a href="#__codelineno-0-3310">3310</a></span>
<span class="normal"><a href="#__codelineno-0-3311">3311</a></span>
<span class="normal"><a href="#__codelineno-0-3312">3312</a></span>
<span class="normal"><a href="#__codelineno-0-3313">3313</a></span>
<span class="normal"><a href="#__codelineno-0-3314">3314</a></span>
<span class="normal"><a href="#__codelineno-0-3315">3315</a></span>
<span class="normal"><a href="#__codelineno-0-3316">3316</a></span>
<span class="normal"><a href="#__codelineno-0-3317">3317</a></span>
<span class="normal"><a href="#__codelineno-0-3318">3318</a></span>
<span class="normal"><a href="#__codelineno-0-3319">3319</a></span>
<span class="normal"><a href="#__codelineno-0-3320">3320</a></span>
<span class="normal"><a href="#__codelineno-0-3321">3321</a></span>
<span class="normal"><a href="#__codelineno-0-3322">3322</a></span>
<span class="normal"><a href="#__codelineno-0-3323">3323</a></span>
<span class="normal"><a href="#__codelineno-0-3324">3324</a></span>
<span class="normal"><a href="#__codelineno-0-3325">3325</a></span>
<span class="normal"><a href="#__codelineno-0-3326">3326</a></span>
<span class="normal"><a href="#__codelineno-0-3327">3327</a></span>
<span class="normal"><a href="#__codelineno-0-3328">3328</a></span>
<span class="normal"><a href="#__codelineno-0-3329">3329</a></span>
<span class="normal"><a href="#__codelineno-0-3330">3330</a></span>
<span class="normal"><a href="#__codelineno-0-3331">3331</a></span>
<span class="normal"><a href="#__codelineno-0-3332">3332</a></span>
<span class="normal"><a href="#__codelineno-0-3333">3333</a></span>
<span class="normal"><a href="#__codelineno-0-3334">3334</a></span>
<span class="normal"><a href="#__codelineno-0-3335">3335</a></span>
<span class="normal"><a href="#__codelineno-0-3336">3336</a></span>
<span class="normal"><a href="#__codelineno-0-3337">3337</a></span>
<span class="normal"><a href="#__codelineno-0-3338">3338</a></span>
<span class="normal"><a href="#__codelineno-0-3339">3339</a></span>
<span class="normal"><a href="#__codelineno-0-3340">3340</a></span>
<span class="normal"><a href="#__codelineno-0-3341">3341</a></span>
<span class="normal"><a href="#__codelineno-0-3342">3342</a></span>
<span class="normal"><a href="#__codelineno-0-3343">3343</a></span>
<span class="normal"><a href="#__codelineno-0-3344">3344</a></span>
<span class="normal"><a href="#__codelineno-0-3345">3345</a></span>
<span class="normal"><a href="#__codelineno-0-3346">3346</a></span>
<span class="normal"><a href="#__codelineno-0-3347">3347</a></span>
<span class="normal"><a href="#__codelineno-0-3348">3348</a></span>
<span class="normal"><a href="#__codelineno-0-3349">3349</a></span>
<span class="normal"><a href="#__codelineno-0-3350">3350</a></span>
<span class="normal"><a href="#__codelineno-0-3351">3351</a></span>
<span class="normal"><a href="#__codelineno-0-3352">3352</a></span>
<span class="normal"><a href="#__codelineno-0-3353">3353</a></span>
<span class="normal"><a href="#__codelineno-0-3354">3354</a></span>
<span class="normal"><a href="#__codelineno-0-3355">3355</a></span>
<span class="normal"><a href="#__codelineno-0-3356">3356</a></span>
<span class="normal"><a href="#__codelineno-0-3357">3357</a></span>
<span class="normal"><a href="#__codelineno-0-3358">3358</a></span>
<span class="normal"><a href="#__codelineno-0-3359">3359</a></span>
<span class="normal"><a href="#__codelineno-0-3360">3360</a></span>
<span class="normal"><a href="#__codelineno-0-3361">3361</a></span>
<span class="normal"><a href="#__codelineno-0-3362">3362</a></span>
<span class="normal"><a href="#__codelineno-0-3363">3363</a></span>
<span class="normal"><a href="#__codelineno-0-3364">3364</a></span>
<span class="normal"><a href="#__codelineno-0-3365">3365</a></span>
<span class="normal"><a href="#__codelineno-0-3366">3366</a></span>
<span class="normal"><a href="#__codelineno-0-3367">3367</a></span>
<span class="normal"><a href="#__codelineno-0-3368">3368</a></span>
<span class="normal"><a href="#__codelineno-0-3369">3369</a></span>
<span class="normal"><a href="#__codelineno-0-3370">3370</a></span>
<span class="normal"><a href="#__codelineno-0-3371">3371</a></span>
<span class="normal"><a href="#__codelineno-0-3372">3372</a></span>
<span class="normal"><a href="#__codelineno-0-3373">3373</a></span>
<span class="normal"><a href="#__codelineno-0-3374">3374</a></span>
<span class="normal"><a href="#__codelineno-0-3375">3375</a></span>
<span class="normal"><a href="#__codelineno-0-3376">3376</a></span>
<span class="normal"><a href="#__codelineno-0-3377">3377</a></span>
<span class="normal"><a href="#__codelineno-0-3378">3378</a></span>
<span class="normal"><a href="#__codelineno-0-3379">3379</a></span>
<span class="normal"><a href="#__codelineno-0-3380">3380</a></span>
<span class="normal"><a href="#__codelineno-0-3381">3381</a></span>
<span class="normal"><a href="#__codelineno-0-3382">3382</a></span>
<span class="normal"><a href="#__codelineno-0-3383">3383</a></span>
<span class="normal"><a href="#__codelineno-0-3384">3384</a></span>
<span class="normal"><a href="#__codelineno-0-3385">3385</a></span>
<span class="normal"><a href="#__codelineno-0-3386">3386</a></span>
<span class="normal"><a href="#__codelineno-0-3387">3387</a></span>
<span class="normal"><a href="#__codelineno-0-3388">3388</a></span>
<span class="normal"><a href="#__codelineno-0-3389">3389</a></span>
<span class="normal"><a href="#__codelineno-0-3390">3390</a></span>
<span class="normal"><a href="#__codelineno-0-3391">3391</a></span>
<span class="normal"><a href="#__codelineno-0-3392">3392</a></span>
<span class="normal"><a href="#__codelineno-0-3393">3393</a></span>
<span class="normal"><a href="#__codelineno-0-3394">3394</a></span>
<span class="normal"><a href="#__codelineno-0-3395">3395</a></span>
<span class="normal"><a href="#__codelineno-0-3396">3396</a></span>
<span class="normal"><a href="#__codelineno-0-3397">3397</a></span>
<span class="normal"><a href="#__codelineno-0-3398">3398</a></span>
<span class="normal"><a href="#__codelineno-0-3399">3399</a></span>
<span class="normal"><a href="#__codelineno-0-3400">3400</a></span>
<span class="normal"><a href="#__codelineno-0-3401">3401</a></span>
<span class="normal"><a href="#__codelineno-0-3402">3402</a></span>
<span class="normal"><a href="#__codelineno-0-3403">3403</a></span>
<span class="normal"><a href="#__codelineno-0-3404">3404</a></span>
<span class="normal"><a href="#__codelineno-0-3405">3405</a></span>
<span class="normal"><a href="#__codelineno-0-3406">3406</a></span>
<span class="normal"><a href="#__codelineno-0-3407">3407</a></span>
<span class="normal"><a href="#__codelineno-0-3408">3408</a></span>
<span class="normal"><a href="#__codelineno-0-3409">3409</a></span>
<span class="normal"><a href="#__codelineno-0-3410">3410</a></span>
<span class="normal"><a href="#__codelineno-0-3411">3411</a></span>
<span class="normal"><a href="#__codelineno-0-3412">3412</a></span>
<span class="normal"><a href="#__codelineno-0-3413">3413</a></span>
<span class="normal"><a href="#__codelineno-0-3414">3414</a></span>
<span class="normal"><a href="#__codelineno-0-3415">3415</a></span>
<span class="normal"><a href="#__codelineno-0-3416">3416</a></span>
<span class="normal"><a href="#__codelineno-0-3417">3417</a></span>
<span class="normal"><a href="#__codelineno-0-3418">3418</a></span>
<span class="normal"><a href="#__codelineno-0-3419">3419</a></span>
<span class="normal"><a href="#__codelineno-0-3420">3420</a></span>
<span class="normal"><a href="#__codelineno-0-3421">3421</a></span>
<span class="normal"><a href="#__codelineno-0-3422">3422</a></span>
<span class="normal"><a href="#__codelineno-0-3423">3423</a></span>
<span class="normal"><a href="#__codelineno-0-3424">3424</a></span>
<span class="normal"><a href="#__codelineno-0-3425">3425</a></span>
<span class="normal"><a href="#__codelineno-0-3426">3426</a></span>
<span class="normal"><a href="#__codelineno-0-3427">3427</a></span>
<span class="normal"><a href="#__codelineno-0-3428">3428</a></span>
<span class="normal"><a href="#__codelineno-0-3429">3429</a></span>
<span class="normal"><a href="#__codelineno-0-3430">3430</a></span>
<span class="normal"><a href="#__codelineno-0-3431">3431</a></span>
<span class="normal"><a href="#__codelineno-0-3432">3432</a></span>
<span class="normal"><a href="#__codelineno-0-3433">3433</a></span>
<span class="normal"><a href="#__codelineno-0-3434">3434</a></span>
<span class="normal"><a href="#__codelineno-0-3435">3435</a></span>
<span class="normal"><a href="#__codelineno-0-3436">3436</a></span>
<span class="normal"><a href="#__codelineno-0-3437">3437</a></span>
<span class="normal"><a href="#__codelineno-0-3438">3438</a></span>
<span class="normal"><a href="#__codelineno-0-3439">3439</a></span>
<span class="normal"><a href="#__codelineno-0-3440">3440</a></span>
<span class="normal"><a href="#__codelineno-0-3441">3441</a></span>
<span class="normal"><a href="#__codelineno-0-3442">3442</a></span>
<span class="normal"><a href="#__codelineno-0-3443">3443</a></span>
<span class="normal"><a href="#__codelineno-0-3444">3444</a></span>
<span class="normal"><a href="#__codelineno-0-3445">3445</a></span>
<span class="normal"><a href="#__codelineno-0-3446">3446</a></span>
<span class="normal"><a href="#__codelineno-0-3447">3447</a></span>
<span class="normal"><a href="#__codelineno-0-3448">3448</a></span>
<span class="normal"><a href="#__codelineno-0-3449">3449</a></span>
<span class="normal"><a href="#__codelineno-0-3450">3450</a></span>
<span class="normal"><a href="#__codelineno-0-3451">3451</a></span>
<span class="normal"><a href="#__codelineno-0-3452">3452</a></span>
<span class="normal"><a href="#__codelineno-0-3453">3453</a></span>
<span class="normal"><a href="#__codelineno-0-3454">3454</a></span>
<span class="normal"><a href="#__codelineno-0-3455">3455</a></span>
<span class="normal"><a href="#__codelineno-0-3456">3456</a></span>
<span class="normal"><a href="#__codelineno-0-3457">3457</a></span>
<span class="normal"><a href="#__codelineno-0-3458">3458</a></span>
<span class="normal"><a href="#__codelineno-0-3459">3459</a></span>
<span class="normal"><a href="#__codelineno-0-3460">3460</a></span>
<span class="normal"><a href="#__codelineno-0-3461">3461</a></span>
<span class="normal"><a href="#__codelineno-0-3462">3462</a></span>
<span class="normal"><a href="#__codelineno-0-3463">3463</a></span>
<span class="normal"><a href="#__codelineno-0-3464">3464</a></span>
<span class="normal"><a href="#__codelineno-0-3465">3465</a></span>
<span class="normal"><a href="#__codelineno-0-3466">3466</a></span>
<span class="normal"><a href="#__codelineno-0-3467">3467</a></span>
<span class="normal"><a href="#__codelineno-0-3468">3468</a></span>
<span class="normal"><a href="#__codelineno-0-3469">3469</a></span>
<span class="normal"><a href="#__codelineno-0-3470">3470</a></span>
<span class="normal"><a href="#__codelineno-0-3471">3471</a></span>
<span class="normal"><a href="#__codelineno-0-3472">3472</a></span>
<span class="normal"><a href="#__codelineno-0-3473">3473</a></span>
<span class="normal"><a href="#__codelineno-0-3474">3474</a></span>
<span class="normal"><a href="#__codelineno-0-3475">3475</a></span>
<span class="normal"><a href="#__codelineno-0-3476">3476</a></span>
<span class="normal"><a href="#__codelineno-0-3477">3477</a></span>
<span class="normal"><a href="#__codelineno-0-3478">3478</a></span>
<span class="normal"><a href="#__codelineno-0-3479">3479</a></span>
<span class="normal"><a href="#__codelineno-0-3480">3480</a></span>
<span class="normal"><a href="#__codelineno-0-3481">3481</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-3253" name="__codelineno-0-3253"></a><span class="k">def</span> <span class="nf">get_qualifier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3254" name="__codelineno-0-3254"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3255" name="__codelineno-0-3255"></a><span class="sd">    Return resource name qualifier for the current configuration.</span>
<a id="__codelineno-0-3256" name="__codelineno-0-3256"></a><span class="sd">    for example</span>
<a id="__codelineno-0-3257" name="__codelineno-0-3257"></a>
<a id="__codelineno-0-3258" name="__codelineno-0-3258"></a><span class="sd">    * `ldpi-v4`</span>
<a id="__codelineno-0-3259" name="__codelineno-0-3259"></a><span class="sd">    * `hdpi-v4`</span>
<a id="__codelineno-0-3260" name="__codelineno-0-3260"></a>
<a id="__codelineno-0-3261" name="__codelineno-0-3261"></a><span class="sd">    All possible qualifiers are listed in table 2 of &lt;https://developer.android.com/guide/topics/resources/providing-resources&gt;</span>
<a id="__codelineno-0-3262" name="__codelineno-0-3262"></a>
<a id="__codelineno-0-3263" name="__codelineno-0-3263"></a><span class="sd">    You can find how android process this at [ResourceTypes 3243](http://aospxref.com/android-13.0.0_r3/xref/frameworks/base/libs/androidfw/ResourceTypes.cpp#3243)</span>
<a id="__codelineno-0-3264" name="__codelineno-0-3264"></a>
<a id="__codelineno-0-3265" name="__codelineno-0-3265"></a><span class="sd">    :return: the resource name qualifer string</span>
<a id="__codelineno-0-3266" name="__codelineno-0-3266"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-3267" name="__codelineno-0-3267"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-3268" name="__codelineno-0-3268"></a>
<a id="__codelineno-0-3269" name="__codelineno-0-3269"></a>    <span class="n">mcc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">imsi</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>
<a id="__codelineno-0-3270" name="__codelineno-0-3270"></a>    <span class="n">mnc</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imsi</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3271" name="__codelineno-0-3271"></a>    <span class="k">if</span> <span class="n">mcc</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3272" name="__codelineno-0-3272"></a>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;mcc</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mcc</span><span class="p">)</span>
<a id="__codelineno-0-3273" name="__codelineno-0-3273"></a>    <span class="k">if</span> <span class="n">mnc</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3274" name="__codelineno-0-3274"></a>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;mnc</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mnc</span><span class="p">)</span>
<a id="__codelineno-0-3275" name="__codelineno-0-3275"></a>
<a id="__codelineno-0-3276" name="__codelineno-0-3276"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3277" name="__codelineno-0-3277"></a>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_language_and_region</span><span class="p">())</span>
<a id="__codelineno-0-3278" name="__codelineno-0-3278"></a>
<a id="__codelineno-0-3279" name="__codelineno-0-3279"></a>    <span class="n">screenLayout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenConfig</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
<a id="__codelineno-0-3280" name="__codelineno-0-3280"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_LAYOUTDIR</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3281" name="__codelineno-0-3281"></a>        <span class="k">if</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_LAYOUTDIR</span> <span class="o">==</span> <span class="n">LAYOUTDIR_LTR</span><span class="p">:</span>
<a id="__codelineno-0-3282" name="__codelineno-0-3282"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ldltr&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3283" name="__codelineno-0-3283"></a>        <span class="k">elif</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_LAYOUTDIR</span> <span class="o">==</span> <span class="n">LAYOUTDIR_RTL</span><span class="p">:</span>
<a id="__codelineno-0-3284" name="__codelineno-0-3284"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ldrtl&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3285" name="__codelineno-0-3285"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3286" name="__codelineno-0-3286"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;layoutDir_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_LAYOUTDIR</span><span class="p">))</span>
<a id="__codelineno-0-3287" name="__codelineno-0-3287"></a>
<a id="__codelineno-0-3288" name="__codelineno-0-3288"></a>    <span class="n">smallestScreenWidthDp</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenConfig</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3289" name="__codelineno-0-3289"></a>    <span class="k">if</span> <span class="n">smallestScreenWidthDp</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3290" name="__codelineno-0-3290"></a>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;sw</span><span class="si">%d</span><span class="s2">dp&quot;</span> <span class="o">%</span> <span class="n">smallestScreenWidthDp</span><span class="p">)</span>
<a id="__codelineno-0-3291" name="__codelineno-0-3291"></a>
<a id="__codelineno-0-3292" name="__codelineno-0-3292"></a>    <span class="n">screenWidthDp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenSizeDp</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>
<a id="__codelineno-0-3293" name="__codelineno-0-3293"></a>    <span class="n">screenHeightDp</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenSizeDp</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3294" name="__codelineno-0-3294"></a>    <span class="k">if</span> <span class="n">screenWidthDp</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3295" name="__codelineno-0-3295"></a>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;w</span><span class="si">%d</span><span class="s2">dp&quot;</span> <span class="o">%</span> <span class="n">screenWidthDp</span><span class="p">)</span>
<a id="__codelineno-0-3296" name="__codelineno-0-3296"></a>    <span class="k">if</span> <span class="n">screenHeightDp</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3297" name="__codelineno-0-3297"></a>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;h</span><span class="si">%d</span><span class="s2">dp&quot;</span> <span class="o">%</span> <span class="n">screenHeightDp</span><span class="p">)</span>
<a id="__codelineno-0-3298" name="__codelineno-0-3298"></a>
<a id="__codelineno-0-3299" name="__codelineno-0-3299"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENSIZE</span><span class="p">)</span> <span class="o">!=</span> <span class="n">SCREENSIZE_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3300" name="__codelineno-0-3300"></a>        <span class="k">if</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENSIZE</span> <span class="o">==</span> <span class="n">SCREENSIZE_SMALL</span><span class="p">:</span>
<a id="__codelineno-0-3301" name="__codelineno-0-3301"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;small&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3302" name="__codelineno-0-3302"></a>        <span class="k">elif</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENSIZE</span> <span class="o">==</span> <span class="n">SCREENSIZE_NORMAL</span><span class="p">:</span>
<a id="__codelineno-0-3303" name="__codelineno-0-3303"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3304" name="__codelineno-0-3304"></a>        <span class="k">elif</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENSIZE</span> <span class="o">==</span> <span class="n">SCREENSIZE_LARGE</span><span class="p">:</span>
<a id="__codelineno-0-3305" name="__codelineno-0-3305"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3306" name="__codelineno-0-3306"></a>        <span class="k">elif</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENSIZE</span> <span class="o">==</span> <span class="n">SCREENSIZE_XLARGE</span><span class="p">:</span>
<a id="__codelineno-0-3307" name="__codelineno-0-3307"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;xlarge&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3308" name="__codelineno-0-3308"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3309" name="__codelineno-0-3309"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-3310" name="__codelineno-0-3310"></a>                <span class="s2">&quot;screenLayoutSize_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENSIZE</span><span class="p">)</span>
<a id="__codelineno-0-3311" name="__codelineno-0-3311"></a>            <span class="p">)</span>
<a id="__codelineno-0-3312" name="__codelineno-0-3312"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENLONG</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3313" name="__codelineno-0-3313"></a>        <span class="k">if</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENLONG</span> <span class="o">==</span> <span class="n">SCREENLONG_NO</span><span class="p">:</span>
<a id="__codelineno-0-3314" name="__codelineno-0-3314"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;notlong&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3315" name="__codelineno-0-3315"></a>        <span class="k">elif</span> <span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENLONG</span> <span class="o">==</span> <span class="n">SCREENLONG_YES</span><span class="p">:</span>
<a id="__codelineno-0-3316" name="__codelineno-0-3316"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;long&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3317" name="__codelineno-0-3317"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3318" name="__codelineno-0-3318"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-3319" name="__codelineno-0-3319"></a>                <span class="s2">&quot;screenLayoutLong_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">screenLayout</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENLONG</span><span class="p">)</span>
<a id="__codelineno-0-3320" name="__codelineno-0-3320"></a>            <span class="p">)</span>
<a id="__codelineno-0-3321" name="__codelineno-0-3321"></a>
<a id="__codelineno-0-3322" name="__codelineno-0-3322"></a>    <span class="n">screenLayout2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenConfig2</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
<a id="__codelineno-0-3323" name="__codelineno-0-3323"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">screenLayout2</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENROUND</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3324" name="__codelineno-0-3324"></a>        <span class="k">if</span> <span class="n">screenLayout2</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENROUND</span> <span class="o">==</span> <span class="n">SCREENROUND_NO</span><span class="p">:</span>
<a id="__codelineno-0-3325" name="__codelineno-0-3325"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;notround&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3326" name="__codelineno-0-3326"></a>        <span class="k">elif</span> <span class="n">screenLayout2</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENROUND</span> <span class="o">==</span> <span class="n">SCREENROUND_YES</span><span class="p">:</span>
<a id="__codelineno-0-3327" name="__codelineno-0-3327"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;round&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3328" name="__codelineno-0-3328"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3329" name="__codelineno-0-3329"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-3330" name="__codelineno-0-3330"></a>                <span class="s2">&quot;screenRound_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">screenLayout2</span> <span class="o">&amp;</span> <span class="n">MASK_SCREENROUND</span><span class="p">)</span>
<a id="__codelineno-0-3331" name="__codelineno-0-3331"></a>            <span class="p">)</span>
<a id="__codelineno-0-3332" name="__codelineno-0-3332"></a>
<a id="__codelineno-0-3333" name="__codelineno-0-3333"></a>    <span class="n">colorMode</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenConfig2</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
<a id="__codelineno-0-3334" name="__codelineno-0-3334"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_WIDE_COLOR_GAMUT</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3335" name="__codelineno-0-3335"></a>        <span class="k">if</span> <span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_WIDE_COLOR_GAMUT</span> <span class="o">==</span> <span class="n">WIDE_COLOR_GAMUT_NO</span><span class="p">:</span>
<a id="__codelineno-0-3336" name="__codelineno-0-3336"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;nowidecg&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3337" name="__codelineno-0-3337"></a>        <span class="k">elif</span> <span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_WIDE_COLOR_GAMUT</span> <span class="o">==</span> <span class="n">WIDE_COLOR_GAMUT_YES</span><span class="p">:</span>
<a id="__codelineno-0-3338" name="__codelineno-0-3338"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;widecg&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3339" name="__codelineno-0-3339"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3340" name="__codelineno-0-3340"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-3341" name="__codelineno-0-3341"></a>                <span class="s2">&quot;wideColorGamut_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_WIDE_COLOR_GAMUT</span><span class="p">)</span>
<a id="__codelineno-0-3342" name="__codelineno-0-3342"></a>            <span class="p">)</span>
<a id="__codelineno-0-3343" name="__codelineno-0-3343"></a>
<a id="__codelineno-0-3344" name="__codelineno-0-3344"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_HDR</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3345" name="__codelineno-0-3345"></a>        <span class="k">if</span> <span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_HDR</span> <span class="o">==</span> <span class="n">HDR_NO</span><span class="p">:</span>
<a id="__codelineno-0-3346" name="__codelineno-0-3346"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;lowdr&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3347" name="__codelineno-0-3347"></a>        <span class="k">elif</span> <span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_HDR</span> <span class="o">==</span> <span class="n">HDR_YES</span><span class="p">:</span>
<a id="__codelineno-0-3348" name="__codelineno-0-3348"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;highdr&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3349" name="__codelineno-0-3349"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3350" name="__codelineno-0-3350"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;hdr_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">colorMode</span> <span class="o">&amp;</span> <span class="n">MASK_HDR</span><span class="p">))</span>
<a id="__codelineno-0-3351" name="__codelineno-0-3351"></a>
<a id="__codelineno-0-3352" name="__codelineno-0-3352"></a>    <span class="n">orientation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenType</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
<a id="__codelineno-0-3353" name="__codelineno-0-3353"></a>    <span class="k">if</span> <span class="n">orientation</span> <span class="o">!=</span> <span class="n">ORIENTATION_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3354" name="__codelineno-0-3354"></a>        <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="n">ORIENTATION_PORT</span><span class="p">:</span>
<a id="__codelineno-0-3355" name="__codelineno-0-3355"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;port&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3356" name="__codelineno-0-3356"></a>        <span class="k">elif</span> <span class="n">orientation</span> <span class="o">==</span> <span class="n">ORIENTATION_LAND</span><span class="p">:</span>
<a id="__codelineno-0-3357" name="__codelineno-0-3357"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;land&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3358" name="__codelineno-0-3358"></a>        <span class="k">elif</span> <span class="n">orientation</span> <span class="o">==</span> <span class="n">ORIENTATION_SQUARE</span><span class="p">:</span>
<a id="__codelineno-0-3359" name="__codelineno-0-3359"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;square&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3360" name="__codelineno-0-3360"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3361" name="__codelineno-0-3361"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;orientation_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">orientation</span><span class="p">)</span>
<a id="__codelineno-0-3362" name="__codelineno-0-3362"></a>
<a id="__codelineno-0-3363" name="__codelineno-0-3363"></a>    <span class="n">uiMode</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenConfig</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
<a id="__codelineno-0-3364" name="__codelineno-0-3364"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">uiMode</span> <span class="o">&amp;</span> <span class="n">MASK_UI_MODE_TYPE</span><span class="p">)</span> <span class="o">!=</span> <span class="n">UI_MODE_TYPE_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3365" name="__codelineno-0-3365"></a>        <span class="n">ui_mode</span> <span class="o">=</span> <span class="n">uiMode</span> <span class="o">&amp;</span> <span class="n">MASK_UI_MODE_TYPE</span>
<a id="__codelineno-0-3366" name="__codelineno-0-3366"></a>        <span class="k">if</span> <span class="n">ui_mode</span> <span class="o">==</span> <span class="n">UI_MODE_TYPE_DESK</span><span class="p">:</span>
<a id="__codelineno-0-3367" name="__codelineno-0-3367"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;desk&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3368" name="__codelineno-0-3368"></a>        <span class="k">elif</span> <span class="n">ui_mode</span> <span class="o">==</span> <span class="n">UI_MODE_TYPE_CAR</span><span class="p">:</span>
<a id="__codelineno-0-3369" name="__codelineno-0-3369"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;car&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3370" name="__codelineno-0-3370"></a>        <span class="k">elif</span> <span class="n">ui_mode</span> <span class="o">==</span> <span class="n">UI_MODE_TYPE_TELEVISION</span><span class="p">:</span>
<a id="__codelineno-0-3371" name="__codelineno-0-3371"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;television&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3372" name="__codelineno-0-3372"></a>        <span class="k">elif</span> <span class="n">ui_mode</span> <span class="o">==</span> <span class="n">UI_MODE_TYPE_APPLIANCE</span><span class="p">:</span>
<a id="__codelineno-0-3373" name="__codelineno-0-3373"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;appliance&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3374" name="__codelineno-0-3374"></a>        <span class="k">elif</span> <span class="n">ui_mode</span> <span class="o">==</span> <span class="n">UI_MODE_TYPE_WATCH</span><span class="p">:</span>
<a id="__codelineno-0-3375" name="__codelineno-0-3375"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;watch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3376" name="__codelineno-0-3376"></a>        <span class="k">elif</span> <span class="n">ui_mode</span> <span class="o">==</span> <span class="n">UI_MODE_TYPE_VR_HEADSET</span><span class="p">:</span>
<a id="__codelineno-0-3377" name="__codelineno-0-3377"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;vrheadset&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3378" name="__codelineno-0-3378"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3379" name="__codelineno-0-3379"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;uiModeType_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ui_mode</span><span class="p">)</span>
<a id="__codelineno-0-3380" name="__codelineno-0-3380"></a>
<a id="__codelineno-0-3381" name="__codelineno-0-3381"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">uiMode</span> <span class="o">&amp;</span> <span class="n">MASK_UI_MODE_NIGHT</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3382" name="__codelineno-0-3382"></a>        <span class="k">if</span> <span class="n">uiMode</span> <span class="o">&amp;</span> <span class="n">MASK_UI_MODE_NIGHT</span> <span class="o">==</span> <span class="n">UI_MODE_NIGHT_NO</span><span class="p">:</span>
<a id="__codelineno-0-3383" name="__codelineno-0-3383"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;notnight&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3384" name="__codelineno-0-3384"></a>        <span class="k">elif</span> <span class="n">uiMode</span> <span class="o">&amp;</span> <span class="n">MASK_UI_MODE_NIGHT</span> <span class="o">==</span> <span class="n">UI_MODE_NIGHT_YES</span><span class="p">:</span>
<a id="__codelineno-0-3385" name="__codelineno-0-3385"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;night&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3386" name="__codelineno-0-3386"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3387" name="__codelineno-0-3387"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;uiModeNight_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">uiMode</span> <span class="o">&amp;</span> <span class="n">MASK_UI_MODE_NIGHT</span><span class="p">))</span>
<a id="__codelineno-0-3388" name="__codelineno-0-3388"></a>
<a id="__codelineno-0-3389" name="__codelineno-0-3389"></a>    <span class="n">density</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenType</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3390" name="__codelineno-0-3390"></a>    <span class="k">if</span> <span class="n">density</span> <span class="o">!=</span> <span class="n">DENSITY_DEFAULT</span><span class="p">:</span>
<a id="__codelineno-0-3391" name="__codelineno-0-3391"></a>        <span class="k">if</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_LOW</span><span class="p">:</span>
<a id="__codelineno-0-3392" name="__codelineno-0-3392"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ldpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3393" name="__codelineno-0-3393"></a>        <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_MEDIUM</span><span class="p">:</span>
<a id="__codelineno-0-3394" name="__codelineno-0-3394"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;mdpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3395" name="__codelineno-0-3395"></a>        <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_TV</span><span class="p">:</span>
<a id="__codelineno-0-3396" name="__codelineno-0-3396"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;tvdpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3397" name="__codelineno-0-3397"></a>        <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_HIGH</span><span class="p">:</span>
<a id="__codelineno-0-3398" name="__codelineno-0-3398"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;hdpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3399" name="__codelineno-0-3399"></a>        <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_XHIGH</span><span class="p">:</span>
<a id="__codelineno-0-3400" name="__codelineno-0-3400"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;xhdpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3401" name="__codelineno-0-3401"></a>        <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_XXHIGH</span><span class="p">:</span>
<a id="__codelineno-0-3402" name="__codelineno-0-3402"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;xxhdpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3403" name="__codelineno-0-3403"></a>        <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_XXXHIGH</span><span class="p">:</span>
<a id="__codelineno-0-3404" name="__codelineno-0-3404"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;xxxhdpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3405" name="__codelineno-0-3405"></a>        <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_NONE</span><span class="p">:</span>
<a id="__codelineno-0-3406" name="__codelineno-0-3406"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;nodpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3407" name="__codelineno-0-3407"></a>        <span class="k">elif</span> <span class="n">density</span> <span class="o">==</span> <span class="n">DENSITY_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3408" name="__codelineno-0-3408"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;anydpi&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3409" name="__codelineno-0-3409"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3410" name="__codelineno-0-3410"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">dpi&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">density</span><span class="p">))</span>
<a id="__codelineno-0-3411" name="__codelineno-0-3411"></a>
<a id="__codelineno-0-3412" name="__codelineno-0-3412"></a>    <span class="n">touchscreen</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenType</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
<a id="__codelineno-0-3413" name="__codelineno-0-3413"></a>    <span class="k">if</span> <span class="n">touchscreen</span> <span class="o">!=</span> <span class="n">TOUCHSCREEN_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3414" name="__codelineno-0-3414"></a>        <span class="k">if</span> <span class="n">touchscreen</span> <span class="o">==</span> <span class="n">TOUCHSCREEN_NOTOUCH</span><span class="p">:</span>
<a id="__codelineno-0-3415" name="__codelineno-0-3415"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;notouch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3416" name="__codelineno-0-3416"></a>        <span class="k">elif</span> <span class="n">touchscreen</span> <span class="o">==</span> <span class="n">TOUCHSCREEN_FINGER</span><span class="p">:</span>
<a id="__codelineno-0-3417" name="__codelineno-0-3417"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;finger&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3418" name="__codelineno-0-3418"></a>        <span class="k">elif</span> <span class="n">touchscreen</span> <span class="o">==</span> <span class="n">TOUCHSCREEN_STYLUS</span><span class="p">:</span>
<a id="__codelineno-0-3419" name="__codelineno-0-3419"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;stylus&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3420" name="__codelineno-0-3420"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3421" name="__codelineno-0-3421"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;touchscreen_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">touchscreen</span><span class="p">)</span>
<a id="__codelineno-0-3422" name="__codelineno-0-3422"></a>
<a id="__codelineno-0-3423" name="__codelineno-0-3423"></a>    <span class="n">keyboard</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
<a id="__codelineno-0-3424" name="__codelineno-0-3424"></a>    <span class="n">navigation</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
<a id="__codelineno-0-3425" name="__codelineno-0-3425"></a>    <span class="n">inputFlags</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">&amp;</span> <span class="mh">0xFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3426" name="__codelineno-0-3426"></a>
<a id="__codelineno-0-3427" name="__codelineno-0-3427"></a>    <span class="k">if</span> <span class="n">inputFlags</span> <span class="o">&amp;</span> <span class="n">MASK_KEYSHIDDEN</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3428" name="__codelineno-0-3428"></a>        <span class="n">input_flags</span> <span class="o">=</span> <span class="n">inputFlags</span> <span class="o">&amp;</span> <span class="n">MASK_KEYSHIDDEN</span>
<a id="__codelineno-0-3429" name="__codelineno-0-3429"></a>        <span class="k">if</span> <span class="n">input_flags</span> <span class="o">==</span> <span class="n">KEYSHIDDEN_NO</span><span class="p">:</span>
<a id="__codelineno-0-3430" name="__codelineno-0-3430"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;keysexposed&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3431" name="__codelineno-0-3431"></a>        <span class="k">elif</span> <span class="n">input_flags</span> <span class="o">==</span> <span class="n">KEYSHIDDEN_YES</span><span class="p">:</span>
<a id="__codelineno-0-3432" name="__codelineno-0-3432"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;keyshidden&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3433" name="__codelineno-0-3433"></a>        <span class="k">elif</span> <span class="n">input_flags</span> <span class="o">==</span> <span class="n">KEYSHIDDEN_SOFT</span><span class="p">:</span>
<a id="__codelineno-0-3434" name="__codelineno-0-3434"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;keyssoft&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3435" name="__codelineno-0-3435"></a>
<a id="__codelineno-0-3436" name="__codelineno-0-3436"></a>    <span class="k">if</span> <span class="n">keyboard</span> <span class="o">!=</span> <span class="n">KEYBOARD_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3437" name="__codelineno-0-3437"></a>        <span class="k">if</span> <span class="n">keyboard</span> <span class="o">==</span> <span class="n">KEYBOARD_NOKEYS</span><span class="p">:</span>
<a id="__codelineno-0-3438" name="__codelineno-0-3438"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;nokeys&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3439" name="__codelineno-0-3439"></a>        <span class="k">elif</span> <span class="n">keyboard</span> <span class="o">==</span> <span class="n">KEYBOARD_QWERTY</span><span class="p">:</span>
<a id="__codelineno-0-3440" name="__codelineno-0-3440"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;qwerty&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3441" name="__codelineno-0-3441"></a>        <span class="k">elif</span> <span class="n">keyboard</span> <span class="o">==</span> <span class="n">KEYBOARD_12KEY</span><span class="p">:</span>
<a id="__codelineno-0-3442" name="__codelineno-0-3442"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;12key&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3443" name="__codelineno-0-3443"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3444" name="__codelineno-0-3444"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;keyboard_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">keyboard</span><span class="p">)</span>
<a id="__codelineno-0-3445" name="__codelineno-0-3445"></a>
<a id="__codelineno-0-3446" name="__codelineno-0-3446"></a>    <span class="k">if</span> <span class="n">inputFlags</span> <span class="o">&amp;</span> <span class="n">MASK_NAVHIDDEN</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3447" name="__codelineno-0-3447"></a>        <span class="n">input_flags</span> <span class="o">=</span> <span class="n">inputFlags</span> <span class="o">&amp;</span> <span class="n">MASK_NAVHIDDEN</span>
<a id="__codelineno-0-3448" name="__codelineno-0-3448"></a>        <span class="k">if</span> <span class="n">input_flags</span> <span class="o">==</span> <span class="n">NAVHIDDEN_NO</span><span class="p">:</span>
<a id="__codelineno-0-3449" name="__codelineno-0-3449"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;navexposed&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3450" name="__codelineno-0-3450"></a>        <span class="k">elif</span> <span class="n">input_flags</span> <span class="o">==</span> <span class="n">NAVHIDDEN_YES</span><span class="p">:</span>
<a id="__codelineno-0-3451" name="__codelineno-0-3451"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;navhidden&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3452" name="__codelineno-0-3452"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3453" name="__codelineno-0-3453"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;inputFlagsNavHidden_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">input_flags</span><span class="p">)</span>
<a id="__codelineno-0-3454" name="__codelineno-0-3454"></a>
<a id="__codelineno-0-3455" name="__codelineno-0-3455"></a>    <span class="k">if</span> <span class="n">navigation</span> <span class="o">!=</span> <span class="n">NAVIGATION_ANY</span><span class="p">:</span>
<a id="__codelineno-0-3456" name="__codelineno-0-3456"></a>        <span class="k">if</span> <span class="n">navigation</span> <span class="o">==</span> <span class="n">NAVIGATION_NONAV</span><span class="p">:</span>
<a id="__codelineno-0-3457" name="__codelineno-0-3457"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;nonav&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3458" name="__codelineno-0-3458"></a>        <span class="k">elif</span> <span class="n">navigation</span> <span class="o">==</span> <span class="n">NAVIGATION_DPAD</span><span class="p">:</span>
<a id="__codelineno-0-3459" name="__codelineno-0-3459"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;dpad&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3460" name="__codelineno-0-3460"></a>        <span class="k">elif</span> <span class="n">navigation</span> <span class="o">==</span> <span class="n">NAVIGATION_TRACKBALL</span><span class="p">:</span>
<a id="__codelineno-0-3461" name="__codelineno-0-3461"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;trackball&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3462" name="__codelineno-0-3462"></a>        <span class="k">elif</span> <span class="n">navigation</span> <span class="o">==</span> <span class="n">NAVIGATION_WHEEL</span><span class="p">:</span>
<a id="__codelineno-0-3463" name="__codelineno-0-3463"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;wheel&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3464" name="__codelineno-0-3464"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3465" name="__codelineno-0-3465"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;navigation_</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">navigation</span><span class="p">)</span>
<a id="__codelineno-0-3466" name="__codelineno-0-3466"></a>
<a id="__codelineno-0-3467" name="__codelineno-0-3467"></a>    <span class="n">screenSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenSize</span>
<a id="__codelineno-0-3468" name="__codelineno-0-3468"></a>    <span class="k">if</span> <span class="n">screenSize</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3469" name="__codelineno-0-3469"></a>        <span class="n">screenWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenSize</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>
<a id="__codelineno-0-3470" name="__codelineno-0-3470"></a>        <span class="n">screenHeight</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">screenSize</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3471" name="__codelineno-0-3471"></a>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">x</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">screenWidth</span><span class="p">,</span> <span class="n">screenHeight</span><span class="p">))</span>
<a id="__codelineno-0-3472" name="__codelineno-0-3472"></a>
<a id="__codelineno-0-3473" name="__codelineno-0-3473"></a>    <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span>
<a id="__codelineno-0-3474" name="__codelineno-0-3474"></a>    <span class="k">if</span> <span class="n">version</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3475" name="__codelineno-0-3475"></a>        <span class="n">sdkVersion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>
<a id="__codelineno-0-3476" name="__codelineno-0-3476"></a>        <span class="n">minorVersion</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
<a id="__codelineno-0-3477" name="__codelineno-0-3477"></a>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;v</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sdkVersion</span><span class="p">)</span>
<a id="__codelineno-0-3478" name="__codelineno-0-3478"></a>        <span class="k">if</span> <span class="n">minorVersion</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3479" name="__codelineno-0-3479"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;.</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">minorVersion</span><span class="p">)</span>
<a id="__codelineno-0-3480" name="__codelineno-0-3480"></a>
<a id="__codelineno-0-3481" name="__codelineno-0-3481"></a>    <span class="k">return</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.ARSCResTableConfig.is_default" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_default</span><span class="p">()</span></code>

<a href="#androguard.core.axml.ARSCResTableConfig.is_default" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Test if this is a default resource, which matches all</p>
<p>This is indicated that all fields are zero.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if default, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3495">3495</a></span>
<span class="normal"><a href="#__codelineno-0-3496">3496</a></span>
<span class="normal"><a href="#__codelineno-0-3497">3497</a></span>
<span class="normal"><a href="#__codelineno-0-3498">3498</a></span>
<span class="normal"><a href="#__codelineno-0-3499">3499</a></span>
<span class="normal"><a href="#__codelineno-0-3500">3500</a></span>
<span class="normal"><a href="#__codelineno-0-3501">3501</a></span>
<span class="normal"><a href="#__codelineno-0-3502">3502</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-3495" name="__codelineno-0-3495"></a><span class="k">def</span> <span class="nf">is_default</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-3496" name="__codelineno-0-3496"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3497" name="__codelineno-0-3497"></a><span class="sd">    Test if this is a default resource, which matches all</span>
<a id="__codelineno-0-3498" name="__codelineno-0-3498"></a>
<a id="__codelineno-0-3499" name="__codelineno-0-3499"></a><span class="sd">    This is indicated that all fields are zero.</span>
<a id="__codelineno-0-3500" name="__codelineno-0-3500"></a><span class="sd">    :returns: True if default, False otherwise</span>
<a id="__codelineno-0-3501" name="__codelineno-0-3501"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-3502" name="__codelineno-0-3502"></a>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_tuple</span><span class="p">()))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.ARSCResTableEntry" class="doc doc-heading">
            <code>ARSCResTableEntry</code>


<a href="#androguard.core.axml.ARSCResTableEntry" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>A <code>ResTable_entry</code>.</p>
<p>See <a href="https://cs.android.com/android/platform/superproject/main/+/main:frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h;l=1522;drc=442fcb158a5b2e23340b74ce2e29e5e1f5bf9d66;bpv=0;bpt=0">https://cs.android.com/android/platform/superproject/main/+/main:frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h;l=1522;drc=442fcb158a5b2e23340b74ce2e29e5e1f5bf9d66;bpv=0;bpt=0</a></p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3529">3529</a></span>
<span class="normal"><a href="#__codelineno-0-3530">3530</a></span>
<span class="normal"><a href="#__codelineno-0-3531">3531</a></span>
<span class="normal"><a href="#__codelineno-0-3532">3532</a></span>
<span class="normal"><a href="#__codelineno-0-3533">3533</a></span>
<span class="normal"><a href="#__codelineno-0-3534">3534</a></span>
<span class="normal"><a href="#__codelineno-0-3535">3535</a></span>
<span class="normal"><a href="#__codelineno-0-3536">3536</a></span>
<span class="normal"><a href="#__codelineno-0-3537">3537</a></span>
<span class="normal"><a href="#__codelineno-0-3538">3538</a></span>
<span class="normal"><a href="#__codelineno-0-3539">3539</a></span>
<span class="normal"><a href="#__codelineno-0-3540">3540</a></span>
<span class="normal"><a href="#__codelineno-0-3541">3541</a></span>
<span class="normal"><a href="#__codelineno-0-3542">3542</a></span>
<span class="normal"><a href="#__codelineno-0-3543">3543</a></span>
<span class="normal"><a href="#__codelineno-0-3544">3544</a></span>
<span class="normal"><a href="#__codelineno-0-3545">3545</a></span>
<span class="normal"><a href="#__codelineno-0-3546">3546</a></span>
<span class="normal"><a href="#__codelineno-0-3547">3547</a></span>
<span class="normal"><a href="#__codelineno-0-3548">3548</a></span>
<span class="normal"><a href="#__codelineno-0-3549">3549</a></span>
<span class="normal"><a href="#__codelineno-0-3550">3550</a></span>
<span class="normal"><a href="#__codelineno-0-3551">3551</a></span>
<span class="normal"><a href="#__codelineno-0-3552">3552</a></span>
<span class="normal"><a href="#__codelineno-0-3553">3553</a></span>
<span class="normal"><a href="#__codelineno-0-3554">3554</a></span>
<span class="normal"><a href="#__codelineno-0-3555">3555</a></span>
<span class="normal"><a href="#__codelineno-0-3556">3556</a></span>
<span class="normal"><a href="#__codelineno-0-3557">3557</a></span>
<span class="normal"><a href="#__codelineno-0-3558">3558</a></span>
<span class="normal"><a href="#__codelineno-0-3559">3559</a></span>
<span class="normal"><a href="#__codelineno-0-3560">3560</a></span>
<span class="normal"><a href="#__codelineno-0-3561">3561</a></span>
<span class="normal"><a href="#__codelineno-0-3562">3562</a></span>
<span class="normal"><a href="#__codelineno-0-3563">3563</a></span>
<span class="normal"><a href="#__codelineno-0-3564">3564</a></span>
<span class="normal"><a href="#__codelineno-0-3565">3565</a></span>
<span class="normal"><a href="#__codelineno-0-3566">3566</a></span>
<span class="normal"><a href="#__codelineno-0-3567">3567</a></span>
<span class="normal"><a href="#__codelineno-0-3568">3568</a></span>
<span class="normal"><a href="#__codelineno-0-3569">3569</a></span>
<span class="normal"><a href="#__codelineno-0-3570">3570</a></span>
<span class="normal"><a href="#__codelineno-0-3571">3571</a></span>
<span class="normal"><a href="#__codelineno-0-3572">3572</a></span>
<span class="normal"><a href="#__codelineno-0-3573">3573</a></span>
<span class="normal"><a href="#__codelineno-0-3574">3574</a></span>
<span class="normal"><a href="#__codelineno-0-3575">3575</a></span>
<span class="normal"><a href="#__codelineno-0-3576">3576</a></span>
<span class="normal"><a href="#__codelineno-0-3577">3577</a></span>
<span class="normal"><a href="#__codelineno-0-3578">3578</a></span>
<span class="normal"><a href="#__codelineno-0-3579">3579</a></span>
<span class="normal"><a href="#__codelineno-0-3580">3580</a></span>
<span class="normal"><a href="#__codelineno-0-3581">3581</a></span>
<span class="normal"><a href="#__codelineno-0-3582">3582</a></span>
<span class="normal"><a href="#__codelineno-0-3583">3583</a></span>
<span class="normal"><a href="#__codelineno-0-3584">3584</a></span>
<span class="normal"><a href="#__codelineno-0-3585">3585</a></span>
<span class="normal"><a href="#__codelineno-0-3586">3586</a></span>
<span class="normal"><a href="#__codelineno-0-3587">3587</a></span>
<span class="normal"><a href="#__codelineno-0-3588">3588</a></span>
<span class="normal"><a href="#__codelineno-0-3589">3589</a></span>
<span class="normal"><a href="#__codelineno-0-3590">3590</a></span>
<span class="normal"><a href="#__codelineno-0-3591">3591</a></span>
<span class="normal"><a href="#__codelineno-0-3592">3592</a></span>
<span class="normal"><a href="#__codelineno-0-3593">3593</a></span>
<span class="normal"><a href="#__codelineno-0-3594">3594</a></span>
<span class="normal"><a href="#__codelineno-0-3595">3595</a></span>
<span class="normal"><a href="#__codelineno-0-3596">3596</a></span>
<span class="normal"><a href="#__codelineno-0-3597">3597</a></span>
<span class="normal"><a href="#__codelineno-0-3598">3598</a></span>
<span class="normal"><a href="#__codelineno-0-3599">3599</a></span>
<span class="normal"><a href="#__codelineno-0-3600">3600</a></span>
<span class="normal"><a href="#__codelineno-0-3601">3601</a></span>
<span class="normal"><a href="#__codelineno-0-3602">3602</a></span>
<span class="normal"><a href="#__codelineno-0-3603">3603</a></span>
<span class="normal"><a href="#__codelineno-0-3604">3604</a></span>
<span class="normal"><a href="#__codelineno-0-3605">3605</a></span>
<span class="normal"><a href="#__codelineno-0-3606">3606</a></span>
<span class="normal"><a href="#__codelineno-0-3607">3607</a></span>
<span class="normal"><a href="#__codelineno-0-3608">3608</a></span>
<span class="normal"><a href="#__codelineno-0-3609">3609</a></span>
<span class="normal"><a href="#__codelineno-0-3610">3610</a></span>
<span class="normal"><a href="#__codelineno-0-3611">3611</a></span>
<span class="normal"><a href="#__codelineno-0-3612">3612</a></span>
<span class="normal"><a href="#__codelineno-0-3613">3613</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-3529" name="__codelineno-0-3529"></a><span class="k">class</span> <span class="nc">ARSCResTableEntry</span><span class="p">:</span>
<a id="__codelineno-0-3530" name="__codelineno-0-3530"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3531" name="__codelineno-0-3531"></a><span class="sd">    A `ResTable_entry`.</span>
<a id="__codelineno-0-3532" name="__codelineno-0-3532"></a>
<a id="__codelineno-0-3533" name="__codelineno-0-3533"></a><span class="sd">    See &lt;https://cs.android.com/android/platform/superproject/main/+/main:frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h;l=1522;drc=442fcb158a5b2e23340b74ce2e29e5e1f5bf9d66;bpv=0;bpt=0&gt;</span>
<a id="__codelineno-0-3534" name="__codelineno-0-3534"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-3535" name="__codelineno-0-3535"></a>
<a id="__codelineno-0-3536" name="__codelineno-0-3536"></a>    <span class="c1"># If set, this is a complex entry, holding a set of name/value</span>
<a id="__codelineno-0-3537" name="__codelineno-0-3537"></a>    <span class="c1"># mappings.  It is followed by an array of ResTable_map structures.</span>
<a id="__codelineno-0-3538" name="__codelineno-0-3538"></a>    <span class="n">FLAG_COMPLEX</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-3539" name="__codelineno-0-3539"></a>
<a id="__codelineno-0-3540" name="__codelineno-0-3540"></a>    <span class="c1"># If set, this resource has been declared public, so libraries</span>
<a id="__codelineno-0-3541" name="__codelineno-0-3541"></a>    <span class="c1"># are allowed to reference it.</span>
<a id="__codelineno-0-3542" name="__codelineno-0-3542"></a>    <span class="n">FLAG_PUBLIC</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-0-3543" name="__codelineno-0-3543"></a>
<a id="__codelineno-0-3544" name="__codelineno-0-3544"></a>    <span class="c1"># If set, this is a weak resource and may be overriden by strong</span>
<a id="__codelineno-0-3545" name="__codelineno-0-3545"></a>    <span class="c1"># resources of the same name/type. This is only useful during</span>
<a id="__codelineno-0-3546" name="__codelineno-0-3546"></a>    <span class="c1"># linking with other resource tables.</span>
<a id="__codelineno-0-3547" name="__codelineno-0-3547"></a>    <span class="n">FLAG_WEAK</span> <span class="o">=</span> <span class="mi">4</span>
<a id="__codelineno-0-3548" name="__codelineno-0-3548"></a>
<a id="__codelineno-0-3549" name="__codelineno-0-3549"></a>    <span class="c1"># If set, this is a compact entry with data type and value directly</span>
<a id="__codelineno-0-3550" name="__codelineno-0-3550"></a>    <span class="c1"># encoded in this entry</span>
<a id="__codelineno-0-3551" name="__codelineno-0-3551"></a>    <span class="n">FLAG_COMPACT</span> <span class="o">=</span> <span class="mi">8</span>
<a id="__codelineno-0-3552" name="__codelineno-0-3552"></a>
<a id="__codelineno-0-3553" name="__codelineno-0-3553"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-3554" name="__codelineno-0-3554"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-3555" name="__codelineno-0-3555"></a>        <span class="n">buff</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span>
<a id="__codelineno-0-3556" name="__codelineno-0-3556"></a>        <span class="n">entry_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-3557" name="__codelineno-0-3557"></a>        <span class="n">expected_end_of_chunk</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-3558" name="__codelineno-0-3558"></a>        <span class="n">mResId</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-3559" name="__codelineno-0-3559"></a>        <span class="n">parent</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PackageContext</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-3560" name="__codelineno-0-3560"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-3561" name="__codelineno-0-3561"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">entry_offset</span><span class="p">)</span>
<a id="__codelineno-0-3562" name="__codelineno-0-3562"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mResId</span> <span class="o">=</span> <span class="n">mResId</span>
<a id="__codelineno-0-3563" name="__codelineno-0-3563"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
<a id="__codelineno-0-3564" name="__codelineno-0-3564"></a>
<a id="__codelineno-0-3565" name="__codelineno-0-3565"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3566" name="__codelineno-0-3566"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3567" name="__codelineno-0-3567"></a>        <span class="c1"># This is a ResStringPool_ref</span>
<a id="__codelineno-0-3568" name="__codelineno-0-3568"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-3569" name="__codelineno-0-3569"></a>
<a id="__codelineno-0-3570" name="__codelineno-0-3570"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">():</span>
<a id="__codelineno-0-3571" name="__codelineno-0-3571"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="n">ARSCComplex</span><span class="p">(</span><span class="n">buff</span><span class="p">,</span> <span class="n">expected_end_of_chunk</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
<a id="__codelineno-0-3572" name="__codelineno-0-3572"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_compact</span><span class="p">():</span>
<a id="__codelineno-0-3573" name="__codelineno-0-3573"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-3574" name="__codelineno-0-3574"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span>
<a id="__codelineno-0-3575" name="__codelineno-0-3575"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
<a id="__codelineno-0-3576" name="__codelineno-0-3576"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3577" name="__codelineno-0-3577"></a>            <span class="c1"># If FLAG_COMPLEX is not set, a Res_value structure will follow</span>
<a id="__codelineno-0-3578" name="__codelineno-0-3578"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">ARSCResStringPoolRef</span><span class="p">(</span><span class="n">buff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
<a id="__codelineno-0-3579" name="__codelineno-0-3579"></a>
<a id="__codelineno-0-3580" name="__codelineno-0-3580"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_weak</span><span class="p">():</span>
<a id="__codelineno-0-3581" name="__codelineno-0-3581"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Parsed </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
<a id="__codelineno-0-3582" name="__codelineno-0-3582"></a>
<a id="__codelineno-0-3583" name="__codelineno-0-3583"></a>    <span class="k">def</span> <span class="nf">get_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-3584" name="__codelineno-0-3584"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span>
<a id="__codelineno-0-3585" name="__codelineno-0-3585"></a>
<a id="__codelineno-0-3586" name="__codelineno-0-3586"></a>    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3587" name="__codelineno-0-3587"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mKeyStrings</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-3588" name="__codelineno-0-3588"></a>
<a id="__codelineno-0-3589" name="__codelineno-0-3589"></a>    <span class="k">def</span> <span class="nf">get_key_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3590" name="__codelineno-0-3590"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_compact</span><span class="p">():</span>
<a id="__codelineno-0-3591" name="__codelineno-0-3591"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">stringpool_main</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-3592" name="__codelineno-0-3592"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-3593" name="__codelineno-0-3593"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">get_data_value</span><span class="p">()</span>
<a id="__codelineno-0-3594" name="__codelineno-0-3594"></a>
<a id="__codelineno-0-3595" name="__codelineno-0-3595"></a>    <span class="k">def</span> <span class="nf">is_public</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-3596" name="__codelineno-0-3596"></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">FLAG_PUBLIC</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
<a id="__codelineno-0-3597" name="__codelineno-0-3597"></a>
<a id="__codelineno-0-3598" name="__codelineno-0-3598"></a>    <span class="k">def</span> <span class="nf">is_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-3599" name="__codelineno-0-3599"></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">FLAG_COMPLEX</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
<a id="__codelineno-0-3600" name="__codelineno-0-3600"></a>
<a id="__codelineno-0-3601" name="__codelineno-0-3601"></a>    <span class="k">def</span> <span class="nf">is_compact</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-3602" name="__codelineno-0-3602"></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">FLAG_COMPACT</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
<a id="__codelineno-0-3603" name="__codelineno-0-3603"></a>
<a id="__codelineno-0-3604" name="__codelineno-0-3604"></a>    <span class="k">def</span> <span class="nf">is_weak</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-3605" name="__codelineno-0-3605"></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">FLAG_WEAK</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
<a id="__codelineno-0-3606" name="__codelineno-0-3606"></a>
<a id="__codelineno-0-3607" name="__codelineno-0-3607"></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-3608" name="__codelineno-0-3608"></a>        <span class="k">return</span> <span class="s2">&quot;&lt;ARSCResTableEntry idx=&#39;0x</span><span class="si">{:08x}</span><span class="s2">&#39; mResId=&#39;0x</span><span class="si">{:08x}</span><span class="s2">&#39; flags=&#39;0x</span><span class="si">{:02x}</span><span class="s2">&#39; holding=</span><span class="si">{}</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-3609" name="__codelineno-0-3609"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
<a id="__codelineno-0-3610" name="__codelineno-0-3610"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mResId</span><span class="p">,</span>
<a id="__codelineno-0-3611" name="__codelineno-0-3611"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span>
<a id="__codelineno-0-3612" name="__codelineno-0-3612"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">()</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span>
<a id="__codelineno-0-3613" name="__codelineno-0-3613"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.ARSCResTablePackage" class="doc doc-heading">
            <code>ARSCResTablePackage</code>


<a href="#androguard.core.axml.ARSCResTablePackage" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>A <code>ResTable_package</code></p>
<p>See http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#861</p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2893">2893</a></span>
<span class="normal"><a href="#__codelineno-0-2894">2894</a></span>
<span class="normal"><a href="#__codelineno-0-2895">2895</a></span>
<span class="normal"><a href="#__codelineno-0-2896">2896</a></span>
<span class="normal"><a href="#__codelineno-0-2897">2897</a></span>
<span class="normal"><a href="#__codelineno-0-2898">2898</a></span>
<span class="normal"><a href="#__codelineno-0-2899">2899</a></span>
<span class="normal"><a href="#__codelineno-0-2900">2900</a></span>
<span class="normal"><a href="#__codelineno-0-2901">2901</a></span>
<span class="normal"><a href="#__codelineno-0-2902">2902</a></span>
<span class="normal"><a href="#__codelineno-0-2903">2903</a></span>
<span class="normal"><a href="#__codelineno-0-2904">2904</a></span>
<span class="normal"><a href="#__codelineno-0-2905">2905</a></span>
<span class="normal"><a href="#__codelineno-0-2906">2906</a></span>
<span class="normal"><a href="#__codelineno-0-2907">2907</a></span>
<span class="normal"><a href="#__codelineno-0-2908">2908</a></span>
<span class="normal"><a href="#__codelineno-0-2909">2909</a></span>
<span class="normal"><a href="#__codelineno-0-2910">2910</a></span>
<span class="normal"><a href="#__codelineno-0-2911">2911</a></span>
<span class="normal"><a href="#__codelineno-0-2912">2912</a></span>
<span class="normal"><a href="#__codelineno-0-2913">2913</a></span>
<span class="normal"><a href="#__codelineno-0-2914">2914</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2893" name="__codelineno-0-2893"></a><span class="k">class</span> <span class="nc">ARSCResTablePackage</span><span class="p">:</span>
<a id="__codelineno-0-2894" name="__codelineno-0-2894"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2895" name="__codelineno-0-2895"></a><span class="sd">    A `ResTable_package`</span>
<a id="__codelineno-0-2896" name="__codelineno-0-2896"></a>
<a id="__codelineno-0-2897" name="__codelineno-0-2897"></a><span class="sd">    See http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#861</span>
<a id="__codelineno-0-2898" name="__codelineno-0-2898"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2899" name="__codelineno-0-2899"></a>
<a id="__codelineno-0-2900" name="__codelineno-0-2900"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buff</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span> <span class="n">header</span><span class="p">:</span> <span class="n">ARSCHeader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2901" name="__codelineno-0-2901"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">header</span>
<a id="__codelineno-0-2902" name="__codelineno-0-2902"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2903" name="__codelineno-0-2903"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2904" name="__codelineno-0-2904"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
<a id="__codelineno-0-2905" name="__codelineno-0-2905"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">typeStrings</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2906" name="__codelineno-0-2906"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lastPublicType</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2907" name="__codelineno-0-2907"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">keyStrings</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2908" name="__codelineno-0-2908"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lastPublicKey</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2909" name="__codelineno-0-2909"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mResId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span>
<a id="__codelineno-0-2910" name="__codelineno-0-2910"></a>
<a id="__codelineno-0-2911" name="__codelineno-0-2911"></a>    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2912" name="__codelineno-0-2912"></a>        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-16&quot;</span><span class="p">,</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2913" name="__codelineno-0-2913"></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[:</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)]</span>
<a id="__codelineno-0-2914" name="__codelineno-0-2914"></a>        <span class="k">return</span> <span class="n">name</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.ARSCResType" class="doc doc-heading">
            <code>ARSCResType</code>


<a href="#androguard.core.axml.ARSCResType" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>This is a <code>ResTable_type</code> without it's <code>ResChunk_header</code>.
It contains a <code>ResTable_config</code></p>
<p>See http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#1364</p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2945">2945</a></span>
<span class="normal"><a href="#__codelineno-0-2946">2946</a></span>
<span class="normal"><a href="#__codelineno-0-2947">2947</a></span>
<span class="normal"><a href="#__codelineno-0-2948">2948</a></span>
<span class="normal"><a href="#__codelineno-0-2949">2949</a></span>
<span class="normal"><a href="#__codelineno-0-2950">2950</a></span>
<span class="normal"><a href="#__codelineno-0-2951">2951</a></span>
<span class="normal"><a href="#__codelineno-0-2952">2952</a></span>
<span class="normal"><a href="#__codelineno-0-2953">2953</a></span>
<span class="normal"><a href="#__codelineno-0-2954">2954</a></span>
<span class="normal"><a href="#__codelineno-0-2955">2955</a></span>
<span class="normal"><a href="#__codelineno-0-2956">2956</a></span>
<span class="normal"><a href="#__codelineno-0-2957">2957</a></span>
<span class="normal"><a href="#__codelineno-0-2958">2958</a></span>
<span class="normal"><a href="#__codelineno-0-2959">2959</a></span>
<span class="normal"><a href="#__codelineno-0-2960">2960</a></span>
<span class="normal"><a href="#__codelineno-0-2961">2961</a></span>
<span class="normal"><a href="#__codelineno-0-2962">2962</a></span>
<span class="normal"><a href="#__codelineno-0-2963">2963</a></span>
<span class="normal"><a href="#__codelineno-0-2964">2964</a></span>
<span class="normal"><a href="#__codelineno-0-2965">2965</a></span>
<span class="normal"><a href="#__codelineno-0-2966">2966</a></span>
<span class="normal"><a href="#__codelineno-0-2967">2967</a></span>
<span class="normal"><a href="#__codelineno-0-2968">2968</a></span>
<span class="normal"><a href="#__codelineno-0-2969">2969</a></span>
<span class="normal"><a href="#__codelineno-0-2970">2970</a></span>
<span class="normal"><a href="#__codelineno-0-2971">2971</a></span>
<span class="normal"><a href="#__codelineno-0-2972">2972</a></span>
<span class="normal"><a href="#__codelineno-0-2973">2973</a></span>
<span class="normal"><a href="#__codelineno-0-2974">2974</a></span>
<span class="normal"><a href="#__codelineno-0-2975">2975</a></span>
<span class="normal"><a href="#__codelineno-0-2976">2976</a></span>
<span class="normal"><a href="#__codelineno-0-2977">2977</a></span>
<span class="normal"><a href="#__codelineno-0-2978">2978</a></span>
<span class="normal"><a href="#__codelineno-0-2979">2979</a></span>
<span class="normal"><a href="#__codelineno-0-2980">2980</a></span>
<span class="normal"><a href="#__codelineno-0-2981">2981</a></span>
<span class="normal"><a href="#__codelineno-0-2982">2982</a></span>
<span class="normal"><a href="#__codelineno-0-2983">2983</a></span>
<span class="normal"><a href="#__codelineno-0-2984">2984</a></span>
<span class="normal"><a href="#__codelineno-0-2985">2985</a></span>
<span class="normal"><a href="#__codelineno-0-2986">2986</a></span>
<span class="normal"><a href="#__codelineno-0-2987">2987</a></span>
<span class="normal"><a href="#__codelineno-0-2988">2988</a></span>
<span class="normal"><a href="#__codelineno-0-2989">2989</a></span>
<span class="normal"><a href="#__codelineno-0-2990">2990</a></span>
<span class="normal"><a href="#__codelineno-0-2991">2991</a></span>
<span class="normal"><a href="#__codelineno-0-2992">2992</a></span>
<span class="normal"><a href="#__codelineno-0-2993">2993</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2945" name="__codelineno-0-2945"></a><span class="k">class</span> <span class="nc">ARSCResType</span><span class="p">:</span>
<a id="__codelineno-0-2946" name="__codelineno-0-2946"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2947" name="__codelineno-0-2947"></a><span class="sd">    This is a `ResTable_type` without it&#39;s `ResChunk_header`.</span>
<a id="__codelineno-0-2948" name="__codelineno-0-2948"></a><span class="sd">    It contains a `ResTable_config`</span>
<a id="__codelineno-0-2949" name="__codelineno-0-2949"></a>
<a id="__codelineno-0-2950" name="__codelineno-0-2950"></a><span class="sd">    See http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#1364</span>
<a id="__codelineno-0-2951" name="__codelineno-0-2951"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2952" name="__codelineno-0-2952"></a>
<a id="__codelineno-0-2953" name="__codelineno-0-2953"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-2954" name="__codelineno-0-2954"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">buff</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PackageContext</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2955" name="__codelineno-0-2955"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2956" name="__codelineno-0-2956"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2957" name="__codelineno-0-2957"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
<a id="__codelineno-0-2958" name="__codelineno-0-2958"></a>
<a id="__codelineno-0-2959" name="__codelineno-0-2959"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2960" name="__codelineno-0-2960"></a>        <span class="c1"># TODO there is now FLAG_SPARSE: http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#1401</span>
<a id="__codelineno-0-2961" name="__codelineno-0-2961"></a>        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-2962" name="__codelineno-0-2962"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reserved</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2963" name="__codelineno-0-2963"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-2964" name="__codelineno-0-2964"></a>            <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span><span class="s2">&quot;reserved must be zero!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2965" name="__codelineno-0-2965"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entryCount</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2966" name="__codelineno-0-2966"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">entriesStart</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2967" name="__codelineno-0-2967"></a>
<a id="__codelineno-0-2968" name="__codelineno-0-2968"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mResId</span> <span class="o">=</span> <span class="p">(</span><span class="mh">0xFF000000</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">get_mResId</span><span class="p">())</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span>
<a id="__codelineno-0-2969" name="__codelineno-0-2969"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">set_mResId</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mResId</span><span class="p">)</span>
<a id="__codelineno-0-2970" name="__codelineno-0-2970"></a>
<a id="__codelineno-0-2971" name="__codelineno-0-2971"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">ARSCResTableConfig</span><span class="p">(</span><span class="n">buff</span><span class="p">)</span>
<a id="__codelineno-0-2972" name="__codelineno-0-2972"></a>
<a id="__codelineno-0-2973" name="__codelineno-0-2973"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Parsed </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
<a id="__codelineno-0-2974" name="__codelineno-0-2974"></a>
<a id="__codelineno-0-2975" name="__codelineno-0-2975"></a>    <span class="k">def</span> <span class="nf">get_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-2976" name="__codelineno-0-2976"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mTableStrings</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-2977" name="__codelineno-0-2977"></a>
<a id="__codelineno-0-2978" name="__codelineno-0-2978"></a>    <span class="k">def</span> <span class="nf">get_package_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-2979" name="__codelineno-0-2979"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">get_package_name</span><span class="p">()</span>
<a id="__codelineno-0-2980" name="__codelineno-0-2980"></a>
<a id="__codelineno-0-2981" name="__codelineno-0-2981"></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2982" name="__codelineno-0-2982"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-2983" name="__codelineno-0-2983"></a>            <span class="s2">&quot;&lt;ARSCResType(start=0x</span><span class="si">%x</span><span class="s2">, id=0x</span><span class="si">%x</span><span class="s2">, flags=0x</span><span class="si">%x</span><span class="s2">, entryCount=</span><span class="si">%d</span><span class="s2">, entriesStart=0x</span><span class="si">%x</span><span class="s2">, mResId=0x</span><span class="si">%x</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&gt;&quot;</span>
<a id="__codelineno-0-2984" name="__codelineno-0-2984"></a>            <span class="o">%</span> <span class="p">(</span>
<a id="__codelineno-0-2985" name="__codelineno-0-2985"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
<a id="__codelineno-0-2986" name="__codelineno-0-2986"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<a id="__codelineno-0-2987" name="__codelineno-0-2987"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span>
<a id="__codelineno-0-2988" name="__codelineno-0-2988"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">entryCount</span><span class="p">,</span>
<a id="__codelineno-0-2989" name="__codelineno-0-2989"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">entriesStart</span><span class="p">,</span>
<a id="__codelineno-0-2990" name="__codelineno-0-2990"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mResId</span><span class="p">,</span>
<a id="__codelineno-0-2991" name="__codelineno-0-2991"></a>                <span class="s2">&quot;table:&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mTableStrings</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-2992" name="__codelineno-0-2992"></a>            <span class="p">)</span>
<a id="__codelineno-0-2993" name="__codelineno-0-2993"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.ARSCResTypeSpec" class="doc doc-heading">
            <code>ARSCResTypeSpec</code>


<a href="#androguard.core.axml.ARSCResTypeSpec" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>See http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#1327</p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2917">2917</a></span>
<span class="normal"><a href="#__codelineno-0-2918">2918</a></span>
<span class="normal"><a href="#__codelineno-0-2919">2919</a></span>
<span class="normal"><a href="#__codelineno-0-2920">2920</a></span>
<span class="normal"><a href="#__codelineno-0-2921">2921</a></span>
<span class="normal"><a href="#__codelineno-0-2922">2922</a></span>
<span class="normal"><a href="#__codelineno-0-2923">2923</a></span>
<span class="normal"><a href="#__codelineno-0-2924">2924</a></span>
<span class="normal"><a href="#__codelineno-0-2925">2925</a></span>
<span class="normal"><a href="#__codelineno-0-2926">2926</a></span>
<span class="normal"><a href="#__codelineno-0-2927">2927</a></span>
<span class="normal"><a href="#__codelineno-0-2928">2928</a></span>
<span class="normal"><a href="#__codelineno-0-2929">2929</a></span>
<span class="normal"><a href="#__codelineno-0-2930">2930</a></span>
<span class="normal"><a href="#__codelineno-0-2931">2931</a></span>
<span class="normal"><a href="#__codelineno-0-2932">2932</a></span>
<span class="normal"><a href="#__codelineno-0-2933">2933</a></span>
<span class="normal"><a href="#__codelineno-0-2934">2934</a></span>
<span class="normal"><a href="#__codelineno-0-2935">2935</a></span>
<span class="normal"><a href="#__codelineno-0-2936">2936</a></span>
<span class="normal"><a href="#__codelineno-0-2937">2937</a></span>
<span class="normal"><a href="#__codelineno-0-2938">2938</a></span>
<span class="normal"><a href="#__codelineno-0-2939">2939</a></span>
<span class="normal"><a href="#__codelineno-0-2940">2940</a></span>
<span class="normal"><a href="#__codelineno-0-2941">2941</a></span>
<span class="normal"><a href="#__codelineno-0-2942">2942</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2917" name="__codelineno-0-2917"></a><span class="k">class</span> <span class="nc">ARSCResTypeSpec</span><span class="p">:</span>
<a id="__codelineno-0-2918" name="__codelineno-0-2918"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2919" name="__codelineno-0-2919"></a><span class="sd">    See http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#1327</span>
<a id="__codelineno-0-2920" name="__codelineno-0-2920"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2921" name="__codelineno-0-2921"></a>
<a id="__codelineno-0-2922" name="__codelineno-0-2922"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-2923" name="__codelineno-0-2923"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">buff</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PackageContext</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-2924" name="__codelineno-0-2924"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2925" name="__codelineno-0-2925"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-2926" name="__codelineno-0-2926"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
<a id="__codelineno-0-2927" name="__codelineno-0-2927"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2928" name="__codelineno-0-2928"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">res0</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2929" name="__codelineno-0-2929"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">res1</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2930" name="__codelineno-0-2930"></a>        <span class="c1"># TODO: https://github.com/androguard/androguard/issues/1014 | Properly account for the cases where res0/1 are not zero</span>
<a id="__codelineno-0-2931" name="__codelineno-0-2931"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-2932" name="__codelineno-0-2932"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">res0</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-2933" name="__codelineno-0-2933"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;res0 must be zero!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2934" name="__codelineno-0-2934"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">res1</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-2935" name="__codelineno-0-2935"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;res1 must be zero!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2936" name="__codelineno-0-2936"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">entryCount</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-2937" name="__codelineno-0-2937"></a>
<a id="__codelineno-0-2938" name="__codelineno-0-2938"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">typespec_entries</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-2939" name="__codelineno-0-2939"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">entryCount</span><span class="p">):</span>
<a id="__codelineno-0-2940" name="__codelineno-0-2940"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">typespec_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-2941" name="__codelineno-0-2941"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-2942" name="__codelineno-0-2942"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.AXMLParser" class="doc doc-heading">
            <code>AXMLParser</code>


<a href="#androguard.core.axml.AXMLParser" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p><code>AXMLParser</code> reads through all chunks in the AXML file
and implements a state machine to return information about
the current chunk, which can then be read by <a class="autorefs autorefs-internal" href="#androguard.core.axml.AXMLPrinter">AXMLPrinter</a>.</p>
<p>An AXML file is a file which contains multiple chunks of data, defined
by the <code>ResChunk_header</code>.
There is no real file magic but as the size of the first header is fixed
and the <code>type</code> of the <code>ResChunk_header</code> is set to <code>RES_XML_TYPE</code>, a file
will usually start with <code>0x03000800</code>.
But there are several examples where the <code>type</code> is set to something
else, probably in order to fool parsers.</p>
<p>Typically the <code>AXMLParser</code> is used in a loop which terminates if <code>m_event</code> is set to <code>END_DOCUMENT</code>.
You can use the <code>next()</code> function to get the next chunk.
Note that not all chunk types are yielded from the iterator! Some chunks are processed in
the <code>AXMLParser</code> only.
The parser will set <a class="autorefs autorefs-internal" href="#androguard.core.axml.AXMLParser.is_valid">is_valid</a> to <code>False</code> if it parses something not valid.
Messages what is wrong are logged.</p>
<p>See http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#563</p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="k">class</span> <span class="nc">AXMLParser</span><span class="p">:</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    `AXMLParser` reads through all chunks in the AXML file</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">    and implements a state machine to return information about</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">    the current chunk, which can then be read by [AXMLPrinter][androguard.core.axml.AXMLPrinter].</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">    An AXML file is a file which contains multiple chunks of data, defined</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">    by the `ResChunk_header`.</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">    There is no real file magic but as the size of the first header is fixed</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">    and the `type` of the `ResChunk_header` is set to `RES_XML_TYPE`, a file</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">    will usually start with `0x03000800`.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">    But there are several examples where the `type` is set to something</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    else, probably in order to fool parsers.</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">    Typically the `AXMLParser` is used in a loop which terminates if `m_event` is set to `END_DOCUMENT`.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">    You can use the `next()` function to get the next chunk.</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">    Note that not all chunk types are yielded from the iterator! Some chunks are processed in</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">    the `AXMLParser` only.</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">    The parser will set [is_valid][androguard.core.axml.AXMLParser.is_valid] to `False` if it parses something not valid.</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">    Messages what is wrong are logged.</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">    See http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#563</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_buff</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;AXMLParser&quot;</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">axml_tampered</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">buff</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BufferedReader</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">raw_buff</span><span class="p">))</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">raw</span><span class="o">.</span><span class="n">getbuffer</span><span class="p">()</span><span class="o">.</span><span class="n">nbytes</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">packerwarning</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="c1"># Minimum is a single ARSCHeader, which would be a strange edge case...</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>                <span class="s2">&quot;Filesize is too small to be a valid AXML file! Filesize: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                <span class="p">)</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>            <span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>            <span class="k">return</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="c1"># This would be even stranger, if an AXML file is larger than 4GB...</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>        <span class="c1"># But this is not possible as the maximum chunk size is a unsigned 4 byte int.</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span> <span class="o">&gt;</span> <span class="mh">0xFFFFFFFF</span><span class="p">:</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>                <span class="s2">&quot;Filesize is too large to be a valid AXML file! Filesize: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>                <span class="p">)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>            <span class="k">return</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="n">axml_header</span> <span class="o">=</span> <span class="n">ARSCHeader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;FIRST HEADER </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">axml_header</span><span class="p">))</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="k">except</span> <span class="n">ResParserError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error parsing first resource header: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="k">return</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filesize</span> <span class="o">=</span> <span class="n">axml_header</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="k">if</span> <span class="n">axml_header</span><span class="o">.</span><span class="n">header_size</span> <span class="o">==</span> <span class="mi">28024</span><span class="p">:</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>            <span class="c1"># Can be a common error: the file is not an AXML but a plain XML</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="c1"># The file will then usually start with &#39;&lt;?xm&#39; / &#39;3C 3F 78 6D&#39;</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>                <span class="s2">&quot;Header size is 28024! Are you trying to parse a plain XML file?&quot;</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>            <span class="p">)</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="k">if</span> <span class="n">axml_header</span><span class="o">.</span><span class="n">header_size</span> <span class="o">!=</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                <span class="s2">&quot;This does not look like an AXML file. header size does not equal 8! header size = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                    <span class="n">axml_header</span><span class="o">.</span><span class="n">header_size</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                <span class="p">)</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="p">)</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>            <span class="k">return</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filesize</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span><span class="p">:</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>                <span class="s2">&quot;This does not look like an AXML file. Declared filesize does not match real size: </span><span class="si">{}</span><span class="s2"> vs </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">filesize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>                <span class="p">)</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>            <span class="p">)</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>            <span class="k">return</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filesize</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span><span class="p">:</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>            <span class="c1"># The file can still be parsed up to the point where the chunk should end.</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">axml_tampered</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                <span class="s2">&quot;Declared filesize (</span><span class="si">{}</span><span class="s2">) is smaller than total file size (</span><span class="si">{}</span><span class="s2">). &quot;</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>                <span class="s2">&quot;Was something appended to the file? Trying to parse it anyways.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">filesize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff_size</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                <span class="p">)</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="p">)</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="c1"># Not that severe of an error, we have plenty files where this is not</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>        <span class="c1"># set correctly</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="k">if</span> <span class="n">axml_header</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="n">RES_XML_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">axml_tampered</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>                <span class="s2">&quot;AXML file has an unusual resource type! &quot;</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                <span class="s2">&quot;Malware likes to to such stuff to anti androguard! &quot;</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                <span class="s2">&quot;But we try to parse it anyways. Resource Type: 0x</span><span class="si">{:04x}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>                    <span class="n">axml_header</span><span class="o">.</span><span class="n">type</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>                <span class="p">)</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="p">)</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="c1"># Now we parse the STRING POOL</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>            <span class="n">header</span> <span class="o">=</span> <span class="n">ARSCHeader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">expected_type</span><span class="o">=</span><span class="n">RES_STRING_POOL_TYPE</span><span class="p">)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;STRING_POOL </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">header</span><span class="p">))</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="k">except</span> <span class="n">ResParserError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>                <span class="s2">&quot;Error parsing resource header of string pool: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>            <span class="p">)</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>            <span class="k">return</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="k">if</span> <span class="n">header</span><span class="o">.</span><span class="n">header_size</span> <span class="o">!=</span> <span class="mh">0x1C</span><span class="p">:</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>                <span class="s2">&quot;This does not look like an AXML file. String chunk header size does not equal 28! header size = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>                    <span class="n">header</span><span class="o">.</span><span class="n">header_size</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>                <span class="p">)</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>            <span class="p">)</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>            <span class="k">return</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sb</span> <span class="o">=</span> <span class="n">StringBlock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">axml_header</span><span class="o">.</span><span class="n">header_size</span> <span class="o">+</span> <span class="n">header</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="c1"># Stores resource ID mappings, if any</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_resourceIDs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="c1"># Store a list of prefix/uri mappings encountered</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">namespaces</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">        Get the state of the [AXMLPrinter][androguard.core.axml.AXMLPrinter].</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">        if an error happend somewhere in the process of parsing the file,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">        this flag is set to `False`.</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">        :returns: `True` if the `AXMLPrinter` finished parsing, or `False` if an error occurred</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_valid</span><span class="p">)</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>    <span class="k">def</span> <span class="nf">_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_lineNumber</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_name</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_namespaceUri</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_idAttribute</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_classAttribute</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_styleAttribute</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_do_next</span><span class="p">()</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>    <span class="k">def</span> <span class="nf">_do_next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;M_EVENT </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_event</span><span class="p">))</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">==</span> <span class="n">END_DOCUMENT</span><span class="p">:</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>            <span class="k">return</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span><span class="p">:</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>            <span class="c1"># Stop at the declared filesize or at the end of the file</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">filesize</span><span class="p">:</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">=</span> <span class="n">END_DOCUMENT</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>                <span class="k">break</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>            <span class="c1"># Again, we read an ARSCHeader</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>                <span class="n">possible_types</span> <span class="o">=</span> <span class="p">{</span><span class="mi">256</span><span class="p">,</span> <span class="mi">257</span><span class="p">,</span> <span class="mi">258</span><span class="p">,</span> <span class="mi">259</span><span class="p">,</span> <span class="mi">260</span><span class="p">,</span> <span class="mi">384</span><span class="p">}</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>                <span class="n">h</span> <span class="o">=</span> <span class="n">ARSCHeader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="p">,</span> <span class="n">possible_types</span><span class="o">=</span><span class="n">possible_types</span><span class="p">)</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;NEXT HEADER </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>            <span class="k">except</span> <span class="n">ResParserError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error parsing resource header: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>                <span class="k">return</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>            <span class="c1"># Special chunk: Resource Map. This chunk might be contained inside</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>            <span class="c1"># the file, after the string pool.</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>            <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_XML_RESOURCE_MAP_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;AXML contains a RESOURCE MAP&quot;</span><span class="p">)</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>                <span class="c1"># Check size: &lt; 8 bytes mean that the chunk is not complete</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>                <span class="c1"># Should be aligned to 4 bytes.</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>                <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="ow">or</span> <span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">size</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>                        <span class="s2">&quot;Invalid chunk size in chunk XML_RESOURCE_MAP&quot;</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>                    <span class="p">)</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>                    <span class="k">return</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="n">h</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="n">h</span><span class="o">.</span><span class="n">header_size</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span><span class="p">):</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">m_resourceIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>                        <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>                    <span class="p">)</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>                <span class="k">continue</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="c1"># Parse now the XML chunks.</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="c1"># unknown chunk types might cause problems, but we can skip them!</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>                <span class="n">h</span><span class="o">.</span><span class="n">type</span> <span class="o">&lt;</span> <span class="n">RES_XML_FIRST_CHUNK_TYPE</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>                <span class="ow">or</span> <span class="n">h</span><span class="o">.</span><span class="n">type</span> <span class="o">&gt;</span> <span class="n">RES_XML_LAST_CHUNK_TYPE</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>            <span class="p">):</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>                <span class="c1"># h.size is the size of the whole chunk including the header.</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>                <span class="c1"># We read already 8 bytes of the header, thus we need to</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>                <span class="c1"># subtract them.</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>                    <span class="s2">&quot;Not a XML resource chunk type: 0x</span><span class="si">{:04x}</span><span class="s2">. Skipping </span><span class="si">{}</span><span class="s2"> bytes&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>                        <span class="n">h</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>                    <span class="p">)</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>                <span class="p">)</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>                <span class="k">continue</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>            <span class="c1"># Check that we read a correct header</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>            <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">header_size</span> <span class="o">!=</span> <span class="mh">0x10</span><span class="p">:</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>                    <span class="s2">&quot;XML Resource Type Chunk header size does not match 16! &quot;</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>                    <span class="s2">&quot;At chunk type 0x</span><span class="si">{:04x}</span><span class="s2">, declared header size=0x</span><span class="si">{:04x}</span><span class="s2">, chunk size=0x</span><span class="si">{:04x}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>                        <span class="n">h</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">header_size</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>                    <span class="p">)</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>                <span class="p">)</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>                <span class="k">continue</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="c1"># Line Number of the source file, only used as meta information</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_lineNumber</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>            <span class="c1"># Comment_Index (usually 0xFFFFFFFF)</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_comment_index</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_comment_index</span> <span class="o">!=</span> <span class="mh">0xFFFFFFFF</span> <span class="ow">and</span> <span class="n">h</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>                <span class="n">RES_XML_START_NAMESPACE_TYPE</span><span class="p">,</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>                <span class="n">RES_XML_END_NAMESPACE_TYPE</span><span class="p">,</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>            <span class="p">]:</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>                    <span class="s2">&quot;Unhandled Comment at namespace chunk: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">m_comment_index</span><span class="p">]</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>                    <span class="p">)</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                <span class="p">)</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>            <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_XML_START_NAMESPACE_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>                <span class="p">(</span><span class="n">prefix</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>                <span class="p">(</span><span class="n">uri</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>                <span class="n">s_prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="n">prefix</span><span class="p">]</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>                <span class="n">s_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="n">uri</span><span class="p">]</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>                    <span class="s2">&quot;Start of Namespace mapping: prefix </span><span class="si">{}</span><span class="s2">: &#39;</span><span class="si">{}</span><span class="s2">&#39; --&gt; uri </span><span class="si">{}</span><span class="s2">: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>                        <span class="n">prefix</span><span class="p">,</span> <span class="n">s_prefix</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">s_uri</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>                    <span class="p">)</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>                <span class="p">)</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>                <span class="k">if</span> <span class="n">s_uri</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>                        <span class="s2">&quot;Namespace prefix &#39;</span><span class="si">{}</span><span class="s2">&#39; resolves to empty URI. &quot;</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>                        <span class="s2">&quot;This might be a packer.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s_prefix</span><span class="p">)</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>                    <span class="p">)</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">uri</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespaces</span><span class="p">:</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>                        <span class="s2">&quot;Namespace mapping (</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">) already seen! &quot;</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>                        <span class="s2">&quot;This is usually not a problem but could indicate packers or broken AXML compilers.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>                            <span class="n">prefix</span><span class="p">,</span> <span class="n">uri</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>                        <span class="p">)</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>                    <span class="p">)</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">namespaces</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">prefix</span><span class="p">,</span> <span class="n">uri</span><span class="p">))</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>                <span class="c1"># We can continue with the next chunk, as we store the namespace</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>                <span class="c1"># mappings for each tag</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>                <span class="k">continue</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>            <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_XML_END_NAMESPACE_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>                <span class="c1"># END_PREFIX contains again prefix and uri field</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>                <span class="p">(</span><span class="n">prefix</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>                <span class="p">(</span><span class="n">uri</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>                <span class="c1"># We remove the last namespace mapping matching</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>                <span class="k">if</span> <span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">uri</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespaces</span><span class="p">:</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">namespaces</span><span class="o">.</span><span class="n">remove</span><span class="p">((</span><span class="n">prefix</span><span class="p">,</span> <span class="n">uri</span><span class="p">))</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>                        <span class="s2">&quot;Reached a NAMESPACE_END without having the namespace stored before? &quot;</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>                        <span class="s2">&quot;Prefix ID: </span><span class="si">{}</span><span class="s2">, URI ID: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">uri</span><span class="p">)</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>                    <span class="p">)</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>                <span class="c1"># We can continue with the next chunk, as we store the namespace</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>                <span class="c1"># mappings for each tag</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>                <span class="k">continue</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>            <span class="c1"># START_TAG is the start of a new tag.</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>            <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_XML_START_ELEMENT_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>                <span class="c1"># The TAG consists of some fields:</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>                <span class="c1"># * (chunk_size, line_number, comment_index - we read before)</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>                <span class="c1"># * namespace_uri</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>                <span class="c1"># * name</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>                <span class="c1"># * flags</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>                <span class="c1"># * attribute_count</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>                <span class="c1"># * class_attribute</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>                <span class="c1"># After that, there are two lists of attributes, 20 bytes each</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>                <span class="c1"># Namespace URI (String ID)</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_namespaceUri</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>                <span class="c1"># Name of the Tag (String ID)</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_name</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">at_start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">at_size</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;HH&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>                <span class="c1"># Attribute Count</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>                <span class="p">(</span><span class="n">attributeCount</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>                <span class="c1"># Class Attribute</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_classAttribute</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">m_idAttribute</span> <span class="o">=</span> <span class="p">(</span><span class="n">attributeCount</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">m_attribute_count</span> <span class="o">=</span> <span class="n">attributeCount</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">m_styleAttribute</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_classAttribute</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">m_classAttribute</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_classAttribute</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>                <span class="c1"># Now, we parse the attributes.</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>                <span class="c1"># Each attribute has 5 fields of 4 byte</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attribute_count</span><span class="p">):</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>                    <span class="c1"># Each field is linearly parsed into the array</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>                    <span class="c1"># Each Attribute contains:</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>                    <span class="c1"># * Namespace URI (String ID)</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>                    <span class="c1"># * Name (String ID)</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>                    <span class="c1"># * Value</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>                    <span class="c1"># * Type</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>                    <span class="c1"># * Data</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ATTRIBUTE_LENGTH</span><span class="p">):</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>                            <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>                        <span class="p">)</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">at_size</span> <span class="o">!=</span> <span class="mi">20</span><span class="p">:</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">at_size</span> <span class="o">-</span> <span class="mi">20</span><span class="p">)</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>                <span class="c1"># Then there are class_attributes</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>                    <span class="n">ATTRIBUTE_IX_VALUE_TYPE</span><span class="p">,</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>                    <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">),</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>                    <span class="n">ATTRIBUTE_LENGTH</span><span class="p">,</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>                <span class="p">):</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">=</span> <span class="n">START_TAG</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>                <span class="k">break</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>            <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_XML_END_ELEMENT_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_namespaceUri</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_name</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">=</span> <span class="n">END_TAG</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>                <span class="k">break</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>            <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">RES_XML_CDATA_TYPE</span><span class="p">:</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>                <span class="c1"># The CDATA field is like an attribute.</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>                <span class="c1"># It contains an index into the String pool</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>                <span class="c1"># as well as a typed value.</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>                <span class="c1"># usually, this typed value is set to UNDEFINED</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>                <span class="c1"># ResStringPool_ref data --&gt; uint32_t index</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_name</span><span class="p">,)</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;L&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>                <span class="c1"># Res_value typedData:</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>                <span class="c1"># uint16_t size</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>                <span class="c1"># uint8_t res0 -&gt; always zero</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>                <span class="c1"># uint8_t dataType</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>                <span class="c1"># uint32_t data</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>                <span class="c1"># For now, we ingore these values</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>                <span class="n">size</span><span class="p">,</span> <span class="n">res0</span><span class="p">,</span> <span class="n">dataType</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&lt;HBBL&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>                    <span class="s2">&quot;found a CDATA Chunk: &quot;</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>                    <span class="s2">&quot;index=</span><span class="si">{: 6d}</span><span class="s2">, size=</span><span class="si">{: 4d}</span><span class="s2">, res0=</span><span class="si">{: 4d}</span><span class="s2">, dataType=</span><span class="si">{: 4d}</span><span class="s2">, data=</span><span class="si">{: 4d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">m_name</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">res0</span><span class="p">,</span> <span class="n">dataType</span><span class="p">,</span> <span class="n">data</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>                    <span class="p">)</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>                <span class="p">)</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">=</span> <span class="n">TEXT</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>                <span class="k">break</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>            <span class="c1"># Still here? Looks like we read an unknown XML header, try to skip it...</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>                <span class="s2">&quot;Unknown XML Chunk: 0x</span><span class="si">{:04x}</span><span class="s2">, skipping </span><span class="si">{}</span><span class="s2"> bytes.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>                    <span class="n">h</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>                <span class="p">)</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>            <span class="p">)</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">buff</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">        Return the String associated with the tag name</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">        :returns: the string</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_name</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="p">(</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">!=</span> <span class="n">START_TAG</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">!=</span> <span class="n">END_TAG</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>        <span class="p">):</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">m_name</span><span class="p">]</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">        Return the comment at the current position or None if no comment is given</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">        This works only for Tags, as the comments of Namespaces are silently dropped.</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">        Currently, there is no way of retrieving comments of namespaces.</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">        :returns: the comment string, or None if no comment exists</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_comment_index</span> <span class="o">==</span> <span class="mh">0xFFFFFFFF</span><span class="p">:</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">m_comment_index</span><span class="p">]</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>    <span class="k">def</span> <span class="nf">namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">        Return the Namespace URI (if any) as a String for the current tag</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">        :returns: the namespace uri, or empty if namespace does not exist</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_name</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="p">(</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">!=</span> <span class="n">START_TAG</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">!=</span> <span class="n">END_TAG</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>        <span class="p">):</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>        <span class="c1"># No Namespace</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_namespaceUri</span> <span class="o">==</span> <span class="mh">0xFFFFFFFF</span><span class="p">:</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">m_namespaceUri</span><span class="p">]</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>    <span class="k">def</span> <span class="nf">nsmap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">        Returns the current namespace mapping as a dictionary</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">        there are several problems with the map and we try to guess a few</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">        things here:</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">        1) a URI can be mapped by many prefixes, so it is to decide which one to take</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">        2) a prefix might map to an empty string (some packers)</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">        3) uri+prefix mappings might be included several times</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">        4) prefix might be empty</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">        :returns: the namespace mapping dictionary</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>        <span class="n">NSMAP</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>        <span class="c1"># solve 3) by using a set</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">namespaces</span><span class="p">):</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>            <span class="n">s_prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>            <span class="n">s_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>            <span class="c1"># Solve 2) &amp; 4) by not including</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>            <span class="k">if</span> <span class="n">s_uri</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">s_prefix</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>                <span class="c1"># solve 1) by using the last one in the list</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>                <span class="n">NSMAP</span><span class="p">[</span><span class="n">s_prefix</span><span class="p">]</span> <span class="o">=</span> <span class="n">s_uri</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>        <span class="k">return</span> <span class="n">NSMAP</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">        Return the String assosicated with the current text</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">        :returns: the string associated with the current text</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_name</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">!=</span> <span class="n">TEXT</span><span class="p">:</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">m_name</span><span class="p">]</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">        Legacy only!</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">        use `name` attribute instead</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>    <span class="k">def</span> <span class="nf">getText</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">        Legacy only!</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">        use `text` attribute instead</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>    <span class="k">def</span> <span class="nf">getPrefix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">        Legacy only!</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">        use `namespace` attribute instead</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>    <span class="k">def</span> <span class="nf">_get_attribute_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">        Return the start inside the m_attributes array for a given attribute</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">!=</span> <span class="n">START_TAG</span><span class="p">:</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Current event is not START_TAG.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>        <span class="n">offset</span> <span class="o">=</span> <span class="n">index</span> <span class="o">*</span> <span class="n">ATTRIBUTE_LENGTH</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>        <span class="k">if</span> <span class="n">offset</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">):</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Invalid attribute index&quot;</span><span class="p">)</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>        <span class="k">return</span> <span class="n">offset</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>    <span class="k">def</span> <span class="nf">getAttributeCount</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">        Return the number of Attributes for a Tag</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">        or -1 if not in a tag</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">        :returns: the number of attributes</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">!=</span> <span class="n">START_TAG</span><span class="p">:</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attribute_count</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>    <span class="k">def</span> <span class="nf">getAttributeUri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">        Returns the numeric ID for the namespace URI of an attribute</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">        :returns: the namespace URI numeric id</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>        <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_offset</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>        <span class="n">uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">ATTRIBUTE_IX_NAMESPACE_URI</span><span class="p">]</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>        <span class="k">return</span> <span class="n">uri</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>    <span class="k">def</span> <span class="nf">getAttributeNamespace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">        Return the Namespace URI (if any) for the attribute</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">        :returns: the attribute uri, or empty string if no namespace</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>        <span class="n">uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAttributeUri</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>        <span class="c1"># No Namespace</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>        <span class="k">if</span> <span class="n">uri</span> <span class="o">==</span> <span class="mh">0xFFFFFFFF</span><span class="p">:</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="n">uri</span><span class="p">]</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>    <span class="k">def</span> <span class="nf">getAttributeName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">        Returns the String which represents the attribute name</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">        :returns: the attribute name</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>        <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_offset</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">ATTRIBUTE_IX_NAME</span><span class="p">]</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>        <span class="c1"># If the result is a (null) string, we need to look it up.</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>        <span class="k">if</span> <span class="n">name</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_resourceIDs</span><span class="p">):</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>            <span class="n">attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_resourceIDs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>            <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">public</span><span class="o">.</span><span class="n">SYSTEM_RESOURCES</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="s1">&#39;inverse&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>                <span class="n">res</span> <span class="o">=</span> <span class="n">public</span><span class="o">.</span><span class="n">SYSTEM_RESOURCES</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="s1">&#39;inverse&#39;</span><span class="p">][</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>                    <span class="n">attr</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>                <span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>                <span class="k">if</span> <span class="n">res</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">packerwarning</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span> <span class="ow">or</span> <span class="n">res</span> <span class="o">==</span> <span class="s2">&quot;:&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>            <span class="c1"># Attach the HEX Number, so for multiple missing attributes we do not run</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>            <span class="c1"># into problems.</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>            <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;android:UNKNOWN_SYSTEM_ATTRIBUTE_</span><span class="si">{:08x}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>        <span class="k">return</span> <span class="n">res</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>    <span class="k">def</span> <span class="nf">getAttributeValueType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">        Return the type of the attribute at the given index</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">        :param index: index of the attribute</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>        <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_offset</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">ATTRIBUTE_IX_VALUE_TYPE</span><span class="p">]</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>    <span class="k">def</span> <span class="nf">getAttributeValueData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">        Return the data of the attribute at the given index</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">        :param index: index of the attribute</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>        <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_offset</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">ATTRIBUTE_IX_VALUE_DATA</span><span class="p">]</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>    <span class="k">def</span> <span class="nf">getAttributeValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">        This function is only used to look up strings</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">        All other work is done by</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">        [format_value][androguard.core.axml.format_value]</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">        # FIXME should unite those functions</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">        :param index: index of the attribute</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><span class="sd">        :returns: the string</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>        <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_offset</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>        <span class="n">valueType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">ATTRIBUTE_IX_VALUE_TYPE</span><span class="p">]</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>        <span class="k">if</span> <span class="n">valueType</span> <span class="o">==</span> <span class="n">TYPE_STRING</span><span class="p">:</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>            <span class="n">valueString</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">ATTRIBUTE_IX_VALUE_STRING</span><span class="p">]</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="n">valueString</span><span class="p">]</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="androguard.core.axml.AXMLParser.comment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">comment</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#androguard.core.axml.AXMLParser.comment" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the comment at the current position or None if no comment is given</p>
<p>This works only for Tags, as the comments of Namespaces are silently dropped.
Currently, there is no way of retrieving comments of namespaces.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the comment string, or None if no comment exists</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="androguard.core.axml.AXMLParser.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#androguard.core.axml.AXMLParser.name" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the String associated with the tag name</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="androguard.core.axml.AXMLParser.namespace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">namespace</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#androguard.core.axml.AXMLParser.namespace" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the Namespace URI (if any) as a String for the current tag</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the namespace uri, or empty if namespace does not exist</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="androguard.core.axml.AXMLParser.nsmap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nsmap</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#androguard.core.axml.AXMLParser.nsmap" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the current namespace mapping as a dictionary</p>
<p>there are several problems with the map and we try to guess a few
things here:</p>
<p>1) a URI can be mapped by many prefixes, so it is to decide which one to take
2) a prefix might map to an empty string (some packers)
3) uri+prefix mappings might be included several times
4) prefix might be empty</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict[str, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the namespace mapping dictionary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="androguard.core.axml.AXMLParser.text" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">text</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#androguard.core.axml.AXMLParser.text" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the String assosicated with the current text</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the string associated with the current text</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLParser.getAttributeCount" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getAttributeCount</span><span class="p">()</span></code>

<a href="#androguard.core.axml.AXMLParser.getAttributeCount" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the number of Attributes for a Tag
or -1 if not in a tag</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the number of attributes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="k">def</span> <span class="nf">getAttributeCount</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">    Return the number of Attributes for a Tag</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">    or -1 if not in a tag</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">    :returns: the number of attributes</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_event</span> <span class="o">!=</span> <span class="n">START_TAG</span><span class="p">:</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attribute_count</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLParser.getAttributeName" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getAttributeName</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

<a href="#androguard.core.axml.AXMLParser.getAttributeName" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the String which represents the attribute name</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the attribute name</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="k">def</span> <span class="nf">getAttributeName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">    Returns the String which represents the attribute name</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">    :returns: the attribute name</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_offset</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>    <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">ATTRIBUTE_IX_NAME</span><span class="p">]</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>    <span class="c1"># If the result is a (null) string, we need to look it up.</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>    <span class="k">if</span> <span class="n">name</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_resourceIDs</span><span class="p">):</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>        <span class="n">attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_resourceIDs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>        <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">public</span><span class="o">.</span><span class="n">SYSTEM_RESOURCES</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="s1">&#39;inverse&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">public</span><span class="o">.</span><span class="n">SYSTEM_RESOURCES</span><span class="p">[</span><span class="s1">&#39;attributes&#39;</span><span class="p">][</span><span class="s1">&#39;inverse&#39;</span><span class="p">][</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>                <span class="n">attr</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>            <span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>            <span class="k">if</span> <span class="n">res</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">packerwarning</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span> <span class="ow">or</span> <span class="n">res</span> <span class="o">==</span> <span class="s2">&quot;:&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="c1"># Attach the HEX Number, so for multiple missing attributes we do not run</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>        <span class="c1"># into problems.</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>        <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;android:UNKNOWN_SYSTEM_ATTRIBUTE_</span><span class="si">{:08x}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLParser.getAttributeNamespace" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getAttributeNamespace</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

<a href="#androguard.core.axml.AXMLParser.getAttributeNamespace" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the Namespace URI (if any) for the attribute</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the attribute uri, or empty string if no namespace</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span>
<span class="normal"><a href="#__codelineno-0-982">982</a></span>
<span class="normal"><a href="#__codelineno-0-983">983</a></span>
<span class="normal"><a href="#__codelineno-0-984">984</a></span>
<span class="normal"><a href="#__codelineno-0-985">985</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="k">def</span> <span class="nf">getAttributeNamespace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">    Return the Namespace URI (if any) for the attribute</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">    :returns: the attribute uri, or empty string if no namespace</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>    <span class="n">uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAttributeUri</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>    <span class="c1"># No Namespace</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>    <span class="k">if</span> <span class="n">uri</span> <span class="o">==</span> <span class="mh">0xFFFFFFFF</span><span class="p">:</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="n">uri</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLParser.getAttributeUri" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getAttributeUri</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

<a href="#androguard.core.axml.AXMLParser.getAttributeUri" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the numeric ID for the namespace URI of an attribute</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the namespace URI numeric id</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="k">def</span> <span class="nf">getAttributeUri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">    Returns the numeric ID for the namespace URI of an attribute</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">    :returns: the namespace URI numeric id</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_offset</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>    <span class="n">uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">ATTRIBUTE_IX_NAMESPACE_URI</span><span class="p">]</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>    <span class="k">return</span> <span class="n">uri</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLParser.getAttributeValue" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getAttributeValue</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

<a href="#androguard.core.axml.AXMLParser.getAttributeValue" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>This function is only used to look up strings
All other work is done by
<a class="autorefs autorefs-internal" href="#androguard.core.axml.format_value">format_value</a></p>
<h4 id="androguard.core.axml.AXMLParser.getAttributeValue--fixme-should-unite-those-functions">FIXME should unite those functions<a class="headerlink" href="#androguard.core.axml.AXMLParser.getAttributeValue--fixme-should-unite-those-functions" title="Permanent link">#</a></h4>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>index of the attribute</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="k">def</span> <span class="nf">getAttributeValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">    This function is only used to look up strings</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">    All other work is done by</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">    [format_value][androguard.core.axml.format_value]</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">    # FIXME should unite those functions</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">    :param index: index of the attribute</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><span class="sd">    :returns: the string</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_offset</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>    <span class="n">valueType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">ATTRIBUTE_IX_VALUE_TYPE</span><span class="p">]</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>    <span class="k">if</span> <span class="n">valueType</span> <span class="o">==</span> <span class="n">TYPE_STRING</span><span class="p">:</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>        <span class="n">valueString</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">ATTRIBUTE_IX_VALUE_STRING</span><span class="p">]</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sb</span><span class="p">[</span><span class="n">valueString</span><span class="p">]</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>    <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLParser.getAttributeValueData" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getAttributeValueData</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

<a href="#androguard.core.axml.AXMLParser.getAttributeValueData" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the data of the attribute at the given index</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>index of the attribute</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="k">def</span> <span class="nf">getAttributeValueData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">    Return the data of the attribute at the given index</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">    :param index: index of the attribute</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_offset</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">ATTRIBUTE_IX_VALUE_DATA</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLParser.getAttributeValueType" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getAttributeValueType</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

<a href="#androguard.core.axml.AXMLParser.getAttributeValueType" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the type of the attribute at the given index</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>index of the attribute</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="k">def</span> <span class="nf">getAttributeValueType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">    Return the type of the attribute at the given index</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">    :param index: index of the attribute</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_offset</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_attributes</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">ATTRIBUTE_IX_VALUE_TYPE</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLParser.getName" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getName</span><span class="p">()</span></code>

<a href="#androguard.core.axml.AXMLParser.getName" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Legacy only!
use <code>name</code> attribute instead</p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">    Legacy only!</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">    use `name` attribute instead</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLParser.getPrefix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getPrefix</span><span class="p">()</span></code>

<a href="#androguard.core.axml.AXMLParser.getPrefix" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Legacy only!
use <code>namespace</code> attribute instead</p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="k">def</span> <span class="nf">getPrefix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">    Legacy only!</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">    use `namespace` attribute instead</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLParser.getText" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getText</span><span class="p">()</span></code>

<a href="#androguard.core.axml.AXMLParser.getText" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Legacy only!
use <code>text</code> attribute instead</p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="k">def</span> <span class="nf">getText</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">    Legacy only!</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a><span class="sd">    use `text` attribute instead</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLParser.is_valid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_valid</span><span class="p">()</span></code>

<a href="#androguard.core.axml.AXMLParser.is_valid" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Get the state of the <a class="autorefs autorefs-internal" href="#androguard.core.axml.AXMLPrinter">AXMLPrinter</a>.
if an error happend somewhere in the process of parsing the file,
this flag is set to <code>False</code>.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if the <code>AXMLPrinter</code> finished parsing, or <code>False</code> if an error occurred</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">    Get the state of the [AXMLPrinter][androguard.core.axml.AXMLPrinter].</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">    if an error happend somewhere in the process of parsing the file,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">    this flag is set to `False`.</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">    :returns: `True` if the `AXMLPrinter` finished parsing, or `False` if an error occurred</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_valid</span><span class="p">)</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.AXMLPrinter" class="doc doc-heading">
            <code>AXMLPrinter</code>


<a href="#androguard.core.axml.AXMLPrinter" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>Converter for AXML Files into a lxml ElementTree, which can easily be
converted into XML.</p>
<p>A Reference Implementation can be found at http://androidxref.com/9.0.0_r3/xref/frameworks/base/tools/aapt/XMLNode.cpp</p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="k">class</span> <span class="nc">AXMLPrinter</span><span class="p">:</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">    Converter for AXML Files into a lxml ElementTree, which can easily be</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">    converted into XML.</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">    A Reference Implementation can be found at http://androidxref.com/9.0.0_r3/xref/frameworks/base/tools/aapt/XMLNode.cpp</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>    <span class="n">__charrange</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>    <span class="n">__replacement</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_buff</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;AXMLPrinter&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">axml</span> <span class="o">=</span> <span class="n">AXMLParser</span><span class="p">(</span><span class="n">raw_buff</span><span class="p">)</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">packerwarning</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>        <span class="n">cur</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>            <span class="n">_type</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="p">)</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;DEBUG ARSC TYPE </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_type</span><span class="p">))</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a>            <span class="k">if</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">START_TAG</span><span class="p">:</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>  <span class="c1"># Check if the name is empty</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Empty tag name, skipping to next element&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>                    <span class="k">continue</span>  <span class="c1"># Skip this iteration</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>                <span class="n">uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_namespace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>                <span class="n">uri</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_name</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>                <span class="n">tag</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>                <span class="n">comment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">comment</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>                <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>                            <span class="s2">&quot;Can not attach comment with content &#39;</span><span class="si">{}</span><span class="s2">&#39; without root!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>                                <span class="n">comment</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>                            <span class="p">)</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>                        <span class="n">cur</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">etree</span><span class="o">.</span><span class="n">Comment</span><span class="p">(</span><span class="n">comment</span><span class="p">))</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>                    <span class="s2">&quot;START_TAG: </span><span class="si">{}</span><span class="s2"> (line=</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>                        <span class="n">tag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">m_lineNumber</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>                <span class="p">)</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>                    <span class="n">elem</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">nsmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">nsmap</span><span class="p">)</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>                    <span class="c1"># nsmap= {&#39;&lt;!--&#39;: &#39;http://schemas.android.com/apk/res/android&#39;} | pull/1056</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>                    <span class="k">if</span> <span class="s1">&#39;Invalid namespace prefix&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>                        <span class="n">corrected_nsmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clean_and_replace_nsmap</span><span class="p">(</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">nsmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>                        <span class="n">elem</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">nsmap</span><span class="o">=</span><span class="n">corrected_nsmap</span><span class="p">)</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>                        <span class="k">raise</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">getAttributeCount</span><span class="p">()):</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>                    <span class="n">uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_namespace</span><span class="p">(</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">getAttributeNamespace</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>                    <span class="n">uri</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_name</span><span class="p">(</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>                        <span class="n">uri</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">getAttributeName</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_attribute_value</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>                        <span class="s2">&quot;found an attribute: </span><span class="si">{}{}</span><span class="s2">=&#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>                            <span class="n">uri</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>                    <span class="k">if</span> <span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">attrib</span><span class="p">:</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>                            <span class="s2">&quot;Duplicate attribute &#39;</span><span class="si">{}{}</span><span class="s2">&#39;! Will overwrite!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>                                <span class="n">uri</span><span class="p">,</span> <span class="n">name</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>                            <span class="p">)</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>                    <span class="n">elem</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">elem</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">cur</span><span class="p">:</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>                        <span class="c1"># looks like we lost the root?</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>                            <span class="s2">&quot;No more elements available to attach to! Is the XML malformed?&quot;</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>                        <span class="k">break</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>                    <span class="n">cur</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>                <span class="n">cur</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>            <span class="k">if</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">END_TAG</span><span class="p">:</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">cur</span><span class="p">:</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>                        <span class="s2">&quot;Too many END_TAG! No more elements available to attach to!&quot;</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>  <span class="c1"># Check if the name is empty</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>                            <span class="s2">&quot;Empty tag name at END_TAG, skipping to next element&quot;</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>                        <span class="k">continue</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>                <span class="n">uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_namespace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>                <span class="n">tag</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>                <span class="k">if</span> <span class="n">cur</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tag</span> <span class="o">!=</span> <span class="n">tag</span><span class="p">:</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>                        <span class="s2">&quot;Closing tag &#39;</span><span class="si">{}</span><span class="s2">&#39; does not match current stack! At line number: </span><span class="si">{}</span><span class="s2">. Is the XML malformed?&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">m_lineNumber</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>                <span class="n">cur</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>            <span class="k">if</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">TEXT</span><span class="p">:</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;TEXT for </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cur</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>                <span class="n">cur</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">text</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>            <span class="k">if</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">END_DOCUMENT</span><span class="p">:</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>                <span class="c1"># Check if all namespace mappings are closed</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">namespaces</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>                        <span class="s2">&quot;Not all namespace mappings were closed! Malformed AXML?&quot;</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>                <span class="k">break</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>    <span class="k">def</span> <span class="nf">clean_and_replace_nsmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nsmap</span><span class="p">,</span> <span class="n">invalid_prefix</span><span class="p">):</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>        <span class="n">correct_prefix</span> <span class="o">=</span> <span class="s1">&#39;android&#39;</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>        <span class="n">corrected_nsmap</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>        <span class="k">for</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">uri</span> <span class="ow">in</span> <span class="n">nsmap</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>            <span class="k">if</span> <span class="n">prefix</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">invalid_prefix</span><span class="p">):</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>                <span class="n">corrected_nsmap</span><span class="p">[</span><span class="n">correct_prefix</span><span class="p">]</span> <span class="o">=</span> <span class="n">uri</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>                <span class="n">corrected_nsmap</span><span class="p">[</span><span class="n">prefix</span><span class="p">]</span> <span class="o">=</span> <span class="n">uri</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>        <span class="k">return</span> <span class="n">corrected_nsmap</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>    <span class="k">def</span> <span class="nf">get_buff</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">        Returns the raw XML file without prettification applied.</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">        :returns: bytes, encoded as UTF-8</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xml</span><span class="p">(</span><span class="n">pretty</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>    <span class="k">def</span> <span class="nf">get_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pretty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">        Get the XML as an UTF-8 string</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">        :returns: bytes encoded as UTF-8</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>        <span class="k">return</span> <span class="n">etree</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">pretty_print</span><span class="o">=</span><span class="n">pretty</span><span class="p">)</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>    <span class="k">def</span> <span class="nf">get_xml_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">:</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">        Get the XML as an ElementTree object</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">        :returns: `lxml.etree.Element` object</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><span class="sd">        Return the state of the [AXMLParser][androguard.core.axml.AXMLParser].</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><span class="sd">        If this flag is set to `False`, the parsing has failed, thus</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">        the resulting XML will not work or will even be empty.</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">        :returns: `True` if the `AXMLParser` finished parsing, or `False` if an error occurred</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>    <span class="k">def</span> <span class="nf">is_packed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a><span class="sd">        Returns True if the AXML is likely to be packed</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a><span class="sd">        Packers do some weird stuff and we try to detect it.</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">        Sometimes the files are not packed but simply broken or compiled with</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a><span class="sd">        some broken version of a tool.</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a><span class="sd">        Some file corruption might also be appear to be a packed file.</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a><span class="sd">        :returns: True if packer detected, False otherwise</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">packerwarning</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">packerwarning</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>    <span class="k">def</span> <span class="nf">_get_attribute_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="sd">        Wrapper function for format_value to resolve the actual value of an attribute in a tag</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a><span class="sd">        :param index: index of the current attribute</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a><span class="sd">        :return: formatted value</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>        <span class="n">_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">getAttributeValueType</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>        <span class="n">_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">getAttributeValueData</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>        <span class="k">return</span> <span class="n">format_value</span><span class="p">(</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>            <span class="n">_type</span><span class="p">,</span> <span class="n">_data</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">getAttributeValue</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>        <span class="p">)</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>    <span class="k">def</span> <span class="nf">_fix_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><span class="sd">        Apply some fixes to element named and attribute names.</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a><span class="sd">        Try to get conform to:</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="sd">        &gt; Like element names, attribute names are case-sensitive and must start with a letter or underscore.</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">        &gt; The rest of the name can contain letters, digits, hyphens, underscores, and periods.</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">        See: &lt;https://msdn.microsoft.com/en-us/library/ms256152(v=vs.110).aspx&gt;</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="sd">        This function tries to fix some broken namespace mappings.</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="sd">        In some cases, the namespace prefix is inside the name and not in the prefix field.</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">        Then, the tag name will usually look like &#39;android:foobar&#39;.</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a><span class="sd">        If and only if the namespace prefix is inside the namespace mapping and the actual prefix field is empty,</span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">        we will strip the prefix from the attribute name and return the fixed prefix URI instead.</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">        Otherwise replacement rules will be applied.</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">        The replacement rules work in that way, that all unwanted characters are replaced by underscores.</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a><span class="sd">        In other words, all characters except the ones listed above are replaced.</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">        :param name: Name of the attribute or tag</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a><span class="sd">        :param prefix: The existing prefix uri as found in the AXML chunk</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a><span class="sd">        :return: a fixed version of prefix and name</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;_&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>                <span class="s2">&quot;Invalid start for name &#39;</span><span class="si">{}</span><span class="s2">&#39;. &quot;</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>                <span class="s2">&quot;XML name must start with a letter.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>            <span class="p">)</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">packerwarning</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a>            <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;android:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>            <span class="ow">and</span> <span class="n">prefix</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>            <span class="ow">and</span> <span class="s1">&#39;android&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">nsmap</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>        <span class="p">):</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>            <span class="c1"># Seems be a common thing...</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>                <span class="s2">&quot;Name &#39;</span><span class="si">{}</span><span class="s2">&#39; starts with &#39;android:&#39; prefix but &#39;android&#39; is a known prefix. Replacing prefix.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>                    <span class="n">name</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>                <span class="p">)</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>            <span class="p">)</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>            <span class="n">prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_namespace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">nsmap</span><span class="p">[</span><span class="s1">&#39;android&#39;</span><span class="p">])</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;android:&quot;</span><span class="p">)</span> <span class="p">:]</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>            <span class="c1"># It looks like this is some kind of packer... Not sure though.</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">packerwarning</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>        <span class="k">elif</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">and</span> <span class="n">prefix</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">packerwarning</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>            <span class="n">embedded_prefix</span><span class="p">,</span> <span class="n">new_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>            <span class="k">if</span> <span class="n">embedded_prefix</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">nsmap</span><span class="p">:</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>                    <span class="s2">&quot;Prefix &#39;</span><span class="si">{}</span><span class="s2">&#39; is in namespace mapping, assume that it is a prefix.&quot;</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a>                <span class="p">)</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>                <span class="n">prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_namespace</span><span class="p">(</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">nsmap</span><span class="p">[</span><span class="n">embedded_prefix</span><span class="p">]</span>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>                <span class="p">)</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>                <span class="n">name</span> <span class="o">=</span> <span class="n">new_name</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>                <span class="c1"># Print out an extra warning</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>                    <span class="s2">&quot;Confused: name contains a unknown namespace prefix: &#39;</span><span class="si">{}</span><span class="s2">&#39;. &quot;</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>                    <span class="s2">&quot;This is either a broken AXML file or some attempt to break stuff.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>                        <span class="n">name</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>                <span class="p">)</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[a-zA-Z0-9._-]*$&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a>                <span class="s2">&quot;Name &#39;</span><span class="si">{}</span><span class="s2">&#39; contains invalid characters!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>            <span class="p">)</span>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">packerwarning</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^a-zA-Z0-9._-]&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a>        <span class="k">return</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">name</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a>    <span class="k">def</span> <span class="nf">_fix_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a><span class="sd">        Return a cleaned version of a value</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><span class="sd">        according to the specification:</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a><span class="sd">        &gt; Char	   ::=   	#x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF]</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a><span class="sd">        See &lt;https://www.w3.org/TR/xml/#charsets&gt;</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a><span class="sd">        :param value: a value to clean</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a><span class="sd">        :return: the cleaned value</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__charrange</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__replacement</span><span class="p">:</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__charrange</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a>                <span class="s1">&#39;^[</span><span class="se">\u0020</span><span class="s1">-</span><span class="se">\uD7FF\u0009\u000A\u000D\uE000</span><span class="s1">-</span><span class="se">\uFFFD\U00010000</span><span class="s1">-</span><span class="se">\U0010FFFF</span><span class="s1">]*$&#39;</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a>            <span class="p">)</span>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__replacement</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>                <span class="s1">&#39;[^</span><span class="se">\u0020</span><span class="s1">-</span><span class="se">\uD7FF\u0009\u000A\u000D\uE000</span><span class="s1">-</span><span class="se">\uFFFD\U00010000</span><span class="s1">-</span><span class="se">\U0010FFFF</span><span class="s1">]&#39;</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>            <span class="p">)</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a>        <span class="c1"># Reading string until \x00. This is the same as aapt does.</span>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a>        <span class="k">if</span> <span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">packerwarning</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a>                <span class="s2">&quot;Null byte found in attribute value at position </span><span class="si">{}</span><span class="s2">: &quot;</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>                <span class="s2">&quot;Value(hex): &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a>                    <span class="n">value</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>                <span class="p">)</span>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>            <span class="p">)</span>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[:</span> <span class="n">value</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)]</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__charrange</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a>                <span class="s2">&quot;Invalid character in value found. Replacing with &#39;_&#39;.&quot;</span>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>            <span class="p">)</span>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">packerwarning</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a>            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__replacement</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>        <span class="k">return</span> <span class="n">value</span>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a>    <span class="k">def</span> <span class="nf">_print_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">):</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>        <span class="k">if</span> <span class="n">uri</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>            <span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;{{</span><span class="si">{}</span><span class="s2">}}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a>        <span class="k">return</span> <span class="n">uri</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLPrinter.get_buff" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_buff</span><span class="p">()</span></code>

<a href="#androguard.core.axml.AXMLPrinter.get_buff" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the raw XML file without prettification applied.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bytes, encoded as UTF-8</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="k">def</span> <span class="nf">get_buff</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">    Returns the raw XML file without prettification applied.</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">    :returns: bytes, encoded as UTF-8</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xml</span><span class="p">(</span><span class="n">pretty</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLPrinter.get_xml" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_xml</span><span class="p">(</span><span class="n">pretty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#androguard.core.axml.AXMLPrinter.get_xml" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Get the XML as an UTF-8 string</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bytes</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bytes encoded as UTF-8</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="k">def</span> <span class="nf">get_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pretty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">    Get the XML as an UTF-8 string</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">    :returns: bytes encoded as UTF-8</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>    <span class="k">return</span> <span class="n">etree</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">pretty_print</span><span class="o">=</span><span class="n">pretty</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLPrinter.get_xml_obj" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_xml_obj</span><span class="p">()</span></code>

<a href="#androguard.core.axml.AXMLPrinter.get_xml_obj" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Get the XML as an ElementTree object</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="lxml.etree.Element">Element</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>lxml.etree.Element</code> object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="k">def</span> <span class="nf">get_xml_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">:</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">    Get the XML as an ElementTree object</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">    :returns: `lxml.etree.Element` object</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLPrinter.is_packed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_packed</span><span class="p">()</span></code>

<a href="#androguard.core.axml.AXMLPrinter.is_packed" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns True if the AXML is likely to be packed</p>
<p>Packers do some weird stuff and we try to detect it.
Sometimes the files are not packed but simply broken or compiled with
some broken version of a tool.
Some file corruption might also be appear to be a packed file.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if packer detected, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1290" name="__codelineno-0-1290"></a><span class="k">def</span> <span class="nf">is_packed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a><span class="sd">    Returns True if the AXML is likely to be packed</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a><span class="sd">    Packers do some weird stuff and we try to detect it.</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">    Sometimes the files are not packed but simply broken or compiled with</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a><span class="sd">    some broken version of a tool.</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a><span class="sd">    Some file corruption might also be appear to be a packed file.</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a><span class="sd">    :returns: True if packer detected, False otherwise</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">packerwarning</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">packerwarning</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.AXMLPrinter.is_valid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_valid</span><span class="p">()</span></code>

<a href="#androguard.core.axml.AXMLPrinter.is_valid" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the state of the <a class="autorefs autorefs-internal" href="#androguard.core.axml.AXMLParser">AXMLParser</a>.
If this flag is set to <code>False</code>, the parsing has failed, thus
the resulting XML will not work or will even be empty.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if the <code>AXMLParser</code> finished parsing, or <code>False</code> if an error occurred</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1280" name="__codelineno-0-1280"></a><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><span class="sd">    Return the state of the [AXMLParser][androguard.core.axml.AXMLParser].</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><span class="sd">    If this flag is set to `False`, the parsing has failed, thus</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">    the resulting XML will not work or will even be empty.</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">    :returns: `True` if the `AXMLParser` finished parsing, or `False` if an error occurred</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axml</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.PackageContext" class="doc doc-heading">
            <code>PackageContext</code>


<a href="#androguard.core.axml.PackageContext" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2717">2717</a></span>
<span class="normal"><a href="#__codelineno-0-2718">2718</a></span>
<span class="normal"><a href="#__codelineno-0-2719">2719</a></span>
<span class="normal"><a href="#__codelineno-0-2720">2720</a></span>
<span class="normal"><a href="#__codelineno-0-2721">2721</a></span>
<span class="normal"><a href="#__codelineno-0-2722">2722</a></span>
<span class="normal"><a href="#__codelineno-0-2723">2723</a></span>
<span class="normal"><a href="#__codelineno-0-2724">2724</a></span>
<span class="normal"><a href="#__codelineno-0-2725">2725</a></span>
<span class="normal"><a href="#__codelineno-0-2726">2726</a></span>
<span class="normal"><a href="#__codelineno-0-2727">2727</a></span>
<span class="normal"><a href="#__codelineno-0-2728">2728</a></span>
<span class="normal"><a href="#__codelineno-0-2729">2729</a></span>
<span class="normal"><a href="#__codelineno-0-2730">2730</a></span>
<span class="normal"><a href="#__codelineno-0-2731">2731</a></span>
<span class="normal"><a href="#__codelineno-0-2732">2732</a></span>
<span class="normal"><a href="#__codelineno-0-2733">2733</a></span>
<span class="normal"><a href="#__codelineno-0-2734">2734</a></span>
<span class="normal"><a href="#__codelineno-0-2735">2735</a></span>
<span class="normal"><a href="#__codelineno-0-2736">2736</a></span>
<span class="normal"><a href="#__codelineno-0-2737">2737</a></span>
<span class="normal"><a href="#__codelineno-0-2738">2738</a></span>
<span class="normal"><a href="#__codelineno-0-2739">2739</a></span>
<span class="normal"><a href="#__codelineno-0-2740">2740</a></span>
<span class="normal"><a href="#__codelineno-0-2741">2741</a></span>
<span class="normal"><a href="#__codelineno-0-2742">2742</a></span>
<span class="normal"><a href="#__codelineno-0-2743">2743</a></span>
<span class="normal"><a href="#__codelineno-0-2744">2744</a></span>
<span class="normal"><a href="#__codelineno-0-2745">2745</a></span>
<span class="normal"><a href="#__codelineno-0-2746">2746</a></span>
<span class="normal"><a href="#__codelineno-0-2747">2747</a></span>
<span class="normal"><a href="#__codelineno-0-2748">2748</a></span>
<span class="normal"><a href="#__codelineno-0-2749">2749</a></span>
<span class="normal"><a href="#__codelineno-0-2750">2750</a></span>
<span class="normal"><a href="#__codelineno-0-2751">2751</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2717" name="__codelineno-0-2717"></a><span class="k">class</span> <span class="nc">PackageContext</span><span class="p">:</span>
<a id="__codelineno-0-2718" name="__codelineno-0-2718"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-2719" name="__codelineno-0-2719"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2720" name="__codelineno-0-2720"></a>        <span class="n">current_package</span><span class="p">:</span> <span class="n">ARSCResTablePackage</span><span class="p">,</span>
<a id="__codelineno-0-2721" name="__codelineno-0-2721"></a>        <span class="n">stringpool_main</span><span class="p">:</span> <span class="n">StringBlock</span><span class="p">,</span>
<a id="__codelineno-0-2722" name="__codelineno-0-2722"></a>        <span class="n">mTableStrings</span><span class="p">:</span> <span class="n">StringBlock</span><span class="p">,</span>
<a id="__codelineno-0-2723" name="__codelineno-0-2723"></a>        <span class="n">mKeyStrings</span><span class="p">:</span> <span class="n">StringBlock</span><span class="p">,</span>
<a id="__codelineno-0-2724" name="__codelineno-0-2724"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2725" name="__codelineno-0-2725"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2726" name="__codelineno-0-2726"></a><span class="sd">        :param current_package:</span>
<a id="__codelineno-0-2727" name="__codelineno-0-2727"></a><span class="sd">        :param stringpool_main:</span>
<a id="__codelineno-0-2728" name="__codelineno-0-2728"></a><span class="sd">        :param mTableStrings:</span>
<a id="__codelineno-0-2729" name="__codelineno-0-2729"></a><span class="sd">        :param mKeyStrings:</span>
<a id="__codelineno-0-2730" name="__codelineno-0-2730"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2731" name="__codelineno-0-2731"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stringpool_main</span> <span class="o">=</span> <span class="n">stringpool_main</span>
<a id="__codelineno-0-2732" name="__codelineno-0-2732"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mTableStrings</span> <span class="o">=</span> <span class="n">mTableStrings</span>
<a id="__codelineno-0-2733" name="__codelineno-0-2733"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mKeyStrings</span> <span class="o">=</span> <span class="n">mKeyStrings</span>
<a id="__codelineno-0-2734" name="__codelineno-0-2734"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_package</span> <span class="o">=</span> <span class="n">current_package</span>
<a id="__codelineno-0-2735" name="__codelineno-0-2735"></a>
<a id="__codelineno-0-2736" name="__codelineno-0-2736"></a>    <span class="k">def</span> <span class="nf">get_mResId</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-2737" name="__codelineno-0-2737"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_package</span><span class="o">.</span><span class="n">mResId</span>
<a id="__codelineno-0-2738" name="__codelineno-0-2738"></a>
<a id="__codelineno-0-2739" name="__codelineno-0-2739"></a>    <span class="k">def</span> <span class="nf">set_mResId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mResId</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2740" name="__codelineno-0-2740"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_package</span><span class="o">.</span><span class="n">mResId</span> <span class="o">=</span> <span class="n">mResId</span>
<a id="__codelineno-0-2741" name="__codelineno-0-2741"></a>
<a id="__codelineno-0-2742" name="__codelineno-0-2742"></a>    <span class="k">def</span> <span class="nf">get_package_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-2743" name="__codelineno-0-2743"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_package</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
<a id="__codelineno-0-2744" name="__codelineno-0-2744"></a>
<a id="__codelineno-0-2745" name="__codelineno-0-2745"></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-2746" name="__codelineno-0-2746"></a>        <span class="k">return</span> <span class="s2">&quot;&lt;PackageContext </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-2747" name="__codelineno-0-2747"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">current_package</span><span class="p">,</span>
<a id="__codelineno-0-2748" name="__codelineno-0-2748"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stringpool_main</span><span class="p">,</span>
<a id="__codelineno-0-2749" name="__codelineno-0-2749"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mTableStrings</span><span class="p">,</span>
<a id="__codelineno-0-2750" name="__codelineno-0-2750"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mKeyStrings</span><span class="p">,</span>
<a id="__codelineno-0-2751" name="__codelineno-0-2751"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.PackageContext.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">current_package</span><span class="p">,</span> <span class="n">stringpool_main</span><span class="p">,</span> <span class="n">mTableStrings</span><span class="p">,</span> <span class="n">mKeyStrings</span><span class="p">)</span></code>

<a href="#androguard.core.axml.PackageContext.__init__" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>current_package</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCResTablePackage" href="#androguard.core.axml.ARSCResTablePackage">ARSCResTablePackage</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stringpool_main</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="androguard.core.axml.StringBlock" href="#androguard.core.axml.StringBlock">StringBlock</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mTableStrings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="androguard.core.axml.StringBlock" href="#androguard.core.axml.StringBlock">StringBlock</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mKeyStrings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="androguard.core.axml.StringBlock" href="#androguard.core.axml.StringBlock">StringBlock</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2718">2718</a></span>
<span class="normal"><a href="#__codelineno-0-2719">2719</a></span>
<span class="normal"><a href="#__codelineno-0-2720">2720</a></span>
<span class="normal"><a href="#__codelineno-0-2721">2721</a></span>
<span class="normal"><a href="#__codelineno-0-2722">2722</a></span>
<span class="normal"><a href="#__codelineno-0-2723">2723</a></span>
<span class="normal"><a href="#__codelineno-0-2724">2724</a></span>
<span class="normal"><a href="#__codelineno-0-2725">2725</a></span>
<span class="normal"><a href="#__codelineno-0-2726">2726</a></span>
<span class="normal"><a href="#__codelineno-0-2727">2727</a></span>
<span class="normal"><a href="#__codelineno-0-2728">2728</a></span>
<span class="normal"><a href="#__codelineno-0-2729">2729</a></span>
<span class="normal"><a href="#__codelineno-0-2730">2730</a></span>
<span class="normal"><a href="#__codelineno-0-2731">2731</a></span>
<span class="normal"><a href="#__codelineno-0-2732">2732</a></span>
<span class="normal"><a href="#__codelineno-0-2733">2733</a></span>
<span class="normal"><a href="#__codelineno-0-2734">2734</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2718" name="__codelineno-0-2718"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-2719" name="__codelineno-0-2719"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2720" name="__codelineno-0-2720"></a>    <span class="n">current_package</span><span class="p">:</span> <span class="n">ARSCResTablePackage</span><span class="p">,</span>
<a id="__codelineno-0-2721" name="__codelineno-0-2721"></a>    <span class="n">stringpool_main</span><span class="p">:</span> <span class="n">StringBlock</span><span class="p">,</span>
<a id="__codelineno-0-2722" name="__codelineno-0-2722"></a>    <span class="n">mTableStrings</span><span class="p">:</span> <span class="n">StringBlock</span><span class="p">,</span>
<a id="__codelineno-0-2723" name="__codelineno-0-2723"></a>    <span class="n">mKeyStrings</span><span class="p">:</span> <span class="n">StringBlock</span><span class="p">,</span>
<a id="__codelineno-0-2724" name="__codelineno-0-2724"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2725" name="__codelineno-0-2725"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2726" name="__codelineno-0-2726"></a><span class="sd">    :param current_package:</span>
<a id="__codelineno-0-2727" name="__codelineno-0-2727"></a><span class="sd">    :param stringpool_main:</span>
<a id="__codelineno-0-2728" name="__codelineno-0-2728"></a><span class="sd">    :param mTableStrings:</span>
<a id="__codelineno-0-2729" name="__codelineno-0-2729"></a><span class="sd">    :param mKeyStrings:</span>
<a id="__codelineno-0-2730" name="__codelineno-0-2730"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2731" name="__codelineno-0-2731"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stringpool_main</span> <span class="o">=</span> <span class="n">stringpool_main</span>
<a id="__codelineno-0-2732" name="__codelineno-0-2732"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mTableStrings</span> <span class="o">=</span> <span class="n">mTableStrings</span>
<a id="__codelineno-0-2733" name="__codelineno-0-2733"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mKeyStrings</span> <span class="o">=</span> <span class="n">mKeyStrings</span>
<a id="__codelineno-0-2734" name="__codelineno-0-2734"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">current_package</span> <span class="o">=</span> <span class="n">current_package</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.ResParserError" class="doc doc-heading">
            <code>ResParserError</code>


<a href="#androguard.core.axml.ResParserError" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Exception</code></p>


        <p>Exception for the parsers</p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="k">class</span> <span class="nc">ResParserError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception for the parsers&quot;&quot;&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="androguard.core.axml.StringBlock" class="doc doc-heading">
            <code>StringBlock</code>


<a href="#androguard.core.axml.StringBlock" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">


        <p>StringBlock is a CHUNK inside an AXML File: <code>ResStringPool_header</code>
It contains all strings, which are used by referencing to ID's</p>
<p>See http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#436</p>






              <details class="quote">
                <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="k">class</span> <span class="nc">StringBlock</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    StringBlock is a CHUNK inside an AXML File: `ResStringPool_header`</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    It contains all strings, which are used by referencing to ID&#39;s</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    See http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/include/androidfw/ResourceTypes.h#436</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buff</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span> <span class="n">header</span><span class="p">:</span> <span class="n">ARSCHeader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        :param buff: buffer which holds the string block</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        :param header: a instance of [ARSCHeader][androguard.core.axml.ARSCHeader]</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">header</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="c1"># We already read the header (which was chunk_type and chunk_size</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="c1"># Now, we read the string_count:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="c1"># style_count</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="c1"># flags</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_isUTF8</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">UTF8_FLAG</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="c1"># string_pool_offset</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="c1"># The string offset is counted from the beginning of the string section</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stringsOffset</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="c1"># check if the stringCount is correct</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stringsOffset</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">28</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="p">)</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringsOffset</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">28</span><span class="p">))</span> <span class="o">/</span> <span class="mi">4</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="c1"># style_pool_offset</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="c1"># The styles offset is counted as well from the beginning of the string section</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="c1"># Check if they supplied a stylesOffset even if the count is 0:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>                <span class="s2">&quot;Styles Offset given, but styleCount is zero. &quot;</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>                <span class="s2">&quot;This is not a problem but could indicate packers.&quot;</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_stringOffsets</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_styleOffsets</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_charbuff</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_styles</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="c1"># Next, there is a list of string following.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="c1"># This is only a list of offsets (4 byte each)</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span><span class="p">):</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">m_stringOffsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="c1"># And a list of styles</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="c1"># again, a list of offsets</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span><span class="p">):</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">m_styleOffsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="c1"># FIXME it is probably better to parse n strings and not calculate the size</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringsOffset</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="c1"># if there are styles as well, we do not want to read them too.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="c1"># Only read them, if no</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringsOffset</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Size of strings is not aligned by four bytes.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_charbuff</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Size of styles is not aligned by four bytes.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">//</span> <span class="mi">4</span><span class="p">):</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">m_styles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="k">return</span> <span class="s2">&quot;&lt;StringPool #strings=</span><span class="si">{}</span><span class="s2">, #styles=</span><span class="si">{}</span><span class="s2">, UTF8=</span><span class="si">{}</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_isUTF8</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="p">)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        Returns the string at the index in the string table</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        :returns: the string</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        Get the number of strings stored in this table</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        :return: the number of strings</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        Iterable over all strings</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        :returns: a generator over all strings</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span><span class="p">):</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="k">def</span> <span class="nf">getString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        Return the string at the index in the string table</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        :param idx: index in the string table</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        :return: the string</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_stringOffsets</span> <span class="ow">or</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_stringOffsets</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_isUTF8</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode8</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode16</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="k">def</span> <span class="nf">getStyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        Return the style associated with the index</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        :param idx: index of the style</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        :return: the style integer</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_styles</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="k">def</span> <span class="nf">_decode8</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        Decode an UTF-8 String at the given offset</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        :param offset: offset of the string inside the data</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        :raises ResParserError: if string is not null terminated</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        :return: the decoded string</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="c1"># UTF-8 Strings contain two lengths, as they might differ:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="c1"># 1) the UTF-16 length</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="n">str_len</span><span class="p">,</span> <span class="n">skip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode_length</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="n">offset</span> <span class="o">+=</span> <span class="n">skip</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="c1"># 2) the utf-8 string length</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="n">encoded_bytes</span><span class="p">,</span> <span class="n">skip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode_length</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">offset</span> <span class="o">+=</span> <span class="n">skip</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="c1"># Two checks should happen here:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="c1"># a) offset + encoded_bytes surpassing the string_pool length and</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="c1"># b) non-null terminated strings which should be rejected</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="c1"># platform/frameworks/base/libs/androidfw/ResourceTypes.cpp#789</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_charbuff</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="n">encoded_bytes</span><span class="p">):</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                <span class="sa">f</span><span class="s2">&quot;String size: </span><span class="si">{</span><span class="n">offset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">encoded_bytes</span><span class="si">}</span><span class="s2"> is exceeding string pool size. Returning empty string.&quot;</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_charbuff</span><span class="p">[</span><span class="n">offset</span> <span class="p">:</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">encoded_bytes</span><span class="p">]</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_charbuff</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">encoded_bytes</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                <span class="s2">&quot;UTF-8 String is not null terminated! At offset=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>                    <span class="n">offset</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>                <span class="p">)</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>            <span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">str_len</span><span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="k">def</span> <span class="nf">_decode16</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        Decode an UTF-16 String at the given offset</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        :param offset: offset of the string inside the data</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        :raises ResParserError: if string is not null terminated</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        :return: the decoded string</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="n">str_len</span><span class="p">,</span> <span class="n">skip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode_length</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="n">offset</span> <span class="o">+=</span> <span class="n">skip</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="c1"># The len is the string len in utf-16 units</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="n">encoded_bytes</span> <span class="o">=</span> <span class="n">str_len</span> <span class="o">*</span> <span class="mi">2</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="c1"># Two checks should happen here:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="c1"># a) offset + encoded_bytes surpassing the string_pool length and</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="c1"># b) non-null terminated strings which should be rejected</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="c1"># platform/frameworks/base/libs/androidfw/ResourceTypes.cpp#789</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m_charbuff</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="n">encoded_bytes</span><span class="p">):</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>                <span class="sa">f</span><span class="s2">&quot;String size: </span><span class="si">{</span><span class="n">offset</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">encoded_bytes</span><span class="si">}</span><span class="s2"> is exceeding string pool size. Returning empty string.&quot;</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>            <span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_charbuff</span><span class="p">[</span><span class="n">offset</span> <span class="p">:</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">encoded_bytes</span><span class="p">]</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">m_charbuff</span><span class="p">[</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>                <span class="n">offset</span> <span class="o">+</span> <span class="n">encoded_bytes</span> <span class="p">:</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">encoded_bytes</span> <span class="o">+</span> <span class="mi">2</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="p">]</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>            <span class="o">!=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00\x00</span><span class="s2">&quot;</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="p">):</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>            <span class="k">raise</span> <span class="n">ResParserError</span><span class="p">(</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>                <span class="s2">&quot;UTF-16 String is not null terminated! At offset=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>                    <span class="n">offset</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>                <span class="p">)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="p">)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;utf-16&#39;</span><span class="p">,</span> <span class="n">str_len</span><span class="p">)</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="k">def</span> <span class="nf">_decode_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">str_len</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        Generic decoding with length check.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        The string is decoded from bytes with the given encoding, then the length</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        of the string is checked.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        The string is decoded using the &quot;replace&quot; method.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        :param data: bytes</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        :param encoding: encoding name (&quot;utf-8&quot; or &quot;utf-16&quot;)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        :param str_len: length of the decoded string</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        :return: the decoded bytes</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="n">string</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encoding</span><span class="p">,</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="o">!=</span> <span class="n">str_len</span><span class="p">:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;invalid decoded string length&quot;</span><span class="p">)</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="k">return</span> <span class="n">string</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="k">def</span> <span class="nf">_decode_length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sizeof_char</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        Generic Length Decoding at offset of string</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        The method works for both 8 and 16 bit Strings.</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">        Length checks are enforced:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        * 8 bit strings: maximum of 0x7FFF bytes (See</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/ResourceTypes.cpp#692)</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        * 16 bit strings: maximum of 0x7FFFFFF bytes (See</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        http://androidxref.com/9.0.0_r3/xref/frameworks/base/libs/androidfw/ResourceTypes.cpp#670)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        :param offset: offset into the string data section of the beginning of</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        the string</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        :param sizeof_char: number of bytes per char (1 = 8bit, 2 = 16bit)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        :returns: tuple of (length, read bytes)</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="n">sizeof_2chars</span> <span class="o">=</span> <span class="n">sizeof_char</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;&lt;2</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;B&#39;</span> <span class="k">if</span> <span class="n">sizeof_char</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;H&#39;</span><span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="n">highbit</span> <span class="o">=</span> <span class="mh">0x80</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="n">sizeof_char</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="n">length1</span><span class="p">,</span> <span class="n">length2</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="n">fmt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_charbuff</span><span class="p">[</span><span class="n">offset</span> <span class="p">:</span> <span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="n">sizeof_2chars</span><span class="p">)]</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="p">)</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">length1</span> <span class="o">&amp;</span> <span class="n">highbit</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>            <span class="n">length</span> <span class="o">=</span> <span class="p">((</span><span class="n">length1</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">highbit</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">sizeof_char</span><span class="p">))</span> <span class="o">|</span> <span class="n">length2</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="n">size</span> <span class="o">=</span> <span class="n">sizeof_2chars</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>            <span class="n">length</span> <span class="o">=</span> <span class="n">length1</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="n">size</span> <span class="o">=</span> <span class="n">sizeof_char</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="c1"># These are true asserts, as the size should never be less than the values</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="k">if</span> <span class="n">sizeof_char</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="k">assert</span> <span class="p">(</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                <span class="n">length</span> <span class="o">&lt;=</span> <span class="mh">0x7FFF</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="p">),</span> <span class="s2">&quot;length of UTF-8 string is too large! At offset=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>                <span class="n">offset</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="k">assert</span> <span class="p">(</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>                <span class="n">length</span> <span class="o">&lt;=</span> <span class="mh">0x7FFFFFFF</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="p">),</span> <span class="s2">&quot;length of UTF-16 string is too large!  At offset=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>                <span class="n">offset</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">return</span> <span class="n">length</span><span class="p">,</span> <span class="n">size</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        Print some information on stdout about the string table</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>            <span class="s2">&quot;StringBlock(stringsCount=0x</span><span class="si">%x</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>            <span class="s2">&quot;stringsOffset=0x</span><span class="si">%x</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>            <span class="s2">&quot;stylesCount=0x</span><span class="si">%x</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>            <span class="s2">&quot;stylesOffset=0x</span><span class="si">%x</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="s2">&quot;flags=0x</span><span class="si">%x</span><span class="s2">&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>            <span class="s2">&quot;)&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>            <span class="o">%</span> <span class="p">(</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span><span class="p">,</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stringsOffset</span><span class="p">,</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span><span class="p">,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>            <span class="p">)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="nb">print</span><span class="p">()</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;String Table: &quot;</span><span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:08d}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="nb">print</span><span class="p">()</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Styles Table: &quot;</span><span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span><span class="p">):</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:08d}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getStyle</span><span class="p">(</span><span class="n">i</span><span class="p">))))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.StringBlock.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></code>

<a href="#androguard.core.axml.StringBlock.__getitem__" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the string at the index in the string table</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    Returns the string at the index in the string table</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    :returns: the string</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.StringBlock.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">buff</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span></code>

<a href="#androguard.core.axml.StringBlock.__init__" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>buff</code>
            </td>
            <td>
                  <code><span title="typing.BinaryIO">BinaryIO</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>buffer which holds the string block</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>header</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCHeader" href="#androguard.core.axml.ARSCHeader">ARSCHeader</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a instance of <a class="autorefs autorefs-internal" href="#androguard.core.axml.ARSCHeader">ARSCHeader</a></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buff</span><span class="p">:</span> <span class="n">BinaryIO</span><span class="p">,</span> <span class="n">header</span><span class="p">:</span> <span class="n">ARSCHeader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    :param buff: buffer which holds the string block</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    :param header: a instance of [ARSCHeader][androguard.core.axml.ARSCHeader]</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">header</span> <span class="o">=</span> <span class="n">header</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="c1"># We already read the header (which was chunk_type and chunk_size</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="c1"># Now, we read the string_count:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="c1"># style_count</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="c1"># flags</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">m_isUTF8</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">UTF8_FLAG</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="c1"># string_pool_offset</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="c1"># The string offset is counted from the beginning of the string section</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stringsOffset</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="c1"># check if the stringCount is correct</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stringsOffset</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">28</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="p">)</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringsOffset</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">28</span><span class="p">))</span> <span class="o">/</span> <span class="mi">4</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="c1"># style_pool_offset</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="c1"># The styles offset is counted as well from the beginning of the string section</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="c1"># Check if they supplied a stylesOffset even if the count is 0:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="s2">&quot;Styles Offset given, but styleCount is zero. &quot;</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>            <span class="s2">&quot;This is not a problem but could indicate packers.&quot;</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">m_stringOffsets</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">m_styleOffsets</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">m_charbuff</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">m_styles</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="c1"># Next, there is a list of string following.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="c1"># This is only a list of offsets (4 byte each)</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span><span class="p">):</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_stringOffsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="c1"># And a list of styles</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="c1"># again, a list of offsets</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span><span class="p">):</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">m_styleOffsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="c1"># FIXME it is probably better to parse n strings and not calculate the size</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringsOffset</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="c1"># if there are styles as well, we do not want to read them too.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="c1"># Only read them, if no</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringsOffset</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Size of strings is not aligned by four bytes.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">m_charbuff</span> <span class="o">=</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Size of styles is not aligned by four bytes.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">//</span> <span class="mi">4</span><span class="p">):</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">m_styles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">buff</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.StringBlock.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

<a href="#androguard.core.axml.StringBlock.__iter__" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Iterable over all strings</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a generator over all strings</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    Iterable over all strings</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    :returns: a generator over all strings</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span><span class="p">):</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">getString</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.StringBlock.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

<a href="#androguard.core.axml.StringBlock.__len__" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Get the number of strings stored in this table</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the number of strings</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    Get the number of strings stored in this table</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    :return: the number of strings</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.StringBlock.getString" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getString</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></code>

<a href="#androguard.core.axml.StringBlock.getString" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the string at the index in the string table</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>idx</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>index in the string table</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="k">def</span> <span class="nf">getString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">    Return the string at the index in the string table</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">    :param idx: index in the string table</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    :return: the string</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_stringOffsets</span> <span class="ow">or</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_stringOffsets</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_isUTF8</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode8</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode16</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.StringBlock.getStyle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">getStyle</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></code>

<a href="#androguard.core.axml.StringBlock.getStyle" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return the style associated with the index</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>idx</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>index of the style</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the style integer</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="k">def</span> <span class="nf">getStyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    Return the style associated with the index</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    :param idx: index of the style</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    :return: the style integer</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">m_styles</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="androguard.core.axml.StringBlock.show" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show</span><span class="p">()</span></code>

<a href="#androguard.core.axml.StringBlock.show" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Print some information on stdout about the string table</p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">    Print some information on stdout about the string table</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="s2">&quot;StringBlock(stringsCount=0x</span><span class="si">%x</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="s2">&quot;stringsOffset=0x</span><span class="si">%x</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="s2">&quot;stylesCount=0x</span><span class="si">%x</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="s2">&quot;stylesOffset=0x</span><span class="si">%x</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="s2">&quot;flags=0x</span><span class="si">%x</span><span class="s2">&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="s2">&quot;)&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="o">%</span> <span class="p">(</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span><span class="p">,</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stringsOffset</span><span class="p">,</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stylesOffset</span><span class="p">,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="p">)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stringCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="nb">print</span><span class="p">()</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;String Table: &quot;</span><span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:08d}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="nb">print</span><span class="p">()</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Styles Table: &quot;</span><span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">styleCount</span><span class="p">):</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:08d}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getStyle</span><span class="p">(</span><span class="n">i</span><span class="p">))))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="androguard.core.axml.complexToFloat" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">complexToFloat</span><span class="p">(</span><span class="n">xcomplex</span><span class="p">)</span></code>

<a href="#androguard.core.axml.complexToFloat" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Convert a complex unit into float</p>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="k">def</span> <span class="nf">complexToFloat</span><span class="p">(</span><span class="n">xcomplex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">    Convert a complex unit into float</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">xcomplex</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFF00</span><span class="p">)</span> <span class="o">*</span> <span class="n">RADIX_MULTS</span><span class="p">[(</span><span class="n">xcomplex</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="androguard.core.axml.format_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">format_value</span><span class="p">(</span><span class="n">_type</span><span class="p">,</span> <span class="n">_data</span><span class="p">,</span> <span class="n">lookup_string</span><span class="o">=</span><span class="k">lambda</span> <span class="n">ix</span><span class="p">:</span> <span class="s1">&#39;&lt;string&gt;&#39;</span><span class="p">)</span></code>

<a href="#androguard.core.axml.format_value" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Format a value based on type and data.
By default, no strings are looked up and <code>"&lt;string&gt;"</code> is returned.
You need to define <code>lookup_string</code> in order to actually lookup strings from
the string table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_type</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The numeric type of the value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>_data</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The numeric data of the value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lookup_string</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A function how to resolve strings from integer IDs</p>
              </div>
            </td>
            <td>
                  <code>lambda ix: &#39;&lt;string&gt;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the formatted string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="k">def</span> <span class="nf">format_value</span><span class="p">(</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>    <span class="n">_type</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">_data</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">lookup_string</span><span class="o">=</span><span class="k">lambda</span> <span class="n">ix</span><span class="p">:</span> <span class="s2">&quot;&lt;string&gt;&quot;</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">    Format a value based on type and data.</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">    By default, no strings are looked up and `&quot;&lt;string&gt;&quot;` is returned.</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">    You need to define `lookup_string` in order to actually lookup strings from</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">    the string table.</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="sd">    :param _type: The numeric type of the value</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">    :param _data: The numeric data of the value</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">    :param lookup_string: A function how to resolve strings from integer IDs</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">    :returns: the formatted string</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>    <span class="c1"># Function to prepend android prefix for attributes/references from the</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>    <span class="c1"># android library</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>    <span class="n">fmt_package</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;android:&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>    <span class="c1"># Function to represent integers</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>    <span class="n">fmt_int</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x7FFFFFFF</span> <span class="o">&amp;</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0x80000000</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mh">0x7FFFFFFF</span> <span class="k">else</span> <span class="n">x</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>    <span class="k">if</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">TYPE_STRING</span><span class="p">:</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>        <span class="k">return</span> <span class="n">lookup_string</span><span class="p">(</span><span class="n">_data</span><span class="p">)</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>    <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">TYPE_ATTRIBUTE</span><span class="p">:</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>        <span class="k">return</span> <span class="s2">&quot;?</span><span class="si">{}{:08X}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt_package</span><span class="p">(</span><span class="n">_data</span><span class="p">),</span> <span class="n">_data</span><span class="p">)</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>    <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">TYPE_REFERENCE</span><span class="p">:</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>        <span class="k">return</span> <span class="s2">&quot;@</span><span class="si">{}{:08X}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fmt_package</span><span class="p">(</span><span class="n">_data</span><span class="p">),</span> <span class="n">_data</span><span class="p">)</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>    <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">TYPE_FLOAT</span><span class="p">:</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;=f&quot;</span><span class="p">,</span> <span class="n">pack</span><span class="p">(</span><span class="s2">&quot;=L&quot;</span><span class="p">,</span> <span class="n">_data</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>    <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">TYPE_INT_HEX</span><span class="p">:</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>        <span class="k">return</span> <span class="s2">&quot;0x</span><span class="si">%08X</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">_data</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>    <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">TYPE_INT_BOOLEAN</span><span class="p">:</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>        <span class="k">if</span> <span class="n">_data</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>            <span class="k">return</span> <span class="s2">&quot;false&quot;</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>        <span class="k">return</span> <span class="s2">&quot;true&quot;</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>    <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">TYPE_DIMENSION</span><span class="p">:</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:f}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>            <span class="n">complexToFloat</span><span class="p">(</span><span class="n">_data</span><span class="p">),</span> <span class="n">DIMENSION_UNITS</span><span class="p">[</span><span class="n">_data</span> <span class="o">&amp;</span> <span class="n">COMPLEX_UNIT_MASK</span><span class="p">]</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>        <span class="p">)</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>    <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="n">TYPE_FRACTION</span><span class="p">:</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{:f}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>            <span class="n">complexToFloat</span><span class="p">(</span><span class="n">_data</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>            <span class="n">FRACTION_UNITS</span><span class="p">[</span><span class="n">_data</span> <span class="o">&amp;</span> <span class="n">COMPLEX_UNIT_MASK</span><span class="p">],</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>        <span class="p">)</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>    <span class="k">elif</span> <span class="n">TYPE_FIRST_COLOR_INT</span> <span class="o">&lt;=</span> <span class="n">_type</span> <span class="o">&lt;=</span> <span class="n">TYPE_LAST_COLOR_INT</span><span class="p">:</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>        <span class="k">return</span> <span class="s2">&quot;#</span><span class="si">%08X</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">_data</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>    <span class="k">elif</span> <span class="n">TYPE_FIRST_INT</span> <span class="o">&lt;=</span> <span class="n">_type</span> <span class="o">&lt;=</span> <span class="n">TYPE_LAST_INT</span><span class="p">:</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fmt_int</span><span class="p">(</span><span class="n">_data</span><span class="p">)</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>    <span class="k">return</span> <span class="s2">&quot;&lt;0x</span><span class="si">{:X}</span><span class="s2">, type 0x</span><span class="si">{:02X}</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_data</span><span class="p">,</span> <span class="n">_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="androguard.core.axml.get_arsc_info" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_arsc_info</span><span class="p">(</span><span class="n">arscobj</span><span class="p">)</span></code>

<a href="#androguard.core.axml.get_arsc_info" class="headerlink" title="Permanent link">#</a></h2>


    <div class="doc doc-contents ">

        <p>Return a string containing all resources packages ordered by packagename, locale and type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>arscobj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="androguard.core.axml.ARSCParser" href="#androguard.core.axml.ARSCParser">ARSCParser</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><a class="autorefs autorefs-internal" href="#androguard.core.axml.ARSCParser">ARSCParser</a></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>androguard/core/axml/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-3722">3722</a></span>
<span class="normal"><a href="#__codelineno-0-3723">3723</a></span>
<span class="normal"><a href="#__codelineno-0-3724">3724</a></span>
<span class="normal"><a href="#__codelineno-0-3725">3725</a></span>
<span class="normal"><a href="#__codelineno-0-3726">3726</a></span>
<span class="normal"><a href="#__codelineno-0-3727">3727</a></span>
<span class="normal"><a href="#__codelineno-0-3728">3728</a></span>
<span class="normal"><a href="#__codelineno-0-3729">3729</a></span>
<span class="normal"><a href="#__codelineno-0-3730">3730</a></span>
<span class="normal"><a href="#__codelineno-0-3731">3731</a></span>
<span class="normal"><a href="#__codelineno-0-3732">3732</a></span>
<span class="normal"><a href="#__codelineno-0-3733">3733</a></span>
<span class="normal"><a href="#__codelineno-0-3734">3734</a></span>
<span class="normal"><a href="#__codelineno-0-3735">3735</a></span>
<span class="normal"><a href="#__codelineno-0-3736">3736</a></span>
<span class="normal"><a href="#__codelineno-0-3737">3737</a></span>
<span class="normal"><a href="#__codelineno-0-3738">3738</a></span>
<span class="normal"><a href="#__codelineno-0-3739">3739</a></span>
<span class="normal"><a href="#__codelineno-0-3740">3740</a></span>
<span class="normal"><a href="#__codelineno-0-3741">3741</a></span>
<span class="normal"><a href="#__codelineno-0-3742">3742</a></span>
<span class="normal"><a href="#__codelineno-0-3743">3743</a></span>
<span class="normal"><a href="#__codelineno-0-3744">3744</a></span>
<span class="normal"><a href="#__codelineno-0-3745">3745</a></span>
<span class="normal"><a href="#__codelineno-0-3746">3746</a></span>
<span class="normal"><a href="#__codelineno-0-3747">3747</a></span>
<span class="normal"><a href="#__codelineno-0-3748">3748</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-3722" name="__codelineno-0-3722"></a><span class="k">def</span> <span class="nf">get_arsc_info</span><span class="p">(</span><span class="n">arscobj</span><span class="p">:</span> <span class="n">ARSCParser</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-3723" name="__codelineno-0-3723"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3724" name="__codelineno-0-3724"></a><span class="sd">    Return a string containing all resources packages ordered by packagename, locale and type.</span>
<a id="__codelineno-0-3725" name="__codelineno-0-3725"></a>
<a id="__codelineno-0-3726" name="__codelineno-0-3726"></a><span class="sd">    :param arscobj: [ARSCParser][androguard.core.axml.ARSCParser]</span>
<a id="__codelineno-0-3727" name="__codelineno-0-3727"></a><span class="sd">    :return: a string</span>
<a id="__codelineno-0-3728" name="__codelineno-0-3728"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-3729" name="__codelineno-0-3729"></a>    <span class="n">buff</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-3730" name="__codelineno-0-3730"></a>    <span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">arscobj</span><span class="o">.</span><span class="n">get_packages_names</span><span class="p">():</span>
<a id="__codelineno-0-3731" name="__codelineno-0-3731"></a>        <span class="n">buff</span> <span class="o">+=</span> <span class="n">package</span> <span class="o">+</span> <span class="s2">&quot;:</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-3732" name="__codelineno-0-3732"></a>        <span class="k">for</span> <span class="n">locale</span> <span class="ow">in</span> <span class="n">arscobj</span><span class="o">.</span><span class="n">get_locales</span><span class="p">(</span><span class="n">package</span><span class="p">):</span>
<a id="__codelineno-0-3733" name="__codelineno-0-3733"></a>            <span class="n">buff</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">locale</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;:</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-3734" name="__codelineno-0-3734"></a>            <span class="k">for</span> <span class="n">ttype</span> <span class="ow">in</span> <span class="n">arscobj</span><span class="o">.</span><span class="n">get_types</span><span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">locale</span><span class="p">):</span>
<a id="__codelineno-0-3735" name="__codelineno-0-3735"></a>                <span class="n">buff</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">ttype</span> <span class="o">+</span> <span class="s2">&quot;:</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-3736" name="__codelineno-0-3736"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-3737" name="__codelineno-0-3737"></a>                    <span class="n">tmp_buff</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-3738" name="__codelineno-0-3738"></a>                        <span class="nb">getattr</span><span class="p">(</span><span class="n">arscobj</span><span class="p">,</span> <span class="s2">&quot;get_&quot;</span> <span class="o">+</span> <span class="n">ttype</span> <span class="o">+</span> <span class="s2">&quot;_resources&quot;</span><span class="p">)(</span>
<a id="__codelineno-0-3739" name="__codelineno-0-3739"></a>                            <span class="n">package</span><span class="p">,</span> <span class="n">locale</span>
<a id="__codelineno-0-3740" name="__codelineno-0-3740"></a>                        <span class="p">)</span>
<a id="__codelineno-0-3741" name="__codelineno-0-3741"></a>                        <span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<a id="__codelineno-0-3742" name="__codelineno-0-3742"></a>                        <span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3743" name="__codelineno-0-3743"></a>                    <span class="p">)</span>
<a id="__codelineno-0-3744" name="__codelineno-0-3744"></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tmp_buff</span><span class="p">:</span>
<a id="__codelineno-0-3745" name="__codelineno-0-3745"></a>                        <span class="n">buff</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t\t\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-3746" name="__codelineno-0-3746"></a>                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<a id="__codelineno-0-3747" name="__codelineno-0-3747"></a>                    <span class="k">pass</span>
<a id="__codelineno-0-3748" name="__codelineno-0-3748"></a>    <span class="k">return</span> <span class="n">buff</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2024 androguard
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tracking", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>